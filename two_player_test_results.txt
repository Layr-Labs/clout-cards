
> clout-cards@1.0.0 test
> vitest tests/integration/twoPlayerMatrix.test.ts


 RUN  v4.0.14 /Users/scottconner/projects/clout-cards

stdout | tests/integration/twoPlayerMatrix.test.ts
Starting PostgreSQL test container...

Loaded Prisma config from prisma.config.ts.

Prisma config detected, skipping environment variable loading.
Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "cloutcards_test", schema "public" at "localhost:33699"

ðŸš€  Your database is now in sync with your Prisma schema. Done in 106ms

Loaded Prisma config from prisma.config.ts.

Prisma config detected, skipping environment variable loading.
Prisma schema loaded from prisma/schema.prisma

âœ” Generated Prisma Client (v6.19.0) to ./node_modules/@prisma/client in 46ms

Start by importing your Prisma Client (See: https://pris.ly/d/importing-client)

Tip: Want to turn off tips and other hints? https://pris.ly/tip-4-nohints

stdout | tests/integration/twoPlayerMatrix.test.ts
Test database: localhost:33699/cloutcards_test
Pushing Prisma schema to test database...
Generating Prisma client...

stdout | tests/integration/twoPlayerMatrix.test.ts
Test database ready!

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-001: Immediate Fold (Small Blind Folds)
[DEBUG foldAction] Hand 1: Player seat 0 folding in round PRE_FLOP
[DEBUG foldAction] Hand 1: Creating FOLD action with: {"handId":1,"seatNumber":0,"round":"PRE_FLOP","action":"FOLD","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-001: Immediate Fold (Small Blind Folds)
[DEBUG foldAction] Hand 1: FOLD action created successfully: {"id":3,"seatNumber":0,"action":"FOLD","round":"PRE_FLOP","amount":null}
[DEBUG foldAction] Hand 1: FOLD action created, checking if round complete or advancing to next player

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-001: Immediate Fold (Small Blind Folds) - 700 bps rake
[DEBUG foldAction] Hand 2: Player seat 0 folding in round PRE_FLOP
[DEBUG foldAction] Hand 2: Creating FOLD action with: {"handId":2,"seatNumber":0,"round":"PRE_FLOP","action":"FOLD","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-001: Immediate Fold (Small Blind Folds) - 700 bps rake
[DEBUG foldAction] Hand 2: FOLD action created successfully: {"id":6,"seatNumber":0,"action":"FOLD","round":"PRE_FLOP","amount":null}
[DEBUG foldAction] Hand 2: FOLD action created, checking if round complete or advancing to next player

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-001: Immediate Fold (Small Blind Folds) - 700 bps rake
ðŸ’° Added rake 210000 gwei to TEE balance (hand 2)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-002: Immediate Fold (Big Blind Folds)
[DEBUG raiseAction] Hand 3: Player seat 0 raising 3000000 in round PRE_FLOP, currentBet before=2000000, chipsCommitted before=1000000, isAllIn=false
[DEBUG raiseAction] Hand 3: Creating RAISE action - hand.round=PRE_FLOP, actionType=RAISE, eventActionType=RAISE
[DEBUG createActionAndEvent] Hand 3: Creating action with: {"handId":3,"seatNumber":0,"round":"PRE_FLOP","action":"RAISE","amount":"3000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-002: Immediate Fold (Big Blind Folds)
[DEBUG createActionAndEvent] Hand 3: Action created successfully: {"id":9,"seatNumber":0,"action":"RAISE","round":"PRE_FLOP","amount":"3000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-002: Immediate Fold (Big Blind Folds)
[DEBUG raiseAction] Hand 3: RAISE action created successfully, checking if round complete
[DEBUG raiseAction] Hand 3: Checking if betting round complete after RAISE
[DEBUG raiseAction] Hand 3: Context before isBettingRoundComplete - hand.round=PRE_FLOP, currentBet=2000000, currentActionSeat=0
[DEBUG isBettingRoundComplete] Hand 3: Starting check
[DEBUG isBettingRoundComplete] Hand 3: Querying hand with: {"where":{"id":3}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-002: Immediate Fold (Big Blind Folds)
[DEBUG isBettingRoundComplete] Hand 3: Query result - hand={"id":3,"round":"PRE_FLOP","currentBet":"4000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 3: currentBet=4000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 3: Querying handPlayers with: {"where":{"handId":3}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-002: Immediate Fold (Big Blind Folds)
[DEBUG isBettingRoundComplete] Hand 3: Query returned 2 handPlayers: [{"id":5,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"4000000"},{"id":6,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG isBettingRoundComplete] Hand 3: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 3: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 3: Querying roundActions with: {
  "where": {
    "handId": 3,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-002: Immediate Fold (Big Blind Folds)
[DEBUG isBettingRoundComplete] Hand 3: Query returned 1 roundActions for round PRE_FLOP: [{"id":9,"seatNumber":0,"action":"RAISE","amount":"3000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 3: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 3: Checking 2 active players against actedSeats and currentBet=4000000
[DEBUG isBettingRoundComplete] Hand 3: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=4000000, currentBet=4000000)
[DEBUG isBettingRoundComplete] Hand 3: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 3: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-002: Immediate Fold (Big Blind Folds)
[DEBUG raiseAction] Hand 3: isBettingRoundComplete returned false
[DEBUG handleBettingActionCompletion] Hand 3: Called with currentSeatNumber=0, currentRound=PRE_FLOP, bettingRoundComplete=false, isAllIn=false
[DEBUG handleBettingActionCompletion] Hand 3: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 3: Called with currentSeatNumber=0, currentRound=PRE_FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-002: Immediate Fold (Big Blind Folds)
[DEBUG handleNextPlayerOrRoundComplete] Hand 3: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 3: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 3: Querying hand with: {"where":{"id":3},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-002: Immediate Fold (Big Blind Folds)
[DEBUG handleNextPlayerOrRoundComplete] Hand 3: Query result - hand.round=PRE_FLOP, currentRound param=PRE_FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 3: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"4000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 3: nextPlayer seat=1, chipsCommitted=2000000, currentBet=4000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 3: Next player hasn't matched (chipsCommitted=2000000, currentBet=4000000)
[DEBUG handleNextPlayerOrRoundComplete] Hand 3: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 3: Starting check
[DEBUG isBettingRoundComplete] Hand 3: Querying hand with: {"where":{"id":3}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-002: Immediate Fold (Big Blind Folds)
[DEBUG isBettingRoundComplete] Hand 3: Query result - hand={"id":3,"round":"PRE_FLOP","currentBet":"4000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 3: currentBet=4000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 3: Querying handPlayers with: {"where":{"handId":3}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-002: Immediate Fold (Big Blind Folds)
[DEBUG isBettingRoundComplete] Hand 3: Query returned 2 handPlayers: [{"id":5,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"4000000"},{"id":6,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG isBettingRoundComplete] Hand 3: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 3: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 3: Querying roundActions with: {
  "where": {
    "handId": 3,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-002: Immediate Fold (Big Blind Folds)
[DEBUG isBettingRoundComplete] Hand 3: Query returned 1 roundActions for round PRE_FLOP: [{"id":9,"seatNumber":0,"action":"RAISE","amount":"3000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 3: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 3: Checking 2 active players against actedSeats and currentBet=4000000
[DEBUG isBettingRoundComplete] Hand 3: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=4000000, currentBet=4000000)
[DEBUG isBettingRoundComplete] Hand 3: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 3: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-002: Immediate Fold (Big Blind Folds)
[DEBUG handleNextPlayerOrRoundComplete] Hand 3: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 3: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 3: Updating hand with: {"where":{"id":3},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-002: Immediate Fold (Big Blind Folds)
[DEBUG handleNextPlayerOrRoundComplete] Hand 3: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 3: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 3: Context - currentRound=PRE_FLOP, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-002: Immediate Fold (Big Blind Folds)
[DEBUG handleBettingActionCompletion] Hand 3: RETURNING result: handEnded=false, roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-002: Immediate Fold (Big Blind Folds)
[DEBUG raiseAction] Hand 3: handleBettingActionCompletion returned: handEnded=false, roundAdvanced=false
[DEBUG raiseAction] Hand 3: RETURNING from transaction
[DEBUG raiseAction] Hand 3: Context - hand.round=PRE_FLOP, handEnded=false, roundAdvanced=false, winnerSeatNumber=null
[DEBUG raiseAction] Hand 3: RETURNING from transaction - Final values: handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-002: Immediate Fold (Big Blind Folds)
[DEBUG raiseAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=3

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-002: Immediate Fold (Big Blind Folds)
[DEBUG foldAction] Hand 3: Player seat 1 folding in round PRE_FLOP
[DEBUG foldAction] Hand 3: Creating FOLD action with: {"handId":3,"seatNumber":1,"round":"PRE_FLOP","action":"FOLD","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-002: Immediate Fold (Big Blind Folds)
[DEBUG foldAction] Hand 3: FOLD action created successfully: {"id":10,"seatNumber":1,"action":"FOLD","round":"PRE_FLOP","amount":null}
[DEBUG foldAction] Hand 3: FOLD action created, checking if round complete or advancing to next player

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-002: Immediate Fold (Big Blind Folds) - 700 bps rake
[DEBUG raiseAction] Hand 4: Player seat 0 raising 3000000 in round PRE_FLOP, currentBet before=2000000, chipsCommitted before=1000000, isAllIn=false
[DEBUG raiseAction] Hand 4: Creating RAISE action - hand.round=PRE_FLOP, actionType=RAISE, eventActionType=RAISE
[DEBUG createActionAndEvent] Hand 4: Creating action with: {"handId":4,"seatNumber":0,"round":"PRE_FLOP","action":"RAISE","amount":"3000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-002: Immediate Fold (Big Blind Folds) - 700 bps rake
[DEBUG createActionAndEvent] Hand 4: Action created successfully: {"id":13,"seatNumber":0,"action":"RAISE","round":"PRE_FLOP","amount":"3000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-002: Immediate Fold (Big Blind Folds) - 700 bps rake
[DEBUG raiseAction] Hand 4: RAISE action created successfully, checking if round complete
[DEBUG raiseAction] Hand 4: Checking if betting round complete after RAISE
[DEBUG raiseAction] Hand 4: Context before isBettingRoundComplete - hand.round=PRE_FLOP, currentBet=2000000, currentActionSeat=0
[DEBUG isBettingRoundComplete] Hand 4: Starting check
[DEBUG isBettingRoundComplete] Hand 4: Querying hand with: {"where":{"id":4}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-002: Immediate Fold (Big Blind Folds) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 4: Query result - hand={"id":4,"round":"PRE_FLOP","currentBet":"4000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 4: currentBet=4000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 4: Querying handPlayers with: {"where":{"handId":4}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-002: Immediate Fold (Big Blind Folds) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 4: Query returned 2 handPlayers: [{"id":7,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"4000000"},{"id":8,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG isBettingRoundComplete] Hand 4: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 4: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 4: Querying roundActions with: {
  "where": {
    "handId": 4,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-002: Immediate Fold (Big Blind Folds) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 4: Query returned 1 roundActions for round PRE_FLOP: [{"id":13,"seatNumber":0,"action":"RAISE","amount":"3000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 4: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 4: Checking 2 active players against actedSeats and currentBet=4000000
[DEBUG isBettingRoundComplete] Hand 4: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=4000000, currentBet=4000000)
[DEBUG isBettingRoundComplete] Hand 4: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 4: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-002: Immediate Fold (Big Blind Folds) - 700 bps rake
[DEBUG raiseAction] Hand 4: isBettingRoundComplete returned false
[DEBUG handleBettingActionCompletion] Hand 4: Called with currentSeatNumber=0, currentRound=PRE_FLOP, bettingRoundComplete=false, isAllIn=false
[DEBUG handleBettingActionCompletion] Hand 4: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 4: Called with currentSeatNumber=0, currentRound=PRE_FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-002: Immediate Fold (Big Blind Folds) - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 4: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 4: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 4: Querying hand with: {"where":{"id":4},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-002: Immediate Fold (Big Blind Folds) - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 4: Query result - hand.round=PRE_FLOP, currentRound param=PRE_FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 4: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"4000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 4: nextPlayer seat=1, chipsCommitted=2000000, currentBet=4000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 4: Next player hasn't matched (chipsCommitted=2000000, currentBet=4000000)
[DEBUG handleNextPlayerOrRoundComplete] Hand 4: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 4: Starting check
[DEBUG isBettingRoundComplete] Hand 4: Querying hand with: {"where":{"id":4}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-002: Immediate Fold (Big Blind Folds) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 4: Query result - hand={"id":4,"round":"PRE_FLOP","currentBet":"4000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 4: currentBet=4000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 4: Querying handPlayers with: {"where":{"handId":4}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-002: Immediate Fold (Big Blind Folds) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 4: Query returned 2 handPlayers: [{"id":7,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"4000000"},{"id":8,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG isBettingRoundComplete] Hand 4: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 4: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 4: Querying roundActions with: {
  "where": {
    "handId": 4,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-002: Immediate Fold (Big Blind Folds) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 4: Query returned 1 roundActions for round PRE_FLOP: [{"id":13,"seatNumber":0,"action":"RAISE","amount":"3000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 4: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 4: Checking 2 active players against actedSeats and currentBet=4000000
[DEBUG isBettingRoundComplete] Hand 4: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=4000000, currentBet=4000000)
[DEBUG isBettingRoundComplete] Hand 4: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 4: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-002: Immediate Fold (Big Blind Folds) - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 4: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 4: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 4: Updating hand with: {"where":{"id":4},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-002: Immediate Fold (Big Blind Folds) - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 4: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 4: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 4: Context - currentRound=PRE_FLOP, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-002: Immediate Fold (Big Blind Folds) - 700 bps rake
[DEBUG handleBettingActionCompletion] Hand 4: RETURNING result: handEnded=false, roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-002: Immediate Fold (Big Blind Folds) - 700 bps rake
[DEBUG raiseAction] Hand 4: handleBettingActionCompletion returned: handEnded=false, roundAdvanced=false
[DEBUG raiseAction] Hand 4: RETURNING from transaction
[DEBUG raiseAction] Hand 4: Context - hand.round=PRE_FLOP, handEnded=false, roundAdvanced=false, winnerSeatNumber=null
[DEBUG raiseAction] Hand 4: RETURNING from transaction - Final values: handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-002: Immediate Fold (Big Blind Folds) - 700 bps rake
[DEBUG raiseAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=4

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-002: Immediate Fold (Big Blind Folds) - 700 bps rake
[DEBUG foldAction] Hand 4: Player seat 1 folding in round PRE_FLOP
[DEBUG foldAction] Hand 4: Creating FOLD action with: {"handId":4,"seatNumber":1,"round":"PRE_FLOP","action":"FOLD","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-002: Immediate Fold (Big Blind Folds) - 700 bps rake
[DEBUG foldAction] Hand 4: FOLD action created successfully: {"id":14,"seatNumber":1,"action":"FOLD","round":"PRE_FLOP","amount":null}
[DEBUG foldAction] Hand 4: FOLD action created, checking if round complete or advancing to next player

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-002: Immediate Fold (Big Blind Folds) - 700 bps rake
ðŸ’° Added rake 420000 gwei to TEE balance (hand 4)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-003: Call Pre-Flop (No Raise)
[DEBUG callAction] Hand 5: Player seat 0 calling 1000000 in round PRE_FLOP, currentBet=2000000, chipsCommitted before=1000000
[DEBUG callAction] Hand 5: Creating CALL action with: handId=5, seatNumber=0, round=PRE_FLOP, amount=1000000
[DEBUG createActionAndEvent] Hand 5: Creating action with: {"handId":5,"seatNumber":0,"round":"PRE_FLOP","action":"CALL","amount":"1000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-003: Call Pre-Flop (No Raise)
[DEBUG createActionAndEvent] Hand 5: Action created successfully: {"id":17,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"1000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-003: Call Pre-Flop (No Raise)
[DEBUG callAction] Hand 5: CALL action created successfully: {"id":17,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"1000000"}
[DEBUG callAction] Hand 5: CALL action created, chipsCommitted now=2000000

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-003: Call Pre-Flop (No Raise)
[DEBUG callAction] Hand 5: After CALL by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 5: Starting check
[DEBUG isBettingRoundComplete] Hand 5: Querying hand with: {"where":{"id":5}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-003: Call Pre-Flop (No Raise)
[DEBUG isBettingRoundComplete] Hand 5: Query result - hand={"id":5,"round":"PRE_FLOP","currentBet":"2000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 5: currentBet=2000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 5: Querying handPlayers with: {"where":{"handId":5}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-003: Call Pre-Flop (No Raise)
[DEBUG isBettingRoundComplete] Hand 5: Query returned 2 handPlayers: [{"id":9,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"id":10,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG isBettingRoundComplete] Hand 5: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 5: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 5: Querying roundActions with: {
  "where": {
    "handId": 5,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-003: Call Pre-Flop (No Raise)
[DEBUG isBettingRoundComplete] Hand 5: Query returned 1 roundActions for round PRE_FLOP: [{"id":17,"seatNumber":0,"action":"CALL","amount":"1000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 5: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 5: Checking 2 active players against actedSeats and currentBet=2000000
[DEBUG isBettingRoundComplete] Hand 5: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=2000000, currentBet=2000000)
[DEBUG isBettingRoundComplete] Hand 5: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 5: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-003: Call Pre-Flop (No Raise)
[DEBUG callAction] Hand 5: isBettingRoundComplete returned false
[DEBUG callAction] Hand 5: Round not complete, checking auto-advance or next player

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-003: Call Pre-Flop (No Raise)
[DEBUG callAction] Hand 5: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 5: Called with currentSeatNumber=0, currentRound=PRE_FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-003: Call Pre-Flop (No Raise)
[DEBUG handleNextPlayerOrRoundComplete] Hand 5: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 5: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 5: Querying hand with: {"where":{"id":5},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-003: Call Pre-Flop (No Raise)
[DEBUG handleNextPlayerOrRoundComplete] Hand 5: Query result - hand.round=PRE_FLOP, currentRound param=PRE_FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 5: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 5: nextPlayer seat=1, chipsCommitted=2000000, currentBet=2000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 5: Next player has matched bet (currentBet > 0n), checking if all acted and matched
[DEBUG handleNextPlayerOrRoundComplete] Hand 5: Querying roundActions with: {
  "where": {
    "handId": 5,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-003: Call Pre-Flop (No Raise)
[DEBUG handleNextPlayerOrRoundComplete] Hand 5: Query returned 1 roundActions for round PRE_FLOP: [{"id":17,"seatNumber":0,"action":"CALL","amount":"1000000","round":"PRE_FLOP"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 5: allActivePlayers (2): [
  { seatNumber: 0, chipsCommitted: '2000000', status: 'ACTIVE' },
  { seatNumber: 1, chipsCommitted: '2000000', status: 'ACTIVE' }
]
[DEBUG handleNextPlayerOrRoundComplete] Hand 5: Wrap-around check - allActed=false, allMatched=true, actedSeats=0, playersWhoHaventActed=1, onlyNextPlayerHaventActed=true
[DEBUG handleNextPlayerOrRoundComplete] Hand 5: Round complete detected - RETURNING early with round completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 5: Context - allActed=false, onlyNextPlayerHaventActed=true, allMatched=true, currentRound=PRE_FLOP, nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 5: Context - allActivePlayers=[{"seat":0,"chipsCommitted":"2000000","status":"ACTIVE"},{"seat":1,"chipsCommitted":"2000000","status":"ACTIVE"}], actedSeats=[0], roundActions found=1
[DEBUG handleBettingRoundComplete] Hand 5: Called with currentRound=PRE_FLOP
[DEBUG handleBettingRoundComplete] Hand 5: Advancing from PRE_FLOP to next round
[DEBUG advanceBettingRound] Hand 5: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-003: Call Pre-Flop (No Raise)
[DEBUG advanceBettingRound] Hand 5: needsSidePots=false
[DEBUG advanceBettingRound] Hand 5: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-003: Call Pre-Flop (No Raise)
[DEBUG advanceBettingRound] Hand 5: Querying hand with: {"where":{"id":5},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-003: Call Pre-Flop (No Raise)
[DEBUG advanceBettingRound] Hand 5: Query result - hand.round=PRE_FLOP, players=2
[DEBUG advanceBettingRound] Hand 5: currentRound=PRE_FLOP, deckPosition=4, communityCards.length=0
[DEBUG advanceBettingRound] Hand 5: Advancing from PRE_FLOP to FLOP, cardsToDeal=3
[DEBUG advanceBettingRound] Hand 5: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 5: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '2000000' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '2000000' }
]
[DEBUG advanceBettingRound] Hand 5: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 5: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 5: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 5: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 5: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-003: Call Pre-Flop (No Raise)
[DEBUG advanceBettingRound] Hand 5: Updating hand state: round=FLOP, status=FLOP, currentActionSeat=0, newCommunityCards.length=3
[DEBUG advanceBettingRound] Hand 5: Updating hand with: {"where":{"id":5},"data":{"round":"FLOP","status":"FLOP","communityCards":"[3 cards]","deckPosition":7,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-003: Call Pre-Flop (No Raise)
[DEBUG advanceBettingRound] Hand 5: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-003: Call Pre-Flop (No Raise)
[DEBUG advanceBettingRound] Hand 5: RETURNING false - Round advanced successfully from PRE_FLOP to FLOP (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-003: Call Pre-Flop (No Raise)
[DEBUG handleBettingRoundComplete] Hand 5: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 5: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-003: Call Pre-Flop (No Raise)
[DEBUG handleBettingRoundComplete] Hand 5: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 5: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-003: Call Pre-Flop (No Raise)
[DEBUG handleNextPlayerOrRoundComplete] Hand 5: RETURNING result from handleBettingRoundComplete: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-003: Call Pre-Flop (No Raise)
[DEBUG callAction] Hand 5: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=true
[DEBUG callAction] Hand 5: RETURNING from transaction - Final result
[DEBUG callAction] Hand 5: Context - hand.round=PRE_FLOP, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-003: Call Pre-Flop (No Raise)
[DEBUG callAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=5

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-004: Single Raise Pre-Flop (Call)
[DEBUG raiseAction] Hand 6: Player seat 0 raising 3000000 in round PRE_FLOP, currentBet before=2000000, chipsCommitted before=1000000, isAllIn=false
[DEBUG raiseAction] Hand 6: Creating RAISE action - hand.round=PRE_FLOP, actionType=RAISE, eventActionType=RAISE
[DEBUG createActionAndEvent] Hand 6: Creating action with: {"handId":6,"seatNumber":0,"round":"PRE_FLOP","action":"RAISE","amount":"3000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-004: Single Raise Pre-Flop (Call)
[DEBUG createActionAndEvent] Hand 6: Action created successfully: {"id":20,"seatNumber":0,"action":"RAISE","round":"PRE_FLOP","amount":"3000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-004: Single Raise Pre-Flop (Call)
[DEBUG raiseAction] Hand 6: RAISE action created successfully, checking if round complete
[DEBUG raiseAction] Hand 6: Checking if betting round complete after RAISE
[DEBUG raiseAction] Hand 6: Context before isBettingRoundComplete - hand.round=PRE_FLOP, currentBet=2000000, currentActionSeat=0
[DEBUG isBettingRoundComplete] Hand 6: Starting check
[DEBUG isBettingRoundComplete] Hand 6: Querying hand with: {"where":{"id":6}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-004: Single Raise Pre-Flop (Call)
[DEBUG isBettingRoundComplete] Hand 6: Query result - hand={"id":6,"round":"PRE_FLOP","currentBet":"4000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 6: currentBet=4000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 6: Querying handPlayers with: {"where":{"handId":6}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-004: Single Raise Pre-Flop (Call)
[DEBUG isBettingRoundComplete] Hand 6: Query returned 2 handPlayers: [{"id":11,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"4000000"},{"id":12,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG isBettingRoundComplete] Hand 6: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 6: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 6: Querying roundActions with: {
  "where": {
    "handId": 6,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-004: Single Raise Pre-Flop (Call)
[DEBUG isBettingRoundComplete] Hand 6: Query returned 1 roundActions for round PRE_FLOP: [{"id":20,"seatNumber":0,"action":"RAISE","amount":"3000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 6: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 6: Checking 2 active players against actedSeats and currentBet=4000000
[DEBUG isBettingRoundComplete] Hand 6: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=4000000, currentBet=4000000)
[DEBUG isBettingRoundComplete] Hand 6: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 6: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-004: Single Raise Pre-Flop (Call)
[DEBUG raiseAction] Hand 6: isBettingRoundComplete returned false
[DEBUG handleBettingActionCompletion] Hand 6: Called with currentSeatNumber=0, currentRound=PRE_FLOP, bettingRoundComplete=false, isAllIn=false
[DEBUG handleBettingActionCompletion] Hand 6: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 6: Called with currentSeatNumber=0, currentRound=PRE_FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-004: Single Raise Pre-Flop (Call)
[DEBUG handleNextPlayerOrRoundComplete] Hand 6: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 6: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 6: Querying hand with: {"where":{"id":6},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-004: Single Raise Pre-Flop (Call)
[DEBUG handleNextPlayerOrRoundComplete] Hand 6: Query result - hand.round=PRE_FLOP, currentRound param=PRE_FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 6: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"4000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 6: nextPlayer seat=1, chipsCommitted=2000000, currentBet=4000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 6: Next player hasn't matched (chipsCommitted=2000000, currentBet=4000000)
[DEBUG handleNextPlayerOrRoundComplete] Hand 6: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 6: Starting check
[DEBUG isBettingRoundComplete] Hand 6: Querying hand with: {"where":{"id":6}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-004: Single Raise Pre-Flop (Call)
[DEBUG isBettingRoundComplete] Hand 6: Query result - hand={"id":6,"round":"PRE_FLOP","currentBet":"4000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 6: currentBet=4000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 6: Querying handPlayers with: {"where":{"handId":6}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-004: Single Raise Pre-Flop (Call)
[DEBUG isBettingRoundComplete] Hand 6: Query returned 2 handPlayers: [{"id":11,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"4000000"},{"id":12,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG isBettingRoundComplete] Hand 6: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 6: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 6: Querying roundActions with: {
  "where": {
    "handId": 6,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-004: Single Raise Pre-Flop (Call)
[DEBUG isBettingRoundComplete] Hand 6: Query returned 1 roundActions for round PRE_FLOP: [{"id":20,"seatNumber":0,"action":"RAISE","amount":"3000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 6: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 6: Checking 2 active players against actedSeats and currentBet=4000000
[DEBUG isBettingRoundComplete] Hand 6: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=4000000, currentBet=4000000)
[DEBUG isBettingRoundComplete] Hand 6: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 6: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-004: Single Raise Pre-Flop (Call)
[DEBUG handleNextPlayerOrRoundComplete] Hand 6: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 6: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 6: Updating hand with: {"where":{"id":6},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-004: Single Raise Pre-Flop (Call)
[DEBUG handleNextPlayerOrRoundComplete] Hand 6: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 6: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 6: Context - currentRound=PRE_FLOP, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-004: Single Raise Pre-Flop (Call)
[DEBUG handleBettingActionCompletion] Hand 6: RETURNING result: handEnded=false, roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-004: Single Raise Pre-Flop (Call)
[DEBUG raiseAction] Hand 6: handleBettingActionCompletion returned: handEnded=false, roundAdvanced=false
[DEBUG raiseAction] Hand 6: RETURNING from transaction
[DEBUG raiseAction] Hand 6: Context - hand.round=PRE_FLOP, handEnded=false, roundAdvanced=false, winnerSeatNumber=null
[DEBUG raiseAction] Hand 6: RETURNING from transaction - Final values: handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-004: Single Raise Pre-Flop (Call)
[DEBUG raiseAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=6

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-004: Single Raise Pre-Flop (Call)
[DEBUG callAction] Hand 6: Player seat 1 calling 2000000 in round PRE_FLOP, currentBet=4000000, chipsCommitted before=2000000
[DEBUG callAction] Hand 6: Creating CALL action with: handId=6, seatNumber=1, round=PRE_FLOP, amount=2000000
[DEBUG createActionAndEvent] Hand 6: Creating action with: {"handId":6,"seatNumber":1,"round":"PRE_FLOP","action":"CALL","amount":"2000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-004: Single Raise Pre-Flop (Call)
[DEBUG createActionAndEvent] Hand 6: Action created successfully: {"id":21,"seatNumber":1,"action":"CALL","round":"PRE_FLOP","amount":"2000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-004: Single Raise Pre-Flop (Call)
[DEBUG callAction] Hand 6: CALL action created successfully: {"id":21,"seatNumber":1,"action":"CALL","round":"PRE_FLOP","amount":"2000000"}
[DEBUG callAction] Hand 6: CALL action created, chipsCommitted now=4000000

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-004: Single Raise Pre-Flop (Call)
[DEBUG callAction] Hand 6: After CALL by seat 1, checking if round complete
[DEBUG isBettingRoundComplete] Hand 6: Starting check
[DEBUG isBettingRoundComplete] Hand 6: Querying hand with: {"where":{"id":6}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-004: Single Raise Pre-Flop (Call)
[DEBUG isBettingRoundComplete] Hand 6: Query result - hand={"id":6,"round":"PRE_FLOP","currentBet":"4000000","currentActionSeat":1,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 6: currentBet=4000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 6: Querying handPlayers with: {"where":{"handId":6}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-004: Single Raise Pre-Flop (Call)
[DEBUG isBettingRoundComplete] Hand 6: Query returned 2 handPlayers: [{"id":11,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"4000000"},{"id":12,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"4000000"}]
[DEBUG isBettingRoundComplete] Hand 6: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 6: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 6: Querying roundActions with: {
  "where": {
    "handId": 6,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-004: Single Raise Pre-Flop (Call)
[DEBUG isBettingRoundComplete] Hand 6: Query returned 2 roundActions for round PRE_FLOP: [{"id":20,"seatNumber":0,"action":"RAISE","amount":"3000000","round":"PRE_FLOP"},{"id":21,"seatNumber":1,"action":"CALL","amount":"2000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 6: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 6: Checking 2 active players against actedSeats and currentBet=4000000
[DEBUG isBettingRoundComplete] Hand 6: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=4000000, currentBet=4000000)
[DEBUG isBettingRoundComplete] Hand 6: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=4000000, currentBet=4000000)
[DEBUG isBettingRoundComplete] Hand 6: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=4000000, currentBet=4000000)
[DEBUG isBettingRoundComplete] Hand 6: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=4000000, currentBet=4000000)
[DEBUG isBettingRoundComplete] Hand 6: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 6: Context - activePlayers=2, actedSeats=[0,1], currentBet=4000000, currentRound=PRE_FLOP, roundActions queried=2, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 6: Active players detail: [{"seatNumber":0,"chipsCommitted":"4000000","status":"ACTIVE","hasActed":true,"hasMatched":true},{"seatNumber":1,"chipsCommitted":"4000000","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-004: Single Raise Pre-Flop (Call)
[DEBUG callAction] Hand 6: isBettingRoundComplete returned true
[DEBUG callAction] Hand 6: Round complete, calling handleBettingRoundComplete
[DEBUG handleBettingRoundComplete] Hand 6: Called with currentRound=PRE_FLOP
[DEBUG handleBettingRoundComplete] Hand 6: Advancing from PRE_FLOP to next round
[DEBUG advanceBettingRound] Hand 6: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-004: Single Raise Pre-Flop (Call)
[DEBUG advanceBettingRound] Hand 6: needsSidePots=false
[DEBUG advanceBettingRound] Hand 6: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-004: Single Raise Pre-Flop (Call)
[DEBUG advanceBettingRound] Hand 6: Querying hand with: {"where":{"id":6},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-004: Single Raise Pre-Flop (Call)
[DEBUG advanceBettingRound] Hand 6: Query result - hand.round=PRE_FLOP, players=2
[DEBUG advanceBettingRound] Hand 6: currentRound=PRE_FLOP, deckPosition=4, communityCards.length=0
[DEBUG advanceBettingRound] Hand 6: Advancing from PRE_FLOP to FLOP, cardsToDeal=3
[DEBUG advanceBettingRound] Hand 6: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 6: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '4000000' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '4000000' }
]
[DEBUG advanceBettingRound] Hand 6: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 6: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 6: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 6: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 6: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-004: Single Raise Pre-Flop (Call)
[DEBUG advanceBettingRound] Hand 6: Updating hand state: round=FLOP, status=FLOP, currentActionSeat=0, newCommunityCards.length=3
[DEBUG advanceBettingRound] Hand 6: Updating hand with: {"where":{"id":6},"data":{"round":"FLOP","status":"FLOP","communityCards":"[3 cards]","deckPosition":7,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-004: Single Raise Pre-Flop (Call)
[DEBUG advanceBettingRound] Hand 6: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-004: Single Raise Pre-Flop (Call)
[DEBUG advanceBettingRound] Hand 6: RETURNING false - Round advanced successfully from PRE_FLOP to FLOP (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-004: Single Raise Pre-Flop (Call)
[DEBUG handleBettingRoundComplete] Hand 6: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 6: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-004: Single Raise Pre-Flop (Call)
[DEBUG handleBettingRoundComplete] Hand 6: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 6: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-004: Single Raise Pre-Flop (Call)
[DEBUG callAction] Hand 6: handleBettingRoundComplete returned handEnded=false, roundAdvanced=true
[DEBUG callAction] Hand 6: RETURNING from transaction - Round complete
[DEBUG callAction] Hand 6: Context - hand.round=PRE_FLOP, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-004: Single Raise Pre-Flop (Call)
[DEBUG callAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=6

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-005: Single Raise Pre-Flop (Fold)
[DEBUG raiseAction] Hand 7: Player seat 0 raising 3000000 in round PRE_FLOP, currentBet before=2000000, chipsCommitted before=1000000, isAllIn=false
[DEBUG raiseAction] Hand 7: Creating RAISE action - hand.round=PRE_FLOP, actionType=RAISE, eventActionType=RAISE
[DEBUG createActionAndEvent] Hand 7: Creating action with: {"handId":7,"seatNumber":0,"round":"PRE_FLOP","action":"RAISE","amount":"3000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-005: Single Raise Pre-Flop (Fold)
[DEBUG createActionAndEvent] Hand 7: Action created successfully: {"id":24,"seatNumber":0,"action":"RAISE","round":"PRE_FLOP","amount":"3000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-005: Single Raise Pre-Flop (Fold)
[DEBUG raiseAction] Hand 7: RAISE action created successfully, checking if round complete
[DEBUG raiseAction] Hand 7: Checking if betting round complete after RAISE
[DEBUG raiseAction] Hand 7: Context before isBettingRoundComplete - hand.round=PRE_FLOP, currentBet=2000000, currentActionSeat=0
[DEBUG isBettingRoundComplete] Hand 7: Starting check
[DEBUG isBettingRoundComplete] Hand 7: Querying hand with: {"where":{"id":7}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-005: Single Raise Pre-Flop (Fold)
[DEBUG isBettingRoundComplete] Hand 7: Query result - hand={"id":7,"round":"PRE_FLOP","currentBet":"4000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 7: currentBet=4000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 7: Querying handPlayers with: {"where":{"handId":7}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-005: Single Raise Pre-Flop (Fold)
[DEBUG isBettingRoundComplete] Hand 7: Query returned 2 handPlayers: [{"id":13,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"4000000"},{"id":14,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG isBettingRoundComplete] Hand 7: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 7: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 7: Querying roundActions with: {
  "where": {
    "handId": 7,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-005: Single Raise Pre-Flop (Fold)
[DEBUG isBettingRoundComplete] Hand 7: Query returned 1 roundActions for round PRE_FLOP: [{"id":24,"seatNumber":0,"action":"RAISE","amount":"3000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 7: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 7: Checking 2 active players against actedSeats and currentBet=4000000
[DEBUG isBettingRoundComplete] Hand 7: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=4000000, currentBet=4000000)
[DEBUG isBettingRoundComplete] Hand 7: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 7: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-005: Single Raise Pre-Flop (Fold)
[DEBUG raiseAction] Hand 7: isBettingRoundComplete returned false
[DEBUG handleBettingActionCompletion] Hand 7: Called with currentSeatNumber=0, currentRound=PRE_FLOP, bettingRoundComplete=false, isAllIn=false
[DEBUG handleBettingActionCompletion] Hand 7: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 7: Called with currentSeatNumber=0, currentRound=PRE_FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-005: Single Raise Pre-Flop (Fold)
[DEBUG handleNextPlayerOrRoundComplete] Hand 7: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 7: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 7: Querying hand with: {"where":{"id":7},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-005: Single Raise Pre-Flop (Fold)
[DEBUG handleNextPlayerOrRoundComplete] Hand 7: Query result - hand.round=PRE_FLOP, currentRound param=PRE_FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 7: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"4000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 7: nextPlayer seat=1, chipsCommitted=2000000, currentBet=4000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 7: Next player hasn't matched (chipsCommitted=2000000, currentBet=4000000)
[DEBUG handleNextPlayerOrRoundComplete] Hand 7: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 7: Starting check
[DEBUG isBettingRoundComplete] Hand 7: Querying hand with: {"where":{"id":7}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-005: Single Raise Pre-Flop (Fold)
[DEBUG isBettingRoundComplete] Hand 7: Query result - hand={"id":7,"round":"PRE_FLOP","currentBet":"4000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 7: currentBet=4000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 7: Querying handPlayers with: {"where":{"handId":7}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-005: Single Raise Pre-Flop (Fold)
[DEBUG isBettingRoundComplete] Hand 7: Query returned 2 handPlayers: [{"id":13,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"4000000"},{"id":14,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG isBettingRoundComplete] Hand 7: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 7: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 7: Querying roundActions with: {
  "where": {
    "handId": 7,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-005: Single Raise Pre-Flop (Fold)
[DEBUG isBettingRoundComplete] Hand 7: Query returned 1 roundActions for round PRE_FLOP: [{"id":24,"seatNumber":0,"action":"RAISE","amount":"3000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 7: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 7: Checking 2 active players against actedSeats and currentBet=4000000
[DEBUG isBettingRoundComplete] Hand 7: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=4000000, currentBet=4000000)
[DEBUG isBettingRoundComplete] Hand 7: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 7: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-005: Single Raise Pre-Flop (Fold)
[DEBUG handleNextPlayerOrRoundComplete] Hand 7: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 7: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 7: Updating hand with: {"where":{"id":7},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-005: Single Raise Pre-Flop (Fold)
[DEBUG handleNextPlayerOrRoundComplete] Hand 7: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 7: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 7: Context - currentRound=PRE_FLOP, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-005: Single Raise Pre-Flop (Fold)
[DEBUG handleBettingActionCompletion] Hand 7: RETURNING result: handEnded=false, roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-005: Single Raise Pre-Flop (Fold)
[DEBUG raiseAction] Hand 7: handleBettingActionCompletion returned: handEnded=false, roundAdvanced=false
[DEBUG raiseAction] Hand 7: RETURNING from transaction
[DEBUG raiseAction] Hand 7: Context - hand.round=PRE_FLOP, handEnded=false, roundAdvanced=false, winnerSeatNumber=null
[DEBUG raiseAction] Hand 7: RETURNING from transaction - Final values: handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-005: Single Raise Pre-Flop (Fold)
[DEBUG raiseAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=7

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-005: Single Raise Pre-Flop (Fold)
[DEBUG foldAction] Hand 7: Player seat 1 folding in round PRE_FLOP
[DEBUG foldAction] Hand 7: Creating FOLD action with: {"handId":7,"seatNumber":1,"round":"PRE_FLOP","action":"FOLD","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-005: Single Raise Pre-Flop (Fold)
[DEBUG foldAction] Hand 7: FOLD action created successfully: {"id":25,"seatNumber":1,"action":"FOLD","round":"PRE_FLOP","amount":null}
[DEBUG foldAction] Hand 7: FOLD action created, checking if round complete or advancing to next player

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-005: Single Raise Pre-Flop (Fold) - 700 bps rake
[DEBUG raiseAction] Hand 8: Player seat 0 raising 3000000 in round PRE_FLOP, currentBet before=2000000, chipsCommitted before=1000000, isAllIn=false
[DEBUG raiseAction] Hand 8: Creating RAISE action - hand.round=PRE_FLOP, actionType=RAISE, eventActionType=RAISE
[DEBUG createActionAndEvent] Hand 8: Creating action with: {"handId":8,"seatNumber":0,"round":"PRE_FLOP","action":"RAISE","amount":"3000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-005: Single Raise Pre-Flop (Fold) - 700 bps rake
[DEBUG createActionAndEvent] Hand 8: Action created successfully: {"id":28,"seatNumber":0,"action":"RAISE","round":"PRE_FLOP","amount":"3000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-005: Single Raise Pre-Flop (Fold) - 700 bps rake
[DEBUG raiseAction] Hand 8: RAISE action created successfully, checking if round complete
[DEBUG raiseAction] Hand 8: Checking if betting round complete after RAISE
[DEBUG raiseAction] Hand 8: Context before isBettingRoundComplete - hand.round=PRE_FLOP, currentBet=2000000, currentActionSeat=0
[DEBUG isBettingRoundComplete] Hand 8: Starting check
[DEBUG isBettingRoundComplete] Hand 8: Querying hand with: {"where":{"id":8}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-005: Single Raise Pre-Flop (Fold) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 8: Query result - hand={"id":8,"round":"PRE_FLOP","currentBet":"4000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 8: currentBet=4000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 8: Querying handPlayers with: {"where":{"handId":8}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-005: Single Raise Pre-Flop (Fold) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 8: Query returned 2 handPlayers: [{"id":15,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"4000000"},{"id":16,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG isBettingRoundComplete] Hand 8: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 8: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 8: Querying roundActions with: {
  "where": {
    "handId": 8,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-005: Single Raise Pre-Flop (Fold) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 8: Query returned 1 roundActions for round PRE_FLOP: [{"id":28,"seatNumber":0,"action":"RAISE","amount":"3000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 8: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 8: Checking 2 active players against actedSeats and currentBet=4000000
[DEBUG isBettingRoundComplete] Hand 8: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=4000000, currentBet=4000000)
[DEBUG isBettingRoundComplete] Hand 8: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 8: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-005: Single Raise Pre-Flop (Fold) - 700 bps rake
[DEBUG raiseAction] Hand 8: isBettingRoundComplete returned false
[DEBUG handleBettingActionCompletion] Hand 8: Called with currentSeatNumber=0, currentRound=PRE_FLOP, bettingRoundComplete=false, isAllIn=false
[DEBUG handleBettingActionCompletion] Hand 8: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 8: Called with currentSeatNumber=0, currentRound=PRE_FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-005: Single Raise Pre-Flop (Fold) - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 8: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 8: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 8: Querying hand with: {"where":{"id":8},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-005: Single Raise Pre-Flop (Fold) - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 8: Query result - hand.round=PRE_FLOP, currentRound param=PRE_FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 8: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"4000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 8: nextPlayer seat=1, chipsCommitted=2000000, currentBet=4000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 8: Next player hasn't matched (chipsCommitted=2000000, currentBet=4000000)
[DEBUG handleNextPlayerOrRoundComplete] Hand 8: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 8: Starting check
[DEBUG isBettingRoundComplete] Hand 8: Querying hand with: {"where":{"id":8}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-005: Single Raise Pre-Flop (Fold) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 8: Query result - hand={"id":8,"round":"PRE_FLOP","currentBet":"4000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 8: currentBet=4000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 8: Querying handPlayers with: {"where":{"handId":8}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-005: Single Raise Pre-Flop (Fold) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 8: Query returned 2 handPlayers: [{"id":15,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"4000000"},{"id":16,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG isBettingRoundComplete] Hand 8: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 8: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 8: Querying roundActions with: {
  "where": {
    "handId": 8,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-005: Single Raise Pre-Flop (Fold) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 8: Query returned 1 roundActions for round PRE_FLOP: [{"id":28,"seatNumber":0,"action":"RAISE","amount":"3000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 8: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 8: Checking 2 active players against actedSeats and currentBet=4000000
[DEBUG isBettingRoundComplete] Hand 8: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=4000000, currentBet=4000000)
[DEBUG isBettingRoundComplete] Hand 8: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 8: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-005: Single Raise Pre-Flop (Fold) - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 8: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 8: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 8: Updating hand with: {"where":{"id":8},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-005: Single Raise Pre-Flop (Fold) - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 8: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 8: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 8: Context - currentRound=PRE_FLOP, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-005: Single Raise Pre-Flop (Fold) - 700 bps rake
[DEBUG handleBettingActionCompletion] Hand 8: RETURNING result: handEnded=false, roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-005: Single Raise Pre-Flop (Fold) - 700 bps rake
[DEBUG raiseAction] Hand 8: handleBettingActionCompletion returned: handEnded=false, roundAdvanced=false
[DEBUG raiseAction] Hand 8: RETURNING from transaction
[DEBUG raiseAction] Hand 8: Context - hand.round=PRE_FLOP, handEnded=false, roundAdvanced=false, winnerSeatNumber=null
[DEBUG raiseAction] Hand 8: RETURNING from transaction - Final values: handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-005: Single Raise Pre-Flop (Fold) - 700 bps rake
[DEBUG raiseAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=8

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-005: Single Raise Pre-Flop (Fold) - 700 bps rake
[DEBUG foldAction] Hand 8: Player seat 1 folding in round PRE_FLOP
[DEBUG foldAction] Hand 8: Creating FOLD action with: {"handId":8,"seatNumber":1,"round":"PRE_FLOP","action":"FOLD","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-005: Single Raise Pre-Flop (Fold) - 700 bps rake
[DEBUG foldAction] Hand 8: FOLD action created successfully: {"id":29,"seatNumber":1,"action":"FOLD","round":"PRE_FLOP","amount":null}
[DEBUG foldAction] Hand 8: FOLD action created, checking if round complete or advancing to next player

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-005: Single Raise Pre-Flop (Fold) - 700 bps rake
ðŸ’° Added rake 420000 gwei to TEE balance (hand 8)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-006: Multiple Raises Pre-Flop (3-Bet)
[DEBUG raiseAction] Hand 9: Player seat 0 raising 3000000 in round PRE_FLOP, currentBet before=2000000, chipsCommitted before=1000000, isAllIn=false
[DEBUG raiseAction] Hand 9: Creating RAISE action - hand.round=PRE_FLOP, actionType=RAISE, eventActionType=RAISE
[DEBUG createActionAndEvent] Hand 9: Creating action with: {"handId":9,"seatNumber":0,"round":"PRE_FLOP","action":"RAISE","amount":"3000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-006: Multiple Raises Pre-Flop (3-Bet)
[DEBUG createActionAndEvent] Hand 9: Action created successfully: {"id":32,"seatNumber":0,"action":"RAISE","round":"PRE_FLOP","amount":"3000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-006: Multiple Raises Pre-Flop (3-Bet)
[DEBUG raiseAction] Hand 9: RAISE action created successfully, checking if round complete
[DEBUG raiseAction] Hand 9: Checking if betting round complete after RAISE
[DEBUG raiseAction] Hand 9: Context before isBettingRoundComplete - hand.round=PRE_FLOP, currentBet=2000000, currentActionSeat=0
[DEBUG isBettingRoundComplete] Hand 9: Starting check
[DEBUG isBettingRoundComplete] Hand 9: Querying hand with: {"where":{"id":9}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-006: Multiple Raises Pre-Flop (3-Bet)
[DEBUG isBettingRoundComplete] Hand 9: Query result - hand={"id":9,"round":"PRE_FLOP","currentBet":"4000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 9: currentBet=4000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 9: Querying handPlayers with: {"where":{"handId":9}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-006: Multiple Raises Pre-Flop (3-Bet)
[DEBUG isBettingRoundComplete] Hand 9: Query returned 2 handPlayers: [{"id":17,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"4000000"},{"id":18,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG isBettingRoundComplete] Hand 9: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 9: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 9: Querying roundActions with: {
  "where": {
    "handId": 9,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-006: Multiple Raises Pre-Flop (3-Bet)
[DEBUG isBettingRoundComplete] Hand 9: Query returned 1 roundActions for round PRE_FLOP: [{"id":32,"seatNumber":0,"action":"RAISE","amount":"3000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 9: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 9: Checking 2 active players against actedSeats and currentBet=4000000
[DEBUG isBettingRoundComplete] Hand 9: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=4000000, currentBet=4000000)
[DEBUG isBettingRoundComplete] Hand 9: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 9: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-006: Multiple Raises Pre-Flop (3-Bet)
[DEBUG raiseAction] Hand 9: isBettingRoundComplete returned false
[DEBUG handleBettingActionCompletion] Hand 9: Called with currentSeatNumber=0, currentRound=PRE_FLOP, bettingRoundComplete=false, isAllIn=false
[DEBUG handleBettingActionCompletion] Hand 9: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 9: Called with currentSeatNumber=0, currentRound=PRE_FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-006: Multiple Raises Pre-Flop (3-Bet)
[DEBUG handleNextPlayerOrRoundComplete] Hand 9: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 9: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 9: Querying hand with: {"where":{"id":9},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-006: Multiple Raises Pre-Flop (3-Bet)
[DEBUG handleNextPlayerOrRoundComplete] Hand 9: Query result - hand.round=PRE_FLOP, currentRound param=PRE_FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 9: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"4000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 9: nextPlayer seat=1, chipsCommitted=2000000, currentBet=4000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 9: Next player hasn't matched (chipsCommitted=2000000, currentBet=4000000)
[DEBUG handleNextPlayerOrRoundComplete] Hand 9: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 9: Starting check
[DEBUG isBettingRoundComplete] Hand 9: Querying hand with: {"where":{"id":9}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-006: Multiple Raises Pre-Flop (3-Bet)
[DEBUG isBettingRoundComplete] Hand 9: Query result - hand={"id":9,"round":"PRE_FLOP","currentBet":"4000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 9: currentBet=4000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 9: Querying handPlayers with: {"where":{"handId":9}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-006: Multiple Raises Pre-Flop (3-Bet)
[DEBUG isBettingRoundComplete] Hand 9: Query returned 2 handPlayers: [{"id":17,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"4000000"},{"id":18,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG isBettingRoundComplete] Hand 9: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 9: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 9: Querying roundActions with: {
  "where": {
    "handId": 9,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-006: Multiple Raises Pre-Flop (3-Bet)
[DEBUG isBettingRoundComplete] Hand 9: Query returned 1 roundActions for round PRE_FLOP: [{"id":32,"seatNumber":0,"action":"RAISE","amount":"3000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 9: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 9: Checking 2 active players against actedSeats and currentBet=4000000
[DEBUG isBettingRoundComplete] Hand 9: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=4000000, currentBet=4000000)
[DEBUG isBettingRoundComplete] Hand 9: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 9: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-006: Multiple Raises Pre-Flop (3-Bet)
[DEBUG handleNextPlayerOrRoundComplete] Hand 9: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 9: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 9: Updating hand with: {"where":{"id":9},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-006: Multiple Raises Pre-Flop (3-Bet)
[DEBUG handleNextPlayerOrRoundComplete] Hand 9: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 9: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 9: Context - currentRound=PRE_FLOP, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-006: Multiple Raises Pre-Flop (3-Bet)
[DEBUG handleBettingActionCompletion] Hand 9: RETURNING result: handEnded=false, roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-006: Multiple Raises Pre-Flop (3-Bet)
[DEBUG raiseAction] Hand 9: handleBettingActionCompletion returned: handEnded=false, roundAdvanced=false
[DEBUG raiseAction] Hand 9: RETURNING from transaction
[DEBUG raiseAction] Hand 9: Context - hand.round=PRE_FLOP, handEnded=false, roundAdvanced=false, winnerSeatNumber=null
[DEBUG raiseAction] Hand 9: RETURNING from transaction - Final values: handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-006: Multiple Raises Pre-Flop (3-Bet)
[DEBUG raiseAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=9

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-006: Multiple Raises Pre-Flop (3-Bet)
[DEBUG raiseAction] Hand 9: Player seat 1 raising 5000000 in round PRE_FLOP, currentBet before=4000000, chipsCommitted before=2000000, isAllIn=false
[DEBUG raiseAction] Hand 9: Creating RAISE action - hand.round=PRE_FLOP, actionType=RAISE, eventActionType=RAISE
[DEBUG createActionAndEvent] Hand 9: Creating action with: {"handId":9,"seatNumber":1,"round":"PRE_FLOP","action":"RAISE","amount":"5000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-006: Multiple Raises Pre-Flop (3-Bet)
[DEBUG createActionAndEvent] Hand 9: Action created successfully: {"id":33,"seatNumber":1,"action":"RAISE","round":"PRE_FLOP","amount":"5000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-006: Multiple Raises Pre-Flop (3-Bet)
[DEBUG raiseAction] Hand 9: RAISE action created successfully, checking if round complete
[DEBUG raiseAction] Hand 9: Checking if betting round complete after RAISE
[DEBUG raiseAction] Hand 9: Context before isBettingRoundComplete - hand.round=PRE_FLOP, currentBet=4000000, currentActionSeat=1
[DEBUG isBettingRoundComplete] Hand 9: Starting check
[DEBUG isBettingRoundComplete] Hand 9: Querying hand with: {"where":{"id":9}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-006: Multiple Raises Pre-Flop (3-Bet)
[DEBUG isBettingRoundComplete] Hand 9: Query result - hand={"id":9,"round":"PRE_FLOP","currentBet":"7000000","currentActionSeat":1,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 9: currentBet=7000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 9: Querying handPlayers with: {"where":{"handId":9}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-006: Multiple Raises Pre-Flop (3-Bet)
[DEBUG isBettingRoundComplete] Hand 9: Query returned 2 handPlayers: [{"id":17,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"4000000"},{"id":18,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"7000000"}]
[DEBUG isBettingRoundComplete] Hand 9: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 9: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 9: Querying roundActions with: {
  "where": {
    "handId": 9,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-006: Multiple Raises Pre-Flop (3-Bet)
[DEBUG isBettingRoundComplete] Hand 9: Query returned 2 roundActions for round PRE_FLOP: [{"id":32,"seatNumber":0,"action":"RAISE","amount":"3000000","round":"PRE_FLOP"},{"id":33,"seatNumber":1,"action":"RAISE","amount":"5000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 9: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 9: Checking 2 active players against actedSeats and currentBet=7000000
[DEBUG isBettingRoundComplete] Hand 9: RETURNING false - Player 0 hasn't matched bet.
[DEBUG isBettingRoundComplete] Hand 9: Context - chipsCommitted=4000000, currentBet=7000000, playerSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-006: Multiple Raises Pre-Flop (3-Bet)
[DEBUG raiseAction] Hand 9: isBettingRoundComplete returned false
[DEBUG handleBettingActionCompletion] Hand 9: Called with currentSeatNumber=1, currentRound=PRE_FLOP, bettingRoundComplete=false, isAllIn=false
[DEBUG handleBettingActionCompletion] Hand 9: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 9: Called with currentSeatNumber=1, currentRound=PRE_FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-006: Multiple Raises Pre-Flop (3-Bet)
[DEBUG handleNextPlayerOrRoundComplete] Hand 9: getNextActivePlayer returned nextSeat=0
[DEBUG handleNextPlayerOrRoundComplete] Hand 9: nextSeat=0, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 9: Querying hand with: {"where":{"id":9},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-006: Multiple Raises Pre-Flop (3-Bet)
[DEBUG handleNextPlayerOrRoundComplete] Hand 9: Query result - hand.round=PRE_FLOP, currentRound param=PRE_FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 9: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"4000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"7000000"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 9: nextPlayer seat=0, chipsCommitted=4000000, currentBet=7000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 9: Next player hasn't matched (chipsCommitted=4000000, currentBet=7000000)
[DEBUG handleNextPlayerOrRoundComplete] Hand 9: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 9: Starting check
[DEBUG isBettingRoundComplete] Hand 9: Querying hand with: {"where":{"id":9}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-006: Multiple Raises Pre-Flop (3-Bet)
[DEBUG isBettingRoundComplete] Hand 9: Query result - hand={"id":9,"round":"PRE_FLOP","currentBet":"7000000","currentActionSeat":1,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 9: currentBet=7000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 9: Querying handPlayers with: {"where":{"handId":9}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-006: Multiple Raises Pre-Flop (3-Bet)
[DEBUG isBettingRoundComplete] Hand 9: Query returned 2 handPlayers: [{"id":17,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"4000000"},{"id":18,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"7000000"}]
[DEBUG isBettingRoundComplete] Hand 9: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 9: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 9: Querying roundActions with: {
  "where": {
    "handId": 9,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-006: Multiple Raises Pre-Flop (3-Bet)
[DEBUG isBettingRoundComplete] Hand 9: Query returned 2 roundActions for round PRE_FLOP: [{"id":32,"seatNumber":0,"action":"RAISE","amount":"3000000","round":"PRE_FLOP"},{"id":33,"seatNumber":1,"action":"RAISE","amount":"5000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 9: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 9: Checking 2 active players against actedSeats and currentBet=7000000
[DEBUG isBettingRoundComplete] Hand 9: RETURNING false - Player 0 hasn't matched bet.
[DEBUG isBettingRoundComplete] Hand 9: Context - chipsCommitted=4000000, currentBet=7000000, playerSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-006: Multiple Raises Pre-Flop (3-Bet)
[DEBUG handleNextPlayerOrRoundComplete] Hand 9: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 9: Round not complete, advancing to next player 0
[DEBUG handleNextPlayerOrRoundComplete] Hand 9: Updating hand with: {"where":{"id":9},"data":{"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-006: Multiple Raises Pre-Flop (3-Bet)
[DEBUG handleNextPlayerOrRoundComplete] Hand 9: Hand updated successfully, currentActionSeat now=0
[DEBUG handleNextPlayerOrRoundComplete] Hand 9: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 9: Context - currentRound=PRE_FLOP, nextSeat=0, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-006: Multiple Raises Pre-Flop (3-Bet)
[DEBUG handleBettingActionCompletion] Hand 9: RETURNING result: handEnded=false, roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-006: Multiple Raises Pre-Flop (3-Bet)
[DEBUG raiseAction] Hand 9: handleBettingActionCompletion returned: handEnded=false, roundAdvanced=false
[DEBUG raiseAction] Hand 9: RETURNING from transaction
[DEBUG raiseAction] Hand 9: Context - hand.round=PRE_FLOP, handEnded=false, roundAdvanced=false, winnerSeatNumber=null
[DEBUG raiseAction] Hand 9: RETURNING from transaction - Final values: handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-006: Multiple Raises Pre-Flop (3-Bet)
[DEBUG raiseAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=9

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-006: Multiple Raises Pre-Flop (3-Bet)
[DEBUG callAction] Hand 9: Player seat 0 calling 3000000 in round PRE_FLOP, currentBet=7000000, chipsCommitted before=4000000
[DEBUG callAction] Hand 9: Creating CALL action with: handId=9, seatNumber=0, round=PRE_FLOP, amount=3000000
[DEBUG createActionAndEvent] Hand 9: Creating action with: {"handId":9,"seatNumber":0,"round":"PRE_FLOP","action":"CALL","amount":"3000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-006: Multiple Raises Pre-Flop (3-Bet)
[DEBUG createActionAndEvent] Hand 9: Action created successfully: {"id":34,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"3000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-006: Multiple Raises Pre-Flop (3-Bet)
[DEBUG callAction] Hand 9: CALL action created successfully: {"id":34,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"3000000"}
[DEBUG callAction] Hand 9: CALL action created, chipsCommitted now=7000000

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-006: Multiple Raises Pre-Flop (3-Bet)
[DEBUG callAction] Hand 9: After CALL by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 9: Starting check
[DEBUG isBettingRoundComplete] Hand 9: Querying hand with: {"where":{"id":9}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-006: Multiple Raises Pre-Flop (3-Bet)
[DEBUG isBettingRoundComplete] Hand 9: Query result - hand={"id":9,"round":"PRE_FLOP","currentBet":"7000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 9: currentBet=7000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 9: Querying handPlayers with: {"where":{"handId":9}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-006: Multiple Raises Pre-Flop (3-Bet)
[DEBUG isBettingRoundComplete] Hand 9: Query returned 2 handPlayers: [{"id":17,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"7000000"},{"id":18,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"7000000"}]
[DEBUG isBettingRoundComplete] Hand 9: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 9: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 9: Querying roundActions with: {
  "where": {
    "handId": 9,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-006: Multiple Raises Pre-Flop (3-Bet)
[DEBUG isBettingRoundComplete] Hand 9: Query returned 3 roundActions for round PRE_FLOP: [{"id":32,"seatNumber":0,"action":"RAISE","amount":"3000000","round":"PRE_FLOP"},{"id":33,"seatNumber":1,"action":"RAISE","amount":"5000000","round":"PRE_FLOP"},{"id":34,"seatNumber":0,"action":"CALL","amount":"3000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 9: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 9: Checking 2 active players against actedSeats and currentBet=7000000
[DEBUG isBettingRoundComplete] Hand 9: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=7000000, currentBet=7000000)
[DEBUG isBettingRoundComplete] Hand 9: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=7000000, currentBet=7000000)
[DEBUG isBettingRoundComplete] Hand 9: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=7000000, currentBet=7000000)
[DEBUG isBettingRoundComplete] Hand 9: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=7000000, currentBet=7000000)
[DEBUG isBettingRoundComplete] Hand 9: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 9: Context - activePlayers=2, actedSeats=[0,1], currentBet=7000000, currentRound=PRE_FLOP, roundActions queried=3, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 9: Active players detail: [{"seatNumber":0,"chipsCommitted":"7000000","status":"ACTIVE","hasActed":true,"hasMatched":true},{"seatNumber":1,"chipsCommitted":"7000000","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-006: Multiple Raises Pre-Flop (3-Bet)
[DEBUG callAction] Hand 9: isBettingRoundComplete returned true
[DEBUG callAction] Hand 9: Round complete, calling handleBettingRoundComplete
[DEBUG handleBettingRoundComplete] Hand 9: Called with currentRound=PRE_FLOP
[DEBUG handleBettingRoundComplete] Hand 9: Advancing from PRE_FLOP to next round
[DEBUG advanceBettingRound] Hand 9: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-006: Multiple Raises Pre-Flop (3-Bet)
[DEBUG advanceBettingRound] Hand 9: needsSidePots=false
[DEBUG advanceBettingRound] Hand 9: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-006: Multiple Raises Pre-Flop (3-Bet)
[DEBUG advanceBettingRound] Hand 9: Querying hand with: {"where":{"id":9},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-006: Multiple Raises Pre-Flop (3-Bet)
[DEBUG advanceBettingRound] Hand 9: Query result - hand.round=PRE_FLOP, players=2
[DEBUG advanceBettingRound] Hand 9: currentRound=PRE_FLOP, deckPosition=4, communityCards.length=0
[DEBUG advanceBettingRound] Hand 9: Advancing from PRE_FLOP to FLOP, cardsToDeal=3
[DEBUG advanceBettingRound] Hand 9: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 9: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '7000000' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '7000000' }
]
[DEBUG advanceBettingRound] Hand 9: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 9: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 9: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 9: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 9: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-006: Multiple Raises Pre-Flop (3-Bet)
[DEBUG advanceBettingRound] Hand 9: Updating hand state: round=FLOP, status=FLOP, currentActionSeat=0, newCommunityCards.length=3
[DEBUG advanceBettingRound] Hand 9: Updating hand with: {"where":{"id":9},"data":{"round":"FLOP","status":"FLOP","communityCards":"[3 cards]","deckPosition":7,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-006: Multiple Raises Pre-Flop (3-Bet)
[DEBUG advanceBettingRound] Hand 9: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-006: Multiple Raises Pre-Flop (3-Bet)
[DEBUG advanceBettingRound] Hand 9: RETURNING false - Round advanced successfully from PRE_FLOP to FLOP (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-006: Multiple Raises Pre-Flop (3-Bet)
[DEBUG handleBettingRoundComplete] Hand 9: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 9: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-006: Multiple Raises Pre-Flop (3-Bet)
[DEBUG handleBettingRoundComplete] Hand 9: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 9: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-006: Multiple Raises Pre-Flop (3-Bet)
[DEBUG callAction] Hand 9: handleBettingRoundComplete returned handEnded=false, roundAdvanced=true
[DEBUG callAction] Hand 9: RETURNING from transaction - Round complete
[DEBUG callAction] Hand 9: Context - hand.round=PRE_FLOP, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-006: Multiple Raises Pre-Flop (3-Bet)
[DEBUG callAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=9

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG raiseAction] Hand 10: Player seat 0 raising 3000000 in round PRE_FLOP, currentBet before=2000000, chipsCommitted before=1000000, isAllIn=false
[DEBUG raiseAction] Hand 10: Creating RAISE action - hand.round=PRE_FLOP, actionType=RAISE, eventActionType=RAISE
[DEBUG createActionAndEvent] Hand 10: Creating action with: {"handId":10,"seatNumber":0,"round":"PRE_FLOP","action":"RAISE","amount":"3000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG createActionAndEvent] Hand 10: Action created successfully: {"id":37,"seatNumber":0,"action":"RAISE","round":"PRE_FLOP","amount":"3000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG raiseAction] Hand 10: RAISE action created successfully, checking if round complete
[DEBUG raiseAction] Hand 10: Checking if betting round complete after RAISE
[DEBUG raiseAction] Hand 10: Context before isBettingRoundComplete - hand.round=PRE_FLOP, currentBet=2000000, currentActionSeat=0
[DEBUG isBettingRoundComplete] Hand 10: Starting check
[DEBUG isBettingRoundComplete] Hand 10: Querying hand with: {"where":{"id":10}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG isBettingRoundComplete] Hand 10: Query result - hand={"id":10,"round":"PRE_FLOP","currentBet":"4000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 10: currentBet=4000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 10: Querying handPlayers with: {"where":{"handId":10}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG isBettingRoundComplete] Hand 10: Query returned 2 handPlayers: [{"id":19,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"4000000"},{"id":20,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG isBettingRoundComplete] Hand 10: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 10: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 10: Querying roundActions with: {
  "where": {
    "handId": 10,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG isBettingRoundComplete] Hand 10: Query returned 1 roundActions for round PRE_FLOP: [{"id":37,"seatNumber":0,"action":"RAISE","amount":"3000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 10: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 10: Checking 2 active players against actedSeats and currentBet=4000000
[DEBUG isBettingRoundComplete] Hand 10: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=4000000, currentBet=4000000)
[DEBUG isBettingRoundComplete] Hand 10: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 10: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG raiseAction] Hand 10: isBettingRoundComplete returned false
[DEBUG handleBettingActionCompletion] Hand 10: Called with currentSeatNumber=0, currentRound=PRE_FLOP, bettingRoundComplete=false, isAllIn=false
[DEBUG handleBettingActionCompletion] Hand 10: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 10: Called with currentSeatNumber=0, currentRound=PRE_FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG handleNextPlayerOrRoundComplete] Hand 10: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 10: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 10: Querying hand with: {"where":{"id":10},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG handleNextPlayerOrRoundComplete] Hand 10: Query result - hand.round=PRE_FLOP, currentRound param=PRE_FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 10: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"4000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 10: nextPlayer seat=1, chipsCommitted=2000000, currentBet=4000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 10: Next player hasn't matched (chipsCommitted=2000000, currentBet=4000000)
[DEBUG handleNextPlayerOrRoundComplete] Hand 10: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 10: Starting check
[DEBUG isBettingRoundComplete] Hand 10: Querying hand with: {"where":{"id":10}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG isBettingRoundComplete] Hand 10: Query result - hand={"id":10,"round":"PRE_FLOP","currentBet":"4000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 10: currentBet=4000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 10: Querying handPlayers with: {"where":{"handId":10}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG isBettingRoundComplete] Hand 10: Query returned 2 handPlayers: [{"id":19,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"4000000"},{"id":20,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG isBettingRoundComplete] Hand 10: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 10: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 10: Querying roundActions with: {
  "where": {
    "handId": 10,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG isBettingRoundComplete] Hand 10: Query returned 1 roundActions for round PRE_FLOP: [{"id":37,"seatNumber":0,"action":"RAISE","amount":"3000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 10: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 10: Checking 2 active players against actedSeats and currentBet=4000000
[DEBUG isBettingRoundComplete] Hand 10: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=4000000, currentBet=4000000)
[DEBUG isBettingRoundComplete] Hand 10: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 10: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG handleNextPlayerOrRoundComplete] Hand 10: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 10: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 10: Updating hand with: {"where":{"id":10},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG handleNextPlayerOrRoundComplete] Hand 10: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 10: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 10: Context - currentRound=PRE_FLOP, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG handleBettingActionCompletion] Hand 10: RETURNING result: handEnded=false, roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG raiseAction] Hand 10: handleBettingActionCompletion returned: handEnded=false, roundAdvanced=false
[DEBUG raiseAction] Hand 10: RETURNING from transaction
[DEBUG raiseAction] Hand 10: Context - hand.round=PRE_FLOP, handEnded=false, roundAdvanced=false, winnerSeatNumber=null
[DEBUG raiseAction] Hand 10: RETURNING from transaction - Final values: handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG raiseAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=10

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG raiseAction] Hand 10: Player seat 1 raising 5000000 in round PRE_FLOP, currentBet before=4000000, chipsCommitted before=2000000, isAllIn=false
[DEBUG raiseAction] Hand 10: Creating RAISE action - hand.round=PRE_FLOP, actionType=RAISE, eventActionType=RAISE
[DEBUG createActionAndEvent] Hand 10: Creating action with: {"handId":10,"seatNumber":1,"round":"PRE_FLOP","action":"RAISE","amount":"5000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG createActionAndEvent] Hand 10: Action created successfully: {"id":38,"seatNumber":1,"action":"RAISE","round":"PRE_FLOP","amount":"5000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG raiseAction] Hand 10: RAISE action created successfully, checking if round complete
[DEBUG raiseAction] Hand 10: Checking if betting round complete after RAISE
[DEBUG raiseAction] Hand 10: Context before isBettingRoundComplete - hand.round=PRE_FLOP, currentBet=4000000, currentActionSeat=1
[DEBUG isBettingRoundComplete] Hand 10: Starting check
[DEBUG isBettingRoundComplete] Hand 10: Querying hand with: {"where":{"id":10}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG isBettingRoundComplete] Hand 10: Query result - hand={"id":10,"round":"PRE_FLOP","currentBet":"7000000","currentActionSeat":1,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 10: currentBet=7000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 10: Querying handPlayers with: {"where":{"handId":10}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG isBettingRoundComplete] Hand 10: Query returned 2 handPlayers: [{"id":19,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"4000000"},{"id":20,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"7000000"}]
[DEBUG isBettingRoundComplete] Hand 10: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 10: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 10: Querying roundActions with: {
  "where": {
    "handId": 10,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG isBettingRoundComplete] Hand 10: Query returned 2 roundActions for round PRE_FLOP: [{"id":37,"seatNumber":0,"action":"RAISE","amount":"3000000","round":"PRE_FLOP"},{"id":38,"seatNumber":1,"action":"RAISE","amount":"5000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 10: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 10: Checking 2 active players against actedSeats and currentBet=7000000
[DEBUG isBettingRoundComplete] Hand 10: RETURNING false - Player 0 hasn't matched bet.
[DEBUG isBettingRoundComplete] Hand 10: Context - chipsCommitted=4000000, currentBet=7000000, playerSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG raiseAction] Hand 10: isBettingRoundComplete returned false
[DEBUG handleBettingActionCompletion] Hand 10: Called with currentSeatNumber=1, currentRound=PRE_FLOP, bettingRoundComplete=false, isAllIn=false
[DEBUG handleBettingActionCompletion] Hand 10: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 10: Called with currentSeatNumber=1, currentRound=PRE_FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG handleNextPlayerOrRoundComplete] Hand 10: getNextActivePlayer returned nextSeat=0
[DEBUG handleNextPlayerOrRoundComplete] Hand 10: nextSeat=0, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 10: Querying hand with: {"where":{"id":10},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG handleNextPlayerOrRoundComplete] Hand 10: Query result - hand.round=PRE_FLOP, currentRound param=PRE_FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 10: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"4000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"7000000"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 10: nextPlayer seat=0, chipsCommitted=4000000, currentBet=7000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 10: Next player hasn't matched (chipsCommitted=4000000, currentBet=7000000)
[DEBUG handleNextPlayerOrRoundComplete] Hand 10: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 10: Starting check
[DEBUG isBettingRoundComplete] Hand 10: Querying hand with: {"where":{"id":10}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG isBettingRoundComplete] Hand 10: Query result - hand={"id":10,"round":"PRE_FLOP","currentBet":"7000000","currentActionSeat":1,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 10: currentBet=7000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 10: Querying handPlayers with: {"where":{"handId":10}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG isBettingRoundComplete] Hand 10: Query returned 2 handPlayers: [{"id":19,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"4000000"},{"id":20,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"7000000"}]
[DEBUG isBettingRoundComplete] Hand 10: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 10: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 10: Querying roundActions with: {
  "where": {
    "handId": 10,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG isBettingRoundComplete] Hand 10: Query returned 2 roundActions for round PRE_FLOP: [{"id":37,"seatNumber":0,"action":"RAISE","amount":"3000000","round":"PRE_FLOP"},{"id":38,"seatNumber":1,"action":"RAISE","amount":"5000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 10: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 10: Checking 2 active players against actedSeats and currentBet=7000000
[DEBUG isBettingRoundComplete] Hand 10: RETURNING false - Player 0 hasn't matched bet.
[DEBUG isBettingRoundComplete] Hand 10: Context - chipsCommitted=4000000, currentBet=7000000, playerSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG handleNextPlayerOrRoundComplete] Hand 10: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 10: Round not complete, advancing to next player 0
[DEBUG handleNextPlayerOrRoundComplete] Hand 10: Updating hand with: {"where":{"id":10},"data":{"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG handleNextPlayerOrRoundComplete] Hand 10: Hand updated successfully, currentActionSeat now=0
[DEBUG handleNextPlayerOrRoundComplete] Hand 10: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 10: Context - currentRound=PRE_FLOP, nextSeat=0, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG handleBettingActionCompletion] Hand 10: RETURNING result: handEnded=false, roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG raiseAction] Hand 10: handleBettingActionCompletion returned: handEnded=false, roundAdvanced=false
[DEBUG raiseAction] Hand 10: RETURNING from transaction
[DEBUG raiseAction] Hand 10: Context - hand.round=PRE_FLOP, handEnded=false, roundAdvanced=false, winnerSeatNumber=null
[DEBUG raiseAction] Hand 10: RETURNING from transaction - Final values: handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG raiseAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=10

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG raiseAction] Hand 10: Player seat 0 raising 10000000 in round PRE_FLOP, currentBet before=7000000, chipsCommitted before=4000000, isAllIn=false
[DEBUG raiseAction] Hand 10: Creating RAISE action - hand.round=PRE_FLOP, actionType=RAISE, eventActionType=RAISE
[DEBUG createActionAndEvent] Hand 10: Creating action with: {"handId":10,"seatNumber":0,"round":"PRE_FLOP","action":"RAISE","amount":"10000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG createActionAndEvent] Hand 10: Action created successfully: {"id":39,"seatNumber":0,"action":"RAISE","round":"PRE_FLOP","amount":"10000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG raiseAction] Hand 10: RAISE action created successfully, checking if round complete
[DEBUG raiseAction] Hand 10: Checking if betting round complete after RAISE
[DEBUG raiseAction] Hand 10: Context before isBettingRoundComplete - hand.round=PRE_FLOP, currentBet=7000000, currentActionSeat=0
[DEBUG isBettingRoundComplete] Hand 10: Starting check
[DEBUG isBettingRoundComplete] Hand 10: Querying hand with: {"where":{"id":10}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG isBettingRoundComplete] Hand 10: Query result - hand={"id":10,"round":"PRE_FLOP","currentBet":"14000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 10: currentBet=14000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 10: Querying handPlayers with: {"where":{"handId":10}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG isBettingRoundComplete] Hand 10: Query returned 2 handPlayers: [{"id":19,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"14000000"},{"id":20,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"7000000"}]
[DEBUG isBettingRoundComplete] Hand 10: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 10: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 10: Querying roundActions with: {
  "where": {
    "handId": 10,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG isBettingRoundComplete] Hand 10: Query returned 3 roundActions for round PRE_FLOP: [{"id":37,"seatNumber":0,"action":"RAISE","amount":"3000000","round":"PRE_FLOP"},{"id":38,"seatNumber":1,"action":"RAISE","amount":"5000000","round":"PRE_FLOP"},{"id":39,"seatNumber":0,"action":"RAISE","amount":"10000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 10: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 10: Checking 2 active players against actedSeats and currentBet=14000000
[DEBUG isBettingRoundComplete] Hand 10: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=14000000, currentBet=14000000)
[DEBUG isBettingRoundComplete] Hand 10: RETURNING false - Player 1 hasn't matched bet.
[DEBUG isBettingRoundComplete] Hand 10: Context - chipsCommitted=7000000, currentBet=14000000, playerSeat=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG raiseAction] Hand 10: isBettingRoundComplete returned false
[DEBUG handleBettingActionCompletion] Hand 10: Called with currentSeatNumber=0, currentRound=PRE_FLOP, bettingRoundComplete=false, isAllIn=false
[DEBUG handleBettingActionCompletion] Hand 10: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 10: Called with currentSeatNumber=0, currentRound=PRE_FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG handleNextPlayerOrRoundComplete] Hand 10: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 10: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 10: Querying hand with: {"where":{"id":10},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG handleNextPlayerOrRoundComplete] Hand 10: Query result - hand.round=PRE_FLOP, currentRound param=PRE_FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 10: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"14000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"7000000"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 10: nextPlayer seat=1, chipsCommitted=7000000, currentBet=14000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 10: Next player hasn't matched (chipsCommitted=7000000, currentBet=14000000)
[DEBUG handleNextPlayerOrRoundComplete] Hand 10: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 10: Starting check
[DEBUG isBettingRoundComplete] Hand 10: Querying hand with: {"where":{"id":10}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG isBettingRoundComplete] Hand 10: Query result - hand={"id":10,"round":"PRE_FLOP","currentBet":"14000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 10: currentBet=14000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 10: Querying handPlayers with: {"where":{"handId":10}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG isBettingRoundComplete] Hand 10: Query returned 2 handPlayers: [{"id":19,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"14000000"},{"id":20,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"7000000"}]
[DEBUG isBettingRoundComplete] Hand 10: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 10: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 10: Querying roundActions with: {
  "where": {
    "handId": 10,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG isBettingRoundComplete] Hand 10: Query returned 3 roundActions for round PRE_FLOP: [{"id":37,"seatNumber":0,"action":"RAISE","amount":"3000000","round":"PRE_FLOP"},{"id":38,"seatNumber":1,"action":"RAISE","amount":"5000000","round":"PRE_FLOP"},{"id":39,"seatNumber":0,"action":"RAISE","amount":"10000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 10: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 10: Checking 2 active players against actedSeats and currentBet=14000000
[DEBUG isBettingRoundComplete] Hand 10: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=14000000, currentBet=14000000)
[DEBUG isBettingRoundComplete] Hand 10: RETURNING false - Player 1 hasn't matched bet.
[DEBUG isBettingRoundComplete] Hand 10: Context - chipsCommitted=7000000, currentBet=14000000, playerSeat=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG handleNextPlayerOrRoundComplete] Hand 10: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 10: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 10: Updating hand with: {"where":{"id":10},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG handleNextPlayerOrRoundComplete] Hand 10: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 10: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 10: Context - currentRound=PRE_FLOP, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG handleBettingActionCompletion] Hand 10: RETURNING result: handEnded=false, roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG raiseAction] Hand 10: handleBettingActionCompletion returned: handEnded=false, roundAdvanced=false
[DEBUG raiseAction] Hand 10: RETURNING from transaction
[DEBUG raiseAction] Hand 10: Context - hand.round=PRE_FLOP, handEnded=false, roundAdvanced=false, winnerSeatNumber=null
[DEBUG raiseAction] Hand 10: RETURNING from transaction - Final values: handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG raiseAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=10

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG callAction] Hand 10: Player seat 1 calling 7000000 in round PRE_FLOP, currentBet=14000000, chipsCommitted before=7000000
[DEBUG callAction] Hand 10: Creating CALL action with: handId=10, seatNumber=1, round=PRE_FLOP, amount=7000000
[DEBUG createActionAndEvent] Hand 10: Creating action with: {"handId":10,"seatNumber":1,"round":"PRE_FLOP","action":"CALL","amount":"7000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG createActionAndEvent] Hand 10: Action created successfully: {"id":40,"seatNumber":1,"action":"CALL","round":"PRE_FLOP","amount":"7000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG callAction] Hand 10: CALL action created successfully: {"id":40,"seatNumber":1,"action":"CALL","round":"PRE_FLOP","amount":"7000000"}
[DEBUG callAction] Hand 10: CALL action created, chipsCommitted now=14000000

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG callAction] Hand 10: After CALL by seat 1, checking if round complete
[DEBUG isBettingRoundComplete] Hand 10: Starting check
[DEBUG isBettingRoundComplete] Hand 10: Querying hand with: {"where":{"id":10}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG isBettingRoundComplete] Hand 10: Query result - hand={"id":10,"round":"PRE_FLOP","currentBet":"14000000","currentActionSeat":1,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 10: currentBet=14000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 10: Querying handPlayers with: {"where":{"handId":10}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG isBettingRoundComplete] Hand 10: Query returned 2 handPlayers: [{"id":19,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"14000000"},{"id":20,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"14000000"}]
[DEBUG isBettingRoundComplete] Hand 10: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 10: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 10: Querying roundActions with: {
  "where": {
    "handId": 10,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG isBettingRoundComplete] Hand 10: Query returned 4 roundActions for round PRE_FLOP: [{"id":37,"seatNumber":0,"action":"RAISE","amount":"3000000","round":"PRE_FLOP"},{"id":38,"seatNumber":1,"action":"RAISE","amount":"5000000","round":"PRE_FLOP"},{"id":39,"seatNumber":0,"action":"RAISE","amount":"10000000","round":"PRE_FLOP"},{"id":40,"seatNumber":1,"action":"CALL","amount":"7000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 10: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 10: Checking 2 active players against actedSeats and currentBet=14000000
[DEBUG isBettingRoundComplete] Hand 10: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=14000000, currentBet=14000000)
[DEBUG isBettingRoundComplete] Hand 10: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=14000000, currentBet=14000000)
[DEBUG isBettingRoundComplete] Hand 10: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=14000000, currentBet=14000000)
[DEBUG isBettingRoundComplete] Hand 10: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=14000000, currentBet=14000000)
[DEBUG isBettingRoundComplete] Hand 10: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 10: Context - activePlayers=2, actedSeats=[0,1], currentBet=14000000, currentRound=PRE_FLOP, roundActions queried=4, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 10: Active players detail: [{"seatNumber":0,"chipsCommitted":"14000000","status":"ACTIVE","hasActed":true,"hasMatched":true},{"seatNumber":1,"chipsCommitted":"14000000","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG callAction] Hand 10: isBettingRoundComplete returned true
[DEBUG callAction] Hand 10: Round complete, calling handleBettingRoundComplete
[DEBUG handleBettingRoundComplete] Hand 10: Called with currentRound=PRE_FLOP
[DEBUG handleBettingRoundComplete] Hand 10: Advancing from PRE_FLOP to next round
[DEBUG advanceBettingRound] Hand 10: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG advanceBettingRound] Hand 10: needsSidePots=false
[DEBUG advanceBettingRound] Hand 10: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG advanceBettingRound] Hand 10: Querying hand with: {"where":{"id":10},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG advanceBettingRound] Hand 10: Query result - hand.round=PRE_FLOP, players=2
[DEBUG advanceBettingRound] Hand 10: currentRound=PRE_FLOP, deckPosition=4, communityCards.length=0
[DEBUG advanceBettingRound] Hand 10: Advancing from PRE_FLOP to FLOP, cardsToDeal=3
[DEBUG advanceBettingRound] Hand 10: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 10: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '14000000' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '14000000' }
]
[DEBUG advanceBettingRound] Hand 10: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 10: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 10: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 10: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 10: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG advanceBettingRound] Hand 10: Updating hand state: round=FLOP, status=FLOP, currentActionSeat=0, newCommunityCards.length=3
[DEBUG advanceBettingRound] Hand 10: Updating hand with: {"where":{"id":10},"data":{"round":"FLOP","status":"FLOP","communityCards":"[3 cards]","deckPosition":7,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG advanceBettingRound] Hand 10: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG advanceBettingRound] Hand 10: RETURNING false - Round advanced successfully from PRE_FLOP to FLOP (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG handleBettingRoundComplete] Hand 10: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 10: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG handleBettingRoundComplete] Hand 10: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 10: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG callAction] Hand 10: handleBettingRoundComplete returned handEnded=false, roundAdvanced=true
[DEBUG callAction] Hand 10: RETURNING from transaction - Round complete
[DEBUG callAction] Hand 10: Context - hand.round=PRE_FLOP, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-007: Multiple Raises Pre-Flop (4-Bet)
[DEBUG callAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=10

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG createActionAndEvent] Hand 11: Creating action with: {"handId":11,"seatNumber":0,"round":"PRE_FLOP","action":"ALL_IN","amount":"49000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG createActionAndEvent] Hand 11: Action created successfully: {"id":43,"seatNumber":0,"action":"ALL_IN","round":"PRE_FLOP","amount":"49000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG isBettingRoundComplete] Hand 11: Starting check
[DEBUG isBettingRoundComplete] Hand 11: Querying hand with: {"where":{"id":11}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG isBettingRoundComplete] Hand 11: Query result - hand={"id":11,"round":"PRE_FLOP","currentBet":"50000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 11: currentBet=50000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 11: Querying handPlayers with: {"where":{"handId":11}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG isBettingRoundComplete] Hand 11: Query returned 2 handPlayers: [{"id":22,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"},{"id":21,"seatNumber":0,"status":"ALL_IN","chipsCommitted":"50000000"}]
[DEBUG isBettingRoundComplete] Hand 11: activePlayers=1, allInPlayers=1
[DEBUG isBettingRoundComplete] Hand 11: Active player seats: [ 1 ]
[DEBUG isBettingRoundComplete] Hand 11: Querying roundActions with: {
  "where": {
    "handId": 11,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG isBettingRoundComplete] Hand 11: Query returned 1 roundActions for round PRE_FLOP: [{"id":43,"seatNumber":0,"action":"ALL_IN","amount":"49000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 11: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 11: Checking 1 active players against actedSeats and currentBet=50000000
[DEBUG isBettingRoundComplete] Hand 11: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 11: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG handleNextPlayerOrRoundComplete] Hand 11: Called with currentSeatNumber=0, currentRound=PRE_FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG handleNextPlayerOrRoundComplete] Hand 11: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 11: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 11: Querying hand with: {"where":{"id":11},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG handleNextPlayerOrRoundComplete] Hand 11: Query result - hand.round=PRE_FLOP, currentRound param=PRE_FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 11: Hand players: [{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"},{"seatNumber":0,"status":"ALL_IN","chipsCommitted":"50000000"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 11: nextPlayer seat=1, chipsCommitted=2000000, currentBet=50000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 11: Next player hasn't matched (chipsCommitted=2000000, currentBet=50000000)
[DEBUG handleNextPlayerOrRoundComplete] Hand 11: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 11: Starting check
[DEBUG isBettingRoundComplete] Hand 11: Querying hand with: {"where":{"id":11}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG isBettingRoundComplete] Hand 11: Query result - hand={"id":11,"round":"PRE_FLOP","currentBet":"50000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 11: currentBet=50000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 11: Querying handPlayers with: {"where":{"handId":11}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG isBettingRoundComplete] Hand 11: Query returned 2 handPlayers: [{"id":22,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"},{"id":21,"seatNumber":0,"status":"ALL_IN","chipsCommitted":"50000000"}]
[DEBUG isBettingRoundComplete] Hand 11: activePlayers=1, allInPlayers=1
[DEBUG isBettingRoundComplete] Hand 11: Active player seats: [ 1 ]
[DEBUG isBettingRoundComplete] Hand 11: Querying roundActions with: {
  "where": {
    "handId": 11,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG isBettingRoundComplete] Hand 11: Query returned 1 roundActions for round PRE_FLOP: [{"id":43,"seatNumber":0,"action":"ALL_IN","amount":"49000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 11: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 11: Checking 1 active players against actedSeats and currentBet=50000000
[DEBUG isBettingRoundComplete] Hand 11: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 11: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG handleNextPlayerOrRoundComplete] Hand 11: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 11: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 11: Updating hand with: {"where":{"id":11},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG handleNextPlayerOrRoundComplete] Hand 11: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 11: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 11: Context - currentRound=PRE_FLOP, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG callAction] Hand 11: Player seat 1 calling 48000000 in round PRE_FLOP, currentBet=50000000, chipsCommitted before=2000000
[DEBUG callAction] Hand 11: Creating CALL action with: handId=11, seatNumber=1, round=PRE_FLOP, amount=48000000
[DEBUG createActionAndEvent] Hand 11: Creating action with: {"handId":11,"seatNumber":1,"round":"PRE_FLOP","action":"CALL","amount":"48000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG createActionAndEvent] Hand 11: Action created successfully: {"id":44,"seatNumber":1,"action":"CALL","round":"PRE_FLOP","amount":"48000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG callAction] Hand 11: CALL action created successfully: {"id":44,"seatNumber":1,"action":"CALL","round":"PRE_FLOP","amount":"48000000"}
[DEBUG callAction] Hand 11: CALL action created, chipsCommitted now=50000000

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG callAction] Hand 11: After CALL by seat 1, checking if round complete
[DEBUG isBettingRoundComplete] Hand 11: Starting check
[DEBUG isBettingRoundComplete] Hand 11: Querying hand with: {"where":{"id":11}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG isBettingRoundComplete] Hand 11: Query result - hand={"id":11,"round":"PRE_FLOP","currentBet":"50000000","currentActionSeat":1,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 11: currentBet=50000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 11: Querying handPlayers with: {"where":{"handId":11}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG isBettingRoundComplete] Hand 11: Query returned 2 handPlayers: [{"id":22,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"50000000"},{"id":21,"seatNumber":0,"status":"ALL_IN","chipsCommitted":"50000000"}]
[DEBUG isBettingRoundComplete] Hand 11: activePlayers=1, allInPlayers=1
[DEBUG isBettingRoundComplete] Hand 11: Active player seats: [ 1 ]
[DEBUG isBettingRoundComplete] Hand 11: Querying roundActions with: {
  "where": {
    "handId": 11,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG isBettingRoundComplete] Hand 11: Query returned 2 roundActions for round PRE_FLOP: [{"id":43,"seatNumber":0,"action":"ALL_IN","amount":"49000000","round":"PRE_FLOP"},{"id":44,"seatNumber":1,"action":"CALL","amount":"48000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 11: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 11: Checking 1 active players against actedSeats and currentBet=50000000
[DEBUG isBettingRoundComplete] Hand 11: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=50000000, currentBet=50000000)
[DEBUG isBettingRoundComplete] Hand 11: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=50000000, currentBet=50000000)
[DEBUG isBettingRoundComplete] Hand 11: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 11: Context - activePlayers=1, actedSeats=[0,1], currentBet=50000000, currentRound=PRE_FLOP, roundActions queried=2, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 11: Active players detail: [{"seatNumber":1,"chipsCommitted":"50000000","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG callAction] Hand 11: isBettingRoundComplete returned true
[DEBUG callAction] Hand 11: Round complete, calling handleBettingRoundComplete
[DEBUG handleBettingRoundComplete] Hand 11: Called with currentRound=PRE_FLOP
[DEBUG handleBettingRoundComplete] Hand 11: Advancing from PRE_FLOP to next round
[DEBUG advanceBettingRound] Hand 11: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG advanceBettingRound] Hand 11: needsSidePots=false
[DEBUG advanceBettingRound] Hand 11: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG advanceBettingRound] Hand 11: Querying hand with: {"where":{"id":11},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG advanceBettingRound] Hand 11: Query result - hand.round=PRE_FLOP, players=2
[DEBUG advanceBettingRound] Hand 11: currentRound=PRE_FLOP, deckPosition=4, communityCards.length=0
[DEBUG advanceBettingRound] Hand 11: Advancing from PRE_FLOP to FLOP, cardsToDeal=3
[DEBUG advanceBettingRound] Hand 11: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 11: Players: [
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '50000000' },
  { seatNumber: 0, status: 'ALL_IN', chipsCommitted: '50000000' }
]
[DEBUG advanceBettingRound] Hand 11: nonFoldedPlayers=2, activePlayers=1
[DEBUG advanceBettingRound] Hand 11: Active player seats: [ 1 ]
[DEBUG advanceBettingRound] Hand 11: allInPlayers=1, allPlayersAllIn=false, onlyOneActivePlayer=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG advanceBettingRound] Hand 11: Updating hand state: round=FLOP, status=FLOP, currentActionSeat=1, newCommunityCards.length=3
[DEBUG advanceBettingRound] Hand 11: Updating hand with: {"where":{"id":11},"data":{"round":"FLOP","status":"FLOP","communityCards":"[3 cards]","deckPosition":7,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG advanceBettingRound] Hand 11: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG advanceBettingRound] Hand 11: RETURNING false - Round advanced successfully from PRE_FLOP to FLOP (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG handleBettingRoundComplete] Hand 11: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 11: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG isBettingRoundComplete] Hand 11: Starting check
[DEBUG isBettingRoundComplete] Hand 11: Querying hand with: {"where":{"id":11}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG isBettingRoundComplete] Hand 11: Query result - hand={"id":11,"round":"FLOP","currentBet":"0","currentActionSeat":1,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 11: currentBet=0, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 11: Querying handPlayers with: {"where":{"handId":11}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG isBettingRoundComplete] Hand 11: Query returned 2 handPlayers: [{"id":22,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"},{"id":21,"seatNumber":0,"status":"ALL_IN","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 11: activePlayers=1, allInPlayers=1
[DEBUG isBettingRoundComplete] Hand 11: Active player seats: [ 1 ]
[DEBUG isBettingRoundComplete] Hand 11: Querying roundActions with: {
  "where": {
    "handId": 11,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG isBettingRoundComplete] Hand 11: Query returned 0 roundActions for round FLOP: []
[DEBUG isBettingRoundComplete] Hand 11: actedSeats: []
[DEBUG isBettingRoundComplete] Hand 11: Checking 1 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 11: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 11: Context - actedSeats=[], playerSeat=1, currentRound=FLOP, roundActions found=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG isBettingRoundComplete] Hand 11: Starting check
[DEBUG isBettingRoundComplete] Hand 11: Querying hand with: {"where":{"id":11}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG isBettingRoundComplete] Hand 11: Query result - hand={"id":11,"round":"FLOP","currentBet":"0","currentActionSeat":1,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 11: currentBet=0, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 11: Querying handPlayers with: {"where":{"handId":11}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG isBettingRoundComplete] Hand 11: Query returned 2 handPlayers: [{"id":22,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"},{"id":21,"seatNumber":0,"status":"ALL_IN","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 11: activePlayers=1, allInPlayers=1
[DEBUG isBettingRoundComplete] Hand 11: Active player seats: [ 1 ]
[DEBUG isBettingRoundComplete] Hand 11: Querying roundActions with: {
  "where": {
    "handId": 11,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG isBettingRoundComplete] Hand 11: Query returned 1 roundActions for round FLOP: [{"id":45,"seatNumber":1,"action":"CHECK","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 11: actedSeats: [ 1 ]
[DEBUG isBettingRoundComplete] Hand 11: Checking 1 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 11: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 11: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 11: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 11: Context - activePlayers=1, actedSeats=[1], currentBet=0, currentRound=FLOP, roundActions queried=1, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 11: Active players detail: [{"seatNumber":1,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG advanceBettingRound] Hand 11: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG advanceBettingRound] Hand 11: needsSidePots=false
[DEBUG advanceBettingRound] Hand 11: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG advanceBettingRound] Hand 11: Querying hand with: {"where":{"id":11},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG advanceBettingRound] Hand 11: Query result - hand.round=FLOP, players=2
[DEBUG advanceBettingRound] Hand 11: currentRound=FLOP, deckPosition=7, communityCards.length=3
[DEBUG advanceBettingRound] Hand 11: Advancing from FLOP to TURN, cardsToDeal=1
[DEBUG advanceBettingRound] Hand 11: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 11: Players: [
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '0' },
  { seatNumber: 0, status: 'ALL_IN', chipsCommitted: '0' }
]
[DEBUG advanceBettingRound] Hand 11: nonFoldedPlayers=2, activePlayers=1
[DEBUG advanceBettingRound] Hand 11: Active player seats: [ 1 ]
[DEBUG advanceBettingRound] Hand 11: allInPlayers=1, allPlayersAllIn=false, onlyOneActivePlayer=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG advanceBettingRound] Hand 11: Updating hand state: round=TURN, status=TURN, currentActionSeat=1, newCommunityCards.length=4
[DEBUG advanceBettingRound] Hand 11: Updating hand with: {"where":{"id":11},"data":{"round":"TURN","status":"TURN","communityCards":"[4 cards]","deckPosition":8,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG advanceBettingRound] Hand 11: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG advanceBettingRound] Hand 11: RETURNING false - Round advanced successfully from FLOP to TURN (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG isBettingRoundComplete] Hand 11: Starting check
[DEBUG isBettingRoundComplete] Hand 11: Querying hand with: {"where":{"id":11}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG isBettingRoundComplete] Hand 11: Query result - hand={"id":11,"round":"TURN","currentBet":"0","currentActionSeat":1,"status":"TURN"}
[DEBUG isBettingRoundComplete] Hand 11: currentBet=0, currentRound=TURN
[DEBUG isBettingRoundComplete] Hand 11: Querying handPlayers with: {"where":{"handId":11}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG isBettingRoundComplete] Hand 11: Query returned 2 handPlayers: [{"id":22,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"},{"id":21,"seatNumber":0,"status":"ALL_IN","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 11: activePlayers=1, allInPlayers=1
[DEBUG isBettingRoundComplete] Hand 11: Active player seats: [ 1 ]
[DEBUG isBettingRoundComplete] Hand 11: Querying roundActions with: {
  "where": {
    "handId": 11,
    "round": "TURN",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG isBettingRoundComplete] Hand 11: Query returned 0 roundActions for round TURN: []
[DEBUG isBettingRoundComplete] Hand 11: actedSeats: []
[DEBUG isBettingRoundComplete] Hand 11: Checking 1 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 11: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 11: Context - actedSeats=[], playerSeat=1, currentRound=TURN, roundActions found=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG isBettingRoundComplete] Hand 11: Starting check
[DEBUG isBettingRoundComplete] Hand 11: Querying hand with: {"where":{"id":11}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG isBettingRoundComplete] Hand 11: Query result - hand={"id":11,"round":"TURN","currentBet":"0","currentActionSeat":1,"status":"TURN"}
[DEBUG isBettingRoundComplete] Hand 11: currentBet=0, currentRound=TURN
[DEBUG isBettingRoundComplete] Hand 11: Querying handPlayers with: {"where":{"handId":11}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG isBettingRoundComplete] Hand 11: Query returned 2 handPlayers: [{"id":22,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"},{"id":21,"seatNumber":0,"status":"ALL_IN","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 11: activePlayers=1, allInPlayers=1
[DEBUG isBettingRoundComplete] Hand 11: Active player seats: [ 1 ]
[DEBUG isBettingRoundComplete] Hand 11: Querying roundActions with: {
  "where": {
    "handId": 11,
    "round": "TURN",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG isBettingRoundComplete] Hand 11: Query returned 1 roundActions for round TURN: [{"id":46,"seatNumber":1,"action":"CHECK","round":"TURN"}]
[DEBUG isBettingRoundComplete] Hand 11: actedSeats: [ 1 ]
[DEBUG isBettingRoundComplete] Hand 11: Checking 1 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 11: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 11: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 11: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 11: Context - activePlayers=1, actedSeats=[1], currentBet=0, currentRound=TURN, roundActions queried=1, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 11: Active players detail: [{"seatNumber":1,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG advanceBettingRound] Hand 11: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG advanceBettingRound] Hand 11: needsSidePots=false
[DEBUG advanceBettingRound] Hand 11: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG advanceBettingRound] Hand 11: Querying hand with: {"where":{"id":11},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG advanceBettingRound] Hand 11: Query result - hand.round=TURN, players=2
[DEBUG advanceBettingRound] Hand 11: currentRound=TURN, deckPosition=8, communityCards.length=4
[DEBUG advanceBettingRound] Hand 11: Advancing from TURN to RIVER, cardsToDeal=1
[DEBUG advanceBettingRound] Hand 11: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 11: Players: [
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '0' },
  { seatNumber: 0, status: 'ALL_IN', chipsCommitted: '0' }
]
[DEBUG advanceBettingRound] Hand 11: nonFoldedPlayers=2, activePlayers=1
[DEBUG advanceBettingRound] Hand 11: Active player seats: [ 1 ]
[DEBUG advanceBettingRound] Hand 11: allInPlayers=1, allPlayersAllIn=false, onlyOneActivePlayer=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG advanceBettingRound] Hand 11: Updating hand state: round=RIVER, status=RIVER, currentActionSeat=1, newCommunityCards.length=5
[DEBUG advanceBettingRound] Hand 11: Updating hand with: {"where":{"id":11},"data":{"round":"RIVER","status":"RIVER","communityCards":"[5 cards]","deckPosition":9,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG advanceBettingRound] Hand 11: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG advanceBettingRound] Hand 11: RETURNING true - Only one active player at RIVER, hand should be settled

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG handleBettingRoundComplete] Hand 11: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=true
[DEBUG handleBettingRoundComplete] Hand 11: Auto-advancing to RIVER and settling

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG handleBettingRoundComplete] Hand 11: Hand settled, winnerSeatNumber=1
[DEBUG handleBettingRoundComplete] Hand 11: RETURNING result with settlement: handEnded=true, roundAdvanced=true, winnerSeatNumber=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG callAction] Hand 11: handleBettingRoundComplete returned handEnded=true, roundAdvanced=true
[DEBUG callAction] Hand 11: RETURNING from transaction - Round complete
[DEBUG callAction] Hand 11: Context - hand.round=PRE_FLOP, handEnded=true, roundAdvanced=true, winnerSeatNumber=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls)
[DEBUG callAction] RETURNING final result: handEnded=true, roundAdvanced=true, tableId=11

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG createActionAndEvent] Hand 12: Creating action with: {"handId":12,"seatNumber":0,"round":"PRE_FLOP","action":"ALL_IN","amount":"49000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG createActionAndEvent] Hand 12: Action created successfully: {"id":49,"seatNumber":0,"action":"ALL_IN","round":"PRE_FLOP","amount":"49000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 12: Starting check
[DEBUG isBettingRoundComplete] Hand 12: Querying hand with: {"where":{"id":12}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 12: Query result - hand={"id":12,"round":"PRE_FLOP","currentBet":"50000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 12: currentBet=50000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 12: Querying handPlayers with: {"where":{"handId":12}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 12: Query returned 2 handPlayers: [{"id":24,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"},{"id":23,"seatNumber":0,"status":"ALL_IN","chipsCommitted":"50000000"}]
[DEBUG isBettingRoundComplete] Hand 12: activePlayers=1, allInPlayers=1
[DEBUG isBettingRoundComplete] Hand 12: Active player seats: [ 1 ]
[DEBUG isBettingRoundComplete] Hand 12: Querying roundActions with: {
  "where": {
    "handId": 12,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 12: Query returned 1 roundActions for round PRE_FLOP: [{"id":49,"seatNumber":0,"action":"ALL_IN","amount":"49000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 12: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 12: Checking 1 active players against actedSeats and currentBet=50000000
[DEBUG isBettingRoundComplete] Hand 12: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 12: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 12: Called with currentSeatNumber=0, currentRound=PRE_FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 12: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 12: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 12: Querying hand with: {"where":{"id":12},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 12: Query result - hand.round=PRE_FLOP, currentRound param=PRE_FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 12: Hand players: [{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"},{"seatNumber":0,"status":"ALL_IN","chipsCommitted":"50000000"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 12: nextPlayer seat=1, chipsCommitted=2000000, currentBet=50000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 12: Next player hasn't matched (chipsCommitted=2000000, currentBet=50000000)
[DEBUG handleNextPlayerOrRoundComplete] Hand 12: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 12: Starting check
[DEBUG isBettingRoundComplete] Hand 12: Querying hand with: {"where":{"id":12}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 12: Query result - hand={"id":12,"round":"PRE_FLOP","currentBet":"50000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 12: currentBet=50000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 12: Querying handPlayers with: {"where":{"handId":12}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 12: Query returned 2 handPlayers: [{"id":24,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"},{"id":23,"seatNumber":0,"status":"ALL_IN","chipsCommitted":"50000000"}]
[DEBUG isBettingRoundComplete] Hand 12: activePlayers=1, allInPlayers=1
[DEBUG isBettingRoundComplete] Hand 12: Active player seats: [ 1 ]
[DEBUG isBettingRoundComplete] Hand 12: Querying roundActions with: {
  "where": {
    "handId": 12,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 12: Query returned 1 roundActions for round PRE_FLOP: [{"id":49,"seatNumber":0,"action":"ALL_IN","amount":"49000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 12: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 12: Checking 1 active players against actedSeats and currentBet=50000000
[DEBUG isBettingRoundComplete] Hand 12: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 12: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 12: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 12: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 12: Updating hand with: {"where":{"id":12},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 12: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 12: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 12: Context - currentRound=PRE_FLOP, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG callAction] Hand 12: Player seat 1 calling 48000000 in round PRE_FLOP, currentBet=50000000, chipsCommitted before=2000000
[DEBUG callAction] Hand 12: Creating CALL action with: handId=12, seatNumber=1, round=PRE_FLOP, amount=48000000
[DEBUG createActionAndEvent] Hand 12: Creating action with: {"handId":12,"seatNumber":1,"round":"PRE_FLOP","action":"CALL","amount":"48000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG createActionAndEvent] Hand 12: Action created successfully: {"id":50,"seatNumber":1,"action":"CALL","round":"PRE_FLOP","amount":"48000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG callAction] Hand 12: CALL action created successfully: {"id":50,"seatNumber":1,"action":"CALL","round":"PRE_FLOP","amount":"48000000"}
[DEBUG callAction] Hand 12: CALL action created, chipsCommitted now=50000000

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG callAction] Hand 12: After CALL by seat 1, checking if round complete
[DEBUG isBettingRoundComplete] Hand 12: Starting check
[DEBUG isBettingRoundComplete] Hand 12: Querying hand with: {"where":{"id":12}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 12: Query result - hand={"id":12,"round":"PRE_FLOP","currentBet":"50000000","currentActionSeat":1,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 12: currentBet=50000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 12: Querying handPlayers with: {"where":{"handId":12}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 12: Query returned 2 handPlayers: [{"id":24,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"50000000"},{"id":23,"seatNumber":0,"status":"ALL_IN","chipsCommitted":"50000000"}]
[DEBUG isBettingRoundComplete] Hand 12: activePlayers=1, allInPlayers=1
[DEBUG isBettingRoundComplete] Hand 12: Active player seats: [ 1 ]
[DEBUG isBettingRoundComplete] Hand 12: Querying roundActions with: {
  "where": {
    "handId": 12,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 12: Query returned 2 roundActions for round PRE_FLOP: [{"id":49,"seatNumber":0,"action":"ALL_IN","amount":"49000000","round":"PRE_FLOP"},{"id":50,"seatNumber":1,"action":"CALL","amount":"48000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 12: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 12: Checking 1 active players against actedSeats and currentBet=50000000
[DEBUG isBettingRoundComplete] Hand 12: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=50000000, currentBet=50000000)
[DEBUG isBettingRoundComplete] Hand 12: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=50000000, currentBet=50000000)
[DEBUG isBettingRoundComplete] Hand 12: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 12: Context - activePlayers=1, actedSeats=[0,1], currentBet=50000000, currentRound=PRE_FLOP, roundActions queried=2, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 12: Active players detail: [{"seatNumber":1,"chipsCommitted":"50000000","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG callAction] Hand 12: isBettingRoundComplete returned true
[DEBUG callAction] Hand 12: Round complete, calling handleBettingRoundComplete
[DEBUG handleBettingRoundComplete] Hand 12: Called with currentRound=PRE_FLOP
[DEBUG handleBettingRoundComplete] Hand 12: Advancing from PRE_FLOP to next round
[DEBUG advanceBettingRound] Hand 12: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG advanceBettingRound] Hand 12: needsSidePots=false
[DEBUG advanceBettingRound] Hand 12: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG advanceBettingRound] Hand 12: Querying hand with: {"where":{"id":12},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG advanceBettingRound] Hand 12: Query result - hand.round=PRE_FLOP, players=2
[DEBUG advanceBettingRound] Hand 12: currentRound=PRE_FLOP, deckPosition=4, communityCards.length=0
[DEBUG advanceBettingRound] Hand 12: Advancing from PRE_FLOP to FLOP, cardsToDeal=3
[DEBUG advanceBettingRound] Hand 12: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 12: Players: [
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '50000000' },
  { seatNumber: 0, status: 'ALL_IN', chipsCommitted: '50000000' }
]
[DEBUG advanceBettingRound] Hand 12: nonFoldedPlayers=2, activePlayers=1
[DEBUG advanceBettingRound] Hand 12: Active player seats: [ 1 ]
[DEBUG advanceBettingRound] Hand 12: allInPlayers=1, allPlayersAllIn=false, onlyOneActivePlayer=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG advanceBettingRound] Hand 12: Updating hand state: round=FLOP, status=FLOP, currentActionSeat=1, newCommunityCards.length=3
[DEBUG advanceBettingRound] Hand 12: Updating hand with: {"where":{"id":12},"data":{"round":"FLOP","status":"FLOP","communityCards":"[3 cards]","deckPosition":7,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG advanceBettingRound] Hand 12: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG advanceBettingRound] Hand 12: RETURNING false - Round advanced successfully from PRE_FLOP to FLOP (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG handleBettingRoundComplete] Hand 12: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 12: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 12: Starting check
[DEBUG isBettingRoundComplete] Hand 12: Querying hand with: {"where":{"id":12}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 12: Query result - hand={"id":12,"round":"FLOP","currentBet":"0","currentActionSeat":1,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 12: currentBet=0, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 12: Querying handPlayers with: {"where":{"handId":12}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 12: Query returned 2 handPlayers: [{"id":24,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"},{"id":23,"seatNumber":0,"status":"ALL_IN","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 12: activePlayers=1, allInPlayers=1
[DEBUG isBettingRoundComplete] Hand 12: Active player seats: [ 1 ]
[DEBUG isBettingRoundComplete] Hand 12: Querying roundActions with: {
  "where": {
    "handId": 12,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 12: Query returned 0 roundActions for round FLOP: []
[DEBUG isBettingRoundComplete] Hand 12: actedSeats: []
[DEBUG isBettingRoundComplete] Hand 12: Checking 1 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 12: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 12: Context - actedSeats=[], playerSeat=1, currentRound=FLOP, roundActions found=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 12: Starting check
[DEBUG isBettingRoundComplete] Hand 12: Querying hand with: {"where":{"id":12}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 12: Query result - hand={"id":12,"round":"FLOP","currentBet":"0","currentActionSeat":1,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 12: currentBet=0, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 12: Querying handPlayers with: {"where":{"handId":12}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 12: Query returned 2 handPlayers: [{"id":24,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"},{"id":23,"seatNumber":0,"status":"ALL_IN","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 12: activePlayers=1, allInPlayers=1
[DEBUG isBettingRoundComplete] Hand 12: Active player seats: [ 1 ]
[DEBUG isBettingRoundComplete] Hand 12: Querying roundActions with: {
  "where": {
    "handId": 12,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 12: Query returned 1 roundActions for round FLOP: [{"id":51,"seatNumber":1,"action":"CHECK","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 12: actedSeats: [ 1 ]
[DEBUG isBettingRoundComplete] Hand 12: Checking 1 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 12: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 12: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 12: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 12: Context - activePlayers=1, actedSeats=[1], currentBet=0, currentRound=FLOP, roundActions queried=1, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 12: Active players detail: [{"seatNumber":1,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG advanceBettingRound] Hand 12: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG advanceBettingRound] Hand 12: needsSidePots=false
[DEBUG advanceBettingRound] Hand 12: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG advanceBettingRound] Hand 12: Querying hand with: {"where":{"id":12},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG advanceBettingRound] Hand 12: Query result - hand.round=FLOP, players=2
[DEBUG advanceBettingRound] Hand 12: currentRound=FLOP, deckPosition=7, communityCards.length=3
[DEBUG advanceBettingRound] Hand 12: Advancing from FLOP to TURN, cardsToDeal=1
[DEBUG advanceBettingRound] Hand 12: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 12: Players: [
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '0' },
  { seatNumber: 0, status: 'ALL_IN', chipsCommitted: '0' }
]
[DEBUG advanceBettingRound] Hand 12: nonFoldedPlayers=2, activePlayers=1
[DEBUG advanceBettingRound] Hand 12: Active player seats: [ 1 ]
[DEBUG advanceBettingRound] Hand 12: allInPlayers=1, allPlayersAllIn=false, onlyOneActivePlayer=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG advanceBettingRound] Hand 12: Updating hand state: round=TURN, status=TURN, currentActionSeat=1, newCommunityCards.length=4
[DEBUG advanceBettingRound] Hand 12: Updating hand with: {"where":{"id":12},"data":{"round":"TURN","status":"TURN","communityCards":"[4 cards]","deckPosition":8,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG advanceBettingRound] Hand 12: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG advanceBettingRound] Hand 12: RETURNING false - Round advanced successfully from FLOP to TURN (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 12: Starting check
[DEBUG isBettingRoundComplete] Hand 12: Querying hand with: {"where":{"id":12}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 12: Query result - hand={"id":12,"round":"TURN","currentBet":"0","currentActionSeat":1,"status":"TURN"}
[DEBUG isBettingRoundComplete] Hand 12: currentBet=0, currentRound=TURN
[DEBUG isBettingRoundComplete] Hand 12: Querying handPlayers with: {"where":{"handId":12}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 12: Query returned 2 handPlayers: [{"id":24,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"},{"id":23,"seatNumber":0,"status":"ALL_IN","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 12: activePlayers=1, allInPlayers=1
[DEBUG isBettingRoundComplete] Hand 12: Active player seats: [ 1 ]
[DEBUG isBettingRoundComplete] Hand 12: Querying roundActions with: {
  "where": {
    "handId": 12,
    "round": "TURN",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 12: Query returned 0 roundActions for round TURN: []
[DEBUG isBettingRoundComplete] Hand 12: actedSeats: []
[DEBUG isBettingRoundComplete] Hand 12: Checking 1 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 12: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 12: Context - actedSeats=[], playerSeat=1, currentRound=TURN, roundActions found=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 12: Starting check
[DEBUG isBettingRoundComplete] Hand 12: Querying hand with: {"where":{"id":12}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 12: Query result - hand={"id":12,"round":"TURN","currentBet":"0","currentActionSeat":1,"status":"TURN"}
[DEBUG isBettingRoundComplete] Hand 12: currentBet=0, currentRound=TURN
[DEBUG isBettingRoundComplete] Hand 12: Querying handPlayers with: {"where":{"handId":12}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 12: Query returned 2 handPlayers: [{"id":24,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"},{"id":23,"seatNumber":0,"status":"ALL_IN","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 12: activePlayers=1, allInPlayers=1
[DEBUG isBettingRoundComplete] Hand 12: Active player seats: [ 1 ]
[DEBUG isBettingRoundComplete] Hand 12: Querying roundActions with: {
  "where": {
    "handId": 12,
    "round": "TURN",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 12: Query returned 1 roundActions for round TURN: [{"id":52,"seatNumber":1,"action":"CHECK","round":"TURN"}]
[DEBUG isBettingRoundComplete] Hand 12: actedSeats: [ 1 ]
[DEBUG isBettingRoundComplete] Hand 12: Checking 1 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 12: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 12: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 12: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 12: Context - activePlayers=1, actedSeats=[1], currentBet=0, currentRound=TURN, roundActions queried=1, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 12: Active players detail: [{"seatNumber":1,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG advanceBettingRound] Hand 12: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG advanceBettingRound] Hand 12: needsSidePots=false
[DEBUG advanceBettingRound] Hand 12: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG advanceBettingRound] Hand 12: Querying hand with: {"where":{"id":12},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG advanceBettingRound] Hand 12: Query result - hand.round=TURN, players=2
[DEBUG advanceBettingRound] Hand 12: currentRound=TURN, deckPosition=8, communityCards.length=4
[DEBUG advanceBettingRound] Hand 12: Advancing from TURN to RIVER, cardsToDeal=1
[DEBUG advanceBettingRound] Hand 12: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 12: Players: [
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '0' },
  { seatNumber: 0, status: 'ALL_IN', chipsCommitted: '0' }
]
[DEBUG advanceBettingRound] Hand 12: nonFoldedPlayers=2, activePlayers=1
[DEBUG advanceBettingRound] Hand 12: Active player seats: [ 1 ]
[DEBUG advanceBettingRound] Hand 12: allInPlayers=1, allPlayersAllIn=false, onlyOneActivePlayer=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG advanceBettingRound] Hand 12: Updating hand state: round=RIVER, status=RIVER, currentActionSeat=1, newCommunityCards.length=5
[DEBUG advanceBettingRound] Hand 12: Updating hand with: {"where":{"id":12},"data":{"round":"RIVER","status":"RIVER","communityCards":"[5 cards]","deckPosition":9,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG advanceBettingRound] Hand 12: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG advanceBettingRound] Hand 12: RETURNING true - Only one active player at RIVER, hand should be settled

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG handleBettingRoundComplete] Hand 12: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=true
[DEBUG handleBettingRoundComplete] Hand 12: Auto-advancing to RIVER and settling

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
ðŸ’° Added rake 7000000 gwei to TEE balance (hand 12)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG handleBettingRoundComplete] Hand 12: Hand settled, winnerSeatNumber=0
[DEBUG handleBettingRoundComplete] Hand 12: RETURNING result with settlement: handEnded=true, roundAdvanced=true, winnerSeatNumber=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG callAction] Hand 12: handleBettingRoundComplete returned handEnded=true, roundAdvanced=true
[DEBUG callAction] Hand 12: RETURNING from transaction - Round complete
[DEBUG callAction] Hand 12: Context - hand.round=PRE_FLOP, handEnded=true, roundAdvanced=true, winnerSeatNumber=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-008: Small Blind All-In Pre-Flop (Big Blind Calls) - 700 bps rake
[DEBUG callAction] RETURNING final result: handEnded=true, roundAdvanced=true, tableId=12

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-009: Small Blind All-In Pre-Flop (Big Blind Folds)
[DEBUG createActionAndEvent] Hand 13: Creating action with: {"handId":13,"seatNumber":0,"round":"PRE_FLOP","action":"ALL_IN","amount":"49000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-009: Small Blind All-In Pre-Flop (Big Blind Folds)
[DEBUG createActionAndEvent] Hand 13: Action created successfully: {"id":55,"seatNumber":0,"action":"ALL_IN","round":"PRE_FLOP","amount":"49000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-009: Small Blind All-In Pre-Flop (Big Blind Folds)
[DEBUG isBettingRoundComplete] Hand 13: Starting check
[DEBUG isBettingRoundComplete] Hand 13: Querying hand with: {"where":{"id":13}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-009: Small Blind All-In Pre-Flop (Big Blind Folds)
[DEBUG isBettingRoundComplete] Hand 13: Query result - hand={"id":13,"round":"PRE_FLOP","currentBet":"50000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 13: currentBet=50000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 13: Querying handPlayers with: {"where":{"handId":13}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-009: Small Blind All-In Pre-Flop (Big Blind Folds)
[DEBUG isBettingRoundComplete] Hand 13: Query returned 2 handPlayers: [{"id":26,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"},{"id":25,"seatNumber":0,"status":"ALL_IN","chipsCommitted":"50000000"}]
[DEBUG isBettingRoundComplete] Hand 13: activePlayers=1, allInPlayers=1
[DEBUG isBettingRoundComplete] Hand 13: Active player seats: [ 1 ]
[DEBUG isBettingRoundComplete] Hand 13: Querying roundActions with: {
  "where": {
    "handId": 13,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-009: Small Blind All-In Pre-Flop (Big Blind Folds)
[DEBUG isBettingRoundComplete] Hand 13: Query returned 1 roundActions for round PRE_FLOP: [{"id":55,"seatNumber":0,"action":"ALL_IN","amount":"49000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 13: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 13: Checking 1 active players against actedSeats and currentBet=50000000
[DEBUG isBettingRoundComplete] Hand 13: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 13: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-009: Small Blind All-In Pre-Flop (Big Blind Folds)
[DEBUG handleNextPlayerOrRoundComplete] Hand 13: Called with currentSeatNumber=0, currentRound=PRE_FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-009: Small Blind All-In Pre-Flop (Big Blind Folds)
[DEBUG handleNextPlayerOrRoundComplete] Hand 13: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 13: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 13: Querying hand with: {"where":{"id":13},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-009: Small Blind All-In Pre-Flop (Big Blind Folds)
[DEBUG handleNextPlayerOrRoundComplete] Hand 13: Query result - hand.round=PRE_FLOP, currentRound param=PRE_FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 13: Hand players: [{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"},{"seatNumber":0,"status":"ALL_IN","chipsCommitted":"50000000"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 13: nextPlayer seat=1, chipsCommitted=2000000, currentBet=50000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 13: Next player hasn't matched (chipsCommitted=2000000, currentBet=50000000)
[DEBUG handleNextPlayerOrRoundComplete] Hand 13: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 13: Starting check
[DEBUG isBettingRoundComplete] Hand 13: Querying hand with: {"where":{"id":13}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-009: Small Blind All-In Pre-Flop (Big Blind Folds)
[DEBUG isBettingRoundComplete] Hand 13: Query result - hand={"id":13,"round":"PRE_FLOP","currentBet":"50000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 13: currentBet=50000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 13: Querying handPlayers with: {"where":{"handId":13}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-009: Small Blind All-In Pre-Flop (Big Blind Folds)
[DEBUG isBettingRoundComplete] Hand 13: Query returned 2 handPlayers: [{"id":26,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"},{"id":25,"seatNumber":0,"status":"ALL_IN","chipsCommitted":"50000000"}]
[DEBUG isBettingRoundComplete] Hand 13: activePlayers=1, allInPlayers=1
[DEBUG isBettingRoundComplete] Hand 13: Active player seats: [ 1 ]
[DEBUG isBettingRoundComplete] Hand 13: Querying roundActions with: {
  "where": {
    "handId": 13,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-009: Small Blind All-In Pre-Flop (Big Blind Folds)
[DEBUG isBettingRoundComplete] Hand 13: Query returned 1 roundActions for round PRE_FLOP: [{"id":55,"seatNumber":0,"action":"ALL_IN","amount":"49000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 13: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 13: Checking 1 active players against actedSeats and currentBet=50000000
[DEBUG isBettingRoundComplete] Hand 13: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 13: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-009: Small Blind All-In Pre-Flop (Big Blind Folds)
[DEBUG handleNextPlayerOrRoundComplete] Hand 13: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 13: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 13: Updating hand with: {"where":{"id":13},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-009: Small Blind All-In Pre-Flop (Big Blind Folds)
[DEBUG handleNextPlayerOrRoundComplete] Hand 13: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 13: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 13: Context - currentRound=PRE_FLOP, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-009: Small Blind All-In Pre-Flop (Big Blind Folds)
[DEBUG foldAction] Hand 13: Player seat 1 folding in round PRE_FLOP
[DEBUG foldAction] Hand 13: Creating FOLD action with: {"handId":13,"seatNumber":1,"round":"PRE_FLOP","action":"FOLD","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-009: Small Blind All-In Pre-Flop (Big Blind Folds)
[DEBUG foldAction] Hand 13: FOLD action created successfully: {"id":56,"seatNumber":1,"action":"FOLD","round":"PRE_FLOP","amount":null}
[DEBUG foldAction] Hand 13: FOLD action created, checking if round complete or advancing to next player

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-009: Small Blind All-In Pre-Flop (Big Blind Folds) - 700 bps rake
[DEBUG createActionAndEvent] Hand 14: Creating action with: {"handId":14,"seatNumber":0,"round":"PRE_FLOP","action":"ALL_IN","amount":"49000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-009: Small Blind All-In Pre-Flop (Big Blind Folds) - 700 bps rake
[DEBUG createActionAndEvent] Hand 14: Action created successfully: {"id":59,"seatNumber":0,"action":"ALL_IN","round":"PRE_FLOP","amount":"49000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-009: Small Blind All-In Pre-Flop (Big Blind Folds) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 14: Starting check
[DEBUG isBettingRoundComplete] Hand 14: Querying hand with: {"where":{"id":14}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-009: Small Blind All-In Pre-Flop (Big Blind Folds) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 14: Query result - hand={"id":14,"round":"PRE_FLOP","currentBet":"50000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 14: currentBet=50000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 14: Querying handPlayers with: {"where":{"handId":14}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-009: Small Blind All-In Pre-Flop (Big Blind Folds) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 14: Query returned 2 handPlayers: [{"id":28,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"},{"id":27,"seatNumber":0,"status":"ALL_IN","chipsCommitted":"50000000"}]
[DEBUG isBettingRoundComplete] Hand 14: activePlayers=1, allInPlayers=1
[DEBUG isBettingRoundComplete] Hand 14: Active player seats: [ 1 ]
[DEBUG isBettingRoundComplete] Hand 14: Querying roundActions with: {
  "where": {
    "handId": 14,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-009: Small Blind All-In Pre-Flop (Big Blind Folds) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 14: Query returned 1 roundActions for round PRE_FLOP: [{"id":59,"seatNumber":0,"action":"ALL_IN","amount":"49000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 14: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 14: Checking 1 active players against actedSeats and currentBet=50000000
[DEBUG isBettingRoundComplete] Hand 14: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 14: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-009: Small Blind All-In Pre-Flop (Big Blind Folds) - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 14: Called with currentSeatNumber=0, currentRound=PRE_FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-009: Small Blind All-In Pre-Flop (Big Blind Folds) - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 14: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 14: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 14: Querying hand with: {"where":{"id":14},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-009: Small Blind All-In Pre-Flop (Big Blind Folds) - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 14: Query result - hand.round=PRE_FLOP, currentRound param=PRE_FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 14: Hand players: [{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"},{"seatNumber":0,"status":"ALL_IN","chipsCommitted":"50000000"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 14: nextPlayer seat=1, chipsCommitted=2000000, currentBet=50000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 14: Next player hasn't matched (chipsCommitted=2000000, currentBet=50000000)
[DEBUG handleNextPlayerOrRoundComplete] Hand 14: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 14: Starting check
[DEBUG isBettingRoundComplete] Hand 14: Querying hand with: {"where":{"id":14}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-009: Small Blind All-In Pre-Flop (Big Blind Folds) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 14: Query result - hand={"id":14,"round":"PRE_FLOP","currentBet":"50000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 14: currentBet=50000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 14: Querying handPlayers with: {"where":{"handId":14}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-009: Small Blind All-In Pre-Flop (Big Blind Folds) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 14: Query returned 2 handPlayers: [{"id":28,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"},{"id":27,"seatNumber":0,"status":"ALL_IN","chipsCommitted":"50000000"}]
[DEBUG isBettingRoundComplete] Hand 14: activePlayers=1, allInPlayers=1
[DEBUG isBettingRoundComplete] Hand 14: Active player seats: [ 1 ]
[DEBUG isBettingRoundComplete] Hand 14: Querying roundActions with: {
  "where": {
    "handId": 14,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-009: Small Blind All-In Pre-Flop (Big Blind Folds) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 14: Query returned 1 roundActions for round PRE_FLOP: [{"id":59,"seatNumber":0,"action":"ALL_IN","amount":"49000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 14: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 14: Checking 1 active players against actedSeats and currentBet=50000000
[DEBUG isBettingRoundComplete] Hand 14: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 14: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-009: Small Blind All-In Pre-Flop (Big Blind Folds) - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 14: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 14: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 14: Updating hand with: {"where":{"id":14},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-009: Small Blind All-In Pre-Flop (Big Blind Folds) - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 14: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 14: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 14: Context - currentRound=PRE_FLOP, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-009: Small Blind All-In Pre-Flop (Big Blind Folds) - 700 bps rake
[DEBUG foldAction] Hand 14: Player seat 1 folding in round PRE_FLOP
[DEBUG foldAction] Hand 14: Creating FOLD action with: {"handId":14,"seatNumber":1,"round":"PRE_FLOP","action":"FOLD","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-009: Small Blind All-In Pre-Flop (Big Blind Folds) - 700 bps rake
[DEBUG foldAction] Hand 14: FOLD action created successfully: {"id":60,"seatNumber":1,"action":"FOLD","round":"PRE_FLOP","amount":null}
[DEBUG foldAction] Hand 14: FOLD action created, checking if round complete or advancing to next player

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-009: Small Blind All-In Pre-Flop (Big Blind Folds) - 700 bps rake
ðŸ’° Added rake 3640000 gwei to TEE balance (hand 14)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG raiseAction] Hand 15: Player seat 0 raising 3000000 in round PRE_FLOP, currentBet before=2000000, chipsCommitted before=1000000, isAllIn=false
[DEBUG raiseAction] Hand 15: Creating RAISE action - hand.round=PRE_FLOP, actionType=RAISE, eventActionType=RAISE
[DEBUG createActionAndEvent] Hand 15: Creating action with: {"handId":15,"seatNumber":0,"round":"PRE_FLOP","action":"RAISE","amount":"3000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG createActionAndEvent] Hand 15: Action created successfully: {"id":63,"seatNumber":0,"action":"RAISE","round":"PRE_FLOP","amount":"3000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG raiseAction] Hand 15: RAISE action created successfully, checking if round complete
[DEBUG raiseAction] Hand 15: Checking if betting round complete after RAISE
[DEBUG raiseAction] Hand 15: Context before isBettingRoundComplete - hand.round=PRE_FLOP, currentBet=2000000, currentActionSeat=0
[DEBUG isBettingRoundComplete] Hand 15: Starting check
[DEBUG isBettingRoundComplete] Hand 15: Querying hand with: {"where":{"id":15}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG isBettingRoundComplete] Hand 15: Query result - hand={"id":15,"round":"PRE_FLOP","currentBet":"4000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 15: currentBet=4000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 15: Querying handPlayers with: {"where":{"handId":15}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG isBettingRoundComplete] Hand 15: Query returned 2 handPlayers: [{"id":29,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"4000000"},{"id":30,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG isBettingRoundComplete] Hand 15: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 15: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 15: Querying roundActions with: {
  "where": {
    "handId": 15,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG isBettingRoundComplete] Hand 15: Query returned 1 roundActions for round PRE_FLOP: [{"id":63,"seatNumber":0,"action":"RAISE","amount":"3000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 15: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 15: Checking 2 active players against actedSeats and currentBet=4000000
[DEBUG isBettingRoundComplete] Hand 15: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=4000000, currentBet=4000000)
[DEBUG isBettingRoundComplete] Hand 15: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 15: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG raiseAction] Hand 15: isBettingRoundComplete returned false
[DEBUG handleBettingActionCompletion] Hand 15: Called with currentSeatNumber=0, currentRound=PRE_FLOP, bettingRoundComplete=false, isAllIn=false
[DEBUG handleBettingActionCompletion] Hand 15: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 15: Called with currentSeatNumber=0, currentRound=PRE_FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG handleNextPlayerOrRoundComplete] Hand 15: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 15: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 15: Querying hand with: {"where":{"id":15},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG handleNextPlayerOrRoundComplete] Hand 15: Query result - hand.round=PRE_FLOP, currentRound param=PRE_FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 15: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"4000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 15: nextPlayer seat=1, chipsCommitted=2000000, currentBet=4000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 15: Next player hasn't matched (chipsCommitted=2000000, currentBet=4000000)
[DEBUG handleNextPlayerOrRoundComplete] Hand 15: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 15: Starting check
[DEBUG isBettingRoundComplete] Hand 15: Querying hand with: {"where":{"id":15}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG isBettingRoundComplete] Hand 15: Query result - hand={"id":15,"round":"PRE_FLOP","currentBet":"4000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 15: currentBet=4000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 15: Querying handPlayers with: {"where":{"handId":15}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG isBettingRoundComplete] Hand 15: Query returned 2 handPlayers: [{"id":29,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"4000000"},{"id":30,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG isBettingRoundComplete] Hand 15: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 15: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 15: Querying roundActions with: {
  "where": {
    "handId": 15,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG isBettingRoundComplete] Hand 15: Query returned 1 roundActions for round PRE_FLOP: [{"id":63,"seatNumber":0,"action":"RAISE","amount":"3000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 15: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 15: Checking 2 active players against actedSeats and currentBet=4000000
[DEBUG isBettingRoundComplete] Hand 15: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=4000000, currentBet=4000000)
[DEBUG isBettingRoundComplete] Hand 15: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 15: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG handleNextPlayerOrRoundComplete] Hand 15: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 15: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 15: Updating hand with: {"where":{"id":15},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG handleNextPlayerOrRoundComplete] Hand 15: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 15: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 15: Context - currentRound=PRE_FLOP, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG handleBettingActionCompletion] Hand 15: RETURNING result: handEnded=false, roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG raiseAction] Hand 15: handleBettingActionCompletion returned: handEnded=false, roundAdvanced=false
[DEBUG raiseAction] Hand 15: RETURNING from transaction
[DEBUG raiseAction] Hand 15: Context - hand.round=PRE_FLOP, handEnded=false, roundAdvanced=false, winnerSeatNumber=null
[DEBUG raiseAction] Hand 15: RETURNING from transaction - Final values: handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG raiseAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=15

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG createActionAndEvent] Hand 15: Creating action with: {"handId":15,"seatNumber":1,"round":"PRE_FLOP","action":"ALL_IN","amount":"48000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG createActionAndEvent] Hand 15: Action created successfully: {"id":64,"seatNumber":1,"action":"ALL_IN","round":"PRE_FLOP","amount":"48000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG isBettingRoundComplete] Hand 15: Starting check
[DEBUG isBettingRoundComplete] Hand 15: Querying hand with: {"where":{"id":15}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG isBettingRoundComplete] Hand 15: Query result - hand={"id":15,"round":"PRE_FLOP","currentBet":"50000000","currentActionSeat":1,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 15: currentBet=50000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 15: Querying handPlayers with: {"where":{"handId":15}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG isBettingRoundComplete] Hand 15: Query returned 2 handPlayers: [{"id":29,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"4000000"},{"id":30,"seatNumber":1,"status":"ALL_IN","chipsCommitted":"50000000"}]
[DEBUG isBettingRoundComplete] Hand 15: activePlayers=1, allInPlayers=1
[DEBUG isBettingRoundComplete] Hand 15: Active player seats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 15: Querying roundActions with: {
  "where": {
    "handId": 15,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG isBettingRoundComplete] Hand 15: Query returned 2 roundActions for round PRE_FLOP: [{"id":63,"seatNumber":0,"action":"RAISE","amount":"3000000","round":"PRE_FLOP"},{"id":64,"seatNumber":1,"action":"ALL_IN","amount":"48000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 15: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 15: Checking 1 active players against actedSeats and currentBet=50000000
[DEBUG isBettingRoundComplete] Hand 15: RETURNING false - Player 0 hasn't matched bet.
[DEBUG isBettingRoundComplete] Hand 15: Context - chipsCommitted=4000000, currentBet=50000000, playerSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG handleNextPlayerOrRoundComplete] Hand 15: Called with currentSeatNumber=1, currentRound=PRE_FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG handleNextPlayerOrRoundComplete] Hand 15: getNextActivePlayer returned nextSeat=0
[DEBUG handleNextPlayerOrRoundComplete] Hand 15: nextSeat=0, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 15: Querying hand with: {"where":{"id":15},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG handleNextPlayerOrRoundComplete] Hand 15: Query result - hand.round=PRE_FLOP, currentRound param=PRE_FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 15: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"4000000"},{"seatNumber":1,"status":"ALL_IN","chipsCommitted":"50000000"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 15: nextPlayer seat=0, chipsCommitted=4000000, currentBet=50000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 15: Next player hasn't matched (chipsCommitted=4000000, currentBet=50000000)
[DEBUG handleNextPlayerOrRoundComplete] Hand 15: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 15: Starting check
[DEBUG isBettingRoundComplete] Hand 15: Querying hand with: {"where":{"id":15}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG isBettingRoundComplete] Hand 15: Query result - hand={"id":15,"round":"PRE_FLOP","currentBet":"50000000","currentActionSeat":1,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 15: currentBet=50000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 15: Querying handPlayers with: {"where":{"handId":15}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG isBettingRoundComplete] Hand 15: Query returned 2 handPlayers: [{"id":29,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"4000000"},{"id":30,"seatNumber":1,"status":"ALL_IN","chipsCommitted":"50000000"}]
[DEBUG isBettingRoundComplete] Hand 15: activePlayers=1, allInPlayers=1
[DEBUG isBettingRoundComplete] Hand 15: Active player seats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 15: Querying roundActions with: {
  "where": {
    "handId": 15,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG isBettingRoundComplete] Hand 15: Query returned 2 roundActions for round PRE_FLOP: [{"id":63,"seatNumber":0,"action":"RAISE","amount":"3000000","round":"PRE_FLOP"},{"id":64,"seatNumber":1,"action":"ALL_IN","amount":"48000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 15: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 15: Checking 1 active players against actedSeats and currentBet=50000000
[DEBUG isBettingRoundComplete] Hand 15: RETURNING false - Player 0 hasn't matched bet.
[DEBUG isBettingRoundComplete] Hand 15: Context - chipsCommitted=4000000, currentBet=50000000, playerSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG handleNextPlayerOrRoundComplete] Hand 15: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 15: Round not complete, advancing to next player 0
[DEBUG handleNextPlayerOrRoundComplete] Hand 15: Updating hand with: {"where":{"id":15},"data":{"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG handleNextPlayerOrRoundComplete] Hand 15: Hand updated successfully, currentActionSeat now=0
[DEBUG handleNextPlayerOrRoundComplete] Hand 15: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 15: Context - currentRound=PRE_FLOP, nextSeat=0, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG callAction] Hand 15: Player seat 0 calling 46000000 in round PRE_FLOP, currentBet=50000000, chipsCommitted before=4000000
[DEBUG callAction] Hand 15: Creating CALL action with: handId=15, seatNumber=0, round=PRE_FLOP, amount=46000000
[DEBUG createActionAndEvent] Hand 15: Creating action with: {"handId":15,"seatNumber":0,"round":"PRE_FLOP","action":"CALL","amount":"46000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG createActionAndEvent] Hand 15: Action created successfully: {"id":65,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"46000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG callAction] Hand 15: CALL action created successfully: {"id":65,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"46000000"}
[DEBUG callAction] Hand 15: CALL action created, chipsCommitted now=50000000

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG callAction] Hand 15: After CALL by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 15: Starting check
[DEBUG isBettingRoundComplete] Hand 15: Querying hand with: {"where":{"id":15}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG isBettingRoundComplete] Hand 15: Query result - hand={"id":15,"round":"PRE_FLOP","currentBet":"50000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 15: currentBet=50000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 15: Querying handPlayers with: {"where":{"handId":15}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG isBettingRoundComplete] Hand 15: Query returned 2 handPlayers: [{"id":29,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"50000000"},{"id":30,"seatNumber":1,"status":"ALL_IN","chipsCommitted":"50000000"}]
[DEBUG isBettingRoundComplete] Hand 15: activePlayers=1, allInPlayers=1
[DEBUG isBettingRoundComplete] Hand 15: Active player seats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 15: Querying roundActions with: {
  "where": {
    "handId": 15,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG isBettingRoundComplete] Hand 15: Query returned 3 roundActions for round PRE_FLOP: [{"id":63,"seatNumber":0,"action":"RAISE","amount":"3000000","round":"PRE_FLOP"},{"id":64,"seatNumber":1,"action":"ALL_IN","amount":"48000000","round":"PRE_FLOP"},{"id":65,"seatNumber":0,"action":"CALL","amount":"46000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 15: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 15: Checking 1 active players against actedSeats and currentBet=50000000
[DEBUG isBettingRoundComplete] Hand 15: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=50000000, currentBet=50000000)
[DEBUG isBettingRoundComplete] Hand 15: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=50000000, currentBet=50000000)
[DEBUG isBettingRoundComplete] Hand 15: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 15: Context - activePlayers=1, actedSeats=[0,1], currentBet=50000000, currentRound=PRE_FLOP, roundActions queried=3, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 15: Active players detail: [{"seatNumber":0,"chipsCommitted":"50000000","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG callAction] Hand 15: isBettingRoundComplete returned true
[DEBUG callAction] Hand 15: Round complete, calling handleBettingRoundComplete
[DEBUG handleBettingRoundComplete] Hand 15: Called with currentRound=PRE_FLOP
[DEBUG handleBettingRoundComplete] Hand 15: Advancing from PRE_FLOP to next round
[DEBUG advanceBettingRound] Hand 15: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG advanceBettingRound] Hand 15: needsSidePots=false
[DEBUG advanceBettingRound] Hand 15: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG advanceBettingRound] Hand 15: Querying hand with: {"where":{"id":15},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG advanceBettingRound] Hand 15: Query result - hand.round=PRE_FLOP, players=2
[DEBUG advanceBettingRound] Hand 15: currentRound=PRE_FLOP, deckPosition=4, communityCards.length=0
[DEBUG advanceBettingRound] Hand 15: Advancing from PRE_FLOP to FLOP, cardsToDeal=3
[DEBUG advanceBettingRound] Hand 15: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 15: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '50000000' },
  { seatNumber: 1, status: 'ALL_IN', chipsCommitted: '50000000' }
]
[DEBUG advanceBettingRound] Hand 15: nonFoldedPlayers=2, activePlayers=1
[DEBUG advanceBettingRound] Hand 15: Active player seats: [ 0 ]
[DEBUG advanceBettingRound] Hand 15: allInPlayers=1, allPlayersAllIn=false, onlyOneActivePlayer=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG advanceBettingRound] Hand 15: Updating hand state: round=FLOP, status=FLOP, currentActionSeat=0, newCommunityCards.length=3
[DEBUG advanceBettingRound] Hand 15: Updating hand with: {"where":{"id":15},"data":{"round":"FLOP","status":"FLOP","communityCards":"[3 cards]","deckPosition":7,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG advanceBettingRound] Hand 15: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG advanceBettingRound] Hand 15: RETURNING false - Round advanced successfully from PRE_FLOP to FLOP (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG handleBettingRoundComplete] Hand 15: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 15: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG isBettingRoundComplete] Hand 15: Starting check
[DEBUG isBettingRoundComplete] Hand 15: Querying hand with: {"where":{"id":15}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG isBettingRoundComplete] Hand 15: Query result - hand={"id":15,"round":"FLOP","currentBet":"0","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 15: currentBet=0, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 15: Querying handPlayers with: {"where":{"handId":15}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG isBettingRoundComplete] Hand 15: Query returned 2 handPlayers: [{"id":29,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":30,"seatNumber":1,"status":"ALL_IN","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 15: activePlayers=1, allInPlayers=1
[DEBUG isBettingRoundComplete] Hand 15: Active player seats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 15: Querying roundActions with: {
  "where": {
    "handId": 15,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG isBettingRoundComplete] Hand 15: Query returned 0 roundActions for round FLOP: []
[DEBUG isBettingRoundComplete] Hand 15: actedSeats: []
[DEBUG isBettingRoundComplete] Hand 15: Checking 1 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 15: RETURNING false - Player 0 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 15: Context - actedSeats=[], playerSeat=0, currentRound=FLOP, roundActions found=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG isBettingRoundComplete] Hand 15: Starting check
[DEBUG isBettingRoundComplete] Hand 15: Querying hand with: {"where":{"id":15}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG isBettingRoundComplete] Hand 15: Query result - hand={"id":15,"round":"FLOP","currentBet":"0","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 15: currentBet=0, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 15: Querying handPlayers with: {"where":{"handId":15}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG isBettingRoundComplete] Hand 15: Query returned 2 handPlayers: [{"id":29,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":30,"seatNumber":1,"status":"ALL_IN","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 15: activePlayers=1, allInPlayers=1
[DEBUG isBettingRoundComplete] Hand 15: Active player seats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 15: Querying roundActions with: {
  "where": {
    "handId": 15,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG isBettingRoundComplete] Hand 15: Query returned 1 roundActions for round FLOP: [{"id":66,"seatNumber":0,"action":"CHECK","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 15: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 15: Checking 1 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 15: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 15: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 15: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 15: Context - activePlayers=1, actedSeats=[0], currentBet=0, currentRound=FLOP, roundActions queried=1, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 15: Active players detail: [{"seatNumber":0,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG advanceBettingRound] Hand 15: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG advanceBettingRound] Hand 15: needsSidePots=false
[DEBUG advanceBettingRound] Hand 15: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG advanceBettingRound] Hand 15: Querying hand with: {"where":{"id":15},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG advanceBettingRound] Hand 15: Query result - hand.round=FLOP, players=2
[DEBUG advanceBettingRound] Hand 15: currentRound=FLOP, deckPosition=7, communityCards.length=3
[DEBUG advanceBettingRound] Hand 15: Advancing from FLOP to TURN, cardsToDeal=1
[DEBUG advanceBettingRound] Hand 15: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 15: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '0' },
  { seatNumber: 1, status: 'ALL_IN', chipsCommitted: '0' }
]
[DEBUG advanceBettingRound] Hand 15: nonFoldedPlayers=2, activePlayers=1
[DEBUG advanceBettingRound] Hand 15: Active player seats: [ 0 ]
[DEBUG advanceBettingRound] Hand 15: allInPlayers=1, allPlayersAllIn=false, onlyOneActivePlayer=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG advanceBettingRound] Hand 15: Updating hand state: round=TURN, status=TURN, currentActionSeat=0, newCommunityCards.length=4
[DEBUG advanceBettingRound] Hand 15: Updating hand with: {"where":{"id":15},"data":{"round":"TURN","status":"TURN","communityCards":"[4 cards]","deckPosition":8,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG advanceBettingRound] Hand 15: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG advanceBettingRound] Hand 15: RETURNING false - Round advanced successfully from FLOP to TURN (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG isBettingRoundComplete] Hand 15: Starting check
[DEBUG isBettingRoundComplete] Hand 15: Querying hand with: {"where":{"id":15}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG isBettingRoundComplete] Hand 15: Query result - hand={"id":15,"round":"TURN","currentBet":"0","currentActionSeat":0,"status":"TURN"}
[DEBUG isBettingRoundComplete] Hand 15: currentBet=0, currentRound=TURN
[DEBUG isBettingRoundComplete] Hand 15: Querying handPlayers with: {"where":{"handId":15}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG isBettingRoundComplete] Hand 15: Query returned 2 handPlayers: [{"id":29,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":30,"seatNumber":1,"status":"ALL_IN","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 15: activePlayers=1, allInPlayers=1
[DEBUG isBettingRoundComplete] Hand 15: Active player seats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 15: Querying roundActions with: {
  "where": {
    "handId": 15,
    "round": "TURN",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG isBettingRoundComplete] Hand 15: Query returned 0 roundActions for round TURN: []
[DEBUG isBettingRoundComplete] Hand 15: actedSeats: []
[DEBUG isBettingRoundComplete] Hand 15: Checking 1 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 15: RETURNING false - Player 0 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 15: Context - actedSeats=[], playerSeat=0, currentRound=TURN, roundActions found=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG isBettingRoundComplete] Hand 15: Starting check
[DEBUG isBettingRoundComplete] Hand 15: Querying hand with: {"where":{"id":15}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG isBettingRoundComplete] Hand 15: Query result - hand={"id":15,"round":"TURN","currentBet":"0","currentActionSeat":0,"status":"TURN"}
[DEBUG isBettingRoundComplete] Hand 15: currentBet=0, currentRound=TURN
[DEBUG isBettingRoundComplete] Hand 15: Querying handPlayers with: {"where":{"handId":15}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG isBettingRoundComplete] Hand 15: Query returned 2 handPlayers: [{"id":29,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":30,"seatNumber":1,"status":"ALL_IN","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 15: activePlayers=1, allInPlayers=1
[DEBUG isBettingRoundComplete] Hand 15: Active player seats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 15: Querying roundActions with: {
  "where": {
    "handId": 15,
    "round": "TURN",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG isBettingRoundComplete] Hand 15: Query returned 1 roundActions for round TURN: [{"id":67,"seatNumber":0,"action":"CHECK","round":"TURN"}]
[DEBUG isBettingRoundComplete] Hand 15: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 15: Checking 1 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 15: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 15: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 15: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 15: Context - activePlayers=1, actedSeats=[0], currentBet=0, currentRound=TURN, roundActions queried=1, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 15: Active players detail: [{"seatNumber":0,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG advanceBettingRound] Hand 15: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG advanceBettingRound] Hand 15: needsSidePots=false
[DEBUG advanceBettingRound] Hand 15: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG advanceBettingRound] Hand 15: Querying hand with: {"where":{"id":15},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG advanceBettingRound] Hand 15: Query result - hand.round=TURN, players=2
[DEBUG advanceBettingRound] Hand 15: currentRound=TURN, deckPosition=8, communityCards.length=4
[DEBUG advanceBettingRound] Hand 15: Advancing from TURN to RIVER, cardsToDeal=1
[DEBUG advanceBettingRound] Hand 15: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 15: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '0' },
  { seatNumber: 1, status: 'ALL_IN', chipsCommitted: '0' }
]
[DEBUG advanceBettingRound] Hand 15: nonFoldedPlayers=2, activePlayers=1
[DEBUG advanceBettingRound] Hand 15: Active player seats: [ 0 ]
[DEBUG advanceBettingRound] Hand 15: allInPlayers=1, allPlayersAllIn=false, onlyOneActivePlayer=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG advanceBettingRound] Hand 15: Updating hand state: round=RIVER, status=RIVER, currentActionSeat=0, newCommunityCards.length=5
[DEBUG advanceBettingRound] Hand 15: Updating hand with: {"where":{"id":15},"data":{"round":"RIVER","status":"RIVER","communityCards":"[5 cards]","deckPosition":9,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG advanceBettingRound] Hand 15: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG advanceBettingRound] Hand 15: RETURNING true - Only one active player at RIVER, hand should be settled

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG handleBettingRoundComplete] Hand 15: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=true
[DEBUG handleBettingRoundComplete] Hand 15: Auto-advancing to RIVER and settling

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG handleBettingRoundComplete] Hand 15: Hand settled, winnerSeatNumber=0
[DEBUG handleBettingRoundComplete] Hand 15: RETURNING result with settlement: handEnded=true, roundAdvanced=true, winnerSeatNumber=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG callAction] Hand 15: handleBettingRoundComplete returned handEnded=true, roundAdvanced=true
[DEBUG callAction] Hand 15: RETURNING from transaction - Round complete
[DEBUG callAction] Hand 15: Context - hand.round=PRE_FLOP, handEnded=true, roundAdvanced=true, winnerSeatNumber=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-010: Big Blind All-In Pre-Flop (Small Blind Calls)
[DEBUG callAction] RETURNING final result: handEnded=true, roundAdvanced=true, tableId=15

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts)
[DEBUG createActionAndEvent] Hand 16: Creating action with: {"handId":16,"seatNumber":0,"round":"PRE_FLOP","action":"ALL_IN","amount":"49000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts)
[DEBUG createActionAndEvent] Hand 16: Action created successfully: {"id":70,"seatNumber":0,"action":"ALL_IN","round":"PRE_FLOP","amount":"49000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts)
[DEBUG isBettingRoundComplete] Hand 16: Starting check
[DEBUG isBettingRoundComplete] Hand 16: Querying hand with: {"where":{"id":16}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts)
[DEBUG isBettingRoundComplete] Hand 16: Query result - hand={"id":16,"round":"PRE_FLOP","currentBet":"50000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 16: currentBet=50000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 16: Querying handPlayers with: {"where":{"handId":16}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts)
[DEBUG isBettingRoundComplete] Hand 16: Query returned 2 handPlayers: [{"id":32,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"},{"id":31,"seatNumber":0,"status":"ALL_IN","chipsCommitted":"50000000"}]
[DEBUG isBettingRoundComplete] Hand 16: activePlayers=1, allInPlayers=1
[DEBUG isBettingRoundComplete] Hand 16: Active player seats: [ 1 ]
[DEBUG isBettingRoundComplete] Hand 16: Querying roundActions with: {
  "where": {
    "handId": 16,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts)
[DEBUG isBettingRoundComplete] Hand 16: Query returned 1 roundActions for round PRE_FLOP: [{"id":70,"seatNumber":0,"action":"ALL_IN","amount":"49000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 16: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 16: Checking 1 active players against actedSeats and currentBet=50000000
[DEBUG isBettingRoundComplete] Hand 16: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 16: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts)
[DEBUG handleNextPlayerOrRoundComplete] Hand 16: Called with currentSeatNumber=0, currentRound=PRE_FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts)
[DEBUG handleNextPlayerOrRoundComplete] Hand 16: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 16: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 16: Querying hand with: {"where":{"id":16},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts)
[DEBUG handleNextPlayerOrRoundComplete] Hand 16: Query result - hand.round=PRE_FLOP, currentRound param=PRE_FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 16: Hand players: [{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"},{"seatNumber":0,"status":"ALL_IN","chipsCommitted":"50000000"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 16: nextPlayer seat=1, chipsCommitted=2000000, currentBet=50000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 16: Next player hasn't matched (chipsCommitted=2000000, currentBet=50000000)
[DEBUG handleNextPlayerOrRoundComplete] Hand 16: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 16: Starting check
[DEBUG isBettingRoundComplete] Hand 16: Querying hand with: {"where":{"id":16}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts)
[DEBUG isBettingRoundComplete] Hand 16: Query result - hand={"id":16,"round":"PRE_FLOP","currentBet":"50000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 16: currentBet=50000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 16: Querying handPlayers with: {"where":{"handId":16}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts)
[DEBUG isBettingRoundComplete] Hand 16: Query returned 2 handPlayers: [{"id":32,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"},{"id":31,"seatNumber":0,"status":"ALL_IN","chipsCommitted":"50000000"}]
[DEBUG isBettingRoundComplete] Hand 16: activePlayers=1, allInPlayers=1
[DEBUG isBettingRoundComplete] Hand 16: Active player seats: [ 1 ]
[DEBUG isBettingRoundComplete] Hand 16: Querying roundActions with: {
  "where": {
    "handId": 16,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts)
[DEBUG isBettingRoundComplete] Hand 16: Query returned 1 roundActions for round PRE_FLOP: [{"id":70,"seatNumber":0,"action":"ALL_IN","amount":"49000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 16: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 16: Checking 1 active players against actedSeats and currentBet=50000000
[DEBUG isBettingRoundComplete] Hand 16: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 16: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts)
[DEBUG handleNextPlayerOrRoundComplete] Hand 16: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 16: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 16: Updating hand with: {"where":{"id":16},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts)
[DEBUG handleNextPlayerOrRoundComplete] Hand 16: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 16: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 16: Context - currentRound=PRE_FLOP, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts)
[DEBUG createActionAndEvent] Hand 16: Creating action with: {"handId":16,"seatNumber":1,"round":"PRE_FLOP","action":"ALL_IN","amount":"48000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts)
[DEBUG createActionAndEvent] Hand 16: Action created successfully: {"id":71,"seatNumber":1,"action":"ALL_IN","round":"PRE_FLOP","amount":"48000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts)
[DEBUG isBettingRoundComplete] Hand 16: Starting check
[DEBUG isBettingRoundComplete] Hand 16: Querying hand with: {"where":{"id":16}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts)
[DEBUG isBettingRoundComplete] Hand 16: Query result - hand={"id":16,"round":"PRE_FLOP","currentBet":"50000000","currentActionSeat":1,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 16: currentBet=50000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 16: Querying handPlayers with: {"where":{"handId":16}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts)
[DEBUG isBettingRoundComplete] Hand 16: Query returned 2 handPlayers: [{"id":31,"seatNumber":0,"status":"ALL_IN","chipsCommitted":"50000000"},{"id":32,"seatNumber":1,"status":"ALL_IN","chipsCommitted":"50000000"}]
[DEBUG isBettingRoundComplete] Hand 16: activePlayers=0, allInPlayers=2
[DEBUG isBettingRoundComplete] Hand 16: Active player seats: []
[DEBUG isBettingRoundComplete] Hand 16: Querying roundActions with: {
  "where": {
    "handId": 16,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts)
[DEBUG isBettingRoundComplete] Hand 16: Query returned 2 roundActions for round PRE_FLOP: [{"id":70,"seatNumber":0,"action":"ALL_IN","amount":"49000000","round":"PRE_FLOP"},{"id":71,"seatNumber":1,"action":"ALL_IN","amount":"48000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 16: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 16: Checking 0 active players against actedSeats and currentBet=50000000
[DEBUG isBettingRoundComplete] Hand 16: RETURNING true - All players all-in
[DEBUG isBettingRoundComplete] Hand 16: Context - activePlayers=0, allInPlayers=2, currentRound=PRE_FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts)
[DEBUG handleBettingRoundComplete] Hand 16: Called with currentRound=PRE_FLOP
[DEBUG handleBettingRoundComplete] Hand 16: Advancing from PRE_FLOP to next round
[DEBUG advanceBettingRound] Hand 16: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts)
[DEBUG advanceBettingRound] Hand 16: needsSidePots=false
[DEBUG advanceBettingRound] Hand 16: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts)
[DEBUG advanceBettingRound] Hand 16: Querying hand with: {"where":{"id":16},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts)
[DEBUG advanceBettingRound] Hand 16: Query result - hand.round=PRE_FLOP, players=2
[DEBUG advanceBettingRound] Hand 16: currentRound=PRE_FLOP, deckPosition=4, communityCards.length=0
[DEBUG advanceBettingRound] Hand 16: Advancing from PRE_FLOP to FLOP, cardsToDeal=3
[DEBUG advanceBettingRound] Hand 16: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 16: Players: [
  { seatNumber: 0, status: 'ALL_IN', chipsCommitted: '50000000' },
  { seatNumber: 1, status: 'ALL_IN', chipsCommitted: '50000000' }
]
[DEBUG advanceBettingRound] Hand 16: nonFoldedPlayers=2, activePlayers=0
[DEBUG advanceBettingRound] Hand 16: Active player seats: []
[DEBUG advanceBettingRound] Hand 16: allInPlayers=2, allPlayersAllIn=true, onlyOneActivePlayer=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts)
[DEBUG advanceBettingRound] Hand 16: Updating hand state: round=FLOP, status=FLOP, currentActionSeat=null, newCommunityCards.length=3
[DEBUG advanceBettingRound] Hand 16: Updating hand with: {"where":{"id":16},"data":{"round":"FLOP","status":"FLOP","communityCards":"[3 cards]","deckPosition":7,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":null}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts)
[DEBUG advanceBettingRound] Hand 16: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts)
[DEBUG advanceBettingRound] Hand 16: RETURNING false - Round advanced successfully from PRE_FLOP to FLOP (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts)
[DEBUG handleBettingRoundComplete] Hand 16: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 16: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts)
[DEBUG isBettingRoundComplete] Hand 16: Starting check
[DEBUG isBettingRoundComplete] Hand 16: Querying hand with: {"where":{"id":16}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts)
[DEBUG isBettingRoundComplete] Hand 16: Query result - hand={"id":16,"round":"FLOP","currentBet":"0","currentActionSeat":null,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 16: currentBet=0, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 16: Querying handPlayers with: {"where":{"handId":16}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts)
[DEBUG isBettingRoundComplete] Hand 16: Query returned 2 handPlayers: [{"id":31,"seatNumber":0,"status":"ALL_IN","chipsCommitted":"0"},{"id":32,"seatNumber":1,"status":"ALL_IN","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 16: activePlayers=0, allInPlayers=2
[DEBUG isBettingRoundComplete] Hand 16: Active player seats: []
[DEBUG isBettingRoundComplete] Hand 16: Querying roundActions with: {
  "where": {
    "handId": 16,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts)
[DEBUG isBettingRoundComplete] Hand 16: Query returned 0 roundActions for round FLOP: []
[DEBUG isBettingRoundComplete] Hand 16: actedSeats: []
[DEBUG isBettingRoundComplete] Hand 16: Checking 0 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 16: RETURNING true - All players all-in
[DEBUG isBettingRoundComplete] Hand 16: Context - activePlayers=0, allInPlayers=2, currentRound=FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts)
[DEBUG advanceBettingRound] Hand 16: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts)
[DEBUG advanceBettingRound] Hand 16: needsSidePots=false
[DEBUG advanceBettingRound] Hand 16: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts)
[DEBUG advanceBettingRound] Hand 16: Querying hand with: {"where":{"id":16},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts)
[DEBUG advanceBettingRound] Hand 16: Query result - hand.round=FLOP, players=2
[DEBUG advanceBettingRound] Hand 16: currentRound=FLOP, deckPosition=7, communityCards.length=3
[DEBUG advanceBettingRound] Hand 16: Advancing from FLOP to TURN, cardsToDeal=1
[DEBUG advanceBettingRound] Hand 16: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 16: Players: [
  { seatNumber: 0, status: 'ALL_IN', chipsCommitted: '0' },
  { seatNumber: 1, status: 'ALL_IN', chipsCommitted: '0' }
]
[DEBUG advanceBettingRound] Hand 16: nonFoldedPlayers=2, activePlayers=0
[DEBUG advanceBettingRound] Hand 16: Active player seats: []
[DEBUG advanceBettingRound] Hand 16: allInPlayers=2, allPlayersAllIn=true, onlyOneActivePlayer=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts)
[DEBUG advanceBettingRound] Hand 16: Updating hand state: round=TURN, status=TURN, currentActionSeat=null, newCommunityCards.length=4
[DEBUG advanceBettingRound] Hand 16: Updating hand with: {"where":{"id":16},"data":{"round":"TURN","status":"TURN","communityCards":"[4 cards]","deckPosition":8,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":null}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts)
[DEBUG advanceBettingRound] Hand 16: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts)
[DEBUG advanceBettingRound] Hand 16: RETURNING false - Round advanced successfully from FLOP to TURN (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts)
[DEBUG isBettingRoundComplete] Hand 16: Starting check
[DEBUG isBettingRoundComplete] Hand 16: Querying hand with: {"where":{"id":16}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts)
[DEBUG isBettingRoundComplete] Hand 16: Query result - hand={"id":16,"round":"TURN","currentBet":"0","currentActionSeat":null,"status":"TURN"}
[DEBUG isBettingRoundComplete] Hand 16: currentBet=0, currentRound=TURN
[DEBUG isBettingRoundComplete] Hand 16: Querying handPlayers with: {"where":{"handId":16}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts)
[DEBUG isBettingRoundComplete] Hand 16: Query returned 2 handPlayers: [{"id":31,"seatNumber":0,"status":"ALL_IN","chipsCommitted":"0"},{"id":32,"seatNumber":1,"status":"ALL_IN","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 16: activePlayers=0, allInPlayers=2
[DEBUG isBettingRoundComplete] Hand 16: Active player seats: []
[DEBUG isBettingRoundComplete] Hand 16: Querying roundActions with: {
  "where": {
    "handId": 16,
    "round": "TURN",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts)
[DEBUG isBettingRoundComplete] Hand 16: Query returned 0 roundActions for round TURN: []
[DEBUG isBettingRoundComplete] Hand 16: actedSeats: []
[DEBUG isBettingRoundComplete] Hand 16: Checking 0 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 16: RETURNING true - All players all-in
[DEBUG isBettingRoundComplete] Hand 16: Context - activePlayers=0, allInPlayers=2, currentRound=TURN

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts)
[DEBUG advanceBettingRound] Hand 16: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts)
[DEBUG advanceBettingRound] Hand 16: needsSidePots=false
[DEBUG advanceBettingRound] Hand 16: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts)
[DEBUG advanceBettingRound] Hand 16: Querying hand with: {"where":{"id":16},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts)
[DEBUG advanceBettingRound] Hand 16: Query result - hand.round=TURN, players=2
[DEBUG advanceBettingRound] Hand 16: currentRound=TURN, deckPosition=8, communityCards.length=4
[DEBUG advanceBettingRound] Hand 16: Advancing from TURN to RIVER, cardsToDeal=1
[DEBUG advanceBettingRound] Hand 16: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 16: Players: [
  { seatNumber: 0, status: 'ALL_IN', chipsCommitted: '0' },
  { seatNumber: 1, status: 'ALL_IN', chipsCommitted: '0' }
]
[DEBUG advanceBettingRound] Hand 16: nonFoldedPlayers=2, activePlayers=0
[DEBUG advanceBettingRound] Hand 16: Active player seats: []
[DEBUG advanceBettingRound] Hand 16: allInPlayers=2, allPlayersAllIn=true, onlyOneActivePlayer=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts)
[DEBUG advanceBettingRound] Hand 16: Updating hand state: round=RIVER, status=RIVER, currentActionSeat=null, newCommunityCards.length=5
[DEBUG advanceBettingRound] Hand 16: Updating hand with: {"where":{"id":16},"data":{"round":"RIVER","status":"RIVER","communityCards":"[5 cards]","deckPosition":9,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":null}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts)
[DEBUG advanceBettingRound] Hand 16: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts)
[DEBUG advanceBettingRound] Hand 16: RETURNING true - All players all-in at RIVER, hand should be settled

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts)
[DEBUG handleBettingRoundComplete] Hand 16: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=true
[DEBUG handleBettingRoundComplete] Hand 16: Auto-advancing to RIVER and settling

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts)
[DEBUG handleBettingRoundComplete] Hand 16: Hand settled, winnerSeatNumber=1
[DEBUG handleBettingRoundComplete] Hand 16: RETURNING result with settlement: handEnded=true, roundAdvanced=true, winnerSeatNumber=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts) - 700 bps rake
[DEBUG createActionAndEvent] Hand 17: Creating action with: {"handId":17,"seatNumber":0,"round":"PRE_FLOP","action":"ALL_IN","amount":"29000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts) - 700 bps rake
[DEBUG createActionAndEvent] Hand 17: Action created successfully: {"id":74,"seatNumber":0,"action":"ALL_IN","round":"PRE_FLOP","amount":"29000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 17: Starting check
[DEBUG isBettingRoundComplete] Hand 17: Querying hand with: {"where":{"id":17}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 17: Query result - hand={"id":17,"round":"PRE_FLOP","currentBet":"30000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 17: currentBet=30000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 17: Querying handPlayers with: {"where":{"handId":17}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 17: Query returned 2 handPlayers: [{"id":34,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"},{"id":33,"seatNumber":0,"status":"ALL_IN","chipsCommitted":"30000000"}]
[DEBUG isBettingRoundComplete] Hand 17: activePlayers=1, allInPlayers=1
[DEBUG isBettingRoundComplete] Hand 17: Active player seats: [ 1 ]
[DEBUG isBettingRoundComplete] Hand 17: Querying roundActions with: {
  "where": {
    "handId": 17,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 17: Query returned 1 roundActions for round PRE_FLOP: [{"id":74,"seatNumber":0,"action":"ALL_IN","amount":"29000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 17: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 17: Checking 1 active players against actedSeats and currentBet=30000000
[DEBUG isBettingRoundComplete] Hand 17: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 17: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts) - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 17: Called with currentSeatNumber=0, currentRound=PRE_FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts) - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 17: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 17: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 17: Querying hand with: {"where":{"id":17},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts) - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 17: Query result - hand.round=PRE_FLOP, currentRound param=PRE_FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 17: Hand players: [{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"},{"seatNumber":0,"status":"ALL_IN","chipsCommitted":"30000000"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 17: nextPlayer seat=1, chipsCommitted=2000000, currentBet=30000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 17: Next player hasn't matched (chipsCommitted=2000000, currentBet=30000000)
[DEBUG handleNextPlayerOrRoundComplete] Hand 17: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 17: Starting check
[DEBUG isBettingRoundComplete] Hand 17: Querying hand with: {"where":{"id":17}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 17: Query result - hand={"id":17,"round":"PRE_FLOP","currentBet":"30000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 17: currentBet=30000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 17: Querying handPlayers with: {"where":{"handId":17}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 17: Query returned 2 handPlayers: [{"id":34,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"},{"id":33,"seatNumber":0,"status":"ALL_IN","chipsCommitted":"30000000"}]
[DEBUG isBettingRoundComplete] Hand 17: activePlayers=1, allInPlayers=1
[DEBUG isBettingRoundComplete] Hand 17: Active player seats: [ 1 ]
[DEBUG isBettingRoundComplete] Hand 17: Querying roundActions with: {
  "where": {
    "handId": 17,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 17: Query returned 1 roundActions for round PRE_FLOP: [{"id":74,"seatNumber":0,"action":"ALL_IN","amount":"29000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 17: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 17: Checking 1 active players against actedSeats and currentBet=30000000
[DEBUG isBettingRoundComplete] Hand 17: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 17: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts) - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 17: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 17: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 17: Updating hand with: {"where":{"id":17},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts) - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 17: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 17: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 17: Context - currentRound=PRE_FLOP, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts) - 700 bps rake
[DEBUG createActionAndEvent] Hand 17: Creating action with: {"handId":17,"seatNumber":1,"round":"PRE_FLOP","action":"ALL_IN","amount":"48000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts) - 700 bps rake
[DEBUG createActionAndEvent] Hand 17: Action created successfully: {"id":75,"seatNumber":1,"action":"ALL_IN","round":"PRE_FLOP","amount":"48000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 17: Starting check
[DEBUG isBettingRoundComplete] Hand 17: Querying hand with: {"where":{"id":17}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 17: Query result - hand={"id":17,"round":"PRE_FLOP","currentBet":"50000000","currentActionSeat":1,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 17: currentBet=50000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 17: Querying handPlayers with: {"where":{"handId":17}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 17: Query returned 2 handPlayers: [{"id":33,"seatNumber":0,"status":"ALL_IN","chipsCommitted":"30000000"},{"id":34,"seatNumber":1,"status":"ALL_IN","chipsCommitted":"50000000"}]
[DEBUG isBettingRoundComplete] Hand 17: activePlayers=0, allInPlayers=2
[DEBUG isBettingRoundComplete] Hand 17: Active player seats: []
[DEBUG isBettingRoundComplete] Hand 17: Querying roundActions with: {
  "where": {
    "handId": 17,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 17: Query returned 2 roundActions for round PRE_FLOP: [{"id":74,"seatNumber":0,"action":"ALL_IN","amount":"29000000","round":"PRE_FLOP"},{"id":75,"seatNumber":1,"action":"ALL_IN","amount":"48000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 17: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 17: Checking 0 active players against actedSeats and currentBet=50000000
[DEBUG isBettingRoundComplete] Hand 17: RETURNING true - All players all-in
[DEBUG isBettingRoundComplete] Hand 17: Context - activePlayers=0, allInPlayers=2, currentRound=PRE_FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts) - 700 bps rake
[DEBUG handleBettingRoundComplete] Hand 17: Called with currentRound=PRE_FLOP
[DEBUG handleBettingRoundComplete] Hand 17: Advancing from PRE_FLOP to next round
[DEBUG advanceBettingRound] Hand 17: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts) - 700 bps rake
[DEBUG advanceBettingRound] Hand 17: needsSidePots=true
[DEBUG advanceBettingRound] Hand 17: Creating side pots

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts) - 700 bps rake
[DEBUG advanceBettingRound] Hand 17: Querying hand with: {"where":{"id":17},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts) - 700 bps rake
[DEBUG advanceBettingRound] Hand 17: Query result - hand.round=PRE_FLOP, players=2
[DEBUG advanceBettingRound] Hand 17: currentRound=PRE_FLOP, deckPosition=4, communityCards.length=0
[DEBUG advanceBettingRound] Hand 17: Advancing from PRE_FLOP to FLOP, cardsToDeal=3
[DEBUG advanceBettingRound] Hand 17: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 17: Players: [
  { seatNumber: 0, status: 'ALL_IN', chipsCommitted: '30000000' },
  { seatNumber: 1, status: 'ALL_IN', chipsCommitted: '50000000' }
]
[DEBUG advanceBettingRound] Hand 17: nonFoldedPlayers=2, activePlayers=0
[DEBUG advanceBettingRound] Hand 17: Active player seats: []
[DEBUG advanceBettingRound] Hand 17: allInPlayers=2, allPlayersAllIn=true, onlyOneActivePlayer=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts) - 700 bps rake
[DEBUG advanceBettingRound] Hand 17: Updating hand state: round=FLOP, status=FLOP, currentActionSeat=null, newCommunityCards.length=3
[DEBUG advanceBettingRound] Hand 17: Updating hand with: {"where":{"id":17},"data":{"round":"FLOP","status":"FLOP","communityCards":"[3 cards]","deckPosition":7,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":null}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts) - 700 bps rake
[DEBUG advanceBettingRound] Hand 17: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts) - 700 bps rake
[DEBUG advanceBettingRound] Hand 17: RETURNING false - Round advanced successfully from PRE_FLOP to FLOP (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts) - 700 bps rake
[DEBUG handleBettingRoundComplete] Hand 17: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 17: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 17: Starting check
[DEBUG isBettingRoundComplete] Hand 17: Querying hand with: {"where":{"id":17}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 17: Query result - hand={"id":17,"round":"FLOP","currentBet":"0","currentActionSeat":null,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 17: currentBet=0, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 17: Querying handPlayers with: {"where":{"handId":17}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 17: Query returned 2 handPlayers: [{"id":33,"seatNumber":0,"status":"ALL_IN","chipsCommitted":"0"},{"id":34,"seatNumber":1,"status":"ALL_IN","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 17: activePlayers=0, allInPlayers=2
[DEBUG isBettingRoundComplete] Hand 17: Active player seats: []
[DEBUG isBettingRoundComplete] Hand 17: Querying roundActions with: {
  "where": {
    "handId": 17,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 17: Query returned 0 roundActions for round FLOP: []
[DEBUG isBettingRoundComplete] Hand 17: actedSeats: []
[DEBUG isBettingRoundComplete] Hand 17: Checking 0 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 17: RETURNING true - All players all-in
[DEBUG isBettingRoundComplete] Hand 17: Context - activePlayers=0, allInPlayers=2, currentRound=FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts) - 700 bps rake
[DEBUG advanceBettingRound] Hand 17: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts) - 700 bps rake
[DEBUG advanceBettingRound] Hand 17: needsSidePots=true
[DEBUG advanceBettingRound] Hand 17: Creating side pots

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts) - 700 bps rake
[DEBUG advanceBettingRound] Hand 17: Querying hand with: {"where":{"id":17},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts) - 700 bps rake
[DEBUG advanceBettingRound] Hand 17: Query result - hand.round=FLOP, players=2
[DEBUG advanceBettingRound] Hand 17: currentRound=FLOP, deckPosition=7, communityCards.length=3
[DEBUG advanceBettingRound] Hand 17: Advancing from FLOP to TURN, cardsToDeal=1
[DEBUG advanceBettingRound] Hand 17: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 17: Players: [
  { seatNumber: 0, status: 'ALL_IN', chipsCommitted: '0' },
  { seatNumber: 1, status: 'ALL_IN', chipsCommitted: '0' }
]
[DEBUG advanceBettingRound] Hand 17: nonFoldedPlayers=2, activePlayers=0
[DEBUG advanceBettingRound] Hand 17: Active player seats: []
[DEBUG advanceBettingRound] Hand 17: allInPlayers=2, allPlayersAllIn=true, onlyOneActivePlayer=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts) - 700 bps rake
[DEBUG advanceBettingRound] Hand 17: Updating hand state: round=TURN, status=TURN, currentActionSeat=null, newCommunityCards.length=4
[DEBUG advanceBettingRound] Hand 17: Updating hand with: {"where":{"id":17},"data":{"round":"TURN","status":"TURN","communityCards":"[4 cards]","deckPosition":8,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":null}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts) - 700 bps rake
[DEBUG advanceBettingRound] Hand 17: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts) - 700 bps rake
[DEBUG advanceBettingRound] Hand 17: RETURNING false - Round advanced successfully from FLOP to TURN (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 17: Starting check
[DEBUG isBettingRoundComplete] Hand 17: Querying hand with: {"where":{"id":17}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 17: Query result - hand={"id":17,"round":"TURN","currentBet":"0","currentActionSeat":null,"status":"TURN"}
[DEBUG isBettingRoundComplete] Hand 17: currentBet=0, currentRound=TURN
[DEBUG isBettingRoundComplete] Hand 17: Querying handPlayers with: {"where":{"handId":17}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 17: Query returned 2 handPlayers: [{"id":33,"seatNumber":0,"status":"ALL_IN","chipsCommitted":"0"},{"id":34,"seatNumber":1,"status":"ALL_IN","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 17: activePlayers=0, allInPlayers=2
[DEBUG isBettingRoundComplete] Hand 17: Active player seats: []
[DEBUG isBettingRoundComplete] Hand 17: Querying roundActions with: {
  "where": {
    "handId": 17,
    "round": "TURN",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 17: Query returned 0 roundActions for round TURN: []
[DEBUG isBettingRoundComplete] Hand 17: actedSeats: []
[DEBUG isBettingRoundComplete] Hand 17: Checking 0 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 17: RETURNING true - All players all-in
[DEBUG isBettingRoundComplete] Hand 17: Context - activePlayers=0, allInPlayers=2, currentRound=TURN

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts) - 700 bps rake
[DEBUG advanceBettingRound] Hand 17: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts) - 700 bps rake
[DEBUG advanceBettingRound] Hand 17: needsSidePots=true
[DEBUG advanceBettingRound] Hand 17: Creating side pots

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts) - 700 bps rake
[DEBUG advanceBettingRound] Hand 17: Querying hand with: {"where":{"id":17},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts) - 700 bps rake
[DEBUG advanceBettingRound] Hand 17: Query result - hand.round=TURN, players=2
[DEBUG advanceBettingRound] Hand 17: currentRound=TURN, deckPosition=8, communityCards.length=4
[DEBUG advanceBettingRound] Hand 17: Advancing from TURN to RIVER, cardsToDeal=1
[DEBUG advanceBettingRound] Hand 17: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 17: Players: [
  { seatNumber: 0, status: 'ALL_IN', chipsCommitted: '0' },
  { seatNumber: 1, status: 'ALL_IN', chipsCommitted: '0' }
]
[DEBUG advanceBettingRound] Hand 17: nonFoldedPlayers=2, activePlayers=0
[DEBUG advanceBettingRound] Hand 17: Active player seats: []
[DEBUG advanceBettingRound] Hand 17: allInPlayers=2, allPlayersAllIn=true, onlyOneActivePlayer=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts) - 700 bps rake
[DEBUG advanceBettingRound] Hand 17: Updating hand state: round=RIVER, status=RIVER, currentActionSeat=null, newCommunityCards.length=5
[DEBUG advanceBettingRound] Hand 17: Updating hand with: {"where":{"id":17},"data":{"round":"RIVER","status":"RIVER","communityCards":"[5 cards]","deckPosition":9,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":null}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts) - 700 bps rake
[DEBUG advanceBettingRound] Hand 17: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts) - 700 bps rake
[DEBUG advanceBettingRound] Hand 17: RETURNING true - All players all-in at RIVER, hand should be settled

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts) - 700 bps rake
[DEBUG handleBettingRoundComplete] Hand 17: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=true
[DEBUG handleBettingRoundComplete] Hand 17: Auto-advancing to RIVER and settling

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts) - 700 bps rake
ðŸ’° Added rake 5600000 gwei to TEE balance (hand 17)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > PRE-FLOP Scenarios > PF-011: Both Players All-In Pre-Flop (Different Amounts) - 700 bps rake
[DEBUG handleBettingRoundComplete] Hand 17: Hand settled, winnerSeatNumber=1
[DEBUG handleBettingRoundComplete] Hand 17: RETURNING result with settlement: handEnded=true, roundAdvanced=true, winnerSeatNumber=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG callAction] Hand 18: Player seat 0 calling 1000000 in round PRE_FLOP, currentBet=2000000, chipsCommitted before=1000000
[DEBUG callAction] Hand 18: Creating CALL action with: handId=18, seatNumber=0, round=PRE_FLOP, amount=1000000
[DEBUG createActionAndEvent] Hand 18: Creating action with: {"handId":18,"seatNumber":0,"round":"PRE_FLOP","action":"CALL","amount":"1000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG createActionAndEvent] Hand 18: Action created successfully: {"id":78,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"1000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG callAction] Hand 18: CALL action created successfully: {"id":78,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"1000000"}
[DEBUG callAction] Hand 18: CALL action created, chipsCommitted now=2000000

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG callAction] Hand 18: After CALL by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 18: Starting check
[DEBUG isBettingRoundComplete] Hand 18: Querying hand with: {"where":{"id":18}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG isBettingRoundComplete] Hand 18: Query result - hand={"id":18,"round":"PRE_FLOP","currentBet":"2000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 18: currentBet=2000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 18: Querying handPlayers with: {"where":{"handId":18}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG isBettingRoundComplete] Hand 18: Query returned 2 handPlayers: [{"id":35,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"id":36,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG isBettingRoundComplete] Hand 18: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 18: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 18: Querying roundActions with: {
  "where": {
    "handId": 18,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG isBettingRoundComplete] Hand 18: Query returned 1 roundActions for round PRE_FLOP: [{"id":78,"seatNumber":0,"action":"CALL","amount":"1000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 18: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 18: Checking 2 active players against actedSeats and currentBet=2000000
[DEBUG isBettingRoundComplete] Hand 18: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=2000000, currentBet=2000000)
[DEBUG isBettingRoundComplete] Hand 18: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 18: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG callAction] Hand 18: isBettingRoundComplete returned false
[DEBUG callAction] Hand 18: Round not complete, checking auto-advance or next player

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG callAction] Hand 18: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 18: Called with currentSeatNumber=0, currentRound=PRE_FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 18: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 18: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 18: Querying hand with: {"where":{"id":18},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 18: Query result - hand.round=PRE_FLOP, currentRound param=PRE_FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 18: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 18: nextPlayer seat=1, chipsCommitted=2000000, currentBet=2000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 18: Next player has matched bet (currentBet > 0n), checking if all acted and matched
[DEBUG handleNextPlayerOrRoundComplete] Hand 18: Querying roundActions with: {
  "where": {
    "handId": 18,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 18: Query returned 1 roundActions for round PRE_FLOP: [{"id":78,"seatNumber":0,"action":"CALL","amount":"1000000","round":"PRE_FLOP"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 18: allActivePlayers (2): [
  { seatNumber: 0, chipsCommitted: '2000000', status: 'ACTIVE' },
  { seatNumber: 1, chipsCommitted: '2000000', status: 'ACTIVE' }
]
[DEBUG handleNextPlayerOrRoundComplete] Hand 18: Wrap-around check - allActed=false, allMatched=true, actedSeats=0, playersWhoHaventActed=1, onlyNextPlayerHaventActed=true
[DEBUG handleNextPlayerOrRoundComplete] Hand 18: Round complete detected - RETURNING early with round completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 18: Context - allActed=false, onlyNextPlayerHaventActed=true, allMatched=true, currentRound=PRE_FLOP, nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 18: Context - allActivePlayers=[{"seat":0,"chipsCommitted":"2000000","status":"ACTIVE"},{"seat":1,"chipsCommitted":"2000000","status":"ACTIVE"}], actedSeats=[0], roundActions found=1
[DEBUG handleBettingRoundComplete] Hand 18: Called with currentRound=PRE_FLOP
[DEBUG handleBettingRoundComplete] Hand 18: Advancing from PRE_FLOP to next round
[DEBUG advanceBettingRound] Hand 18: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG advanceBettingRound] Hand 18: needsSidePots=false
[DEBUG advanceBettingRound] Hand 18: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG advanceBettingRound] Hand 18: Querying hand with: {"where":{"id":18},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG advanceBettingRound] Hand 18: Query result - hand.round=PRE_FLOP, players=2
[DEBUG advanceBettingRound] Hand 18: currentRound=PRE_FLOP, deckPosition=4, communityCards.length=0
[DEBUG advanceBettingRound] Hand 18: Advancing from PRE_FLOP to FLOP, cardsToDeal=3
[DEBUG advanceBettingRound] Hand 18: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 18: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '2000000' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '2000000' }
]
[DEBUG advanceBettingRound] Hand 18: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 18: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 18: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 18: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 18: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG advanceBettingRound] Hand 18: Updating hand state: round=FLOP, status=FLOP, currentActionSeat=0, newCommunityCards.length=3
[DEBUG advanceBettingRound] Hand 18: Updating hand with: {"where":{"id":18},"data":{"round":"FLOP","status":"FLOP","communityCards":"[3 cards]","deckPosition":7,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG advanceBettingRound] Hand 18: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG advanceBettingRound] Hand 18: RETURNING false - Round advanced successfully from PRE_FLOP to FLOP (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG handleBettingRoundComplete] Hand 18: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 18: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG handleBettingRoundComplete] Hand 18: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 18: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 18: RETURNING result from handleBettingRoundComplete: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG callAction] Hand 18: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=true
[DEBUG callAction] Hand 18: RETURNING from transaction - Final result
[DEBUG callAction] Hand 18: Context - hand.round=PRE_FLOP, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG callAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=18

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG checkAction] Hand 18: Player seat 0 checking in round FLOP
[DEBUG checkAction] Hand 18: Creating CHECK action with: {"handId":18,"seatNumber":0,"round":"FLOP","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG checkAction] Hand 18: CHECK action created successfully: {"id":79,"seatNumber":0,"action":"CHECK","round":"FLOP","amount":null}
[DEBUG checkAction] Hand 18: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG checkAction] Hand 18: After CHECK by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 18: Starting check
[DEBUG isBettingRoundComplete] Hand 18: Querying hand with: {"where":{"id":18}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG isBettingRoundComplete] Hand 18: Query result - hand={"id":18,"round":"FLOP","currentBet":"0","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 18: currentBet=0, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 18: Querying handPlayers with: {"where":{"handId":18}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG isBettingRoundComplete] Hand 18: Query returned 2 handPlayers: [{"id":35,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":36,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 18: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 18: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 18: Querying roundActions with: {
  "where": {
    "handId": 18,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG isBettingRoundComplete] Hand 18: Query returned 1 roundActions for round FLOP: [{"id":79,"seatNumber":0,"action":"CHECK","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 18: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 18: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 18: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 18: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 18: Context - actedSeats=[0], playerSeat=1, currentRound=FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG checkAction] Hand 18: isBettingRoundComplete returned false
[DEBUG checkAction] Hand 18: Round not complete, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 18: Called with currentSeatNumber=0, currentRound=FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 18: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 18: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 18: Querying hand with: {"where":{"id":18},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 18: Query result - hand.round=FLOP, currentRound param=FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 18: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 18: nextPlayer seat=1, chipsCommitted=0, currentBet=0
[DEBUG handleNextPlayerOrRoundComplete] Hand 18: Zero-bet wrap-around, advancing to next player (will complete after they act)
[DEBUG handleNextPlayerOrRoundComplete] Hand 18: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 18: Starting check
[DEBUG isBettingRoundComplete] Hand 18: Querying hand with: {"where":{"id":18}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG isBettingRoundComplete] Hand 18: Query result - hand={"id":18,"round":"FLOP","currentBet":"0","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 18: currentBet=0, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 18: Querying handPlayers with: {"where":{"handId":18}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG isBettingRoundComplete] Hand 18: Query returned 2 handPlayers: [{"id":35,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":36,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 18: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 18: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 18: Querying roundActions with: {
  "where": {
    "handId": 18,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG isBettingRoundComplete] Hand 18: Query returned 1 roundActions for round FLOP: [{"id":79,"seatNumber":0,"action":"CHECK","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 18: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 18: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 18: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 18: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 18: Context - actedSeats=[0], playerSeat=1, currentRound=FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 18: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 18: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 18: Updating hand with: {"where":{"id":18},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 18: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 18: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 18: Context - currentRound=FLOP, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG checkAction] Hand 18: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=false
[DEBUG checkAction] Hand 18: RETURNING from transaction - Final result
[DEBUG checkAction] Hand 18: Context - hand.round=FLOP, handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG checkAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=18

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG checkAction] Hand 18: Player seat 1 checking in round FLOP
[DEBUG checkAction] Hand 18: Creating CHECK action with: {"handId":18,"seatNumber":1,"round":"FLOP","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG checkAction] Hand 18: CHECK action created successfully: {"id":80,"seatNumber":1,"action":"CHECK","round":"FLOP","amount":null}
[DEBUG checkAction] Hand 18: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG checkAction] Hand 18: After CHECK by seat 1, checking if round complete
[DEBUG isBettingRoundComplete] Hand 18: Starting check
[DEBUG isBettingRoundComplete] Hand 18: Querying hand with: {"where":{"id":18}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG isBettingRoundComplete] Hand 18: Query result - hand={"id":18,"round":"FLOP","currentBet":"0","currentActionSeat":1,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 18: currentBet=0, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 18: Querying handPlayers with: {"where":{"handId":18}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG isBettingRoundComplete] Hand 18: Query returned 2 handPlayers: [{"id":35,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":36,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 18: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 18: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 18: Querying roundActions with: {
  "where": {
    "handId": 18,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG isBettingRoundComplete] Hand 18: Query returned 2 roundActions for round FLOP: [{"id":79,"seatNumber":0,"action":"CHECK","round":"FLOP"},{"id":80,"seatNumber":1,"action":"CHECK","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 18: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 18: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 18: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 18: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 18: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 18: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 18: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 18: Context - activePlayers=2, actedSeats=[0,1], currentBet=0, currentRound=FLOP, roundActions queried=2, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 18: Active players detail: [{"seatNumber":0,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true},{"seatNumber":1,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG checkAction] Hand 18: isBettingRoundComplete returned true
[DEBUG checkAction] Hand 18: Round complete, calling handleBettingRoundComplete
[DEBUG handleBettingRoundComplete] Hand 18: Called with currentRound=FLOP
[DEBUG handleBettingRoundComplete] Hand 18: Advancing from FLOP to next round
[DEBUG advanceBettingRound] Hand 18: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG advanceBettingRound] Hand 18: needsSidePots=false
[DEBUG advanceBettingRound] Hand 18: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG advanceBettingRound] Hand 18: Querying hand with: {"where":{"id":18},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG advanceBettingRound] Hand 18: Query result - hand.round=FLOP, players=2
[DEBUG advanceBettingRound] Hand 18: currentRound=FLOP, deckPosition=7, communityCards.length=3
[DEBUG advanceBettingRound] Hand 18: Advancing from FLOP to TURN, cardsToDeal=1
[DEBUG advanceBettingRound] Hand 18: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 18: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '0' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '0' }
]
[DEBUG advanceBettingRound] Hand 18: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 18: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 18: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 18: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 18: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG advanceBettingRound] Hand 18: Updating hand state: round=TURN, status=TURN, currentActionSeat=0, newCommunityCards.length=4
[DEBUG advanceBettingRound] Hand 18: Updating hand with: {"where":{"id":18},"data":{"round":"TURN","status":"TURN","communityCards":"[4 cards]","deckPosition":8,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG advanceBettingRound] Hand 18: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG advanceBettingRound] Hand 18: RETURNING false - Round advanced successfully from FLOP to TURN (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG handleBettingRoundComplete] Hand 18: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 18: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG handleBettingRoundComplete] Hand 18: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 18: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG checkAction] Hand 18: handleBettingRoundComplete returned handEnded=false, roundAdvanced=true
[DEBUG checkAction] Hand 18: RETURNING from transaction - Round complete
[DEBUG checkAction] Hand 18: Context - hand.round=FLOP, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-001: Check-Check on Flop
[DEBUG checkAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=18

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG callAction] Hand 19: Player seat 0 calling 1000000 in round PRE_FLOP, currentBet=2000000, chipsCommitted before=1000000
[DEBUG callAction] Hand 19: Creating CALL action with: handId=19, seatNumber=0, round=PRE_FLOP, amount=1000000
[DEBUG createActionAndEvent] Hand 19: Creating action with: {"handId":19,"seatNumber":0,"round":"PRE_FLOP","action":"CALL","amount":"1000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG createActionAndEvent] Hand 19: Action created successfully: {"id":83,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"1000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG callAction] Hand 19: CALL action created successfully: {"id":83,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"1000000"}
[DEBUG callAction] Hand 19: CALL action created, chipsCommitted now=2000000

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG callAction] Hand 19: After CALL by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 19: Starting check
[DEBUG isBettingRoundComplete] Hand 19: Querying hand with: {"where":{"id":19}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG isBettingRoundComplete] Hand 19: Query result - hand={"id":19,"round":"PRE_FLOP","currentBet":"2000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 19: currentBet=2000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 19: Querying handPlayers with: {"where":{"handId":19}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG isBettingRoundComplete] Hand 19: Query returned 2 handPlayers: [{"id":37,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"id":38,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG isBettingRoundComplete] Hand 19: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 19: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 19: Querying roundActions with: {
  "where": {
    "handId": 19,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG isBettingRoundComplete] Hand 19: Query returned 1 roundActions for round PRE_FLOP: [{"id":83,"seatNumber":0,"action":"CALL","amount":"1000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 19: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 19: Checking 2 active players against actedSeats and currentBet=2000000
[DEBUG isBettingRoundComplete] Hand 19: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=2000000, currentBet=2000000)
[DEBUG isBettingRoundComplete] Hand 19: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 19: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG callAction] Hand 19: isBettingRoundComplete returned false
[DEBUG callAction] Hand 19: Round not complete, checking auto-advance or next player

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG callAction] Hand 19: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 19: Called with currentSeatNumber=0, currentRound=PRE_FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 19: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 19: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 19: Querying hand with: {"where":{"id":19},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 19: Query result - hand.round=PRE_FLOP, currentRound param=PRE_FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 19: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 19: nextPlayer seat=1, chipsCommitted=2000000, currentBet=2000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 19: Next player has matched bet (currentBet > 0n), checking if all acted and matched
[DEBUG handleNextPlayerOrRoundComplete] Hand 19: Querying roundActions with: {
  "where": {
    "handId": 19,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 19: Query returned 1 roundActions for round PRE_FLOP: [{"id":83,"seatNumber":0,"action":"CALL","amount":"1000000","round":"PRE_FLOP"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 19: allActivePlayers (2): [
  { seatNumber: 0, chipsCommitted: '2000000', status: 'ACTIVE' },
  { seatNumber: 1, chipsCommitted: '2000000', status: 'ACTIVE' }
]
[DEBUG handleNextPlayerOrRoundComplete] Hand 19: Wrap-around check - allActed=false, allMatched=true, actedSeats=0, playersWhoHaventActed=1, onlyNextPlayerHaventActed=true
[DEBUG handleNextPlayerOrRoundComplete] Hand 19: Round complete detected - RETURNING early with round completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 19: Context - allActed=false, onlyNextPlayerHaventActed=true, allMatched=true, currentRound=PRE_FLOP, nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 19: Context - allActivePlayers=[{"seat":0,"chipsCommitted":"2000000","status":"ACTIVE"},{"seat":1,"chipsCommitted":"2000000","status":"ACTIVE"}], actedSeats=[0], roundActions found=1
[DEBUG handleBettingRoundComplete] Hand 19: Called with currentRound=PRE_FLOP
[DEBUG handleBettingRoundComplete] Hand 19: Advancing from PRE_FLOP to next round
[DEBUG advanceBettingRound] Hand 19: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG advanceBettingRound] Hand 19: needsSidePots=false
[DEBUG advanceBettingRound] Hand 19: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG advanceBettingRound] Hand 19: Querying hand with: {"where":{"id":19},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG advanceBettingRound] Hand 19: Query result - hand.round=PRE_FLOP, players=2
[DEBUG advanceBettingRound] Hand 19: currentRound=PRE_FLOP, deckPosition=4, communityCards.length=0
[DEBUG advanceBettingRound] Hand 19: Advancing from PRE_FLOP to FLOP, cardsToDeal=3
[DEBUG advanceBettingRound] Hand 19: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 19: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '2000000' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '2000000' }
]
[DEBUG advanceBettingRound] Hand 19: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 19: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 19: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 19: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 19: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG advanceBettingRound] Hand 19: Updating hand state: round=FLOP, status=FLOP, currentActionSeat=0, newCommunityCards.length=3
[DEBUG advanceBettingRound] Hand 19: Updating hand with: {"where":{"id":19},"data":{"round":"FLOP","status":"FLOP","communityCards":"[3 cards]","deckPosition":7,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG advanceBettingRound] Hand 19: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG advanceBettingRound] Hand 19: RETURNING false - Round advanced successfully from PRE_FLOP to FLOP (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG handleBettingRoundComplete] Hand 19: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 19: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG handleBettingRoundComplete] Hand 19: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 19: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 19: RETURNING result from handleBettingRoundComplete: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG callAction] Hand 19: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=true
[DEBUG callAction] Hand 19: RETURNING from transaction - Final result
[DEBUG callAction] Hand 19: Context - hand.round=PRE_FLOP, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG callAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=19

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG betAction] Hand 19: Player seat 0 betting 5000000 in round FLOP, currentBet before=0, chipsCommitted before=0, isAllIn=false
[DEBUG betAction] Hand 19: Creating BET action - hand.round=FLOP, actionType=RAISE, eventActionType=BET
[DEBUG createActionAndEvent] Hand 19: Creating action with: {"handId":19,"seatNumber":0,"round":"FLOP","action":"RAISE","amount":"5000000","handRound":"FLOP","roundParam":"FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG createActionAndEvent] Hand 19: Action created successfully: {"id":84,"seatNumber":0,"action":"RAISE","round":"FLOP","amount":"5000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG betAction] Hand 19: BET action created successfully, checking if round complete
[DEBUG betAction] Hand 19: Checking if betting round complete after BET
[DEBUG betAction] Hand 19: Context before isBettingRoundComplete - hand.round=FLOP, currentBet=0, currentActionSeat=0
[DEBUG isBettingRoundComplete] Hand 19: Starting check
[DEBUG isBettingRoundComplete] Hand 19: Querying hand with: {"where":{"id":19}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG isBettingRoundComplete] Hand 19: Query result - hand={"id":19,"round":"FLOP","currentBet":"5000000","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 19: currentBet=5000000, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 19: Querying handPlayers with: {"where":{"handId":19}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG isBettingRoundComplete] Hand 19: Query returned 2 handPlayers: [{"id":37,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"5000000"},{"id":38,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 19: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 19: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 19: Querying roundActions with: {
  "where": {
    "handId": 19,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG isBettingRoundComplete] Hand 19: Query returned 1 roundActions for round FLOP: [{"id":84,"seatNumber":0,"action":"RAISE","amount":"5000000","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 19: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 19: Checking 2 active players against actedSeats and currentBet=5000000
[DEBUG isBettingRoundComplete] Hand 19: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=5000000, currentBet=5000000)
[DEBUG isBettingRoundComplete] Hand 19: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 19: Context - actedSeats=[0], playerSeat=1, currentRound=FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG betAction] Hand 19: isBettingRoundComplete returned false
[DEBUG handleBettingActionCompletion] Hand 19: Called with currentSeatNumber=0, currentRound=FLOP, bettingRoundComplete=false, isAllIn=false
[DEBUG handleBettingActionCompletion] Hand 19: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 19: Called with currentSeatNumber=0, currentRound=FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 19: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 19: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 19: Querying hand with: {"where":{"id":19},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 19: Query result - hand.round=FLOP, currentRound param=FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 19: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"5000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 19: nextPlayer seat=1, chipsCommitted=0, currentBet=5000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 19: Next player hasn't matched (chipsCommitted=0, currentBet=5000000)
[DEBUG handleNextPlayerOrRoundComplete] Hand 19: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 19: Starting check
[DEBUG isBettingRoundComplete] Hand 19: Querying hand with: {"where":{"id":19}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG isBettingRoundComplete] Hand 19: Query result - hand={"id":19,"round":"FLOP","currentBet":"5000000","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 19: currentBet=5000000, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 19: Querying handPlayers with: {"where":{"handId":19}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG isBettingRoundComplete] Hand 19: Query returned 2 handPlayers: [{"id":37,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"5000000"},{"id":38,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 19: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 19: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 19: Querying roundActions with: {
  "where": {
    "handId": 19,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG isBettingRoundComplete] Hand 19: Query returned 1 roundActions for round FLOP: [{"id":84,"seatNumber":0,"action":"RAISE","amount":"5000000","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 19: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 19: Checking 2 active players against actedSeats and currentBet=5000000
[DEBUG isBettingRoundComplete] Hand 19: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=5000000, currentBet=5000000)
[DEBUG isBettingRoundComplete] Hand 19: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 19: Context - actedSeats=[0], playerSeat=1, currentRound=FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 19: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 19: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 19: Updating hand with: {"where":{"id":19},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 19: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 19: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 19: Context - currentRound=FLOP, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG handleBettingActionCompletion] Hand 19: RETURNING result: handEnded=false, roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG betAction] Hand 19: handleBettingActionCompletion returned: handEnded=false, roundAdvanced=false
[DEBUG betAction] Hand 19: RETURNING from transaction
[DEBUG betAction] Hand 19: Context - hand.round=FLOP, handEnded=false, roundAdvanced=false, winnerSeatNumber=null
[DEBUG betAction] Hand 19: RETURNING from transaction - Final values: handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG betAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=19

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG callAction] Hand 19: Player seat 1 calling 5000000 in round FLOP, currentBet=5000000, chipsCommitted before=0
[DEBUG callAction] Hand 19: Creating CALL action with: handId=19, seatNumber=1, round=FLOP, amount=5000000
[DEBUG createActionAndEvent] Hand 19: Creating action with: {"handId":19,"seatNumber":1,"round":"FLOP","action":"CALL","amount":"5000000","handRound":"FLOP","roundParam":"FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG createActionAndEvent] Hand 19: Action created successfully: {"id":85,"seatNumber":1,"action":"CALL","round":"FLOP","amount":"5000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG callAction] Hand 19: CALL action created successfully: {"id":85,"seatNumber":1,"action":"CALL","round":"FLOP","amount":"5000000"}
[DEBUG callAction] Hand 19: CALL action created, chipsCommitted now=5000000

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG callAction] Hand 19: After CALL by seat 1, checking if round complete
[DEBUG isBettingRoundComplete] Hand 19: Starting check
[DEBUG isBettingRoundComplete] Hand 19: Querying hand with: {"where":{"id":19}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG isBettingRoundComplete] Hand 19: Query result - hand={"id":19,"round":"FLOP","currentBet":"5000000","currentActionSeat":1,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 19: currentBet=5000000, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 19: Querying handPlayers with: {"where":{"handId":19}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG isBettingRoundComplete] Hand 19: Query returned 2 handPlayers: [{"id":37,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"5000000"},{"id":38,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"5000000"}]
[DEBUG isBettingRoundComplete] Hand 19: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 19: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 19: Querying roundActions with: {
  "where": {
    "handId": 19,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG isBettingRoundComplete] Hand 19: Query returned 2 roundActions for round FLOP: [{"id":84,"seatNumber":0,"action":"RAISE","amount":"5000000","round":"FLOP"},{"id":85,"seatNumber":1,"action":"CALL","amount":"5000000","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 19: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 19: Checking 2 active players against actedSeats and currentBet=5000000
[DEBUG isBettingRoundComplete] Hand 19: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=5000000, currentBet=5000000)
[DEBUG isBettingRoundComplete] Hand 19: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=5000000, currentBet=5000000)
[DEBUG isBettingRoundComplete] Hand 19: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=5000000, currentBet=5000000)
[DEBUG isBettingRoundComplete] Hand 19: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=5000000, currentBet=5000000)
[DEBUG isBettingRoundComplete] Hand 19: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 19: Context - activePlayers=2, actedSeats=[0,1], currentBet=5000000, currentRound=FLOP, roundActions queried=2, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 19: Active players detail: [{"seatNumber":0,"chipsCommitted":"5000000","status":"ACTIVE","hasActed":true,"hasMatched":true},{"seatNumber":1,"chipsCommitted":"5000000","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG callAction] Hand 19: isBettingRoundComplete returned true
[DEBUG callAction] Hand 19: Round complete, calling handleBettingRoundComplete
[DEBUG handleBettingRoundComplete] Hand 19: Called with currentRound=FLOP
[DEBUG handleBettingRoundComplete] Hand 19: Advancing from FLOP to next round
[DEBUG advanceBettingRound] Hand 19: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG advanceBettingRound] Hand 19: needsSidePots=false
[DEBUG advanceBettingRound] Hand 19: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG advanceBettingRound] Hand 19: Querying hand with: {"where":{"id":19},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG advanceBettingRound] Hand 19: Query result - hand.round=FLOP, players=2
[DEBUG advanceBettingRound] Hand 19: currentRound=FLOP, deckPosition=7, communityCards.length=3
[DEBUG advanceBettingRound] Hand 19: Advancing from FLOP to TURN, cardsToDeal=1
[DEBUG advanceBettingRound] Hand 19: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 19: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '5000000' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '5000000' }
]
[DEBUG advanceBettingRound] Hand 19: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 19: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 19: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 19: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 19: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG advanceBettingRound] Hand 19: Updating hand state: round=TURN, status=TURN, currentActionSeat=0, newCommunityCards.length=4
[DEBUG advanceBettingRound] Hand 19: Updating hand with: {"where":{"id":19},"data":{"round":"TURN","status":"TURN","communityCards":"[4 cards]","deckPosition":8,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG advanceBettingRound] Hand 19: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG advanceBettingRound] Hand 19: RETURNING false - Round advanced successfully from FLOP to TURN (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG handleBettingRoundComplete] Hand 19: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 19: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG handleBettingRoundComplete] Hand 19: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 19: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG callAction] Hand 19: handleBettingRoundComplete returned handEnded=false, roundAdvanced=true
[DEBUG callAction] Hand 19: RETURNING from transaction - Round complete
[DEBUG callAction] Hand 19: Context - hand.round=FLOP, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-002: Bet-Call on Flop
[DEBUG callAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=19

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop
[DEBUG callAction] Hand 20: Player seat 0 calling 1000000 in round PRE_FLOP, currentBet=2000000, chipsCommitted before=1000000
[DEBUG callAction] Hand 20: Creating CALL action with: handId=20, seatNumber=0, round=PRE_FLOP, amount=1000000
[DEBUG createActionAndEvent] Hand 20: Creating action with: {"handId":20,"seatNumber":0,"round":"PRE_FLOP","action":"CALL","amount":"1000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop
[DEBUG createActionAndEvent] Hand 20: Action created successfully: {"id":88,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"1000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop
[DEBUG callAction] Hand 20: CALL action created successfully: {"id":88,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"1000000"}
[DEBUG callAction] Hand 20: CALL action created, chipsCommitted now=2000000

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop
[DEBUG callAction] Hand 20: After CALL by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 20: Starting check
[DEBUG isBettingRoundComplete] Hand 20: Querying hand with: {"where":{"id":20}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop
[DEBUG isBettingRoundComplete] Hand 20: Query result - hand={"id":20,"round":"PRE_FLOP","currentBet":"2000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 20: currentBet=2000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 20: Querying handPlayers with: {"where":{"handId":20}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop
[DEBUG isBettingRoundComplete] Hand 20: Query returned 2 handPlayers: [{"id":39,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"id":40,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG isBettingRoundComplete] Hand 20: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 20: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 20: Querying roundActions with: {
  "where": {
    "handId": 20,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop
[DEBUG isBettingRoundComplete] Hand 20: Query returned 1 roundActions for round PRE_FLOP: [{"id":88,"seatNumber":0,"action":"CALL","amount":"1000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 20: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 20: Checking 2 active players against actedSeats and currentBet=2000000
[DEBUG isBettingRoundComplete] Hand 20: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=2000000, currentBet=2000000)
[DEBUG isBettingRoundComplete] Hand 20: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 20: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop
[DEBUG callAction] Hand 20: isBettingRoundComplete returned false
[DEBUG callAction] Hand 20: Round not complete, checking auto-advance or next player

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop
[DEBUG callAction] Hand 20: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 20: Called with currentSeatNumber=0, currentRound=PRE_FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 20: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 20: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 20: Querying hand with: {"where":{"id":20},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 20: Query result - hand.round=PRE_FLOP, currentRound param=PRE_FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 20: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 20: nextPlayer seat=1, chipsCommitted=2000000, currentBet=2000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 20: Next player has matched bet (currentBet > 0n), checking if all acted and matched
[DEBUG handleNextPlayerOrRoundComplete] Hand 20: Querying roundActions with: {
  "where": {
    "handId": 20,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 20: Query returned 1 roundActions for round PRE_FLOP: [{"id":88,"seatNumber":0,"action":"CALL","amount":"1000000","round":"PRE_FLOP"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 20: allActivePlayers (2): [
  { seatNumber: 0, chipsCommitted: '2000000', status: 'ACTIVE' },
  { seatNumber: 1, chipsCommitted: '2000000', status: 'ACTIVE' }
]
[DEBUG handleNextPlayerOrRoundComplete] Hand 20: Wrap-around check - allActed=false, allMatched=true, actedSeats=0, playersWhoHaventActed=1, onlyNextPlayerHaventActed=true
[DEBUG handleNextPlayerOrRoundComplete] Hand 20: Round complete detected - RETURNING early with round completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 20: Context - allActed=false, onlyNextPlayerHaventActed=true, allMatched=true, currentRound=PRE_FLOP, nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 20: Context - allActivePlayers=[{"seat":0,"chipsCommitted":"2000000","status":"ACTIVE"},{"seat":1,"chipsCommitted":"2000000","status":"ACTIVE"}], actedSeats=[0], roundActions found=1
[DEBUG handleBettingRoundComplete] Hand 20: Called with currentRound=PRE_FLOP
[DEBUG handleBettingRoundComplete] Hand 20: Advancing from PRE_FLOP to next round
[DEBUG advanceBettingRound] Hand 20: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop
[DEBUG advanceBettingRound] Hand 20: needsSidePots=false
[DEBUG advanceBettingRound] Hand 20: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop
[DEBUG advanceBettingRound] Hand 20: Querying hand with: {"where":{"id":20},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop
[DEBUG advanceBettingRound] Hand 20: Query result - hand.round=PRE_FLOP, players=2
[DEBUG advanceBettingRound] Hand 20: currentRound=PRE_FLOP, deckPosition=4, communityCards.length=0
[DEBUG advanceBettingRound] Hand 20: Advancing from PRE_FLOP to FLOP, cardsToDeal=3
[DEBUG advanceBettingRound] Hand 20: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 20: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '2000000' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '2000000' }
]
[DEBUG advanceBettingRound] Hand 20: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 20: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 20: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 20: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 20: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop
[DEBUG advanceBettingRound] Hand 20: Updating hand state: round=FLOP, status=FLOP, currentActionSeat=0, newCommunityCards.length=3
[DEBUG advanceBettingRound] Hand 20: Updating hand with: {"where":{"id":20},"data":{"round":"FLOP","status":"FLOP","communityCards":"[3 cards]","deckPosition":7,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop
[DEBUG advanceBettingRound] Hand 20: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop
[DEBUG advanceBettingRound] Hand 20: RETURNING false - Round advanced successfully from PRE_FLOP to FLOP (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop
[DEBUG handleBettingRoundComplete] Hand 20: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 20: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop
[DEBUG handleBettingRoundComplete] Hand 20: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 20: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 20: RETURNING result from handleBettingRoundComplete: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop
[DEBUG callAction] Hand 20: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=true
[DEBUG callAction] Hand 20: RETURNING from transaction - Final result
[DEBUG callAction] Hand 20: Context - hand.round=PRE_FLOP, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop
[DEBUG callAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=20

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop
[DEBUG betAction] Hand 20: Player seat 0 betting 5000000 in round FLOP, currentBet before=0, chipsCommitted before=0, isAllIn=false
[DEBUG betAction] Hand 20: Creating BET action - hand.round=FLOP, actionType=RAISE, eventActionType=BET
[DEBUG createActionAndEvent] Hand 20: Creating action with: {"handId":20,"seatNumber":0,"round":"FLOP","action":"RAISE","amount":"5000000","handRound":"FLOP","roundParam":"FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop
[DEBUG createActionAndEvent] Hand 20: Action created successfully: {"id":89,"seatNumber":0,"action":"RAISE","round":"FLOP","amount":"5000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop
[DEBUG betAction] Hand 20: BET action created successfully, checking if round complete
[DEBUG betAction] Hand 20: Checking if betting round complete after BET
[DEBUG betAction] Hand 20: Context before isBettingRoundComplete - hand.round=FLOP, currentBet=0, currentActionSeat=0
[DEBUG isBettingRoundComplete] Hand 20: Starting check
[DEBUG isBettingRoundComplete] Hand 20: Querying hand with: {"where":{"id":20}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop
[DEBUG isBettingRoundComplete] Hand 20: Query result - hand={"id":20,"round":"FLOP","currentBet":"5000000","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 20: currentBet=5000000, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 20: Querying handPlayers with: {"where":{"handId":20}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop
[DEBUG isBettingRoundComplete] Hand 20: Query returned 2 handPlayers: [{"id":39,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"5000000"},{"id":40,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 20: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 20: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 20: Querying roundActions with: {
  "where": {
    "handId": 20,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop
[DEBUG isBettingRoundComplete] Hand 20: Query returned 1 roundActions for round FLOP: [{"id":89,"seatNumber":0,"action":"RAISE","amount":"5000000","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 20: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 20: Checking 2 active players against actedSeats and currentBet=5000000
[DEBUG isBettingRoundComplete] Hand 20: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=5000000, currentBet=5000000)
[DEBUG isBettingRoundComplete] Hand 20: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 20: Context - actedSeats=[0], playerSeat=1, currentRound=FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop
[DEBUG betAction] Hand 20: isBettingRoundComplete returned false
[DEBUG handleBettingActionCompletion] Hand 20: Called with currentSeatNumber=0, currentRound=FLOP, bettingRoundComplete=false, isAllIn=false
[DEBUG handleBettingActionCompletion] Hand 20: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 20: Called with currentSeatNumber=0, currentRound=FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 20: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 20: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 20: Querying hand with: {"where":{"id":20},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 20: Query result - hand.round=FLOP, currentRound param=FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 20: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"5000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 20: nextPlayer seat=1, chipsCommitted=0, currentBet=5000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 20: Next player hasn't matched (chipsCommitted=0, currentBet=5000000)
[DEBUG handleNextPlayerOrRoundComplete] Hand 20: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 20: Starting check
[DEBUG isBettingRoundComplete] Hand 20: Querying hand with: {"where":{"id":20}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop
[DEBUG isBettingRoundComplete] Hand 20: Query result - hand={"id":20,"round":"FLOP","currentBet":"5000000","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 20: currentBet=5000000, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 20: Querying handPlayers with: {"where":{"handId":20}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop
[DEBUG isBettingRoundComplete] Hand 20: Query returned 2 handPlayers: [{"id":39,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"5000000"},{"id":40,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 20: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 20: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 20: Querying roundActions with: {
  "where": {
    "handId": 20,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop
[DEBUG isBettingRoundComplete] Hand 20: Query returned 1 roundActions for round FLOP: [{"id":89,"seatNumber":0,"action":"RAISE","amount":"5000000","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 20: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 20: Checking 2 active players against actedSeats and currentBet=5000000
[DEBUG isBettingRoundComplete] Hand 20: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=5000000, currentBet=5000000)
[DEBUG isBettingRoundComplete] Hand 20: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 20: Context - actedSeats=[0], playerSeat=1, currentRound=FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 20: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 20: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 20: Updating hand with: {"where":{"id":20},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 20: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 20: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 20: Context - currentRound=FLOP, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop
[DEBUG handleBettingActionCompletion] Hand 20: RETURNING result: handEnded=false, roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop
[DEBUG betAction] Hand 20: handleBettingActionCompletion returned: handEnded=false, roundAdvanced=false
[DEBUG betAction] Hand 20: RETURNING from transaction
[DEBUG betAction] Hand 20: Context - hand.round=FLOP, handEnded=false, roundAdvanced=false, winnerSeatNumber=null
[DEBUG betAction] Hand 20: RETURNING from transaction - Final values: handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop
[DEBUG betAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=20

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop
[DEBUG foldAction] Hand 20: Player seat 1 folding in round FLOP
[DEBUG foldAction] Hand 20: Creating FOLD action with: {"handId":20,"seatNumber":1,"round":"FLOP","action":"FOLD","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop
[DEBUG foldAction] Hand 20: FOLD action created successfully: {"id":90,"seatNumber":1,"action":"FOLD","round":"FLOP","amount":null}
[DEBUG foldAction] Hand 20: FOLD action created, checking if round complete or advancing to next player

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop - 700 bps rake
[DEBUG callAction] Hand 21: Player seat 0 calling 1000000 in round PRE_FLOP, currentBet=2000000, chipsCommitted before=1000000
[DEBUG callAction] Hand 21: Creating CALL action with: handId=21, seatNumber=0, round=PRE_FLOP, amount=1000000
[DEBUG createActionAndEvent] Hand 21: Creating action with: {"handId":21,"seatNumber":0,"round":"PRE_FLOP","action":"CALL","amount":"1000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop - 700 bps rake
[DEBUG createActionAndEvent] Hand 21: Action created successfully: {"id":93,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"1000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop - 700 bps rake
[DEBUG callAction] Hand 21: CALL action created successfully: {"id":93,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"1000000"}
[DEBUG callAction] Hand 21: CALL action created, chipsCommitted now=2000000

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop - 700 bps rake
[DEBUG callAction] Hand 21: After CALL by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 21: Starting check
[DEBUG isBettingRoundComplete] Hand 21: Querying hand with: {"where":{"id":21}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 21: Query result - hand={"id":21,"round":"PRE_FLOP","currentBet":"2000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 21: currentBet=2000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 21: Querying handPlayers with: {"where":{"handId":21}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 21: Query returned 2 handPlayers: [{"id":41,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"id":42,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG isBettingRoundComplete] Hand 21: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 21: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 21: Querying roundActions with: {
  "where": {
    "handId": 21,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 21: Query returned 1 roundActions for round PRE_FLOP: [{"id":93,"seatNumber":0,"action":"CALL","amount":"1000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 21: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 21: Checking 2 active players against actedSeats and currentBet=2000000
[DEBUG isBettingRoundComplete] Hand 21: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=2000000, currentBet=2000000)
[DEBUG isBettingRoundComplete] Hand 21: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 21: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop - 700 bps rake
[DEBUG callAction] Hand 21: isBettingRoundComplete returned false
[DEBUG callAction] Hand 21: Round not complete, checking auto-advance or next player

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop - 700 bps rake
[DEBUG callAction] Hand 21: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 21: Called with currentSeatNumber=0, currentRound=PRE_FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 21: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 21: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 21: Querying hand with: {"where":{"id":21},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 21: Query result - hand.round=PRE_FLOP, currentRound param=PRE_FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 21: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 21: nextPlayer seat=1, chipsCommitted=2000000, currentBet=2000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 21: Next player has matched bet (currentBet > 0n), checking if all acted and matched
[DEBUG handleNextPlayerOrRoundComplete] Hand 21: Querying roundActions with: {
  "where": {
    "handId": 21,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 21: Query returned 1 roundActions for round PRE_FLOP: [{"id":93,"seatNumber":0,"action":"CALL","amount":"1000000","round":"PRE_FLOP"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 21: allActivePlayers (2): [
  { seatNumber: 0, chipsCommitted: '2000000', status: 'ACTIVE' },
  { seatNumber: 1, chipsCommitted: '2000000', status: 'ACTIVE' }
]
[DEBUG handleNextPlayerOrRoundComplete] Hand 21: Wrap-around check - allActed=false, allMatched=true, actedSeats=0, playersWhoHaventActed=1, onlyNextPlayerHaventActed=true
[DEBUG handleNextPlayerOrRoundComplete] Hand 21: Round complete detected - RETURNING early with round completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 21: Context - allActed=false, onlyNextPlayerHaventActed=true, allMatched=true, currentRound=PRE_FLOP, nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 21: Context - allActivePlayers=[{"seat":0,"chipsCommitted":"2000000","status":"ACTIVE"},{"seat":1,"chipsCommitted":"2000000","status":"ACTIVE"}], actedSeats=[0], roundActions found=1
[DEBUG handleBettingRoundComplete] Hand 21: Called with currentRound=PRE_FLOP
[DEBUG handleBettingRoundComplete] Hand 21: Advancing from PRE_FLOP to next round
[DEBUG advanceBettingRound] Hand 21: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop - 700 bps rake
[DEBUG advanceBettingRound] Hand 21: needsSidePots=false
[DEBUG advanceBettingRound] Hand 21: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop - 700 bps rake
[DEBUG advanceBettingRound] Hand 21: Querying hand with: {"where":{"id":21},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop - 700 bps rake
[DEBUG advanceBettingRound] Hand 21: Query result - hand.round=PRE_FLOP, players=2
[DEBUG advanceBettingRound] Hand 21: currentRound=PRE_FLOP, deckPosition=4, communityCards.length=0
[DEBUG advanceBettingRound] Hand 21: Advancing from PRE_FLOP to FLOP, cardsToDeal=3
[DEBUG advanceBettingRound] Hand 21: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 21: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '2000000' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '2000000' }
]
[DEBUG advanceBettingRound] Hand 21: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 21: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 21: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 21: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 21: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop - 700 bps rake
[DEBUG advanceBettingRound] Hand 21: Updating hand state: round=FLOP, status=FLOP, currentActionSeat=0, newCommunityCards.length=3
[DEBUG advanceBettingRound] Hand 21: Updating hand with: {"where":{"id":21},"data":{"round":"FLOP","status":"FLOP","communityCards":"[3 cards]","deckPosition":7,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop - 700 bps rake
[DEBUG advanceBettingRound] Hand 21: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop - 700 bps rake
[DEBUG advanceBettingRound] Hand 21: RETURNING false - Round advanced successfully from PRE_FLOP to FLOP (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop - 700 bps rake
[DEBUG handleBettingRoundComplete] Hand 21: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 21: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop - 700 bps rake
[DEBUG handleBettingRoundComplete] Hand 21: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 21: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 21: RETURNING result from handleBettingRoundComplete: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop - 700 bps rake
[DEBUG callAction] Hand 21: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=true
[DEBUG callAction] Hand 21: RETURNING from transaction - Final result
[DEBUG callAction] Hand 21: Context - hand.round=PRE_FLOP, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop - 700 bps rake
[DEBUG callAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=21

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop - 700 bps rake
[DEBUG betAction] Hand 21: Player seat 0 betting 5000000 in round FLOP, currentBet before=0, chipsCommitted before=0, isAllIn=false
[DEBUG betAction] Hand 21: Creating BET action - hand.round=FLOP, actionType=RAISE, eventActionType=BET
[DEBUG createActionAndEvent] Hand 21: Creating action with: {"handId":21,"seatNumber":0,"round":"FLOP","action":"RAISE","amount":"5000000","handRound":"FLOP","roundParam":"FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop - 700 bps rake
[DEBUG createActionAndEvent] Hand 21: Action created successfully: {"id":94,"seatNumber":0,"action":"RAISE","round":"FLOP","amount":"5000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop - 700 bps rake
[DEBUG betAction] Hand 21: BET action created successfully, checking if round complete
[DEBUG betAction] Hand 21: Checking if betting round complete after BET
[DEBUG betAction] Hand 21: Context before isBettingRoundComplete - hand.round=FLOP, currentBet=0, currentActionSeat=0
[DEBUG isBettingRoundComplete] Hand 21: Starting check
[DEBUG isBettingRoundComplete] Hand 21: Querying hand with: {"where":{"id":21}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 21: Query result - hand={"id":21,"round":"FLOP","currentBet":"5000000","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 21: currentBet=5000000, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 21: Querying handPlayers with: {"where":{"handId":21}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 21: Query returned 2 handPlayers: [{"id":41,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"5000000"},{"id":42,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 21: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 21: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 21: Querying roundActions with: {
  "where": {
    "handId": 21,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 21: Query returned 1 roundActions for round FLOP: [{"id":94,"seatNumber":0,"action":"RAISE","amount":"5000000","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 21: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 21: Checking 2 active players against actedSeats and currentBet=5000000
[DEBUG isBettingRoundComplete] Hand 21: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=5000000, currentBet=5000000)
[DEBUG isBettingRoundComplete] Hand 21: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 21: Context - actedSeats=[0], playerSeat=1, currentRound=FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop - 700 bps rake
[DEBUG betAction] Hand 21: isBettingRoundComplete returned false
[DEBUG handleBettingActionCompletion] Hand 21: Called with currentSeatNumber=0, currentRound=FLOP, bettingRoundComplete=false, isAllIn=false
[DEBUG handleBettingActionCompletion] Hand 21: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 21: Called with currentSeatNumber=0, currentRound=FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 21: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 21: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 21: Querying hand with: {"where":{"id":21},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 21: Query result - hand.round=FLOP, currentRound param=FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 21: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"5000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 21: nextPlayer seat=1, chipsCommitted=0, currentBet=5000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 21: Next player hasn't matched (chipsCommitted=0, currentBet=5000000)
[DEBUG handleNextPlayerOrRoundComplete] Hand 21: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 21: Starting check
[DEBUG isBettingRoundComplete] Hand 21: Querying hand with: {"where":{"id":21}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 21: Query result - hand={"id":21,"round":"FLOP","currentBet":"5000000","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 21: currentBet=5000000, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 21: Querying handPlayers with: {"where":{"handId":21}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 21: Query returned 2 handPlayers: [{"id":41,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"5000000"},{"id":42,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 21: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 21: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 21: Querying roundActions with: {
  "where": {
    "handId": 21,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 21: Query returned 1 roundActions for round FLOP: [{"id":94,"seatNumber":0,"action":"RAISE","amount":"5000000","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 21: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 21: Checking 2 active players against actedSeats and currentBet=5000000
[DEBUG isBettingRoundComplete] Hand 21: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=5000000, currentBet=5000000)
[DEBUG isBettingRoundComplete] Hand 21: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 21: Context - actedSeats=[0], playerSeat=1, currentRound=FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 21: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 21: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 21: Updating hand with: {"where":{"id":21},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 21: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 21: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 21: Context - currentRound=FLOP, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop - 700 bps rake
[DEBUG handleBettingActionCompletion] Hand 21: RETURNING result: handEnded=false, roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop - 700 bps rake
[DEBUG betAction] Hand 21: handleBettingActionCompletion returned: handEnded=false, roundAdvanced=false
[DEBUG betAction] Hand 21: RETURNING from transaction
[DEBUG betAction] Hand 21: Context - hand.round=FLOP, handEnded=false, roundAdvanced=false, winnerSeatNumber=null
[DEBUG betAction] Hand 21: RETURNING from transaction - Final values: handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop - 700 bps rake
[DEBUG betAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=21

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop - 700 bps rake
[DEBUG foldAction] Hand 21: Player seat 1 folding in round FLOP
[DEBUG foldAction] Hand 21: Creating FOLD action with: {"handId":21,"seatNumber":1,"round":"FLOP","action":"FOLD","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop - 700 bps rake
[DEBUG foldAction] Hand 21: FOLD action created successfully: {"id":95,"seatNumber":1,"action":"FOLD","round":"FLOP","amount":null}
[DEBUG foldAction] Hand 21: FOLD action created, checking if round complete or advancing to next player

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-003: Bet-Fold on Flop - 700 bps rake
ðŸ’° Added rake 630000 gwei to TEE balance (hand 21)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG callAction] Hand 22: Player seat 0 calling 1000000 in round PRE_FLOP, currentBet=2000000, chipsCommitted before=1000000
[DEBUG callAction] Hand 22: Creating CALL action with: handId=22, seatNumber=0, round=PRE_FLOP, amount=1000000
[DEBUG createActionAndEvent] Hand 22: Creating action with: {"handId":22,"seatNumber":0,"round":"PRE_FLOP","action":"CALL","amount":"1000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG createActionAndEvent] Hand 22: Action created successfully: {"id":98,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"1000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG callAction] Hand 22: CALL action created successfully: {"id":98,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"1000000"}
[DEBUG callAction] Hand 22: CALL action created, chipsCommitted now=2000000

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG callAction] Hand 22: After CALL by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 22: Starting check
[DEBUG isBettingRoundComplete] Hand 22: Querying hand with: {"where":{"id":22}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG isBettingRoundComplete] Hand 22: Query result - hand={"id":22,"round":"PRE_FLOP","currentBet":"2000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 22: currentBet=2000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 22: Querying handPlayers with: {"where":{"handId":22}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG isBettingRoundComplete] Hand 22: Query returned 2 handPlayers: [{"id":43,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"id":44,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG isBettingRoundComplete] Hand 22: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 22: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 22: Querying roundActions with: {
  "where": {
    "handId": 22,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG isBettingRoundComplete] Hand 22: Query returned 1 roundActions for round PRE_FLOP: [{"id":98,"seatNumber":0,"action":"CALL","amount":"1000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 22: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 22: Checking 2 active players against actedSeats and currentBet=2000000
[DEBUG isBettingRoundComplete] Hand 22: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=2000000, currentBet=2000000)
[DEBUG isBettingRoundComplete] Hand 22: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 22: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG callAction] Hand 22: isBettingRoundComplete returned false
[DEBUG callAction] Hand 22: Round not complete, checking auto-advance or next player

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG callAction] Hand 22: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 22: Called with currentSeatNumber=0, currentRound=PRE_FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 22: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 22: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 22: Querying hand with: {"where":{"id":22},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 22: Query result - hand.round=PRE_FLOP, currentRound param=PRE_FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 22: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 22: nextPlayer seat=1, chipsCommitted=2000000, currentBet=2000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 22: Next player has matched bet (currentBet > 0n), checking if all acted and matched
[DEBUG handleNextPlayerOrRoundComplete] Hand 22: Querying roundActions with: {
  "where": {
    "handId": 22,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 22: Query returned 1 roundActions for round PRE_FLOP: [{"id":98,"seatNumber":0,"action":"CALL","amount":"1000000","round":"PRE_FLOP"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 22: allActivePlayers (2): [
  { seatNumber: 0, chipsCommitted: '2000000', status: 'ACTIVE' },
  { seatNumber: 1, chipsCommitted: '2000000', status: 'ACTIVE' }
]
[DEBUG handleNextPlayerOrRoundComplete] Hand 22: Wrap-around check - allActed=false, allMatched=true, actedSeats=0, playersWhoHaventActed=1, onlyNextPlayerHaventActed=true
[DEBUG handleNextPlayerOrRoundComplete] Hand 22: Round complete detected - RETURNING early with round completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 22: Context - allActed=false, onlyNextPlayerHaventActed=true, allMatched=true, currentRound=PRE_FLOP, nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 22: Context - allActivePlayers=[{"seat":0,"chipsCommitted":"2000000","status":"ACTIVE"},{"seat":1,"chipsCommitted":"2000000","status":"ACTIVE"}], actedSeats=[0], roundActions found=1
[DEBUG handleBettingRoundComplete] Hand 22: Called with currentRound=PRE_FLOP
[DEBUG handleBettingRoundComplete] Hand 22: Advancing from PRE_FLOP to next round
[DEBUG advanceBettingRound] Hand 22: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG advanceBettingRound] Hand 22: needsSidePots=false
[DEBUG advanceBettingRound] Hand 22: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG advanceBettingRound] Hand 22: Querying hand with: {"where":{"id":22},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG advanceBettingRound] Hand 22: Query result - hand.round=PRE_FLOP, players=2
[DEBUG advanceBettingRound] Hand 22: currentRound=PRE_FLOP, deckPosition=4, communityCards.length=0
[DEBUG advanceBettingRound] Hand 22: Advancing from PRE_FLOP to FLOP, cardsToDeal=3
[DEBUG advanceBettingRound] Hand 22: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 22: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '2000000' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '2000000' }
]
[DEBUG advanceBettingRound] Hand 22: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 22: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 22: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 22: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 22: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG advanceBettingRound] Hand 22: Updating hand state: round=FLOP, status=FLOP, currentActionSeat=0, newCommunityCards.length=3
[DEBUG advanceBettingRound] Hand 22: Updating hand with: {"where":{"id":22},"data":{"round":"FLOP","status":"FLOP","communityCards":"[3 cards]","deckPosition":7,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG advanceBettingRound] Hand 22: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG advanceBettingRound] Hand 22: RETURNING false - Round advanced successfully from PRE_FLOP to FLOP (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG handleBettingRoundComplete] Hand 22: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 22: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG handleBettingRoundComplete] Hand 22: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 22: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 22: RETURNING result from handleBettingRoundComplete: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG callAction] Hand 22: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=true
[DEBUG callAction] Hand 22: RETURNING from transaction - Final result
[DEBUG callAction] Hand 22: Context - hand.round=PRE_FLOP, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG callAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=22

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG betAction] Hand 22: Player seat 0 betting 5000000 in round FLOP, currentBet before=0, chipsCommitted before=0, isAllIn=false
[DEBUG betAction] Hand 22: Creating BET action - hand.round=FLOP, actionType=RAISE, eventActionType=BET
[DEBUG createActionAndEvent] Hand 22: Creating action with: {"handId":22,"seatNumber":0,"round":"FLOP","action":"RAISE","amount":"5000000","handRound":"FLOP","roundParam":"FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG createActionAndEvent] Hand 22: Action created successfully: {"id":99,"seatNumber":0,"action":"RAISE","round":"FLOP","amount":"5000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG betAction] Hand 22: BET action created successfully, checking if round complete
[DEBUG betAction] Hand 22: Checking if betting round complete after BET
[DEBUG betAction] Hand 22: Context before isBettingRoundComplete - hand.round=FLOP, currentBet=0, currentActionSeat=0
[DEBUG isBettingRoundComplete] Hand 22: Starting check
[DEBUG isBettingRoundComplete] Hand 22: Querying hand with: {"where":{"id":22}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG isBettingRoundComplete] Hand 22: Query result - hand={"id":22,"round":"FLOP","currentBet":"5000000","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 22: currentBet=5000000, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 22: Querying handPlayers with: {"where":{"handId":22}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG isBettingRoundComplete] Hand 22: Query returned 2 handPlayers: [{"id":43,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"5000000"},{"id":44,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 22: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 22: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 22: Querying roundActions with: {
  "where": {
    "handId": 22,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG isBettingRoundComplete] Hand 22: Query returned 1 roundActions for round FLOP: [{"id":99,"seatNumber":0,"action":"RAISE","amount":"5000000","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 22: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 22: Checking 2 active players against actedSeats and currentBet=5000000
[DEBUG isBettingRoundComplete] Hand 22: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=5000000, currentBet=5000000)
[DEBUG isBettingRoundComplete] Hand 22: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 22: Context - actedSeats=[0], playerSeat=1, currentRound=FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG betAction] Hand 22: isBettingRoundComplete returned false
[DEBUG handleBettingActionCompletion] Hand 22: Called with currentSeatNumber=0, currentRound=FLOP, bettingRoundComplete=false, isAllIn=false
[DEBUG handleBettingActionCompletion] Hand 22: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 22: Called with currentSeatNumber=0, currentRound=FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 22: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 22: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 22: Querying hand with: {"where":{"id":22},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 22: Query result - hand.round=FLOP, currentRound param=FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 22: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"5000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 22: nextPlayer seat=1, chipsCommitted=0, currentBet=5000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 22: Next player hasn't matched (chipsCommitted=0, currentBet=5000000)
[DEBUG handleNextPlayerOrRoundComplete] Hand 22: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 22: Starting check
[DEBUG isBettingRoundComplete] Hand 22: Querying hand with: {"where":{"id":22}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG isBettingRoundComplete] Hand 22: Query result - hand={"id":22,"round":"FLOP","currentBet":"5000000","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 22: currentBet=5000000, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 22: Querying handPlayers with: {"where":{"handId":22}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG isBettingRoundComplete] Hand 22: Query returned 2 handPlayers: [{"id":43,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"5000000"},{"id":44,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 22: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 22: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 22: Querying roundActions with: {
  "where": {
    "handId": 22,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG isBettingRoundComplete] Hand 22: Query returned 1 roundActions for round FLOP: [{"id":99,"seatNumber":0,"action":"RAISE","amount":"5000000","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 22: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 22: Checking 2 active players against actedSeats and currentBet=5000000
[DEBUG isBettingRoundComplete] Hand 22: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=5000000, currentBet=5000000)
[DEBUG isBettingRoundComplete] Hand 22: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 22: Context - actedSeats=[0], playerSeat=1, currentRound=FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 22: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 22: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 22: Updating hand with: {"where":{"id":22},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 22: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 22: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 22: Context - currentRound=FLOP, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG handleBettingActionCompletion] Hand 22: RETURNING result: handEnded=false, roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG betAction] Hand 22: handleBettingActionCompletion returned: handEnded=false, roundAdvanced=false
[DEBUG betAction] Hand 22: RETURNING from transaction
[DEBUG betAction] Hand 22: Context - hand.round=FLOP, handEnded=false, roundAdvanced=false, winnerSeatNumber=null
[DEBUG betAction] Hand 22: RETURNING from transaction - Final values: handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG betAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=22

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG raiseAction] Hand 22: Player seat 1 raising 12000000 in round FLOP, currentBet before=5000000, chipsCommitted before=0, isAllIn=false
[DEBUG raiseAction] Hand 22: Creating RAISE action - hand.round=FLOP, actionType=RAISE, eventActionType=RAISE
[DEBUG createActionAndEvent] Hand 22: Creating action with: {"handId":22,"seatNumber":1,"round":"FLOP","action":"RAISE","amount":"12000000","handRound":"FLOP","roundParam":"FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG createActionAndEvent] Hand 22: Action created successfully: {"id":100,"seatNumber":1,"action":"RAISE","round":"FLOP","amount":"12000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG raiseAction] Hand 22: RAISE action created successfully, checking if round complete
[DEBUG raiseAction] Hand 22: Checking if betting round complete after RAISE
[DEBUG raiseAction] Hand 22: Context before isBettingRoundComplete - hand.round=FLOP, currentBet=5000000, currentActionSeat=1
[DEBUG isBettingRoundComplete] Hand 22: Starting check
[DEBUG isBettingRoundComplete] Hand 22: Querying hand with: {"where":{"id":22}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG isBettingRoundComplete] Hand 22: Query result - hand={"id":22,"round":"FLOP","currentBet":"12000000","currentActionSeat":1,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 22: currentBet=12000000, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 22: Querying handPlayers with: {"where":{"handId":22}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG isBettingRoundComplete] Hand 22: Query returned 2 handPlayers: [{"id":43,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"5000000"},{"id":44,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"12000000"}]
[DEBUG isBettingRoundComplete] Hand 22: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 22: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 22: Querying roundActions with: {
  "where": {
    "handId": 22,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG isBettingRoundComplete] Hand 22: Query returned 2 roundActions for round FLOP: [{"id":99,"seatNumber":0,"action":"RAISE","amount":"5000000","round":"FLOP"},{"id":100,"seatNumber":1,"action":"RAISE","amount":"12000000","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 22: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 22: Checking 2 active players against actedSeats and currentBet=12000000
[DEBUG isBettingRoundComplete] Hand 22: RETURNING false - Player 0 hasn't matched bet.
[DEBUG isBettingRoundComplete] Hand 22: Context - chipsCommitted=5000000, currentBet=12000000, playerSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG raiseAction] Hand 22: isBettingRoundComplete returned false
[DEBUG handleBettingActionCompletion] Hand 22: Called with currentSeatNumber=1, currentRound=FLOP, bettingRoundComplete=false, isAllIn=false
[DEBUG handleBettingActionCompletion] Hand 22: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 22: Called with currentSeatNumber=1, currentRound=FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 22: getNextActivePlayer returned nextSeat=0
[DEBUG handleNextPlayerOrRoundComplete] Hand 22: nextSeat=0, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 22: Querying hand with: {"where":{"id":22},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 22: Query result - hand.round=FLOP, currentRound param=FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 22: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"5000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"12000000"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 22: nextPlayer seat=0, chipsCommitted=5000000, currentBet=12000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 22: Next player hasn't matched (chipsCommitted=5000000, currentBet=12000000)
[DEBUG handleNextPlayerOrRoundComplete] Hand 22: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 22: Starting check
[DEBUG isBettingRoundComplete] Hand 22: Querying hand with: {"where":{"id":22}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG isBettingRoundComplete] Hand 22: Query result - hand={"id":22,"round":"FLOP","currentBet":"12000000","currentActionSeat":1,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 22: currentBet=12000000, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 22: Querying handPlayers with: {"where":{"handId":22}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG isBettingRoundComplete] Hand 22: Query returned 2 handPlayers: [{"id":43,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"5000000"},{"id":44,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"12000000"}]
[DEBUG isBettingRoundComplete] Hand 22: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 22: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 22: Querying roundActions with: {
  "where": {
    "handId": 22,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG isBettingRoundComplete] Hand 22: Query returned 2 roundActions for round FLOP: [{"id":99,"seatNumber":0,"action":"RAISE","amount":"5000000","round":"FLOP"},{"id":100,"seatNumber":1,"action":"RAISE","amount":"12000000","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 22: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 22: Checking 2 active players against actedSeats and currentBet=12000000
[DEBUG isBettingRoundComplete] Hand 22: RETURNING false - Player 0 hasn't matched bet.
[DEBUG isBettingRoundComplete] Hand 22: Context - chipsCommitted=5000000, currentBet=12000000, playerSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 22: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 22: Round not complete, advancing to next player 0
[DEBUG handleNextPlayerOrRoundComplete] Hand 22: Updating hand with: {"where":{"id":22},"data":{"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 22: Hand updated successfully, currentActionSeat now=0
[DEBUG handleNextPlayerOrRoundComplete] Hand 22: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 22: Context - currentRound=FLOP, nextSeat=0, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG handleBettingActionCompletion] Hand 22: RETURNING result: handEnded=false, roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG raiseAction] Hand 22: handleBettingActionCompletion returned: handEnded=false, roundAdvanced=false
[DEBUG raiseAction] Hand 22: RETURNING from transaction
[DEBUG raiseAction] Hand 22: Context - hand.round=FLOP, handEnded=false, roundAdvanced=false, winnerSeatNumber=null
[DEBUG raiseAction] Hand 22: RETURNING from transaction - Final values: handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG raiseAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=22

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG callAction] Hand 22: Player seat 0 calling 7000000 in round FLOP, currentBet=12000000, chipsCommitted before=5000000
[DEBUG callAction] Hand 22: Creating CALL action with: handId=22, seatNumber=0, round=FLOP, amount=7000000
[DEBUG createActionAndEvent] Hand 22: Creating action with: {"handId":22,"seatNumber":0,"round":"FLOP","action":"CALL","amount":"7000000","handRound":"FLOP","roundParam":"FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG createActionAndEvent] Hand 22: Action created successfully: {"id":101,"seatNumber":0,"action":"CALL","round":"FLOP","amount":"7000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG callAction] Hand 22: CALL action created successfully: {"id":101,"seatNumber":0,"action":"CALL","round":"FLOP","amount":"7000000"}
[DEBUG callAction] Hand 22: CALL action created, chipsCommitted now=12000000

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG callAction] Hand 22: After CALL by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 22: Starting check
[DEBUG isBettingRoundComplete] Hand 22: Querying hand with: {"where":{"id":22}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG isBettingRoundComplete] Hand 22: Query result - hand={"id":22,"round":"FLOP","currentBet":"12000000","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 22: currentBet=12000000, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 22: Querying handPlayers with: {"where":{"handId":22}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG isBettingRoundComplete] Hand 22: Query returned 2 handPlayers: [{"id":43,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"12000000"},{"id":44,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"12000000"}]
[DEBUG isBettingRoundComplete] Hand 22: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 22: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 22: Querying roundActions with: {
  "where": {
    "handId": 22,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG isBettingRoundComplete] Hand 22: Query returned 3 roundActions for round FLOP: [{"id":99,"seatNumber":0,"action":"RAISE","amount":"5000000","round":"FLOP"},{"id":100,"seatNumber":1,"action":"RAISE","amount":"12000000","round":"FLOP"},{"id":101,"seatNumber":0,"action":"CALL","amount":"7000000","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 22: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 22: Checking 2 active players against actedSeats and currentBet=12000000
[DEBUG isBettingRoundComplete] Hand 22: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=12000000, currentBet=12000000)
[DEBUG isBettingRoundComplete] Hand 22: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=12000000, currentBet=12000000)
[DEBUG isBettingRoundComplete] Hand 22: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=12000000, currentBet=12000000)
[DEBUG isBettingRoundComplete] Hand 22: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=12000000, currentBet=12000000)
[DEBUG isBettingRoundComplete] Hand 22: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 22: Context - activePlayers=2, actedSeats=[0,1], currentBet=12000000, currentRound=FLOP, roundActions queried=3, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 22: Active players detail: [{"seatNumber":0,"chipsCommitted":"12000000","status":"ACTIVE","hasActed":true,"hasMatched":true},{"seatNumber":1,"chipsCommitted":"12000000","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG callAction] Hand 22: isBettingRoundComplete returned true
[DEBUG callAction] Hand 22: Round complete, calling handleBettingRoundComplete
[DEBUG handleBettingRoundComplete] Hand 22: Called with currentRound=FLOP
[DEBUG handleBettingRoundComplete] Hand 22: Advancing from FLOP to next round
[DEBUG advanceBettingRound] Hand 22: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG advanceBettingRound] Hand 22: needsSidePots=false
[DEBUG advanceBettingRound] Hand 22: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG advanceBettingRound] Hand 22: Querying hand with: {"where":{"id":22},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG advanceBettingRound] Hand 22: Query result - hand.round=FLOP, players=2
[DEBUG advanceBettingRound] Hand 22: currentRound=FLOP, deckPosition=7, communityCards.length=3
[DEBUG advanceBettingRound] Hand 22: Advancing from FLOP to TURN, cardsToDeal=1
[DEBUG advanceBettingRound] Hand 22: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 22: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '12000000' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '12000000' }
]
[DEBUG advanceBettingRound] Hand 22: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 22: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 22: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 22: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 22: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG advanceBettingRound] Hand 22: Updating hand state: round=TURN, status=TURN, currentActionSeat=0, newCommunityCards.length=4
[DEBUG advanceBettingRound] Hand 22: Updating hand with: {"where":{"id":22},"data":{"round":"TURN","status":"TURN","communityCards":"[4 cards]","deckPosition":8,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG advanceBettingRound] Hand 22: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG advanceBettingRound] Hand 22: RETURNING false - Round advanced successfully from FLOP to TURN (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG handleBettingRoundComplete] Hand 22: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 22: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG handleBettingRoundComplete] Hand 22: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 22: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG callAction] Hand 22: handleBettingRoundComplete returned handEnded=false, roundAdvanced=true
[DEBUG callAction] Hand 22: RETURNING from transaction - Round complete
[DEBUG callAction] Hand 22: Context - hand.round=FLOP, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-004: Bet-Raise-Call on Flop
[DEBUG callAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=22

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG callAction] Hand 23: Player seat 0 calling 1000000 in round PRE_FLOP, currentBet=2000000, chipsCommitted before=1000000
[DEBUG callAction] Hand 23: Creating CALL action with: handId=23, seatNumber=0, round=PRE_FLOP, amount=1000000
[DEBUG createActionAndEvent] Hand 23: Creating action with: {"handId":23,"seatNumber":0,"round":"PRE_FLOP","action":"CALL","amount":"1000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG createActionAndEvent] Hand 23: Action created successfully: {"id":104,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"1000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG callAction] Hand 23: CALL action created successfully: {"id":104,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"1000000"}
[DEBUG callAction] Hand 23: CALL action created, chipsCommitted now=2000000

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG callAction] Hand 23: After CALL by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 23: Starting check
[DEBUG isBettingRoundComplete] Hand 23: Querying hand with: {"where":{"id":23}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG isBettingRoundComplete] Hand 23: Query result - hand={"id":23,"round":"PRE_FLOP","currentBet":"2000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 23: currentBet=2000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 23: Querying handPlayers with: {"where":{"handId":23}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG isBettingRoundComplete] Hand 23: Query returned 2 handPlayers: [{"id":45,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"id":46,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG isBettingRoundComplete] Hand 23: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 23: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 23: Querying roundActions with: {
  "where": {
    "handId": 23,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG isBettingRoundComplete] Hand 23: Query returned 1 roundActions for round PRE_FLOP: [{"id":104,"seatNumber":0,"action":"CALL","amount":"1000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 23: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 23: Checking 2 active players against actedSeats and currentBet=2000000
[DEBUG isBettingRoundComplete] Hand 23: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=2000000, currentBet=2000000)
[DEBUG isBettingRoundComplete] Hand 23: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 23: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG callAction] Hand 23: isBettingRoundComplete returned false
[DEBUG callAction] Hand 23: Round not complete, checking auto-advance or next player

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG callAction] Hand 23: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 23: Called with currentSeatNumber=0, currentRound=PRE_FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 23: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 23: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 23: Querying hand with: {"where":{"id":23},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 23: Query result - hand.round=PRE_FLOP, currentRound param=PRE_FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 23: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 23: nextPlayer seat=1, chipsCommitted=2000000, currentBet=2000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 23: Next player has matched bet (currentBet > 0n), checking if all acted and matched
[DEBUG handleNextPlayerOrRoundComplete] Hand 23: Querying roundActions with: {
  "where": {
    "handId": 23,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 23: Query returned 1 roundActions for round PRE_FLOP: [{"id":104,"seatNumber":0,"action":"CALL","amount":"1000000","round":"PRE_FLOP"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 23: allActivePlayers (2): [
  { seatNumber: 0, chipsCommitted: '2000000', status: 'ACTIVE' },
  { seatNumber: 1, chipsCommitted: '2000000', status: 'ACTIVE' }
]
[DEBUG handleNextPlayerOrRoundComplete] Hand 23: Wrap-around check - allActed=false, allMatched=true, actedSeats=0, playersWhoHaventActed=1, onlyNextPlayerHaventActed=true
[DEBUG handleNextPlayerOrRoundComplete] Hand 23: Round complete detected - RETURNING early with round completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 23: Context - allActed=false, onlyNextPlayerHaventActed=true, allMatched=true, currentRound=PRE_FLOP, nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 23: Context - allActivePlayers=[{"seat":0,"chipsCommitted":"2000000","status":"ACTIVE"},{"seat":1,"chipsCommitted":"2000000","status":"ACTIVE"}], actedSeats=[0], roundActions found=1
[DEBUG handleBettingRoundComplete] Hand 23: Called with currentRound=PRE_FLOP
[DEBUG handleBettingRoundComplete] Hand 23: Advancing from PRE_FLOP to next round
[DEBUG advanceBettingRound] Hand 23: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG advanceBettingRound] Hand 23: needsSidePots=false
[DEBUG advanceBettingRound] Hand 23: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG advanceBettingRound] Hand 23: Querying hand with: {"where":{"id":23},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG advanceBettingRound] Hand 23: Query result - hand.round=PRE_FLOP, players=2
[DEBUG advanceBettingRound] Hand 23: currentRound=PRE_FLOP, deckPosition=4, communityCards.length=0
[DEBUG advanceBettingRound] Hand 23: Advancing from PRE_FLOP to FLOP, cardsToDeal=3
[DEBUG advanceBettingRound] Hand 23: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 23: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '2000000' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '2000000' }
]
[DEBUG advanceBettingRound] Hand 23: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 23: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 23: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 23: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 23: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG advanceBettingRound] Hand 23: Updating hand state: round=FLOP, status=FLOP, currentActionSeat=0, newCommunityCards.length=3
[DEBUG advanceBettingRound] Hand 23: Updating hand with: {"where":{"id":23},"data":{"round":"FLOP","status":"FLOP","communityCards":"[3 cards]","deckPosition":7,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG advanceBettingRound] Hand 23: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG advanceBettingRound] Hand 23: RETURNING false - Round advanced successfully from PRE_FLOP to FLOP (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG handleBettingRoundComplete] Hand 23: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 23: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG handleBettingRoundComplete] Hand 23: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 23: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 23: RETURNING result from handleBettingRoundComplete: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG callAction] Hand 23: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=true
[DEBUG callAction] Hand 23: RETURNING from transaction - Final result
[DEBUG callAction] Hand 23: Context - hand.round=PRE_FLOP, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG callAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=23

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG betAction] Hand 23: Player seat 0 betting 5000000 in round FLOP, currentBet before=0, chipsCommitted before=0, isAllIn=false
[DEBUG betAction] Hand 23: Creating BET action - hand.round=FLOP, actionType=RAISE, eventActionType=BET
[DEBUG createActionAndEvent] Hand 23: Creating action with: {"handId":23,"seatNumber":0,"round":"FLOP","action":"RAISE","amount":"5000000","handRound":"FLOP","roundParam":"FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG createActionAndEvent] Hand 23: Action created successfully: {"id":105,"seatNumber":0,"action":"RAISE","round":"FLOP","amount":"5000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG betAction] Hand 23: BET action created successfully, checking if round complete
[DEBUG betAction] Hand 23: Checking if betting round complete after BET
[DEBUG betAction] Hand 23: Context before isBettingRoundComplete - hand.round=FLOP, currentBet=0, currentActionSeat=0
[DEBUG isBettingRoundComplete] Hand 23: Starting check
[DEBUG isBettingRoundComplete] Hand 23: Querying hand with: {"where":{"id":23}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG isBettingRoundComplete] Hand 23: Query result - hand={"id":23,"round":"FLOP","currentBet":"5000000","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 23: currentBet=5000000, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 23: Querying handPlayers with: {"where":{"handId":23}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG isBettingRoundComplete] Hand 23: Query returned 2 handPlayers: [{"id":45,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"5000000"},{"id":46,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 23: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 23: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 23: Querying roundActions with: {
  "where": {
    "handId": 23,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG isBettingRoundComplete] Hand 23: Query returned 1 roundActions for round FLOP: [{"id":105,"seatNumber":0,"action":"RAISE","amount":"5000000","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 23: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 23: Checking 2 active players against actedSeats and currentBet=5000000
[DEBUG isBettingRoundComplete] Hand 23: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=5000000, currentBet=5000000)
[DEBUG isBettingRoundComplete] Hand 23: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 23: Context - actedSeats=[0], playerSeat=1, currentRound=FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG betAction] Hand 23: isBettingRoundComplete returned false
[DEBUG handleBettingActionCompletion] Hand 23: Called with currentSeatNumber=0, currentRound=FLOP, bettingRoundComplete=false, isAllIn=false
[DEBUG handleBettingActionCompletion] Hand 23: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 23: Called with currentSeatNumber=0, currentRound=FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 23: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 23: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 23: Querying hand with: {"where":{"id":23},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 23: Query result - hand.round=FLOP, currentRound param=FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 23: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"5000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 23: nextPlayer seat=1, chipsCommitted=0, currentBet=5000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 23: Next player hasn't matched (chipsCommitted=0, currentBet=5000000)
[DEBUG handleNextPlayerOrRoundComplete] Hand 23: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 23: Starting check
[DEBUG isBettingRoundComplete] Hand 23: Querying hand with: {"where":{"id":23}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG isBettingRoundComplete] Hand 23: Query result - hand={"id":23,"round":"FLOP","currentBet":"5000000","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 23: currentBet=5000000, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 23: Querying handPlayers with: {"where":{"handId":23}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG isBettingRoundComplete] Hand 23: Query returned 2 handPlayers: [{"id":45,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"5000000"},{"id":46,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 23: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 23: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 23: Querying roundActions with: {
  "where": {
    "handId": 23,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG isBettingRoundComplete] Hand 23: Query returned 1 roundActions for round FLOP: [{"id":105,"seatNumber":0,"action":"RAISE","amount":"5000000","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 23: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 23: Checking 2 active players against actedSeats and currentBet=5000000
[DEBUG isBettingRoundComplete] Hand 23: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=5000000, currentBet=5000000)
[DEBUG isBettingRoundComplete] Hand 23: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 23: Context - actedSeats=[0], playerSeat=1, currentRound=FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 23: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 23: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 23: Updating hand with: {"where":{"id":23},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 23: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 23: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 23: Context - currentRound=FLOP, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG handleBettingActionCompletion] Hand 23: RETURNING result: handEnded=false, roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG betAction] Hand 23: handleBettingActionCompletion returned: handEnded=false, roundAdvanced=false
[DEBUG betAction] Hand 23: RETURNING from transaction
[DEBUG betAction] Hand 23: Context - hand.round=FLOP, handEnded=false, roundAdvanced=false, winnerSeatNumber=null
[DEBUG betAction] Hand 23: RETURNING from transaction - Final values: handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG betAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=23

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG raiseAction] Hand 23: Player seat 1 raising 12000000 in round FLOP, currentBet before=5000000, chipsCommitted before=0, isAllIn=false
[DEBUG raiseAction] Hand 23: Creating RAISE action - hand.round=FLOP, actionType=RAISE, eventActionType=RAISE
[DEBUG createActionAndEvent] Hand 23: Creating action with: {"handId":23,"seatNumber":1,"round":"FLOP","action":"RAISE","amount":"12000000","handRound":"FLOP","roundParam":"FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG createActionAndEvent] Hand 23: Action created successfully: {"id":106,"seatNumber":1,"action":"RAISE","round":"FLOP","amount":"12000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG raiseAction] Hand 23: RAISE action created successfully, checking if round complete
[DEBUG raiseAction] Hand 23: Checking if betting round complete after RAISE
[DEBUG raiseAction] Hand 23: Context before isBettingRoundComplete - hand.round=FLOP, currentBet=5000000, currentActionSeat=1
[DEBUG isBettingRoundComplete] Hand 23: Starting check
[DEBUG isBettingRoundComplete] Hand 23: Querying hand with: {"where":{"id":23}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG isBettingRoundComplete] Hand 23: Query result - hand={"id":23,"round":"FLOP","currentBet":"12000000","currentActionSeat":1,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 23: currentBet=12000000, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 23: Querying handPlayers with: {"where":{"handId":23}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG isBettingRoundComplete] Hand 23: Query returned 2 handPlayers: [{"id":45,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"5000000"},{"id":46,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"12000000"}]
[DEBUG isBettingRoundComplete] Hand 23: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 23: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 23: Querying roundActions with: {
  "where": {
    "handId": 23,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG isBettingRoundComplete] Hand 23: Query returned 2 roundActions for round FLOP: [{"id":105,"seatNumber":0,"action":"RAISE","amount":"5000000","round":"FLOP"},{"id":106,"seatNumber":1,"action":"RAISE","amount":"12000000","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 23: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 23: Checking 2 active players against actedSeats and currentBet=12000000
[DEBUG isBettingRoundComplete] Hand 23: RETURNING false - Player 0 hasn't matched bet.
[DEBUG isBettingRoundComplete] Hand 23: Context - chipsCommitted=5000000, currentBet=12000000, playerSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG raiseAction] Hand 23: isBettingRoundComplete returned false
[DEBUG handleBettingActionCompletion] Hand 23: Called with currentSeatNumber=1, currentRound=FLOP, bettingRoundComplete=false, isAllIn=false
[DEBUG handleBettingActionCompletion] Hand 23: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 23: Called with currentSeatNumber=1, currentRound=FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 23: getNextActivePlayer returned nextSeat=0
[DEBUG handleNextPlayerOrRoundComplete] Hand 23: nextSeat=0, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 23: Querying hand with: {"where":{"id":23},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 23: Query result - hand.round=FLOP, currentRound param=FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 23: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"5000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"12000000"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 23: nextPlayer seat=0, chipsCommitted=5000000, currentBet=12000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 23: Next player hasn't matched (chipsCommitted=5000000, currentBet=12000000)
[DEBUG handleNextPlayerOrRoundComplete] Hand 23: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 23: Starting check
[DEBUG isBettingRoundComplete] Hand 23: Querying hand with: {"where":{"id":23}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG isBettingRoundComplete] Hand 23: Query result - hand={"id":23,"round":"FLOP","currentBet":"12000000","currentActionSeat":1,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 23: currentBet=12000000, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 23: Querying handPlayers with: {"where":{"handId":23}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG isBettingRoundComplete] Hand 23: Query returned 2 handPlayers: [{"id":45,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"5000000"},{"id":46,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"12000000"}]
[DEBUG isBettingRoundComplete] Hand 23: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 23: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 23: Querying roundActions with: {
  "where": {
    "handId": 23,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG isBettingRoundComplete] Hand 23: Query returned 2 roundActions for round FLOP: [{"id":105,"seatNumber":0,"action":"RAISE","amount":"5000000","round":"FLOP"},{"id":106,"seatNumber":1,"action":"RAISE","amount":"12000000","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 23: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 23: Checking 2 active players against actedSeats and currentBet=12000000
[DEBUG isBettingRoundComplete] Hand 23: RETURNING false - Player 0 hasn't matched bet.
[DEBUG isBettingRoundComplete] Hand 23: Context - chipsCommitted=5000000, currentBet=12000000, playerSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 23: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 23: Round not complete, advancing to next player 0
[DEBUG handleNextPlayerOrRoundComplete] Hand 23: Updating hand with: {"where":{"id":23},"data":{"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 23: Hand updated successfully, currentActionSeat now=0
[DEBUG handleNextPlayerOrRoundComplete] Hand 23: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 23: Context - currentRound=FLOP, nextSeat=0, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG handleBettingActionCompletion] Hand 23: RETURNING result: handEnded=false, roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG raiseAction] Hand 23: handleBettingActionCompletion returned: handEnded=false, roundAdvanced=false
[DEBUG raiseAction] Hand 23: RETURNING from transaction
[DEBUG raiseAction] Hand 23: Context - hand.round=FLOP, handEnded=false, roundAdvanced=false, winnerSeatNumber=null
[DEBUG raiseAction] Hand 23: RETURNING from transaction - Final values: handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG raiseAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=23

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG foldAction] Hand 23: Player seat 0 folding in round FLOP
[DEBUG foldAction] Hand 23: Creating FOLD action with: {"handId":23,"seatNumber":0,"round":"FLOP","action":"FOLD","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-005: Bet-Raise-Fold on Flop
[DEBUG foldAction] Hand 23: FOLD action created successfully: {"id":107,"seatNumber":0,"action":"FOLD","round":"FLOP","amount":null}
[DEBUG foldAction] Hand 23: FOLD action created, checking if round complete or advancing to next player

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG callAction] Hand 24: Player seat 0 calling 1000000 in round PRE_FLOP, currentBet=2000000, chipsCommitted before=1000000
[DEBUG callAction] Hand 24: Creating CALL action with: handId=24, seatNumber=0, round=PRE_FLOP, amount=1000000
[DEBUG createActionAndEvent] Hand 24: Creating action with: {"handId":24,"seatNumber":0,"round":"PRE_FLOP","action":"CALL","amount":"1000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG createActionAndEvent] Hand 24: Action created successfully: {"id":110,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"1000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG callAction] Hand 24: CALL action created successfully: {"id":110,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"1000000"}
[DEBUG callAction] Hand 24: CALL action created, chipsCommitted now=2000000

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG callAction] Hand 24: After CALL by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 24: Starting check
[DEBUG isBettingRoundComplete] Hand 24: Querying hand with: {"where":{"id":24}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG isBettingRoundComplete] Hand 24: Query result - hand={"id":24,"round":"PRE_FLOP","currentBet":"2000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 24: currentBet=2000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 24: Querying handPlayers with: {"where":{"handId":24}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG isBettingRoundComplete] Hand 24: Query returned 2 handPlayers: [{"id":47,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"id":48,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG isBettingRoundComplete] Hand 24: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 24: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 24: Querying roundActions with: {
  "where": {
    "handId": 24,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG isBettingRoundComplete] Hand 24: Query returned 1 roundActions for round PRE_FLOP: [{"id":110,"seatNumber":0,"action":"CALL","amount":"1000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 24: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 24: Checking 2 active players against actedSeats and currentBet=2000000
[DEBUG isBettingRoundComplete] Hand 24: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=2000000, currentBet=2000000)
[DEBUG isBettingRoundComplete] Hand 24: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 24: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG callAction] Hand 24: isBettingRoundComplete returned false
[DEBUG callAction] Hand 24: Round not complete, checking auto-advance or next player

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG callAction] Hand 24: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 24: Called with currentSeatNumber=0, currentRound=PRE_FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 24: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 24: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 24: Querying hand with: {"where":{"id":24},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 24: Query result - hand.round=PRE_FLOP, currentRound param=PRE_FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 24: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 24: nextPlayer seat=1, chipsCommitted=2000000, currentBet=2000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 24: Next player has matched bet (currentBet > 0n), checking if all acted and matched
[DEBUG handleNextPlayerOrRoundComplete] Hand 24: Querying roundActions with: {
  "where": {
    "handId": 24,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 24: Query returned 1 roundActions for round PRE_FLOP: [{"id":110,"seatNumber":0,"action":"CALL","amount":"1000000","round":"PRE_FLOP"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 24: allActivePlayers (2): [
  { seatNumber: 0, chipsCommitted: '2000000', status: 'ACTIVE' },
  { seatNumber: 1, chipsCommitted: '2000000', status: 'ACTIVE' }
]
[DEBUG handleNextPlayerOrRoundComplete] Hand 24: Wrap-around check - allActed=false, allMatched=true, actedSeats=0, playersWhoHaventActed=1, onlyNextPlayerHaventActed=true
[DEBUG handleNextPlayerOrRoundComplete] Hand 24: Round complete detected - RETURNING early with round completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 24: Context - allActed=false, onlyNextPlayerHaventActed=true, allMatched=true, currentRound=PRE_FLOP, nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 24: Context - allActivePlayers=[{"seat":0,"chipsCommitted":"2000000","status":"ACTIVE"},{"seat":1,"chipsCommitted":"2000000","status":"ACTIVE"}], actedSeats=[0], roundActions found=1
[DEBUG handleBettingRoundComplete] Hand 24: Called with currentRound=PRE_FLOP
[DEBUG handleBettingRoundComplete] Hand 24: Advancing from PRE_FLOP to next round
[DEBUG advanceBettingRound] Hand 24: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG advanceBettingRound] Hand 24: needsSidePots=false
[DEBUG advanceBettingRound] Hand 24: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG advanceBettingRound] Hand 24: Querying hand with: {"where":{"id":24},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG advanceBettingRound] Hand 24: Query result - hand.round=PRE_FLOP, players=2
[DEBUG advanceBettingRound] Hand 24: currentRound=PRE_FLOP, deckPosition=4, communityCards.length=0
[DEBUG advanceBettingRound] Hand 24: Advancing from PRE_FLOP to FLOP, cardsToDeal=3
[DEBUG advanceBettingRound] Hand 24: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 24: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '2000000' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '2000000' }
]
[DEBUG advanceBettingRound] Hand 24: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 24: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 24: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 24: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 24: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG advanceBettingRound] Hand 24: Updating hand state: round=FLOP, status=FLOP, currentActionSeat=0, newCommunityCards.length=3
[DEBUG advanceBettingRound] Hand 24: Updating hand with: {"where":{"id":24},"data":{"round":"FLOP","status":"FLOP","communityCards":"[3 cards]","deckPosition":7,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG advanceBettingRound] Hand 24: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG advanceBettingRound] Hand 24: RETURNING false - Round advanced successfully from PRE_FLOP to FLOP (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG handleBettingRoundComplete] Hand 24: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 24: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG handleBettingRoundComplete] Hand 24: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 24: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 24: RETURNING result from handleBettingRoundComplete: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG callAction] Hand 24: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=true
[DEBUG callAction] Hand 24: RETURNING from transaction - Final result
[DEBUG callAction] Hand 24: Context - hand.round=PRE_FLOP, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG callAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=24

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG checkAction] Hand 24: Player seat 0 checking in round FLOP
[DEBUG checkAction] Hand 24: Creating CHECK action with: {"handId":24,"seatNumber":0,"round":"FLOP","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG checkAction] Hand 24: CHECK action created successfully: {"id":111,"seatNumber":0,"action":"CHECK","round":"FLOP","amount":null}
[DEBUG checkAction] Hand 24: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG checkAction] Hand 24: After CHECK by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 24: Starting check
[DEBUG isBettingRoundComplete] Hand 24: Querying hand with: {"where":{"id":24}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG isBettingRoundComplete] Hand 24: Query result - hand={"id":24,"round":"FLOP","currentBet":"0","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 24: currentBet=0, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 24: Querying handPlayers with: {"where":{"handId":24}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG isBettingRoundComplete] Hand 24: Query returned 2 handPlayers: [{"id":47,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":48,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 24: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 24: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 24: Querying roundActions with: {
  "where": {
    "handId": 24,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG isBettingRoundComplete] Hand 24: Query returned 1 roundActions for round FLOP: [{"id":111,"seatNumber":0,"action":"CHECK","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 24: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 24: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 24: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 24: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 24: Context - actedSeats=[0], playerSeat=1, currentRound=FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG checkAction] Hand 24: isBettingRoundComplete returned false
[DEBUG checkAction] Hand 24: Round not complete, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 24: Called with currentSeatNumber=0, currentRound=FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 24: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 24: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 24: Querying hand with: {"where":{"id":24},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 24: Query result - hand.round=FLOP, currentRound param=FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 24: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 24: nextPlayer seat=1, chipsCommitted=0, currentBet=0
[DEBUG handleNextPlayerOrRoundComplete] Hand 24: Zero-bet wrap-around, advancing to next player (will complete after they act)
[DEBUG handleNextPlayerOrRoundComplete] Hand 24: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 24: Starting check
[DEBUG isBettingRoundComplete] Hand 24: Querying hand with: {"where":{"id":24}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG isBettingRoundComplete] Hand 24: Query result - hand={"id":24,"round":"FLOP","currentBet":"0","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 24: currentBet=0, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 24: Querying handPlayers with: {"where":{"handId":24}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG isBettingRoundComplete] Hand 24: Query returned 2 handPlayers: [{"id":47,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":48,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 24: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 24: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 24: Querying roundActions with: {
  "where": {
    "handId": 24,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG isBettingRoundComplete] Hand 24: Query returned 1 roundActions for round FLOP: [{"id":111,"seatNumber":0,"action":"CHECK","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 24: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 24: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 24: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 24: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 24: Context - actedSeats=[0], playerSeat=1, currentRound=FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 24: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 24: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 24: Updating hand with: {"where":{"id":24},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 24: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 24: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 24: Context - currentRound=FLOP, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG checkAction] Hand 24: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=false
[DEBUG checkAction] Hand 24: RETURNING from transaction - Final result
[DEBUG checkAction] Hand 24: Context - hand.round=FLOP, handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG checkAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=24

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG betAction] Hand 24: Player seat 1 betting 5000000 in round FLOP, currentBet before=0, chipsCommitted before=0, isAllIn=false
[DEBUG betAction] Hand 24: Creating BET action - hand.round=FLOP, actionType=RAISE, eventActionType=BET
[DEBUG createActionAndEvent] Hand 24: Creating action with: {"handId":24,"seatNumber":1,"round":"FLOP","action":"RAISE","amount":"5000000","handRound":"FLOP","roundParam":"FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG createActionAndEvent] Hand 24: Action created successfully: {"id":112,"seatNumber":1,"action":"RAISE","round":"FLOP","amount":"5000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG betAction] Hand 24: BET action created successfully, checking if round complete
[DEBUG betAction] Hand 24: Checking if betting round complete after BET
[DEBUG betAction] Hand 24: Context before isBettingRoundComplete - hand.round=FLOP, currentBet=0, currentActionSeat=1
[DEBUG isBettingRoundComplete] Hand 24: Starting check
[DEBUG isBettingRoundComplete] Hand 24: Querying hand with: {"where":{"id":24}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG isBettingRoundComplete] Hand 24: Query result - hand={"id":24,"round":"FLOP","currentBet":"5000000","currentActionSeat":1,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 24: currentBet=5000000, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 24: Querying handPlayers with: {"where":{"handId":24}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG isBettingRoundComplete] Hand 24: Query returned 2 handPlayers: [{"id":47,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":48,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"5000000"}]
[DEBUG isBettingRoundComplete] Hand 24: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 24: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 24: Querying roundActions with: {
  "where": {
    "handId": 24,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG isBettingRoundComplete] Hand 24: Query returned 2 roundActions for round FLOP: [{"id":111,"seatNumber":0,"action":"CHECK","round":"FLOP"},{"id":112,"seatNumber":1,"action":"RAISE","amount":"5000000","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 24: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 24: Checking 2 active players against actedSeats and currentBet=5000000
[DEBUG isBettingRoundComplete] Hand 24: RETURNING false - Player 0 hasn't matched bet.
[DEBUG isBettingRoundComplete] Hand 24: Context - chipsCommitted=0, currentBet=5000000, playerSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG betAction] Hand 24: isBettingRoundComplete returned false
[DEBUG handleBettingActionCompletion] Hand 24: Called with currentSeatNumber=1, currentRound=FLOP, bettingRoundComplete=false, isAllIn=false
[DEBUG handleBettingActionCompletion] Hand 24: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 24: Called with currentSeatNumber=1, currentRound=FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 24: getNextActivePlayer returned nextSeat=0
[DEBUG handleNextPlayerOrRoundComplete] Hand 24: nextSeat=0, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 24: Querying hand with: {"where":{"id":24},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 24: Query result - hand.round=FLOP, currentRound param=FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 24: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"5000000"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 24: nextPlayer seat=0, chipsCommitted=0, currentBet=5000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 24: Next player hasn't matched (chipsCommitted=0, currentBet=5000000)
[DEBUG handleNextPlayerOrRoundComplete] Hand 24: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 24: Starting check
[DEBUG isBettingRoundComplete] Hand 24: Querying hand with: {"where":{"id":24}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG isBettingRoundComplete] Hand 24: Query result - hand={"id":24,"round":"FLOP","currentBet":"5000000","currentActionSeat":1,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 24: currentBet=5000000, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 24: Querying handPlayers with: {"where":{"handId":24}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG isBettingRoundComplete] Hand 24: Query returned 2 handPlayers: [{"id":47,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":48,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"5000000"}]
[DEBUG isBettingRoundComplete] Hand 24: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 24: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 24: Querying roundActions with: {
  "where": {
    "handId": 24,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG isBettingRoundComplete] Hand 24: Query returned 2 roundActions for round FLOP: [{"id":111,"seatNumber":0,"action":"CHECK","round":"FLOP"},{"id":112,"seatNumber":1,"action":"RAISE","amount":"5000000","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 24: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 24: Checking 2 active players against actedSeats and currentBet=5000000
[DEBUG isBettingRoundComplete] Hand 24: RETURNING false - Player 0 hasn't matched bet.
[DEBUG isBettingRoundComplete] Hand 24: Context - chipsCommitted=0, currentBet=5000000, playerSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 24: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 24: Round not complete, advancing to next player 0
[DEBUG handleNextPlayerOrRoundComplete] Hand 24: Updating hand with: {"where":{"id":24},"data":{"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 24: Hand updated successfully, currentActionSeat now=0
[DEBUG handleNextPlayerOrRoundComplete] Hand 24: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 24: Context - currentRound=FLOP, nextSeat=0, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG handleBettingActionCompletion] Hand 24: RETURNING result: handEnded=false, roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG betAction] Hand 24: handleBettingActionCompletion returned: handEnded=false, roundAdvanced=false
[DEBUG betAction] Hand 24: RETURNING from transaction
[DEBUG betAction] Hand 24: Context - hand.round=FLOP, handEnded=false, roundAdvanced=false, winnerSeatNumber=null
[DEBUG betAction] Hand 24: RETURNING from transaction - Final values: handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG betAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=24

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG callAction] Hand 24: Player seat 0 calling 5000000 in round FLOP, currentBet=5000000, chipsCommitted before=0
[DEBUG callAction] Hand 24: Creating CALL action with: handId=24, seatNumber=0, round=FLOP, amount=5000000
[DEBUG createActionAndEvent] Hand 24: Creating action with: {"handId":24,"seatNumber":0,"round":"FLOP","action":"CALL","amount":"5000000","handRound":"FLOP","roundParam":"FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG createActionAndEvent] Hand 24: Action created successfully: {"id":113,"seatNumber":0,"action":"CALL","round":"FLOP","amount":"5000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG callAction] Hand 24: CALL action created successfully: {"id":113,"seatNumber":0,"action":"CALL","round":"FLOP","amount":"5000000"}
[DEBUG callAction] Hand 24: CALL action created, chipsCommitted now=5000000

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG callAction] Hand 24: After CALL by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 24: Starting check
[DEBUG isBettingRoundComplete] Hand 24: Querying hand with: {"where":{"id":24}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG isBettingRoundComplete] Hand 24: Query result - hand={"id":24,"round":"FLOP","currentBet":"5000000","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 24: currentBet=5000000, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 24: Querying handPlayers with: {"where":{"handId":24}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG isBettingRoundComplete] Hand 24: Query returned 2 handPlayers: [{"id":47,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"5000000"},{"id":48,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"5000000"}]
[DEBUG isBettingRoundComplete] Hand 24: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 24: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 24: Querying roundActions with: {
  "where": {
    "handId": 24,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG isBettingRoundComplete] Hand 24: Query returned 3 roundActions for round FLOP: [{"id":111,"seatNumber":0,"action":"CHECK","round":"FLOP"},{"id":112,"seatNumber":1,"action":"RAISE","amount":"5000000","round":"FLOP"},{"id":113,"seatNumber":0,"action":"CALL","amount":"5000000","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 24: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 24: Checking 2 active players against actedSeats and currentBet=5000000
[DEBUG isBettingRoundComplete] Hand 24: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=5000000, currentBet=5000000)
[DEBUG isBettingRoundComplete] Hand 24: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=5000000, currentBet=5000000)
[DEBUG isBettingRoundComplete] Hand 24: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=5000000, currentBet=5000000)
[DEBUG isBettingRoundComplete] Hand 24: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=5000000, currentBet=5000000)
[DEBUG isBettingRoundComplete] Hand 24: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 24: Context - activePlayers=2, actedSeats=[0,1], currentBet=5000000, currentRound=FLOP, roundActions queried=3, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 24: Active players detail: [{"seatNumber":0,"chipsCommitted":"5000000","status":"ACTIVE","hasActed":true,"hasMatched":true},{"seatNumber":1,"chipsCommitted":"5000000","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG callAction] Hand 24: isBettingRoundComplete returned true
[DEBUG callAction] Hand 24: Round complete, calling handleBettingRoundComplete
[DEBUG handleBettingRoundComplete] Hand 24: Called with currentRound=FLOP
[DEBUG handleBettingRoundComplete] Hand 24: Advancing from FLOP to next round
[DEBUG advanceBettingRound] Hand 24: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG advanceBettingRound] Hand 24: needsSidePots=false
[DEBUG advanceBettingRound] Hand 24: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG advanceBettingRound] Hand 24: Querying hand with: {"where":{"id":24},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG advanceBettingRound] Hand 24: Query result - hand.round=FLOP, players=2
[DEBUG advanceBettingRound] Hand 24: currentRound=FLOP, deckPosition=7, communityCards.length=3
[DEBUG advanceBettingRound] Hand 24: Advancing from FLOP to TURN, cardsToDeal=1
[DEBUG advanceBettingRound] Hand 24: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 24: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '5000000' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '5000000' }
]
[DEBUG advanceBettingRound] Hand 24: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 24: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 24: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 24: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 24: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG advanceBettingRound] Hand 24: Updating hand state: round=TURN, status=TURN, currentActionSeat=0, newCommunityCards.length=4
[DEBUG advanceBettingRound] Hand 24: Updating hand with: {"where":{"id":24},"data":{"round":"TURN","status":"TURN","communityCards":"[4 cards]","deckPosition":8,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG advanceBettingRound] Hand 24: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG advanceBettingRound] Hand 24: RETURNING false - Round advanced successfully from FLOP to TURN (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG handleBettingRoundComplete] Hand 24: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 24: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG handleBettingRoundComplete] Hand 24: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 24: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG callAction] Hand 24: handleBettingRoundComplete returned handEnded=false, roundAdvanced=true
[DEBUG callAction] Hand 24: RETURNING from transaction - Round complete
[DEBUG callAction] Hand 24: Context - hand.round=FLOP, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-006: Check-Bet-Call on Flop
[DEBUG callAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=24

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG callAction] Hand 25: Player seat 0 calling 1000000 in round PRE_FLOP, currentBet=2000000, chipsCommitted before=1000000
[DEBUG callAction] Hand 25: Creating CALL action with: handId=25, seatNumber=0, round=PRE_FLOP, amount=1000000
[DEBUG createActionAndEvent] Hand 25: Creating action with: {"handId":25,"seatNumber":0,"round":"PRE_FLOP","action":"CALL","amount":"1000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG createActionAndEvent] Hand 25: Action created successfully: {"id":116,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"1000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG callAction] Hand 25: CALL action created successfully: {"id":116,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"1000000"}
[DEBUG callAction] Hand 25: CALL action created, chipsCommitted now=2000000

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG callAction] Hand 25: After CALL by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 25: Starting check
[DEBUG isBettingRoundComplete] Hand 25: Querying hand with: {"where":{"id":25}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG isBettingRoundComplete] Hand 25: Query result - hand={"id":25,"round":"PRE_FLOP","currentBet":"2000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 25: currentBet=2000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 25: Querying handPlayers with: {"where":{"handId":25}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG isBettingRoundComplete] Hand 25: Query returned 2 handPlayers: [{"id":49,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"id":50,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG isBettingRoundComplete] Hand 25: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 25: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 25: Querying roundActions with: {
  "where": {
    "handId": 25,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG isBettingRoundComplete] Hand 25: Query returned 1 roundActions for round PRE_FLOP: [{"id":116,"seatNumber":0,"action":"CALL","amount":"1000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 25: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 25: Checking 2 active players against actedSeats and currentBet=2000000
[DEBUG isBettingRoundComplete] Hand 25: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=2000000, currentBet=2000000)
[DEBUG isBettingRoundComplete] Hand 25: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 25: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG callAction] Hand 25: isBettingRoundComplete returned false
[DEBUG callAction] Hand 25: Round not complete, checking auto-advance or next player

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG callAction] Hand 25: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 25: Called with currentSeatNumber=0, currentRound=PRE_FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 25: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 25: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 25: Querying hand with: {"where":{"id":25},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 25: Query result - hand.round=PRE_FLOP, currentRound param=PRE_FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 25: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 25: nextPlayer seat=1, chipsCommitted=2000000, currentBet=2000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 25: Next player has matched bet (currentBet > 0n), checking if all acted and matched
[DEBUG handleNextPlayerOrRoundComplete] Hand 25: Querying roundActions with: {
  "where": {
    "handId": 25,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 25: Query returned 1 roundActions for round PRE_FLOP: [{"id":116,"seatNumber":0,"action":"CALL","amount":"1000000","round":"PRE_FLOP"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 25: allActivePlayers (2): [
  { seatNumber: 0, chipsCommitted: '2000000', status: 'ACTIVE' },
  { seatNumber: 1, chipsCommitted: '2000000', status: 'ACTIVE' }
]
[DEBUG handleNextPlayerOrRoundComplete] Hand 25: Wrap-around check - allActed=false, allMatched=true, actedSeats=0, playersWhoHaventActed=1, onlyNextPlayerHaventActed=true
[DEBUG handleNextPlayerOrRoundComplete] Hand 25: Round complete detected - RETURNING early with round completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 25: Context - allActed=false, onlyNextPlayerHaventActed=true, allMatched=true, currentRound=PRE_FLOP, nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 25: Context - allActivePlayers=[{"seat":0,"chipsCommitted":"2000000","status":"ACTIVE"},{"seat":1,"chipsCommitted":"2000000","status":"ACTIVE"}], actedSeats=[0], roundActions found=1
[DEBUG handleBettingRoundComplete] Hand 25: Called with currentRound=PRE_FLOP
[DEBUG handleBettingRoundComplete] Hand 25: Advancing from PRE_FLOP to next round
[DEBUG advanceBettingRound] Hand 25: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG advanceBettingRound] Hand 25: needsSidePots=false
[DEBUG advanceBettingRound] Hand 25: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG advanceBettingRound] Hand 25: Querying hand with: {"where":{"id":25},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG advanceBettingRound] Hand 25: Query result - hand.round=PRE_FLOP, players=2
[DEBUG advanceBettingRound] Hand 25: currentRound=PRE_FLOP, deckPosition=4, communityCards.length=0
[DEBUG advanceBettingRound] Hand 25: Advancing from PRE_FLOP to FLOP, cardsToDeal=3
[DEBUG advanceBettingRound] Hand 25: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 25: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '2000000' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '2000000' }
]
[DEBUG advanceBettingRound] Hand 25: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 25: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 25: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 25: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 25: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG advanceBettingRound] Hand 25: Updating hand state: round=FLOP, status=FLOP, currentActionSeat=0, newCommunityCards.length=3
[DEBUG advanceBettingRound] Hand 25: Updating hand with: {"where":{"id":25},"data":{"round":"FLOP","status":"FLOP","communityCards":"[3 cards]","deckPosition":7,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG advanceBettingRound] Hand 25: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG advanceBettingRound] Hand 25: RETURNING false - Round advanced successfully from PRE_FLOP to FLOP (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG handleBettingRoundComplete] Hand 25: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 25: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG handleBettingRoundComplete] Hand 25: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 25: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 25: RETURNING result from handleBettingRoundComplete: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG callAction] Hand 25: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=true
[DEBUG callAction] Hand 25: RETURNING from transaction - Final result
[DEBUG callAction] Hand 25: Context - hand.round=PRE_FLOP, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG callAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=25

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG checkAction] Hand 25: Player seat 0 checking in round FLOP
[DEBUG checkAction] Hand 25: Creating CHECK action with: {"handId":25,"seatNumber":0,"round":"FLOP","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG checkAction] Hand 25: CHECK action created successfully: {"id":117,"seatNumber":0,"action":"CHECK","round":"FLOP","amount":null}
[DEBUG checkAction] Hand 25: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG checkAction] Hand 25: After CHECK by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 25: Starting check
[DEBUG isBettingRoundComplete] Hand 25: Querying hand with: {"where":{"id":25}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG isBettingRoundComplete] Hand 25: Query result - hand={"id":25,"round":"FLOP","currentBet":"0","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 25: currentBet=0, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 25: Querying handPlayers with: {"where":{"handId":25}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG isBettingRoundComplete] Hand 25: Query returned 2 handPlayers: [{"id":49,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":50,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 25: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 25: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 25: Querying roundActions with: {
  "where": {
    "handId": 25,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG isBettingRoundComplete] Hand 25: Query returned 1 roundActions for round FLOP: [{"id":117,"seatNumber":0,"action":"CHECK","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 25: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 25: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 25: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 25: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 25: Context - actedSeats=[0], playerSeat=1, currentRound=FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG checkAction] Hand 25: isBettingRoundComplete returned false
[DEBUG checkAction] Hand 25: Round not complete, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 25: Called with currentSeatNumber=0, currentRound=FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 25: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 25: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 25: Querying hand with: {"where":{"id":25},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 25: Query result - hand.round=FLOP, currentRound param=FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 25: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 25: nextPlayer seat=1, chipsCommitted=0, currentBet=0
[DEBUG handleNextPlayerOrRoundComplete] Hand 25: Zero-bet wrap-around, advancing to next player (will complete after they act)
[DEBUG handleNextPlayerOrRoundComplete] Hand 25: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 25: Starting check
[DEBUG isBettingRoundComplete] Hand 25: Querying hand with: {"where":{"id":25}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG isBettingRoundComplete] Hand 25: Query result - hand={"id":25,"round":"FLOP","currentBet":"0","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 25: currentBet=0, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 25: Querying handPlayers with: {"where":{"handId":25}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG isBettingRoundComplete] Hand 25: Query returned 2 handPlayers: [{"id":49,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":50,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 25: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 25: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 25: Querying roundActions with: {
  "where": {
    "handId": 25,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG isBettingRoundComplete] Hand 25: Query returned 1 roundActions for round FLOP: [{"id":117,"seatNumber":0,"action":"CHECK","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 25: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 25: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 25: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 25: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 25: Context - actedSeats=[0], playerSeat=1, currentRound=FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 25: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 25: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 25: Updating hand with: {"where":{"id":25},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 25: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 25: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 25: Context - currentRound=FLOP, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG checkAction] Hand 25: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=false
[DEBUG checkAction] Hand 25: RETURNING from transaction - Final result
[DEBUG checkAction] Hand 25: Context - hand.round=FLOP, handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG checkAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=25

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG betAction] Hand 25: Player seat 1 betting 5000000 in round FLOP, currentBet before=0, chipsCommitted before=0, isAllIn=false
[DEBUG betAction] Hand 25: Creating BET action - hand.round=FLOP, actionType=RAISE, eventActionType=BET
[DEBUG createActionAndEvent] Hand 25: Creating action with: {"handId":25,"seatNumber":1,"round":"FLOP","action":"RAISE","amount":"5000000","handRound":"FLOP","roundParam":"FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG createActionAndEvent] Hand 25: Action created successfully: {"id":118,"seatNumber":1,"action":"RAISE","round":"FLOP","amount":"5000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG betAction] Hand 25: BET action created successfully, checking if round complete
[DEBUG betAction] Hand 25: Checking if betting round complete after BET
[DEBUG betAction] Hand 25: Context before isBettingRoundComplete - hand.round=FLOP, currentBet=0, currentActionSeat=1
[DEBUG isBettingRoundComplete] Hand 25: Starting check
[DEBUG isBettingRoundComplete] Hand 25: Querying hand with: {"where":{"id":25}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG isBettingRoundComplete] Hand 25: Query result - hand={"id":25,"round":"FLOP","currentBet":"5000000","currentActionSeat":1,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 25: currentBet=5000000, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 25: Querying handPlayers with: {"where":{"handId":25}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG isBettingRoundComplete] Hand 25: Query returned 2 handPlayers: [{"id":49,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":50,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"5000000"}]
[DEBUG isBettingRoundComplete] Hand 25: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 25: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 25: Querying roundActions with: {
  "where": {
    "handId": 25,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG isBettingRoundComplete] Hand 25: Query returned 2 roundActions for round FLOP: [{"id":117,"seatNumber":0,"action":"CHECK","round":"FLOP"},{"id":118,"seatNumber":1,"action":"RAISE","amount":"5000000","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 25: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 25: Checking 2 active players against actedSeats and currentBet=5000000
[DEBUG isBettingRoundComplete] Hand 25: RETURNING false - Player 0 hasn't matched bet.
[DEBUG isBettingRoundComplete] Hand 25: Context - chipsCommitted=0, currentBet=5000000, playerSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG betAction] Hand 25: isBettingRoundComplete returned false
[DEBUG handleBettingActionCompletion] Hand 25: Called with currentSeatNumber=1, currentRound=FLOP, bettingRoundComplete=false, isAllIn=false
[DEBUG handleBettingActionCompletion] Hand 25: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 25: Called with currentSeatNumber=1, currentRound=FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 25: getNextActivePlayer returned nextSeat=0
[DEBUG handleNextPlayerOrRoundComplete] Hand 25: nextSeat=0, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 25: Querying hand with: {"where":{"id":25},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 25: Query result - hand.round=FLOP, currentRound param=FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 25: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"5000000"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 25: nextPlayer seat=0, chipsCommitted=0, currentBet=5000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 25: Next player hasn't matched (chipsCommitted=0, currentBet=5000000)
[DEBUG handleNextPlayerOrRoundComplete] Hand 25: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 25: Starting check
[DEBUG isBettingRoundComplete] Hand 25: Querying hand with: {"where":{"id":25}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG isBettingRoundComplete] Hand 25: Query result - hand={"id":25,"round":"FLOP","currentBet":"5000000","currentActionSeat":1,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 25: currentBet=5000000, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 25: Querying handPlayers with: {"where":{"handId":25}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG isBettingRoundComplete] Hand 25: Query returned 2 handPlayers: [{"id":49,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":50,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"5000000"}]
[DEBUG isBettingRoundComplete] Hand 25: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 25: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 25: Querying roundActions with: {
  "where": {
    "handId": 25,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG isBettingRoundComplete] Hand 25: Query returned 2 roundActions for round FLOP: [{"id":117,"seatNumber":0,"action":"CHECK","round":"FLOP"},{"id":118,"seatNumber":1,"action":"RAISE","amount":"5000000","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 25: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 25: Checking 2 active players against actedSeats and currentBet=5000000
[DEBUG isBettingRoundComplete] Hand 25: RETURNING false - Player 0 hasn't matched bet.
[DEBUG isBettingRoundComplete] Hand 25: Context - chipsCommitted=0, currentBet=5000000, playerSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 25: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 25: Round not complete, advancing to next player 0
[DEBUG handleNextPlayerOrRoundComplete] Hand 25: Updating hand with: {"where":{"id":25},"data":{"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG handleNextPlayerOrRoundComplete] Hand 25: Hand updated successfully, currentActionSeat now=0
[DEBUG handleNextPlayerOrRoundComplete] Hand 25: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 25: Context - currentRound=FLOP, nextSeat=0, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG handleBettingActionCompletion] Hand 25: RETURNING result: handEnded=false, roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG betAction] Hand 25: handleBettingActionCompletion returned: handEnded=false, roundAdvanced=false
[DEBUG betAction] Hand 25: RETURNING from transaction
[DEBUG betAction] Hand 25: Context - hand.round=FLOP, handEnded=false, roundAdvanced=false, winnerSeatNumber=null
[DEBUG betAction] Hand 25: RETURNING from transaction - Final values: handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG betAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=25

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG foldAction] Hand 25: Player seat 0 folding in round FLOP
[DEBUG foldAction] Hand 25: Creating FOLD action with: {"handId":25,"seatNumber":0,"round":"FLOP","action":"FOLD","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-007: Check-Bet-Fold on Flop
[DEBUG foldAction] Hand 25: FOLD action created successfully: {"id":119,"seatNumber":0,"action":"FOLD","round":"FLOP","amount":null}
[DEBUG foldAction] Hand 25: FOLD action created, checking if round complete or advancing to next player

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG callAction] Hand 26: Player seat 0 calling 1000000 in round PRE_FLOP, currentBet=2000000, chipsCommitted before=1000000
[DEBUG callAction] Hand 26: Creating CALL action with: handId=26, seatNumber=0, round=PRE_FLOP, amount=1000000
[DEBUG createActionAndEvent] Hand 26: Creating action with: {"handId":26,"seatNumber":0,"round":"PRE_FLOP","action":"CALL","amount":"1000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG createActionAndEvent] Hand 26: Action created successfully: {"id":122,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"1000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG callAction] Hand 26: CALL action created successfully: {"id":122,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"1000000"}
[DEBUG callAction] Hand 26: CALL action created, chipsCommitted now=2000000

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG callAction] Hand 26: After CALL by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 26: Starting check
[DEBUG isBettingRoundComplete] Hand 26: Querying hand with: {"where":{"id":26}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG isBettingRoundComplete] Hand 26: Query result - hand={"id":26,"round":"PRE_FLOP","currentBet":"2000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 26: currentBet=2000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 26: Querying handPlayers with: {"where":{"handId":26}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG isBettingRoundComplete] Hand 26: Query returned 2 handPlayers: [{"id":51,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"id":52,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG isBettingRoundComplete] Hand 26: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 26: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 26: Querying roundActions with: {
  "where": {
    "handId": 26,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG isBettingRoundComplete] Hand 26: Query returned 1 roundActions for round PRE_FLOP: [{"id":122,"seatNumber":0,"action":"CALL","amount":"1000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 26: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 26: Checking 2 active players against actedSeats and currentBet=2000000
[DEBUG isBettingRoundComplete] Hand 26: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=2000000, currentBet=2000000)
[DEBUG isBettingRoundComplete] Hand 26: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 26: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG callAction] Hand 26: isBettingRoundComplete returned false
[DEBUG callAction] Hand 26: Round not complete, checking auto-advance or next player

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG callAction] Hand 26: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 26: Called with currentSeatNumber=0, currentRound=PRE_FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG handleNextPlayerOrRoundComplete] Hand 26: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 26: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 26: Querying hand with: {"where":{"id":26},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG handleNextPlayerOrRoundComplete] Hand 26: Query result - hand.round=PRE_FLOP, currentRound param=PRE_FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 26: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 26: nextPlayer seat=1, chipsCommitted=2000000, currentBet=2000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 26: Next player has matched bet (currentBet > 0n), checking if all acted and matched
[DEBUG handleNextPlayerOrRoundComplete] Hand 26: Querying roundActions with: {
  "where": {
    "handId": 26,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG handleNextPlayerOrRoundComplete] Hand 26: Query returned 1 roundActions for round PRE_FLOP: [{"id":122,"seatNumber":0,"action":"CALL","amount":"1000000","round":"PRE_FLOP"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 26: allActivePlayers (2): [
  { seatNumber: 0, chipsCommitted: '2000000', status: 'ACTIVE' },
  { seatNumber: 1, chipsCommitted: '2000000', status: 'ACTIVE' }
]
[DEBUG handleNextPlayerOrRoundComplete] Hand 26: Wrap-around check - allActed=false, allMatched=true, actedSeats=0, playersWhoHaventActed=1, onlyNextPlayerHaventActed=true
[DEBUG handleNextPlayerOrRoundComplete] Hand 26: Round complete detected - RETURNING early with round completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 26: Context - allActed=false, onlyNextPlayerHaventActed=true, allMatched=true, currentRound=PRE_FLOP, nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 26: Context - allActivePlayers=[{"seat":0,"chipsCommitted":"2000000","status":"ACTIVE"},{"seat":1,"chipsCommitted":"2000000","status":"ACTIVE"}], actedSeats=[0], roundActions found=1
[DEBUG handleBettingRoundComplete] Hand 26: Called with currentRound=PRE_FLOP
[DEBUG handleBettingRoundComplete] Hand 26: Advancing from PRE_FLOP to next round
[DEBUG advanceBettingRound] Hand 26: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG advanceBettingRound] Hand 26: needsSidePots=false
[DEBUG advanceBettingRound] Hand 26: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG advanceBettingRound] Hand 26: Querying hand with: {"where":{"id":26},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG advanceBettingRound] Hand 26: Query result - hand.round=PRE_FLOP, players=2
[DEBUG advanceBettingRound] Hand 26: currentRound=PRE_FLOP, deckPosition=4, communityCards.length=0
[DEBUG advanceBettingRound] Hand 26: Advancing from PRE_FLOP to FLOP, cardsToDeal=3
[DEBUG advanceBettingRound] Hand 26: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 26: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '2000000' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '2000000' }
]
[DEBUG advanceBettingRound] Hand 26: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 26: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 26: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 26: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 26: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG advanceBettingRound] Hand 26: Updating hand state: round=FLOP, status=FLOP, currentActionSeat=0, newCommunityCards.length=3
[DEBUG advanceBettingRound] Hand 26: Updating hand with: {"where":{"id":26},"data":{"round":"FLOP","status":"FLOP","communityCards":"[3 cards]","deckPosition":7,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG advanceBettingRound] Hand 26: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG advanceBettingRound] Hand 26: RETURNING false - Round advanced successfully from PRE_FLOP to FLOP (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG handleBettingRoundComplete] Hand 26: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 26: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG handleBettingRoundComplete] Hand 26: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 26: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG handleNextPlayerOrRoundComplete] Hand 26: RETURNING result from handleBettingRoundComplete: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG callAction] Hand 26: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=true
[DEBUG callAction] Hand 26: RETURNING from transaction - Final result
[DEBUG callAction] Hand 26: Context - hand.round=PRE_FLOP, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG callAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=26

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG createActionAndEvent] Hand 26: Creating action with: {"handId":26,"seatNumber":0,"round":"FLOP","action":"ALL_IN","amount":"48000000","handRound":"FLOP","roundParam":"FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG createActionAndEvent] Hand 26: Action created successfully: {"id":123,"seatNumber":0,"action":"ALL_IN","round":"FLOP","amount":"48000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG isBettingRoundComplete] Hand 26: Starting check
[DEBUG isBettingRoundComplete] Hand 26: Querying hand with: {"where":{"id":26}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG isBettingRoundComplete] Hand 26: Query result - hand={"id":26,"round":"FLOP","currentBet":"48000000","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 26: currentBet=48000000, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 26: Querying handPlayers with: {"where":{"handId":26}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG isBettingRoundComplete] Hand 26: Query returned 2 handPlayers: [{"id":52,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"},{"id":51,"seatNumber":0,"status":"ALL_IN","chipsCommitted":"48000000"}]
[DEBUG isBettingRoundComplete] Hand 26: activePlayers=1, allInPlayers=1
[DEBUG isBettingRoundComplete] Hand 26: Active player seats: [ 1 ]
[DEBUG isBettingRoundComplete] Hand 26: Querying roundActions with: {
  "where": {
    "handId": 26,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG isBettingRoundComplete] Hand 26: Query returned 1 roundActions for round FLOP: [{"id":123,"seatNumber":0,"action":"ALL_IN","amount":"48000000","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 26: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 26: Checking 1 active players against actedSeats and currentBet=48000000
[DEBUG isBettingRoundComplete] Hand 26: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 26: Context - actedSeats=[0], playerSeat=1, currentRound=FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG handleNextPlayerOrRoundComplete] Hand 26: Called with currentSeatNumber=0, currentRound=FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG handleNextPlayerOrRoundComplete] Hand 26: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 26: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 26: Querying hand with: {"where":{"id":26},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG handleNextPlayerOrRoundComplete] Hand 26: Query result - hand.round=FLOP, currentRound param=FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 26: Hand players: [{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"},{"seatNumber":0,"status":"ALL_IN","chipsCommitted":"48000000"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 26: nextPlayer seat=1, chipsCommitted=0, currentBet=48000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 26: Next player hasn't matched (chipsCommitted=0, currentBet=48000000)
[DEBUG handleNextPlayerOrRoundComplete] Hand 26: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 26: Starting check
[DEBUG isBettingRoundComplete] Hand 26: Querying hand with: {"where":{"id":26}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG isBettingRoundComplete] Hand 26: Query result - hand={"id":26,"round":"FLOP","currentBet":"48000000","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 26: currentBet=48000000, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 26: Querying handPlayers with: {"where":{"handId":26}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG isBettingRoundComplete] Hand 26: Query returned 2 handPlayers: [{"id":52,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"},{"id":51,"seatNumber":0,"status":"ALL_IN","chipsCommitted":"48000000"}]
[DEBUG isBettingRoundComplete] Hand 26: activePlayers=1, allInPlayers=1
[DEBUG isBettingRoundComplete] Hand 26: Active player seats: [ 1 ]
[DEBUG isBettingRoundComplete] Hand 26: Querying roundActions with: {
  "where": {
    "handId": 26,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG isBettingRoundComplete] Hand 26: Query returned 1 roundActions for round FLOP: [{"id":123,"seatNumber":0,"action":"ALL_IN","amount":"48000000","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 26: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 26: Checking 1 active players against actedSeats and currentBet=48000000
[DEBUG isBettingRoundComplete] Hand 26: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 26: Context - actedSeats=[0], playerSeat=1, currentRound=FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG handleNextPlayerOrRoundComplete] Hand 26: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 26: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 26: Updating hand with: {"where":{"id":26},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG handleNextPlayerOrRoundComplete] Hand 26: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 26: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 26: Context - currentRound=FLOP, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG callAction] Hand 26: Player seat 1 calling 48000000 in round FLOP, currentBet=48000000, chipsCommitted before=0
[DEBUG callAction] Hand 26: Creating CALL action with: handId=26, seatNumber=1, round=FLOP, amount=48000000
[DEBUG createActionAndEvent] Hand 26: Creating action with: {"handId":26,"seatNumber":1,"round":"FLOP","action":"CALL","amount":"48000000","handRound":"FLOP","roundParam":"FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG createActionAndEvent] Hand 26: Action created successfully: {"id":124,"seatNumber":1,"action":"CALL","round":"FLOP","amount":"48000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG callAction] Hand 26: CALL action created successfully: {"id":124,"seatNumber":1,"action":"CALL","round":"FLOP","amount":"48000000"}
[DEBUG callAction] Hand 26: CALL action created, chipsCommitted now=48000000

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG callAction] Hand 26: After CALL by seat 1, checking if round complete
[DEBUG isBettingRoundComplete] Hand 26: Starting check
[DEBUG isBettingRoundComplete] Hand 26: Querying hand with: {"where":{"id":26}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG isBettingRoundComplete] Hand 26: Query result - hand={"id":26,"round":"FLOP","currentBet":"48000000","currentActionSeat":1,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 26: currentBet=48000000, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 26: Querying handPlayers with: {"where":{"handId":26}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG isBettingRoundComplete] Hand 26: Query returned 2 handPlayers: [{"id":52,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"48000000"},{"id":51,"seatNumber":0,"status":"ALL_IN","chipsCommitted":"48000000"}]
[DEBUG isBettingRoundComplete] Hand 26: activePlayers=1, allInPlayers=1
[DEBUG isBettingRoundComplete] Hand 26: Active player seats: [ 1 ]
[DEBUG isBettingRoundComplete] Hand 26: Querying roundActions with: {
  "where": {
    "handId": 26,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG isBettingRoundComplete] Hand 26: Query returned 2 roundActions for round FLOP: [{"id":123,"seatNumber":0,"action":"ALL_IN","amount":"48000000","round":"FLOP"},{"id":124,"seatNumber":1,"action":"CALL","amount":"48000000","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 26: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 26: Checking 1 active players against actedSeats and currentBet=48000000
[DEBUG isBettingRoundComplete] Hand 26: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=48000000, currentBet=48000000)
[DEBUG isBettingRoundComplete] Hand 26: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=48000000, currentBet=48000000)
[DEBUG isBettingRoundComplete] Hand 26: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 26: Context - activePlayers=1, actedSeats=[0,1], currentBet=48000000, currentRound=FLOP, roundActions queried=2, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 26: Active players detail: [{"seatNumber":1,"chipsCommitted":"48000000","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG callAction] Hand 26: isBettingRoundComplete returned true
[DEBUG callAction] Hand 26: Round complete, calling handleBettingRoundComplete
[DEBUG handleBettingRoundComplete] Hand 26: Called with currentRound=FLOP
[DEBUG handleBettingRoundComplete] Hand 26: Advancing from FLOP to next round
[DEBUG advanceBettingRound] Hand 26: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG advanceBettingRound] Hand 26: needsSidePots=false
[DEBUG advanceBettingRound] Hand 26: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG advanceBettingRound] Hand 26: Querying hand with: {"where":{"id":26},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG advanceBettingRound] Hand 26: Query result - hand.round=FLOP, players=2
[DEBUG advanceBettingRound] Hand 26: currentRound=FLOP, deckPosition=7, communityCards.length=3
[DEBUG advanceBettingRound] Hand 26: Advancing from FLOP to TURN, cardsToDeal=1
[DEBUG advanceBettingRound] Hand 26: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 26: Players: [
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '48000000' },
  { seatNumber: 0, status: 'ALL_IN', chipsCommitted: '48000000' }
]
[DEBUG advanceBettingRound] Hand 26: nonFoldedPlayers=2, activePlayers=1
[DEBUG advanceBettingRound] Hand 26: Active player seats: [ 1 ]
[DEBUG advanceBettingRound] Hand 26: allInPlayers=1, allPlayersAllIn=false, onlyOneActivePlayer=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG advanceBettingRound] Hand 26: Updating hand state: round=TURN, status=TURN, currentActionSeat=1, newCommunityCards.length=4
[DEBUG advanceBettingRound] Hand 26: Updating hand with: {"where":{"id":26},"data":{"round":"TURN","status":"TURN","communityCards":"[4 cards]","deckPosition":8,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG advanceBettingRound] Hand 26: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG advanceBettingRound] Hand 26: RETURNING false - Round advanced successfully from FLOP to TURN (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG handleBettingRoundComplete] Hand 26: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 26: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG isBettingRoundComplete] Hand 26: Starting check
[DEBUG isBettingRoundComplete] Hand 26: Querying hand with: {"where":{"id":26}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG isBettingRoundComplete] Hand 26: Query result - hand={"id":26,"round":"TURN","currentBet":"0","currentActionSeat":1,"status":"TURN"}
[DEBUG isBettingRoundComplete] Hand 26: currentBet=0, currentRound=TURN
[DEBUG isBettingRoundComplete] Hand 26: Querying handPlayers with: {"where":{"handId":26}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG isBettingRoundComplete] Hand 26: Query returned 2 handPlayers: [{"id":52,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"},{"id":51,"seatNumber":0,"status":"ALL_IN","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 26: activePlayers=1, allInPlayers=1
[DEBUG isBettingRoundComplete] Hand 26: Active player seats: [ 1 ]
[DEBUG isBettingRoundComplete] Hand 26: Querying roundActions with: {
  "where": {
    "handId": 26,
    "round": "TURN",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG isBettingRoundComplete] Hand 26: Query returned 0 roundActions for round TURN: []
[DEBUG isBettingRoundComplete] Hand 26: actedSeats: []
[DEBUG isBettingRoundComplete] Hand 26: Checking 1 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 26: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 26: Context - actedSeats=[], playerSeat=1, currentRound=TURN, roundActions found=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG isBettingRoundComplete] Hand 26: Starting check
[DEBUG isBettingRoundComplete] Hand 26: Querying hand with: {"where":{"id":26}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG isBettingRoundComplete] Hand 26: Query result - hand={"id":26,"round":"TURN","currentBet":"0","currentActionSeat":1,"status":"TURN"}
[DEBUG isBettingRoundComplete] Hand 26: currentBet=0, currentRound=TURN
[DEBUG isBettingRoundComplete] Hand 26: Querying handPlayers with: {"where":{"handId":26}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG isBettingRoundComplete] Hand 26: Query returned 2 handPlayers: [{"id":52,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"},{"id":51,"seatNumber":0,"status":"ALL_IN","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 26: activePlayers=1, allInPlayers=1
[DEBUG isBettingRoundComplete] Hand 26: Active player seats: [ 1 ]
[DEBUG isBettingRoundComplete] Hand 26: Querying roundActions with: {
  "where": {
    "handId": 26,
    "round": "TURN",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG isBettingRoundComplete] Hand 26: Query returned 1 roundActions for round TURN: [{"id":125,"seatNumber":1,"action":"CHECK","round":"TURN"}]
[DEBUG isBettingRoundComplete] Hand 26: actedSeats: [ 1 ]
[DEBUG isBettingRoundComplete] Hand 26: Checking 1 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 26: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 26: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 26: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 26: Context - activePlayers=1, actedSeats=[1], currentBet=0, currentRound=TURN, roundActions queried=1, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 26: Active players detail: [{"seatNumber":1,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG advanceBettingRound] Hand 26: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG advanceBettingRound] Hand 26: needsSidePots=false
[DEBUG advanceBettingRound] Hand 26: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG advanceBettingRound] Hand 26: Querying hand with: {"where":{"id":26},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG advanceBettingRound] Hand 26: Query result - hand.round=TURN, players=2
[DEBUG advanceBettingRound] Hand 26: currentRound=TURN, deckPosition=8, communityCards.length=4
[DEBUG advanceBettingRound] Hand 26: Advancing from TURN to RIVER, cardsToDeal=1
[DEBUG advanceBettingRound] Hand 26: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 26: Players: [
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '0' },
  { seatNumber: 0, status: 'ALL_IN', chipsCommitted: '0' }
]
[DEBUG advanceBettingRound] Hand 26: nonFoldedPlayers=2, activePlayers=1
[DEBUG advanceBettingRound] Hand 26: Active player seats: [ 1 ]
[DEBUG advanceBettingRound] Hand 26: allInPlayers=1, allPlayersAllIn=false, onlyOneActivePlayer=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG advanceBettingRound] Hand 26: Updating hand state: round=RIVER, status=RIVER, currentActionSeat=1, newCommunityCards.length=5
[DEBUG advanceBettingRound] Hand 26: Updating hand with: {"where":{"id":26},"data":{"round":"RIVER","status":"RIVER","communityCards":"[5 cards]","deckPosition":9,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG advanceBettingRound] Hand 26: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG advanceBettingRound] Hand 26: RETURNING true - Only one active player at RIVER, hand should be settled

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG handleBettingRoundComplete] Hand 26: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=true
[DEBUG handleBettingRoundComplete] Hand 26: Auto-advancing to RIVER and settling

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG handleBettingRoundComplete] Hand 26: Hand settled, winnerSeatNumber=0
[DEBUG handleBettingRoundComplete] Hand 26: RETURNING result with settlement: handEnded=true, roundAdvanced=true, winnerSeatNumber=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG callAction] Hand 26: handleBettingRoundComplete returned handEnded=true, roundAdvanced=true
[DEBUG callAction] Hand 26: RETURNING from transaction - Round complete
[DEBUG callAction] Hand 26: Context - hand.round=FLOP, handEnded=true, roundAdvanced=true, winnerSeatNumber=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-008: Small Blind All-In on Flop (Big Blind Calls)
[DEBUG callAction] RETURNING final result: handEnded=true, roundAdvanced=true, tableId=26

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds)
[DEBUG callAction] Hand 27: Player seat 0 calling 1000000 in round PRE_FLOP, currentBet=2000000, chipsCommitted before=1000000
[DEBUG callAction] Hand 27: Creating CALL action with: handId=27, seatNumber=0, round=PRE_FLOP, amount=1000000
[DEBUG createActionAndEvent] Hand 27: Creating action with: {"handId":27,"seatNumber":0,"round":"PRE_FLOP","action":"CALL","amount":"1000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds)
[DEBUG createActionAndEvent] Hand 27: Action created successfully: {"id":128,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"1000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds)
[DEBUG callAction] Hand 27: CALL action created successfully: {"id":128,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"1000000"}
[DEBUG callAction] Hand 27: CALL action created, chipsCommitted now=2000000

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds)
[DEBUG callAction] Hand 27: After CALL by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 27: Starting check
[DEBUG isBettingRoundComplete] Hand 27: Querying hand with: {"where":{"id":27}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds)
[DEBUG isBettingRoundComplete] Hand 27: Query result - hand={"id":27,"round":"PRE_FLOP","currentBet":"2000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 27: currentBet=2000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 27: Querying handPlayers with: {"where":{"handId":27}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds)
[DEBUG isBettingRoundComplete] Hand 27: Query returned 2 handPlayers: [{"id":53,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"id":54,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG isBettingRoundComplete] Hand 27: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 27: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 27: Querying roundActions with: {
  "where": {
    "handId": 27,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds)
[DEBUG isBettingRoundComplete] Hand 27: Query returned 1 roundActions for round PRE_FLOP: [{"id":128,"seatNumber":0,"action":"CALL","amount":"1000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 27: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 27: Checking 2 active players against actedSeats and currentBet=2000000
[DEBUG isBettingRoundComplete] Hand 27: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=2000000, currentBet=2000000)
[DEBUG isBettingRoundComplete] Hand 27: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 27: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds)
[DEBUG callAction] Hand 27: isBettingRoundComplete returned false
[DEBUG callAction] Hand 27: Round not complete, checking auto-advance or next player

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds)
[DEBUG callAction] Hand 27: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 27: Called with currentSeatNumber=0, currentRound=PRE_FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds)
[DEBUG handleNextPlayerOrRoundComplete] Hand 27: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 27: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 27: Querying hand with: {"where":{"id":27},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds)
[DEBUG handleNextPlayerOrRoundComplete] Hand 27: Query result - hand.round=PRE_FLOP, currentRound param=PRE_FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 27: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 27: nextPlayer seat=1, chipsCommitted=2000000, currentBet=2000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 27: Next player has matched bet (currentBet > 0n), checking if all acted and matched
[DEBUG handleNextPlayerOrRoundComplete] Hand 27: Querying roundActions with: {
  "where": {
    "handId": 27,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds)
[DEBUG handleNextPlayerOrRoundComplete] Hand 27: Query returned 1 roundActions for round PRE_FLOP: [{"id":128,"seatNumber":0,"action":"CALL","amount":"1000000","round":"PRE_FLOP"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 27: allActivePlayers (2): [
  { seatNumber: 0, chipsCommitted: '2000000', status: 'ACTIVE' },
  { seatNumber: 1, chipsCommitted: '2000000', status: 'ACTIVE' }
]
[DEBUG handleNextPlayerOrRoundComplete] Hand 27: Wrap-around check - allActed=false, allMatched=true, actedSeats=0, playersWhoHaventActed=1, onlyNextPlayerHaventActed=true
[DEBUG handleNextPlayerOrRoundComplete] Hand 27: Round complete detected - RETURNING early with round completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 27: Context - allActed=false, onlyNextPlayerHaventActed=true, allMatched=true, currentRound=PRE_FLOP, nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 27: Context - allActivePlayers=[{"seat":0,"chipsCommitted":"2000000","status":"ACTIVE"},{"seat":1,"chipsCommitted":"2000000","status":"ACTIVE"}], actedSeats=[0], roundActions found=1
[DEBUG handleBettingRoundComplete] Hand 27: Called with currentRound=PRE_FLOP
[DEBUG handleBettingRoundComplete] Hand 27: Advancing from PRE_FLOP to next round
[DEBUG advanceBettingRound] Hand 27: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds)
[DEBUG advanceBettingRound] Hand 27: needsSidePots=false
[DEBUG advanceBettingRound] Hand 27: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds)
[DEBUG advanceBettingRound] Hand 27: Querying hand with: {"where":{"id":27},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds)
[DEBUG advanceBettingRound] Hand 27: Query result - hand.round=PRE_FLOP, players=2
[DEBUG advanceBettingRound] Hand 27: currentRound=PRE_FLOP, deckPosition=4, communityCards.length=0
[DEBUG advanceBettingRound] Hand 27: Advancing from PRE_FLOP to FLOP, cardsToDeal=3
[DEBUG advanceBettingRound] Hand 27: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 27: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '2000000' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '2000000' }
]
[DEBUG advanceBettingRound] Hand 27: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 27: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 27: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 27: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 27: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds)
[DEBUG advanceBettingRound] Hand 27: Updating hand state: round=FLOP, status=FLOP, currentActionSeat=0, newCommunityCards.length=3
[DEBUG advanceBettingRound] Hand 27: Updating hand with: {"where":{"id":27},"data":{"round":"FLOP","status":"FLOP","communityCards":"[3 cards]","deckPosition":7,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds)
[DEBUG advanceBettingRound] Hand 27: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds)
[DEBUG advanceBettingRound] Hand 27: RETURNING false - Round advanced successfully from PRE_FLOP to FLOP (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds)
[DEBUG handleBettingRoundComplete] Hand 27: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 27: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds)
[DEBUG handleBettingRoundComplete] Hand 27: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 27: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds)
[DEBUG handleNextPlayerOrRoundComplete] Hand 27: RETURNING result from handleBettingRoundComplete: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds)
[DEBUG callAction] Hand 27: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=true
[DEBUG callAction] Hand 27: RETURNING from transaction - Final result
[DEBUG callAction] Hand 27: Context - hand.round=PRE_FLOP, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds)
[DEBUG callAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=27

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds)
[DEBUG createActionAndEvent] Hand 27: Creating action with: {"handId":27,"seatNumber":0,"round":"FLOP","action":"ALL_IN","amount":"48000000","handRound":"FLOP","roundParam":"FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds)
[DEBUG createActionAndEvent] Hand 27: Action created successfully: {"id":129,"seatNumber":0,"action":"ALL_IN","round":"FLOP","amount":"48000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds)
[DEBUG isBettingRoundComplete] Hand 27: Starting check
[DEBUG isBettingRoundComplete] Hand 27: Querying hand with: {"where":{"id":27}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds)
[DEBUG isBettingRoundComplete] Hand 27: Query result - hand={"id":27,"round":"FLOP","currentBet":"48000000","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 27: currentBet=48000000, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 27: Querying handPlayers with: {"where":{"handId":27}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds)
[DEBUG isBettingRoundComplete] Hand 27: Query returned 2 handPlayers: [{"id":54,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"},{"id":53,"seatNumber":0,"status":"ALL_IN","chipsCommitted":"48000000"}]
[DEBUG isBettingRoundComplete] Hand 27: activePlayers=1, allInPlayers=1
[DEBUG isBettingRoundComplete] Hand 27: Active player seats: [ 1 ]
[DEBUG isBettingRoundComplete] Hand 27: Querying roundActions with: {
  "where": {
    "handId": 27,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds)
[DEBUG isBettingRoundComplete] Hand 27: Query returned 1 roundActions for round FLOP: [{"id":129,"seatNumber":0,"action":"ALL_IN","amount":"48000000","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 27: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 27: Checking 1 active players against actedSeats and currentBet=48000000
[DEBUG isBettingRoundComplete] Hand 27: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 27: Context - actedSeats=[0], playerSeat=1, currentRound=FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds)
[DEBUG handleNextPlayerOrRoundComplete] Hand 27: Called with currentSeatNumber=0, currentRound=FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds)
[DEBUG handleNextPlayerOrRoundComplete] Hand 27: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 27: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 27: Querying hand with: {"where":{"id":27},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds)
[DEBUG handleNextPlayerOrRoundComplete] Hand 27: Query result - hand.round=FLOP, currentRound param=FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 27: Hand players: [{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"},{"seatNumber":0,"status":"ALL_IN","chipsCommitted":"48000000"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 27: nextPlayer seat=1, chipsCommitted=0, currentBet=48000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 27: Next player hasn't matched (chipsCommitted=0, currentBet=48000000)
[DEBUG handleNextPlayerOrRoundComplete] Hand 27: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 27: Starting check
[DEBUG isBettingRoundComplete] Hand 27: Querying hand with: {"where":{"id":27}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds)
[DEBUG isBettingRoundComplete] Hand 27: Query result - hand={"id":27,"round":"FLOP","currentBet":"48000000","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 27: currentBet=48000000, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 27: Querying handPlayers with: {"where":{"handId":27}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds)
[DEBUG isBettingRoundComplete] Hand 27: Query returned 2 handPlayers: [{"id":54,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"},{"id":53,"seatNumber":0,"status":"ALL_IN","chipsCommitted":"48000000"}]
[DEBUG isBettingRoundComplete] Hand 27: activePlayers=1, allInPlayers=1
[DEBUG isBettingRoundComplete] Hand 27: Active player seats: [ 1 ]
[DEBUG isBettingRoundComplete] Hand 27: Querying roundActions with: {
  "where": {
    "handId": 27,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds)
[DEBUG isBettingRoundComplete] Hand 27: Query returned 1 roundActions for round FLOP: [{"id":129,"seatNumber":0,"action":"ALL_IN","amount":"48000000","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 27: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 27: Checking 1 active players against actedSeats and currentBet=48000000
[DEBUG isBettingRoundComplete] Hand 27: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 27: Context - actedSeats=[0], playerSeat=1, currentRound=FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds)
[DEBUG handleNextPlayerOrRoundComplete] Hand 27: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 27: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 27: Updating hand with: {"where":{"id":27},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds)
[DEBUG handleNextPlayerOrRoundComplete] Hand 27: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 27: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 27: Context - currentRound=FLOP, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds)
[DEBUG foldAction] Hand 27: Player seat 1 folding in round FLOP
[DEBUG foldAction] Hand 27: Creating FOLD action with: {"handId":27,"seatNumber":1,"round":"FLOP","action":"FOLD","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds)
[DEBUG foldAction] Hand 27: FOLD action created successfully: {"id":130,"seatNumber":1,"action":"FOLD","round":"FLOP","amount":null}
[DEBUG foldAction] Hand 27: FOLD action created, checking if round complete or advancing to next player

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds) - 700 bps rake
[DEBUG callAction] Hand 28: Player seat 0 calling 1000000 in round PRE_FLOP, currentBet=2000000, chipsCommitted before=1000000
[DEBUG callAction] Hand 28: Creating CALL action with: handId=28, seatNumber=0, round=PRE_FLOP, amount=1000000
[DEBUG createActionAndEvent] Hand 28: Creating action with: {"handId":28,"seatNumber":0,"round":"PRE_FLOP","action":"CALL","amount":"1000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds) - 700 bps rake
[DEBUG createActionAndEvent] Hand 28: Action created successfully: {"id":133,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"1000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds) - 700 bps rake
[DEBUG callAction] Hand 28: CALL action created successfully: {"id":133,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"1000000"}
[DEBUG callAction] Hand 28: CALL action created, chipsCommitted now=2000000

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds) - 700 bps rake
[DEBUG callAction] Hand 28: After CALL by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 28: Starting check
[DEBUG isBettingRoundComplete] Hand 28: Querying hand with: {"where":{"id":28}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 28: Query result - hand={"id":28,"round":"PRE_FLOP","currentBet":"2000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 28: currentBet=2000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 28: Querying handPlayers with: {"where":{"handId":28}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 28: Query returned 2 handPlayers: [{"id":55,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"id":56,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG isBettingRoundComplete] Hand 28: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 28: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 28: Querying roundActions with: {
  "where": {
    "handId": 28,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 28: Query returned 1 roundActions for round PRE_FLOP: [{"id":133,"seatNumber":0,"action":"CALL","amount":"1000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 28: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 28: Checking 2 active players against actedSeats and currentBet=2000000
[DEBUG isBettingRoundComplete] Hand 28: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=2000000, currentBet=2000000)
[DEBUG isBettingRoundComplete] Hand 28: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 28: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds) - 700 bps rake
[DEBUG callAction] Hand 28: isBettingRoundComplete returned false
[DEBUG callAction] Hand 28: Round not complete, checking auto-advance or next player

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds) - 700 bps rake
[DEBUG callAction] Hand 28: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 28: Called with currentSeatNumber=0, currentRound=PRE_FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds) - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 28: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 28: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 28: Querying hand with: {"where":{"id":28},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds) - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 28: Query result - hand.round=PRE_FLOP, currentRound param=PRE_FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 28: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 28: nextPlayer seat=1, chipsCommitted=2000000, currentBet=2000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 28: Next player has matched bet (currentBet > 0n), checking if all acted and matched
[DEBUG handleNextPlayerOrRoundComplete] Hand 28: Querying roundActions with: {
  "where": {
    "handId": 28,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds) - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 28: Query returned 1 roundActions for round PRE_FLOP: [{"id":133,"seatNumber":0,"action":"CALL","amount":"1000000","round":"PRE_FLOP"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 28: allActivePlayers (2): [
  { seatNumber: 0, chipsCommitted: '2000000', status: 'ACTIVE' },
  { seatNumber: 1, chipsCommitted: '2000000', status: 'ACTIVE' }
]
[DEBUG handleNextPlayerOrRoundComplete] Hand 28: Wrap-around check - allActed=false, allMatched=true, actedSeats=0, playersWhoHaventActed=1, onlyNextPlayerHaventActed=true
[DEBUG handleNextPlayerOrRoundComplete] Hand 28: Round complete detected - RETURNING early with round completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 28: Context - allActed=false, onlyNextPlayerHaventActed=true, allMatched=true, currentRound=PRE_FLOP, nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 28: Context - allActivePlayers=[{"seat":0,"chipsCommitted":"2000000","status":"ACTIVE"},{"seat":1,"chipsCommitted":"2000000","status":"ACTIVE"}], actedSeats=[0], roundActions found=1
[DEBUG handleBettingRoundComplete] Hand 28: Called with currentRound=PRE_FLOP
[DEBUG handleBettingRoundComplete] Hand 28: Advancing from PRE_FLOP to next round
[DEBUG advanceBettingRound] Hand 28: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds) - 700 bps rake
[DEBUG advanceBettingRound] Hand 28: needsSidePots=false
[DEBUG advanceBettingRound] Hand 28: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds) - 700 bps rake
[DEBUG advanceBettingRound] Hand 28: Querying hand with: {"where":{"id":28},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds) - 700 bps rake
[DEBUG advanceBettingRound] Hand 28: Query result - hand.round=PRE_FLOP, players=2
[DEBUG advanceBettingRound] Hand 28: currentRound=PRE_FLOP, deckPosition=4, communityCards.length=0
[DEBUG advanceBettingRound] Hand 28: Advancing from PRE_FLOP to FLOP, cardsToDeal=3
[DEBUG advanceBettingRound] Hand 28: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 28: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '2000000' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '2000000' }
]
[DEBUG advanceBettingRound] Hand 28: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 28: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 28: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 28: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 28: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds) - 700 bps rake
[DEBUG advanceBettingRound] Hand 28: Updating hand state: round=FLOP, status=FLOP, currentActionSeat=0, newCommunityCards.length=3
[DEBUG advanceBettingRound] Hand 28: Updating hand with: {"where":{"id":28},"data":{"round":"FLOP","status":"FLOP","communityCards":"[3 cards]","deckPosition":7,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds) - 700 bps rake
[DEBUG advanceBettingRound] Hand 28: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds) - 700 bps rake
[DEBUG advanceBettingRound] Hand 28: RETURNING false - Round advanced successfully from PRE_FLOP to FLOP (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds) - 700 bps rake
[DEBUG handleBettingRoundComplete] Hand 28: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 28: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds) - 700 bps rake
[DEBUG handleBettingRoundComplete] Hand 28: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 28: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds) - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 28: RETURNING result from handleBettingRoundComplete: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds) - 700 bps rake
[DEBUG callAction] Hand 28: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=true
[DEBUG callAction] Hand 28: RETURNING from transaction - Final result
[DEBUG callAction] Hand 28: Context - hand.round=PRE_FLOP, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds) - 700 bps rake
[DEBUG callAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=28

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds) - 700 bps rake
[DEBUG createActionAndEvent] Hand 28: Creating action with: {"handId":28,"seatNumber":0,"round":"FLOP","action":"ALL_IN","amount":"48000000","handRound":"FLOP","roundParam":"FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds) - 700 bps rake
[DEBUG createActionAndEvent] Hand 28: Action created successfully: {"id":134,"seatNumber":0,"action":"ALL_IN","round":"FLOP","amount":"48000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 28: Starting check
[DEBUG isBettingRoundComplete] Hand 28: Querying hand with: {"where":{"id":28}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 28: Query result - hand={"id":28,"round":"FLOP","currentBet":"48000000","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 28: currentBet=48000000, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 28: Querying handPlayers with: {"where":{"handId":28}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 28: Query returned 2 handPlayers: [{"id":56,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"},{"id":55,"seatNumber":0,"status":"ALL_IN","chipsCommitted":"48000000"}]
[DEBUG isBettingRoundComplete] Hand 28: activePlayers=1, allInPlayers=1
[DEBUG isBettingRoundComplete] Hand 28: Active player seats: [ 1 ]
[DEBUG isBettingRoundComplete] Hand 28: Querying roundActions with: {
  "where": {
    "handId": 28,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 28: Query returned 1 roundActions for round FLOP: [{"id":134,"seatNumber":0,"action":"ALL_IN","amount":"48000000","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 28: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 28: Checking 1 active players against actedSeats and currentBet=48000000
[DEBUG isBettingRoundComplete] Hand 28: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 28: Context - actedSeats=[0], playerSeat=1, currentRound=FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds) - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 28: Called with currentSeatNumber=0, currentRound=FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds) - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 28: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 28: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 28: Querying hand with: {"where":{"id":28},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds) - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 28: Query result - hand.round=FLOP, currentRound param=FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 28: Hand players: [{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"},{"seatNumber":0,"status":"ALL_IN","chipsCommitted":"48000000"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 28: nextPlayer seat=1, chipsCommitted=0, currentBet=48000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 28: Next player hasn't matched (chipsCommitted=0, currentBet=48000000)
[DEBUG handleNextPlayerOrRoundComplete] Hand 28: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 28: Starting check
[DEBUG isBettingRoundComplete] Hand 28: Querying hand with: {"where":{"id":28}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 28: Query result - hand={"id":28,"round":"FLOP","currentBet":"48000000","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 28: currentBet=48000000, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 28: Querying handPlayers with: {"where":{"handId":28}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 28: Query returned 2 handPlayers: [{"id":56,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"},{"id":55,"seatNumber":0,"status":"ALL_IN","chipsCommitted":"48000000"}]
[DEBUG isBettingRoundComplete] Hand 28: activePlayers=1, allInPlayers=1
[DEBUG isBettingRoundComplete] Hand 28: Active player seats: [ 1 ]
[DEBUG isBettingRoundComplete] Hand 28: Querying roundActions with: {
  "where": {
    "handId": 28,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 28: Query returned 1 roundActions for round FLOP: [{"id":134,"seatNumber":0,"action":"ALL_IN","amount":"48000000","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 28: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 28: Checking 1 active players against actedSeats and currentBet=48000000
[DEBUG isBettingRoundComplete] Hand 28: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 28: Context - actedSeats=[0], playerSeat=1, currentRound=FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds) - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 28: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 28: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 28: Updating hand with: {"where":{"id":28},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds) - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 28: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 28: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 28: Context - currentRound=FLOP, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds) - 700 bps rake
[DEBUG foldAction] Hand 28: Player seat 1 folding in round FLOP
[DEBUG foldAction] Hand 28: Creating FOLD action with: {"handId":28,"seatNumber":1,"round":"FLOP","action":"FOLD","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds) - 700 bps rake
[DEBUG foldAction] Hand 28: FOLD action created successfully: {"id":135,"seatNumber":1,"action":"FOLD","round":"FLOP","amount":null}
[DEBUG foldAction] Hand 28: FOLD action created, checking if round complete or advancing to next player

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-009: Small Blind All-In on Flop (Big Blind Folds) - 700 bps rake
ðŸ’° Added rake 3640000 gwei to TEE balance (hand 28)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG callAction] Hand 29: Player seat 0 calling 1000000 in round PRE_FLOP, currentBet=2000000, chipsCommitted before=1000000
[DEBUG callAction] Hand 29: Creating CALL action with: handId=29, seatNumber=0, round=PRE_FLOP, amount=1000000
[DEBUG createActionAndEvent] Hand 29: Creating action with: {"handId":29,"seatNumber":0,"round":"PRE_FLOP","action":"CALL","amount":"1000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG createActionAndEvent] Hand 29: Action created successfully: {"id":138,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"1000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG callAction] Hand 29: CALL action created successfully: {"id":138,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"1000000"}
[DEBUG callAction] Hand 29: CALL action created, chipsCommitted now=2000000

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG callAction] Hand 29: After CALL by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 29: Starting check
[DEBUG isBettingRoundComplete] Hand 29: Querying hand with: {"where":{"id":29}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG isBettingRoundComplete] Hand 29: Query result - hand={"id":29,"round":"PRE_FLOP","currentBet":"2000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 29: currentBet=2000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 29: Querying handPlayers with: {"where":{"handId":29}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG isBettingRoundComplete] Hand 29: Query returned 2 handPlayers: [{"id":57,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"id":58,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG isBettingRoundComplete] Hand 29: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 29: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 29: Querying roundActions with: {
  "where": {
    "handId": 29,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG isBettingRoundComplete] Hand 29: Query returned 1 roundActions for round PRE_FLOP: [{"id":138,"seatNumber":0,"action":"CALL","amount":"1000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 29: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 29: Checking 2 active players against actedSeats and currentBet=2000000
[DEBUG isBettingRoundComplete] Hand 29: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=2000000, currentBet=2000000)
[DEBUG isBettingRoundComplete] Hand 29: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 29: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG callAction] Hand 29: isBettingRoundComplete returned false
[DEBUG callAction] Hand 29: Round not complete, checking auto-advance or next player

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG callAction] Hand 29: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 29: Called with currentSeatNumber=0, currentRound=PRE_FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG handleNextPlayerOrRoundComplete] Hand 29: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 29: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 29: Querying hand with: {"where":{"id":29},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG handleNextPlayerOrRoundComplete] Hand 29: Query result - hand.round=PRE_FLOP, currentRound param=PRE_FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 29: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 29: nextPlayer seat=1, chipsCommitted=2000000, currentBet=2000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 29: Next player has matched bet (currentBet > 0n), checking if all acted and matched
[DEBUG handleNextPlayerOrRoundComplete] Hand 29: Querying roundActions with: {
  "where": {
    "handId": 29,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG handleNextPlayerOrRoundComplete] Hand 29: Query returned 1 roundActions for round PRE_FLOP: [{"id":138,"seatNumber":0,"action":"CALL","amount":"1000000","round":"PRE_FLOP"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 29: allActivePlayers (2): [
  { seatNumber: 0, chipsCommitted: '2000000', status: 'ACTIVE' },
  { seatNumber: 1, chipsCommitted: '2000000', status: 'ACTIVE' }
]
[DEBUG handleNextPlayerOrRoundComplete] Hand 29: Wrap-around check - allActed=false, allMatched=true, actedSeats=0, playersWhoHaventActed=1, onlyNextPlayerHaventActed=true
[DEBUG handleNextPlayerOrRoundComplete] Hand 29: Round complete detected - RETURNING early with round completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 29: Context - allActed=false, onlyNextPlayerHaventActed=true, allMatched=true, currentRound=PRE_FLOP, nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 29: Context - allActivePlayers=[{"seat":0,"chipsCommitted":"2000000","status":"ACTIVE"},{"seat":1,"chipsCommitted":"2000000","status":"ACTIVE"}], actedSeats=[0], roundActions found=1
[DEBUG handleBettingRoundComplete] Hand 29: Called with currentRound=PRE_FLOP
[DEBUG handleBettingRoundComplete] Hand 29: Advancing from PRE_FLOP to next round
[DEBUG advanceBettingRound] Hand 29: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG advanceBettingRound] Hand 29: needsSidePots=false
[DEBUG advanceBettingRound] Hand 29: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG advanceBettingRound] Hand 29: Querying hand with: {"where":{"id":29},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG advanceBettingRound] Hand 29: Query result - hand.round=PRE_FLOP, players=2
[DEBUG advanceBettingRound] Hand 29: currentRound=PRE_FLOP, deckPosition=4, communityCards.length=0
[DEBUG advanceBettingRound] Hand 29: Advancing from PRE_FLOP to FLOP, cardsToDeal=3
[DEBUG advanceBettingRound] Hand 29: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 29: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '2000000' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '2000000' }
]
[DEBUG advanceBettingRound] Hand 29: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 29: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 29: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 29: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 29: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG advanceBettingRound] Hand 29: Updating hand state: round=FLOP, status=FLOP, currentActionSeat=0, newCommunityCards.length=3
[DEBUG advanceBettingRound] Hand 29: Updating hand with: {"where":{"id":29},"data":{"round":"FLOP","status":"FLOP","communityCards":"[3 cards]","deckPosition":7,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG advanceBettingRound] Hand 29: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG advanceBettingRound] Hand 29: RETURNING false - Round advanced successfully from PRE_FLOP to FLOP (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG handleBettingRoundComplete] Hand 29: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 29: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG handleBettingRoundComplete] Hand 29: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 29: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG handleNextPlayerOrRoundComplete] Hand 29: RETURNING result from handleBettingRoundComplete: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG callAction] Hand 29: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=true
[DEBUG callAction] Hand 29: RETURNING from transaction - Final result
[DEBUG callAction] Hand 29: Context - hand.round=PRE_FLOP, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG callAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=29

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG createActionAndEvent] Hand 29: Creating action with: {"handId":29,"seatNumber":0,"round":"FLOP","action":"ALL_IN","amount":"28000000","handRound":"FLOP","roundParam":"FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG createActionAndEvent] Hand 29: Action created successfully: {"id":139,"seatNumber":0,"action":"ALL_IN","round":"FLOP","amount":"28000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG isBettingRoundComplete] Hand 29: Starting check
[DEBUG isBettingRoundComplete] Hand 29: Querying hand with: {"where":{"id":29}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG isBettingRoundComplete] Hand 29: Query result - hand={"id":29,"round":"FLOP","currentBet":"28000000","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 29: currentBet=28000000, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 29: Querying handPlayers with: {"where":{"handId":29}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG isBettingRoundComplete] Hand 29: Query returned 2 handPlayers: [{"id":58,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"},{"id":57,"seatNumber":0,"status":"ALL_IN","chipsCommitted":"28000000"}]
[DEBUG isBettingRoundComplete] Hand 29: activePlayers=1, allInPlayers=1
[DEBUG isBettingRoundComplete] Hand 29: Active player seats: [ 1 ]
[DEBUG isBettingRoundComplete] Hand 29: Querying roundActions with: {
  "where": {
    "handId": 29,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG isBettingRoundComplete] Hand 29: Query returned 1 roundActions for round FLOP: [{"id":139,"seatNumber":0,"action":"ALL_IN","amount":"28000000","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 29: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 29: Checking 1 active players against actedSeats and currentBet=28000000
[DEBUG isBettingRoundComplete] Hand 29: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 29: Context - actedSeats=[0], playerSeat=1, currentRound=FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG handleNextPlayerOrRoundComplete] Hand 29: Called with currentSeatNumber=0, currentRound=FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG handleNextPlayerOrRoundComplete] Hand 29: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 29: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 29: Querying hand with: {"where":{"id":29},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG handleNextPlayerOrRoundComplete] Hand 29: Query result - hand.round=FLOP, currentRound param=FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 29: Hand players: [{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"},{"seatNumber":0,"status":"ALL_IN","chipsCommitted":"28000000"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 29: nextPlayer seat=1, chipsCommitted=0, currentBet=28000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 29: Next player hasn't matched (chipsCommitted=0, currentBet=28000000)
[DEBUG handleNextPlayerOrRoundComplete] Hand 29: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 29: Starting check
[DEBUG isBettingRoundComplete] Hand 29: Querying hand with: {"where":{"id":29}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG isBettingRoundComplete] Hand 29: Query result - hand={"id":29,"round":"FLOP","currentBet":"28000000","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 29: currentBet=28000000, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 29: Querying handPlayers with: {"where":{"handId":29}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG isBettingRoundComplete] Hand 29: Query returned 2 handPlayers: [{"id":58,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"},{"id":57,"seatNumber":0,"status":"ALL_IN","chipsCommitted":"28000000"}]
[DEBUG isBettingRoundComplete] Hand 29: activePlayers=1, allInPlayers=1
[DEBUG isBettingRoundComplete] Hand 29: Active player seats: [ 1 ]
[DEBUG isBettingRoundComplete] Hand 29: Querying roundActions with: {
  "where": {
    "handId": 29,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG isBettingRoundComplete] Hand 29: Query returned 1 roundActions for round FLOP: [{"id":139,"seatNumber":0,"action":"ALL_IN","amount":"28000000","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 29: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 29: Checking 1 active players against actedSeats and currentBet=28000000
[DEBUG isBettingRoundComplete] Hand 29: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 29: Context - actedSeats=[0], playerSeat=1, currentRound=FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG handleNextPlayerOrRoundComplete] Hand 29: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 29: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 29: Updating hand with: {"where":{"id":29},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG handleNextPlayerOrRoundComplete] Hand 29: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 29: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 29: Context - currentRound=FLOP, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG createActionAndEvent] Hand 29: Creating action with: {"handId":29,"seatNumber":1,"round":"FLOP","action":"ALL_IN","amount":"48000000","handRound":"FLOP","roundParam":"FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG createActionAndEvent] Hand 29: Action created successfully: {"id":140,"seatNumber":1,"action":"ALL_IN","round":"FLOP","amount":"48000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG isBettingRoundComplete] Hand 29: Starting check
[DEBUG isBettingRoundComplete] Hand 29: Querying hand with: {"where":{"id":29}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG isBettingRoundComplete] Hand 29: Query result - hand={"id":29,"round":"FLOP","currentBet":"48000000","currentActionSeat":1,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 29: currentBet=48000000, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 29: Querying handPlayers with: {"where":{"handId":29}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG isBettingRoundComplete] Hand 29: Query returned 2 handPlayers: [{"id":57,"seatNumber":0,"status":"ALL_IN","chipsCommitted":"28000000"},{"id":58,"seatNumber":1,"status":"ALL_IN","chipsCommitted":"48000000"}]
[DEBUG isBettingRoundComplete] Hand 29: activePlayers=0, allInPlayers=2
[DEBUG isBettingRoundComplete] Hand 29: Active player seats: []
[DEBUG isBettingRoundComplete] Hand 29: Querying roundActions with: {
  "where": {
    "handId": 29,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG isBettingRoundComplete] Hand 29: Query returned 2 roundActions for round FLOP: [{"id":139,"seatNumber":0,"action":"ALL_IN","amount":"28000000","round":"FLOP"},{"id":140,"seatNumber":1,"action":"ALL_IN","amount":"48000000","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 29: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 29: Checking 0 active players against actedSeats and currentBet=48000000
[DEBUG isBettingRoundComplete] Hand 29: RETURNING true - All players all-in
[DEBUG isBettingRoundComplete] Hand 29: Context - activePlayers=0, allInPlayers=2, currentRound=FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG handleBettingRoundComplete] Hand 29: Called with currentRound=FLOP
[DEBUG handleBettingRoundComplete] Hand 29: Advancing from FLOP to next round
[DEBUG advanceBettingRound] Hand 29: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG advanceBettingRound] Hand 29: needsSidePots=true
[DEBUG advanceBettingRound] Hand 29: Creating side pots

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG advanceBettingRound] Hand 29: Querying hand with: {"where":{"id":29},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG advanceBettingRound] Hand 29: Query result - hand.round=FLOP, players=2
[DEBUG advanceBettingRound] Hand 29: currentRound=FLOP, deckPosition=7, communityCards.length=3
[DEBUG advanceBettingRound] Hand 29: Advancing from FLOP to TURN, cardsToDeal=1
[DEBUG advanceBettingRound] Hand 29: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 29: Players: [
  { seatNumber: 0, status: 'ALL_IN', chipsCommitted: '28000000' },
  { seatNumber: 1, status: 'ALL_IN', chipsCommitted: '48000000' }
]
[DEBUG advanceBettingRound] Hand 29: nonFoldedPlayers=2, activePlayers=0
[DEBUG advanceBettingRound] Hand 29: Active player seats: []
[DEBUG advanceBettingRound] Hand 29: allInPlayers=2, allPlayersAllIn=true, onlyOneActivePlayer=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG advanceBettingRound] Hand 29: Updating hand state: round=TURN, status=TURN, currentActionSeat=null, newCommunityCards.length=4
[DEBUG advanceBettingRound] Hand 29: Updating hand with: {"where":{"id":29},"data":{"round":"TURN","status":"TURN","communityCards":"[4 cards]","deckPosition":8,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":null}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG advanceBettingRound] Hand 29: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG advanceBettingRound] Hand 29: RETURNING false - Round advanced successfully from FLOP to TURN (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG handleBettingRoundComplete] Hand 29: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 29: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG isBettingRoundComplete] Hand 29: Starting check
[DEBUG isBettingRoundComplete] Hand 29: Querying hand with: {"where":{"id":29}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG isBettingRoundComplete] Hand 29: Query result - hand={"id":29,"round":"TURN","currentBet":"0","currentActionSeat":null,"status":"TURN"}
[DEBUG isBettingRoundComplete] Hand 29: currentBet=0, currentRound=TURN
[DEBUG isBettingRoundComplete] Hand 29: Querying handPlayers with: {"where":{"handId":29}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG isBettingRoundComplete] Hand 29: Query returned 2 handPlayers: [{"id":57,"seatNumber":0,"status":"ALL_IN","chipsCommitted":"0"},{"id":58,"seatNumber":1,"status":"ALL_IN","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 29: activePlayers=0, allInPlayers=2
[DEBUG isBettingRoundComplete] Hand 29: Active player seats: []
[DEBUG isBettingRoundComplete] Hand 29: Querying roundActions with: {
  "where": {
    "handId": 29,
    "round": "TURN",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG isBettingRoundComplete] Hand 29: Query returned 0 roundActions for round TURN: []
[DEBUG isBettingRoundComplete] Hand 29: actedSeats: []
[DEBUG isBettingRoundComplete] Hand 29: Checking 0 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 29: RETURNING true - All players all-in
[DEBUG isBettingRoundComplete] Hand 29: Context - activePlayers=0, allInPlayers=2, currentRound=TURN

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG advanceBettingRound] Hand 29: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG advanceBettingRound] Hand 29: needsSidePots=true
[DEBUG advanceBettingRound] Hand 29: Creating side pots

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG advanceBettingRound] Hand 29: Querying hand with: {"where":{"id":29},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG advanceBettingRound] Hand 29: Query result - hand.round=TURN, players=2
[DEBUG advanceBettingRound] Hand 29: currentRound=TURN, deckPosition=8, communityCards.length=4
[DEBUG advanceBettingRound] Hand 29: Advancing from TURN to RIVER, cardsToDeal=1
[DEBUG advanceBettingRound] Hand 29: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 29: Players: [
  { seatNumber: 0, status: 'ALL_IN', chipsCommitted: '0' },
  { seatNumber: 1, status: 'ALL_IN', chipsCommitted: '0' }
]
[DEBUG advanceBettingRound] Hand 29: nonFoldedPlayers=2, activePlayers=0
[DEBUG advanceBettingRound] Hand 29: Active player seats: []
[DEBUG advanceBettingRound] Hand 29: allInPlayers=2, allPlayersAllIn=true, onlyOneActivePlayer=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG advanceBettingRound] Hand 29: Updating hand state: round=RIVER, status=RIVER, currentActionSeat=null, newCommunityCards.length=5
[DEBUG advanceBettingRound] Hand 29: Updating hand with: {"where":{"id":29},"data":{"round":"RIVER","status":"RIVER","communityCards":"[5 cards]","deckPosition":9,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":null}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG advanceBettingRound] Hand 29: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG advanceBettingRound] Hand 29: RETURNING true - All players all-in at RIVER, hand should be settled

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG handleBettingRoundComplete] Hand 29: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=true
[DEBUG handleBettingRoundComplete] Hand 29: Auto-advancing to RIVER and settling

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > FLOP Scenarios > FL-010: Both Players All-In on Flop (Different Amounts)
[DEBUG handleBettingRoundComplete] Hand 29: Hand settled, winnerSeatNumber=0
[DEBUG handleBettingRoundComplete] Hand 29: RETURNING result with settlement: handEnded=true, roundAdvanced=true, winnerSeatNumber=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG callAction] Hand 30: Player seat 0 calling 1000000 in round PRE_FLOP, currentBet=2000000, chipsCommitted before=1000000
[DEBUG callAction] Hand 30: Creating CALL action with: handId=30, seatNumber=0, round=PRE_FLOP, amount=1000000
[DEBUG createActionAndEvent] Hand 30: Creating action with: {"handId":30,"seatNumber":0,"round":"PRE_FLOP","action":"CALL","amount":"1000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG createActionAndEvent] Hand 30: Action created successfully: {"id":143,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"1000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG callAction] Hand 30: CALL action created successfully: {"id":143,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"1000000"}
[DEBUG callAction] Hand 30: CALL action created, chipsCommitted now=2000000

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG callAction] Hand 30: After CALL by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 30: Starting check
[DEBUG isBettingRoundComplete] Hand 30: Querying hand with: {"where":{"id":30}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG isBettingRoundComplete] Hand 30: Query result - hand={"id":30,"round":"PRE_FLOP","currentBet":"2000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 30: currentBet=2000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 30: Querying handPlayers with: {"where":{"handId":30}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG isBettingRoundComplete] Hand 30: Query returned 2 handPlayers: [{"id":59,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"id":60,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG isBettingRoundComplete] Hand 30: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 30: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 30: Querying roundActions with: {
  "where": {
    "handId": 30,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG isBettingRoundComplete] Hand 30: Query returned 1 roundActions for round PRE_FLOP: [{"id":143,"seatNumber":0,"action":"CALL","amount":"1000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 30: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 30: Checking 2 active players against actedSeats and currentBet=2000000
[DEBUG isBettingRoundComplete] Hand 30: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=2000000, currentBet=2000000)
[DEBUG isBettingRoundComplete] Hand 30: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 30: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG callAction] Hand 30: isBettingRoundComplete returned false
[DEBUG callAction] Hand 30: Round not complete, checking auto-advance or next player

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG callAction] Hand 30: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 30: Called with currentSeatNumber=0, currentRound=PRE_FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG handleNextPlayerOrRoundComplete] Hand 30: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 30: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 30: Querying hand with: {"where":{"id":30},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG handleNextPlayerOrRoundComplete] Hand 30: Query result - hand.round=PRE_FLOP, currentRound param=PRE_FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 30: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 30: nextPlayer seat=1, chipsCommitted=2000000, currentBet=2000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 30: Next player has matched bet (currentBet > 0n), checking if all acted and matched
[DEBUG handleNextPlayerOrRoundComplete] Hand 30: Querying roundActions with: {
  "where": {
    "handId": 30,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG handleNextPlayerOrRoundComplete] Hand 30: Query returned 1 roundActions for round PRE_FLOP: [{"id":143,"seatNumber":0,"action":"CALL","amount":"1000000","round":"PRE_FLOP"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 30: allActivePlayers (2): [
  { seatNumber: 0, chipsCommitted: '2000000', status: 'ACTIVE' },
  { seatNumber: 1, chipsCommitted: '2000000', status: 'ACTIVE' }
]
[DEBUG handleNextPlayerOrRoundComplete] Hand 30: Wrap-around check - allActed=false, allMatched=true, actedSeats=0, playersWhoHaventActed=1, onlyNextPlayerHaventActed=true
[DEBUG handleNextPlayerOrRoundComplete] Hand 30: Round complete detected - RETURNING early with round completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 30: Context - allActed=false, onlyNextPlayerHaventActed=true, allMatched=true, currentRound=PRE_FLOP, nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 30: Context - allActivePlayers=[{"seat":0,"chipsCommitted":"2000000","status":"ACTIVE"},{"seat":1,"chipsCommitted":"2000000","status":"ACTIVE"}], actedSeats=[0], roundActions found=1
[DEBUG handleBettingRoundComplete] Hand 30: Called with currentRound=PRE_FLOP
[DEBUG handleBettingRoundComplete] Hand 30: Advancing from PRE_FLOP to next round
[DEBUG advanceBettingRound] Hand 30: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG advanceBettingRound] Hand 30: needsSidePots=false
[DEBUG advanceBettingRound] Hand 30: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG advanceBettingRound] Hand 30: Querying hand with: {"where":{"id":30},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG advanceBettingRound] Hand 30: Query result - hand.round=PRE_FLOP, players=2
[DEBUG advanceBettingRound] Hand 30: currentRound=PRE_FLOP, deckPosition=4, communityCards.length=0
[DEBUG advanceBettingRound] Hand 30: Advancing from PRE_FLOP to FLOP, cardsToDeal=3
[DEBUG advanceBettingRound] Hand 30: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 30: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '2000000' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '2000000' }
]
[DEBUG advanceBettingRound] Hand 30: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 30: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 30: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 30: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 30: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG advanceBettingRound] Hand 30: Updating hand state: round=FLOP, status=FLOP, currentActionSeat=0, newCommunityCards.length=3
[DEBUG advanceBettingRound] Hand 30: Updating hand with: {"where":{"id":30},"data":{"round":"FLOP","status":"FLOP","communityCards":"[3 cards]","deckPosition":7,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG advanceBettingRound] Hand 30: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG advanceBettingRound] Hand 30: RETURNING false - Round advanced successfully from PRE_FLOP to FLOP (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG handleBettingRoundComplete] Hand 30: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 30: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG handleBettingRoundComplete] Hand 30: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 30: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG handleNextPlayerOrRoundComplete] Hand 30: RETURNING result from handleBettingRoundComplete: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG callAction] Hand 30: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=true
[DEBUG callAction] Hand 30: RETURNING from transaction - Final result
[DEBUG callAction] Hand 30: Context - hand.round=PRE_FLOP, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG callAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=30

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG checkAction] Hand 30: Player seat 0 checking in round FLOP
[DEBUG checkAction] Hand 30: Creating CHECK action with: {"handId":30,"seatNumber":0,"round":"FLOP","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG checkAction] Hand 30: CHECK action created successfully: {"id":144,"seatNumber":0,"action":"CHECK","round":"FLOP","amount":null}
[DEBUG checkAction] Hand 30: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG checkAction] Hand 30: After CHECK by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 30: Starting check
[DEBUG isBettingRoundComplete] Hand 30: Querying hand with: {"where":{"id":30}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG isBettingRoundComplete] Hand 30: Query result - hand={"id":30,"round":"FLOP","currentBet":"0","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 30: currentBet=0, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 30: Querying handPlayers with: {"where":{"handId":30}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG isBettingRoundComplete] Hand 30: Query returned 2 handPlayers: [{"id":59,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":60,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 30: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 30: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 30: Querying roundActions with: {
  "where": {
    "handId": 30,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG isBettingRoundComplete] Hand 30: Query returned 1 roundActions for round FLOP: [{"id":144,"seatNumber":0,"action":"CHECK","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 30: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 30: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 30: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 30: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 30: Context - actedSeats=[0], playerSeat=1, currentRound=FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG checkAction] Hand 30: isBettingRoundComplete returned false
[DEBUG checkAction] Hand 30: Round not complete, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 30: Called with currentSeatNumber=0, currentRound=FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG handleNextPlayerOrRoundComplete] Hand 30: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 30: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 30: Querying hand with: {"where":{"id":30},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG handleNextPlayerOrRoundComplete] Hand 30: Query result - hand.round=FLOP, currentRound param=FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 30: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 30: nextPlayer seat=1, chipsCommitted=0, currentBet=0
[DEBUG handleNextPlayerOrRoundComplete] Hand 30: Zero-bet wrap-around, advancing to next player (will complete after they act)
[DEBUG handleNextPlayerOrRoundComplete] Hand 30: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 30: Starting check
[DEBUG isBettingRoundComplete] Hand 30: Querying hand with: {"where":{"id":30}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG isBettingRoundComplete] Hand 30: Query result - hand={"id":30,"round":"FLOP","currentBet":"0","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 30: currentBet=0, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 30: Querying handPlayers with: {"where":{"handId":30}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG isBettingRoundComplete] Hand 30: Query returned 2 handPlayers: [{"id":59,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":60,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 30: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 30: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 30: Querying roundActions with: {
  "where": {
    "handId": 30,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG isBettingRoundComplete] Hand 30: Query returned 1 roundActions for round FLOP: [{"id":144,"seatNumber":0,"action":"CHECK","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 30: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 30: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 30: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 30: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 30: Context - actedSeats=[0], playerSeat=1, currentRound=FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG handleNextPlayerOrRoundComplete] Hand 30: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 30: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 30: Updating hand with: {"where":{"id":30},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG handleNextPlayerOrRoundComplete] Hand 30: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 30: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 30: Context - currentRound=FLOP, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG checkAction] Hand 30: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=false
[DEBUG checkAction] Hand 30: RETURNING from transaction - Final result
[DEBUG checkAction] Hand 30: Context - hand.round=FLOP, handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG checkAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=30

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG checkAction] Hand 30: Player seat 1 checking in round FLOP
[DEBUG checkAction] Hand 30: Creating CHECK action with: {"handId":30,"seatNumber":1,"round":"FLOP","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG checkAction] Hand 30: CHECK action created successfully: {"id":145,"seatNumber":1,"action":"CHECK","round":"FLOP","amount":null}
[DEBUG checkAction] Hand 30: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG checkAction] Hand 30: After CHECK by seat 1, checking if round complete
[DEBUG isBettingRoundComplete] Hand 30: Starting check
[DEBUG isBettingRoundComplete] Hand 30: Querying hand with: {"where":{"id":30}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG isBettingRoundComplete] Hand 30: Query result - hand={"id":30,"round":"FLOP","currentBet":"0","currentActionSeat":1,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 30: currentBet=0, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 30: Querying handPlayers with: {"where":{"handId":30}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG isBettingRoundComplete] Hand 30: Query returned 2 handPlayers: [{"id":59,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":60,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 30: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 30: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 30: Querying roundActions with: {
  "where": {
    "handId": 30,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG isBettingRoundComplete] Hand 30: Query returned 2 roundActions for round FLOP: [{"id":144,"seatNumber":0,"action":"CHECK","round":"FLOP"},{"id":145,"seatNumber":1,"action":"CHECK","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 30: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 30: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 30: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 30: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 30: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 30: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 30: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 30: Context - activePlayers=2, actedSeats=[0,1], currentBet=0, currentRound=FLOP, roundActions queried=2, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 30: Active players detail: [{"seatNumber":0,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true},{"seatNumber":1,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG checkAction] Hand 30: isBettingRoundComplete returned true
[DEBUG checkAction] Hand 30: Round complete, calling handleBettingRoundComplete
[DEBUG handleBettingRoundComplete] Hand 30: Called with currentRound=FLOP
[DEBUG handleBettingRoundComplete] Hand 30: Advancing from FLOP to next round
[DEBUG advanceBettingRound] Hand 30: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG advanceBettingRound] Hand 30: needsSidePots=false
[DEBUG advanceBettingRound] Hand 30: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG advanceBettingRound] Hand 30: Querying hand with: {"where":{"id":30},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG advanceBettingRound] Hand 30: Query result - hand.round=FLOP, players=2
[DEBUG advanceBettingRound] Hand 30: currentRound=FLOP, deckPosition=7, communityCards.length=3
[DEBUG advanceBettingRound] Hand 30: Advancing from FLOP to TURN, cardsToDeal=1
[DEBUG advanceBettingRound] Hand 30: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 30: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '0' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '0' }
]
[DEBUG advanceBettingRound] Hand 30: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 30: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 30: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 30: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 30: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG advanceBettingRound] Hand 30: Updating hand state: round=TURN, status=TURN, currentActionSeat=0, newCommunityCards.length=4
[DEBUG advanceBettingRound] Hand 30: Updating hand with: {"where":{"id":30},"data":{"round":"TURN","status":"TURN","communityCards":"[4 cards]","deckPosition":8,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG advanceBettingRound] Hand 30: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG advanceBettingRound] Hand 30: RETURNING false - Round advanced successfully from FLOP to TURN (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG handleBettingRoundComplete] Hand 30: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 30: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG handleBettingRoundComplete] Hand 30: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 30: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG checkAction] Hand 30: handleBettingRoundComplete returned handEnded=false, roundAdvanced=true
[DEBUG checkAction] Hand 30: RETURNING from transaction - Round complete
[DEBUG checkAction] Hand 30: Context - hand.round=FLOP, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG checkAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=30

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG checkAction] Hand 30: Player seat 0 checking in round TURN
[DEBUG checkAction] Hand 30: Creating CHECK action with: {"handId":30,"seatNumber":0,"round":"TURN","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG checkAction] Hand 30: CHECK action created successfully: {"id":146,"seatNumber":0,"action":"CHECK","round":"TURN","amount":null}
[DEBUG checkAction] Hand 30: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG checkAction] Hand 30: After CHECK by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 30: Starting check
[DEBUG isBettingRoundComplete] Hand 30: Querying hand with: {"where":{"id":30}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG isBettingRoundComplete] Hand 30: Query result - hand={"id":30,"round":"TURN","currentBet":"0","currentActionSeat":0,"status":"TURN"}
[DEBUG isBettingRoundComplete] Hand 30: currentBet=0, currentRound=TURN
[DEBUG isBettingRoundComplete] Hand 30: Querying handPlayers with: {"where":{"handId":30}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG isBettingRoundComplete] Hand 30: Query returned 2 handPlayers: [{"id":59,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":60,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 30: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 30: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 30: Querying roundActions with: {
  "where": {
    "handId": 30,
    "round": "TURN",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG isBettingRoundComplete] Hand 30: Query returned 1 roundActions for round TURN: [{"id":146,"seatNumber":0,"action":"CHECK","round":"TURN"}]
[DEBUG isBettingRoundComplete] Hand 30: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 30: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 30: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 30: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 30: Context - actedSeats=[0], playerSeat=1, currentRound=TURN, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG checkAction] Hand 30: isBettingRoundComplete returned false
[DEBUG checkAction] Hand 30: Round not complete, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 30: Called with currentSeatNumber=0, currentRound=TURN

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG handleNextPlayerOrRoundComplete] Hand 30: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 30: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 30: Querying hand with: {"where":{"id":30},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG handleNextPlayerOrRoundComplete] Hand 30: Query result - hand.round=TURN, currentRound param=TURN, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 30: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 30: nextPlayer seat=1, chipsCommitted=0, currentBet=0
[DEBUG handleNextPlayerOrRoundComplete] Hand 30: Zero-bet wrap-around, advancing to next player (will complete after they act)
[DEBUG handleNextPlayerOrRoundComplete] Hand 30: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 30: Starting check
[DEBUG isBettingRoundComplete] Hand 30: Querying hand with: {"where":{"id":30}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG isBettingRoundComplete] Hand 30: Query result - hand={"id":30,"round":"TURN","currentBet":"0","currentActionSeat":0,"status":"TURN"}
[DEBUG isBettingRoundComplete] Hand 30: currentBet=0, currentRound=TURN
[DEBUG isBettingRoundComplete] Hand 30: Querying handPlayers with: {"where":{"handId":30}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG isBettingRoundComplete] Hand 30: Query returned 2 handPlayers: [{"id":59,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":60,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 30: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 30: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 30: Querying roundActions with: {
  "where": {
    "handId": 30,
    "round": "TURN",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG isBettingRoundComplete] Hand 30: Query returned 1 roundActions for round TURN: [{"id":146,"seatNumber":0,"action":"CHECK","round":"TURN"}]
[DEBUG isBettingRoundComplete] Hand 30: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 30: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 30: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 30: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 30: Context - actedSeats=[0], playerSeat=1, currentRound=TURN, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG handleNextPlayerOrRoundComplete] Hand 30: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 30: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 30: Updating hand with: {"where":{"id":30},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG handleNextPlayerOrRoundComplete] Hand 30: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 30: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 30: Context - currentRound=TURN, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG checkAction] Hand 30: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=false
[DEBUG checkAction] Hand 30: RETURNING from transaction - Final result
[DEBUG checkAction] Hand 30: Context - hand.round=TURN, handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG checkAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=30

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG checkAction] Hand 30: Player seat 1 checking in round TURN
[DEBUG checkAction] Hand 30: Creating CHECK action with: {"handId":30,"seatNumber":1,"round":"TURN","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG checkAction] Hand 30: CHECK action created successfully: {"id":147,"seatNumber":1,"action":"CHECK","round":"TURN","amount":null}
[DEBUG checkAction] Hand 30: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG checkAction] Hand 30: After CHECK by seat 1, checking if round complete
[DEBUG isBettingRoundComplete] Hand 30: Starting check
[DEBUG isBettingRoundComplete] Hand 30: Querying hand with: {"where":{"id":30}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG isBettingRoundComplete] Hand 30: Query result - hand={"id":30,"round":"TURN","currentBet":"0","currentActionSeat":1,"status":"TURN"}
[DEBUG isBettingRoundComplete] Hand 30: currentBet=0, currentRound=TURN
[DEBUG isBettingRoundComplete] Hand 30: Querying handPlayers with: {"where":{"handId":30}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG isBettingRoundComplete] Hand 30: Query returned 2 handPlayers: [{"id":59,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":60,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 30: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 30: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 30: Querying roundActions with: {
  "where": {
    "handId": 30,
    "round": "TURN",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG isBettingRoundComplete] Hand 30: Query returned 2 roundActions for round TURN: [{"id":146,"seatNumber":0,"action":"CHECK","round":"TURN"},{"id":147,"seatNumber":1,"action":"CHECK","round":"TURN"}]
[DEBUG isBettingRoundComplete] Hand 30: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 30: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 30: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 30: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 30: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 30: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 30: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 30: Context - activePlayers=2, actedSeats=[0,1], currentBet=0, currentRound=TURN, roundActions queried=2, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 30: Active players detail: [{"seatNumber":0,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true},{"seatNumber":1,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG checkAction] Hand 30: isBettingRoundComplete returned true
[DEBUG checkAction] Hand 30: Round complete, calling handleBettingRoundComplete
[DEBUG handleBettingRoundComplete] Hand 30: Called with currentRound=TURN
[DEBUG handleBettingRoundComplete] Hand 30: Advancing from TURN to next round
[DEBUG advanceBettingRound] Hand 30: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG advanceBettingRound] Hand 30: needsSidePots=false
[DEBUG advanceBettingRound] Hand 30: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG advanceBettingRound] Hand 30: Querying hand with: {"where":{"id":30},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG advanceBettingRound] Hand 30: Query result - hand.round=TURN, players=2
[DEBUG advanceBettingRound] Hand 30: currentRound=TURN, deckPosition=8, communityCards.length=4
[DEBUG advanceBettingRound] Hand 30: Advancing from TURN to RIVER, cardsToDeal=1
[DEBUG advanceBettingRound] Hand 30: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 30: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '0' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '0' }
]
[DEBUG advanceBettingRound] Hand 30: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 30: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 30: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 30: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 30: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG advanceBettingRound] Hand 30: Updating hand state: round=RIVER, status=RIVER, currentActionSeat=0, newCommunityCards.length=5
[DEBUG advanceBettingRound] Hand 30: Updating hand with: {"where":{"id":30},"data":{"round":"RIVER","status":"RIVER","communityCards":"[5 cards]","deckPosition":9,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG advanceBettingRound] Hand 30: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG advanceBettingRound] Hand 30: RETURNING false - Round advanced successfully from TURN to RIVER (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG handleBettingRoundComplete] Hand 30: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 30: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG handleBettingRoundComplete] Hand 30: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 30: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG checkAction] Hand 30: handleBettingRoundComplete returned handEnded=false, roundAdvanced=true
[DEBUG checkAction] Hand 30: RETURNING from transaction - Round complete
[DEBUG checkAction] Hand 30: Context - hand.round=TURN, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-001: Check-Check on Turn
[DEBUG checkAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=30

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG callAction] Hand 31: Player seat 0 calling 1000000 in round PRE_FLOP, currentBet=2000000, chipsCommitted before=1000000
[DEBUG callAction] Hand 31: Creating CALL action with: handId=31, seatNumber=0, round=PRE_FLOP, amount=1000000
[DEBUG createActionAndEvent] Hand 31: Creating action with: {"handId":31,"seatNumber":0,"round":"PRE_FLOP","action":"CALL","amount":"1000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG createActionAndEvent] Hand 31: Action created successfully: {"id":150,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"1000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG callAction] Hand 31: CALL action created successfully: {"id":150,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"1000000"}
[DEBUG callAction] Hand 31: CALL action created, chipsCommitted now=2000000

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG callAction] Hand 31: After CALL by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 31: Starting check
[DEBUG isBettingRoundComplete] Hand 31: Querying hand with: {"where":{"id":31}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG isBettingRoundComplete] Hand 31: Query result - hand={"id":31,"round":"PRE_FLOP","currentBet":"2000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 31: currentBet=2000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 31: Querying handPlayers with: {"where":{"handId":31}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG isBettingRoundComplete] Hand 31: Query returned 2 handPlayers: [{"id":61,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"id":62,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG isBettingRoundComplete] Hand 31: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 31: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 31: Querying roundActions with: {
  "where": {
    "handId": 31,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG isBettingRoundComplete] Hand 31: Query returned 1 roundActions for round PRE_FLOP: [{"id":150,"seatNumber":0,"action":"CALL","amount":"1000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 31: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 31: Checking 2 active players against actedSeats and currentBet=2000000
[DEBUG isBettingRoundComplete] Hand 31: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=2000000, currentBet=2000000)
[DEBUG isBettingRoundComplete] Hand 31: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 31: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG callAction] Hand 31: isBettingRoundComplete returned false
[DEBUG callAction] Hand 31: Round not complete, checking auto-advance or next player

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG callAction] Hand 31: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 31: Called with currentSeatNumber=0, currentRound=PRE_FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG handleNextPlayerOrRoundComplete] Hand 31: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 31: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 31: Querying hand with: {"where":{"id":31},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG handleNextPlayerOrRoundComplete] Hand 31: Query result - hand.round=PRE_FLOP, currentRound param=PRE_FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 31: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 31: nextPlayer seat=1, chipsCommitted=2000000, currentBet=2000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 31: Next player has matched bet (currentBet > 0n), checking if all acted and matched
[DEBUG handleNextPlayerOrRoundComplete] Hand 31: Querying roundActions with: {
  "where": {
    "handId": 31,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG handleNextPlayerOrRoundComplete] Hand 31: Query returned 1 roundActions for round PRE_FLOP: [{"id":150,"seatNumber":0,"action":"CALL","amount":"1000000","round":"PRE_FLOP"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 31: allActivePlayers (2): [
  { seatNumber: 0, chipsCommitted: '2000000', status: 'ACTIVE' },
  { seatNumber: 1, chipsCommitted: '2000000', status: 'ACTIVE' }
]
[DEBUG handleNextPlayerOrRoundComplete] Hand 31: Wrap-around check - allActed=false, allMatched=true, actedSeats=0, playersWhoHaventActed=1, onlyNextPlayerHaventActed=true
[DEBUG handleNextPlayerOrRoundComplete] Hand 31: Round complete detected - RETURNING early with round completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 31: Context - allActed=false, onlyNextPlayerHaventActed=true, allMatched=true, currentRound=PRE_FLOP, nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 31: Context - allActivePlayers=[{"seat":0,"chipsCommitted":"2000000","status":"ACTIVE"},{"seat":1,"chipsCommitted":"2000000","status":"ACTIVE"}], actedSeats=[0], roundActions found=1
[DEBUG handleBettingRoundComplete] Hand 31: Called with currentRound=PRE_FLOP
[DEBUG handleBettingRoundComplete] Hand 31: Advancing from PRE_FLOP to next round
[DEBUG advanceBettingRound] Hand 31: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG advanceBettingRound] Hand 31: needsSidePots=false
[DEBUG advanceBettingRound] Hand 31: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG advanceBettingRound] Hand 31: Querying hand with: {"where":{"id":31},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG advanceBettingRound] Hand 31: Query result - hand.round=PRE_FLOP, players=2
[DEBUG advanceBettingRound] Hand 31: currentRound=PRE_FLOP, deckPosition=4, communityCards.length=0
[DEBUG advanceBettingRound] Hand 31: Advancing from PRE_FLOP to FLOP, cardsToDeal=3
[DEBUG advanceBettingRound] Hand 31: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 31: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '2000000' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '2000000' }
]
[DEBUG advanceBettingRound] Hand 31: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 31: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 31: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 31: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 31: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG advanceBettingRound] Hand 31: Updating hand state: round=FLOP, status=FLOP, currentActionSeat=0, newCommunityCards.length=3
[DEBUG advanceBettingRound] Hand 31: Updating hand with: {"where":{"id":31},"data":{"round":"FLOP","status":"FLOP","communityCards":"[3 cards]","deckPosition":7,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG advanceBettingRound] Hand 31: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG advanceBettingRound] Hand 31: RETURNING false - Round advanced successfully from PRE_FLOP to FLOP (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG handleBettingRoundComplete] Hand 31: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 31: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG handleBettingRoundComplete] Hand 31: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 31: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG handleNextPlayerOrRoundComplete] Hand 31: RETURNING result from handleBettingRoundComplete: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG callAction] Hand 31: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=true
[DEBUG callAction] Hand 31: RETURNING from transaction - Final result
[DEBUG callAction] Hand 31: Context - hand.round=PRE_FLOP, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG callAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=31

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG checkAction] Hand 31: Player seat 0 checking in round FLOP
[DEBUG checkAction] Hand 31: Creating CHECK action with: {"handId":31,"seatNumber":0,"round":"FLOP","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG checkAction] Hand 31: CHECK action created successfully: {"id":151,"seatNumber":0,"action":"CHECK","round":"FLOP","amount":null}
[DEBUG checkAction] Hand 31: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG checkAction] Hand 31: After CHECK by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 31: Starting check
[DEBUG isBettingRoundComplete] Hand 31: Querying hand with: {"where":{"id":31}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG isBettingRoundComplete] Hand 31: Query result - hand={"id":31,"round":"FLOP","currentBet":"0","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 31: currentBet=0, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 31: Querying handPlayers with: {"where":{"handId":31}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG isBettingRoundComplete] Hand 31: Query returned 2 handPlayers: [{"id":61,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":62,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 31: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 31: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 31: Querying roundActions with: {
  "where": {
    "handId": 31,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG isBettingRoundComplete] Hand 31: Query returned 1 roundActions for round FLOP: [{"id":151,"seatNumber":0,"action":"CHECK","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 31: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 31: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 31: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 31: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 31: Context - actedSeats=[0], playerSeat=1, currentRound=FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG checkAction] Hand 31: isBettingRoundComplete returned false
[DEBUG checkAction] Hand 31: Round not complete, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 31: Called with currentSeatNumber=0, currentRound=FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG handleNextPlayerOrRoundComplete] Hand 31: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 31: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 31: Querying hand with: {"where":{"id":31},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG handleNextPlayerOrRoundComplete] Hand 31: Query result - hand.round=FLOP, currentRound param=FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 31: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 31: nextPlayer seat=1, chipsCommitted=0, currentBet=0
[DEBUG handleNextPlayerOrRoundComplete] Hand 31: Zero-bet wrap-around, advancing to next player (will complete after they act)
[DEBUG handleNextPlayerOrRoundComplete] Hand 31: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 31: Starting check
[DEBUG isBettingRoundComplete] Hand 31: Querying hand with: {"where":{"id":31}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG isBettingRoundComplete] Hand 31: Query result - hand={"id":31,"round":"FLOP","currentBet":"0","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 31: currentBet=0, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 31: Querying handPlayers with: {"where":{"handId":31}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG isBettingRoundComplete] Hand 31: Query returned 2 handPlayers: [{"id":61,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":62,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 31: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 31: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 31: Querying roundActions with: {
  "where": {
    "handId": 31,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG isBettingRoundComplete] Hand 31: Query returned 1 roundActions for round FLOP: [{"id":151,"seatNumber":0,"action":"CHECK","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 31: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 31: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 31: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 31: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 31: Context - actedSeats=[0], playerSeat=1, currentRound=FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG handleNextPlayerOrRoundComplete] Hand 31: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 31: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 31: Updating hand with: {"where":{"id":31},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG handleNextPlayerOrRoundComplete] Hand 31: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 31: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 31: Context - currentRound=FLOP, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG checkAction] Hand 31: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=false
[DEBUG checkAction] Hand 31: RETURNING from transaction - Final result
[DEBUG checkAction] Hand 31: Context - hand.round=FLOP, handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG checkAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=31

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG checkAction] Hand 31: Player seat 1 checking in round FLOP
[DEBUG checkAction] Hand 31: Creating CHECK action with: {"handId":31,"seatNumber":1,"round":"FLOP","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG checkAction] Hand 31: CHECK action created successfully: {"id":152,"seatNumber":1,"action":"CHECK","round":"FLOP","amount":null}
[DEBUG checkAction] Hand 31: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG checkAction] Hand 31: After CHECK by seat 1, checking if round complete
[DEBUG isBettingRoundComplete] Hand 31: Starting check
[DEBUG isBettingRoundComplete] Hand 31: Querying hand with: {"where":{"id":31}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG isBettingRoundComplete] Hand 31: Query result - hand={"id":31,"round":"FLOP","currentBet":"0","currentActionSeat":1,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 31: currentBet=0, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 31: Querying handPlayers with: {"where":{"handId":31}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG isBettingRoundComplete] Hand 31: Query returned 2 handPlayers: [{"id":61,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":62,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 31: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 31: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 31: Querying roundActions with: {
  "where": {
    "handId": 31,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG isBettingRoundComplete] Hand 31: Query returned 2 roundActions for round FLOP: [{"id":151,"seatNumber":0,"action":"CHECK","round":"FLOP"},{"id":152,"seatNumber":1,"action":"CHECK","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 31: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 31: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 31: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 31: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 31: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 31: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 31: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 31: Context - activePlayers=2, actedSeats=[0,1], currentBet=0, currentRound=FLOP, roundActions queried=2, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 31: Active players detail: [{"seatNumber":0,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true},{"seatNumber":1,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG checkAction] Hand 31: isBettingRoundComplete returned true
[DEBUG checkAction] Hand 31: Round complete, calling handleBettingRoundComplete
[DEBUG handleBettingRoundComplete] Hand 31: Called with currentRound=FLOP
[DEBUG handleBettingRoundComplete] Hand 31: Advancing from FLOP to next round
[DEBUG advanceBettingRound] Hand 31: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG advanceBettingRound] Hand 31: needsSidePots=false
[DEBUG advanceBettingRound] Hand 31: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG advanceBettingRound] Hand 31: Querying hand with: {"where":{"id":31},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG advanceBettingRound] Hand 31: Query result - hand.round=FLOP, players=2
[DEBUG advanceBettingRound] Hand 31: currentRound=FLOP, deckPosition=7, communityCards.length=3
[DEBUG advanceBettingRound] Hand 31: Advancing from FLOP to TURN, cardsToDeal=1
[DEBUG advanceBettingRound] Hand 31: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 31: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '0' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '0' }
]
[DEBUG advanceBettingRound] Hand 31: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 31: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 31: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 31: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 31: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG advanceBettingRound] Hand 31: Updating hand state: round=TURN, status=TURN, currentActionSeat=0, newCommunityCards.length=4
[DEBUG advanceBettingRound] Hand 31: Updating hand with: {"where":{"id":31},"data":{"round":"TURN","status":"TURN","communityCards":"[4 cards]","deckPosition":8,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG advanceBettingRound] Hand 31: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG advanceBettingRound] Hand 31: RETURNING false - Round advanced successfully from FLOP to TURN (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG handleBettingRoundComplete] Hand 31: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 31: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG handleBettingRoundComplete] Hand 31: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 31: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG checkAction] Hand 31: handleBettingRoundComplete returned handEnded=false, roundAdvanced=true
[DEBUG checkAction] Hand 31: RETURNING from transaction - Round complete
[DEBUG checkAction] Hand 31: Context - hand.round=FLOP, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG checkAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=31

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG betAction] Hand 31: Player seat 0 betting 5000000 in round TURN, currentBet before=0, chipsCommitted before=0, isAllIn=false
[DEBUG betAction] Hand 31: Creating BET action - hand.round=TURN, actionType=RAISE, eventActionType=BET
[DEBUG createActionAndEvent] Hand 31: Creating action with: {"handId":31,"seatNumber":0,"round":"TURN","action":"RAISE","amount":"5000000","handRound":"TURN","roundParam":"TURN","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG createActionAndEvent] Hand 31: Action created successfully: {"id":153,"seatNumber":0,"action":"RAISE","round":"TURN","amount":"5000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG betAction] Hand 31: BET action created successfully, checking if round complete
[DEBUG betAction] Hand 31: Checking if betting round complete after BET
[DEBUG betAction] Hand 31: Context before isBettingRoundComplete - hand.round=TURN, currentBet=0, currentActionSeat=0
[DEBUG isBettingRoundComplete] Hand 31: Starting check
[DEBUG isBettingRoundComplete] Hand 31: Querying hand with: {"where":{"id":31}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG isBettingRoundComplete] Hand 31: Query result - hand={"id":31,"round":"TURN","currentBet":"5000000","currentActionSeat":0,"status":"TURN"}
[DEBUG isBettingRoundComplete] Hand 31: currentBet=5000000, currentRound=TURN
[DEBUG isBettingRoundComplete] Hand 31: Querying handPlayers with: {"where":{"handId":31}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG isBettingRoundComplete] Hand 31: Query returned 2 handPlayers: [{"id":61,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"5000000"},{"id":62,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 31: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 31: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 31: Querying roundActions with: {
  "where": {
    "handId": 31,
    "round": "TURN",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG isBettingRoundComplete] Hand 31: Query returned 1 roundActions for round TURN: [{"id":153,"seatNumber":0,"action":"RAISE","amount":"5000000","round":"TURN"}]
[DEBUG isBettingRoundComplete] Hand 31: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 31: Checking 2 active players against actedSeats and currentBet=5000000
[DEBUG isBettingRoundComplete] Hand 31: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=5000000, currentBet=5000000)
[DEBUG isBettingRoundComplete] Hand 31: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 31: Context - actedSeats=[0], playerSeat=1, currentRound=TURN, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG betAction] Hand 31: isBettingRoundComplete returned false
[DEBUG handleBettingActionCompletion] Hand 31: Called with currentSeatNumber=0, currentRound=TURN, bettingRoundComplete=false, isAllIn=false
[DEBUG handleBettingActionCompletion] Hand 31: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 31: Called with currentSeatNumber=0, currentRound=TURN

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG handleNextPlayerOrRoundComplete] Hand 31: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 31: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 31: Querying hand with: {"where":{"id":31},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG handleNextPlayerOrRoundComplete] Hand 31: Query result - hand.round=TURN, currentRound param=TURN, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 31: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"5000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 31: nextPlayer seat=1, chipsCommitted=0, currentBet=5000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 31: Next player hasn't matched (chipsCommitted=0, currentBet=5000000)
[DEBUG handleNextPlayerOrRoundComplete] Hand 31: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 31: Starting check
[DEBUG isBettingRoundComplete] Hand 31: Querying hand with: {"where":{"id":31}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG isBettingRoundComplete] Hand 31: Query result - hand={"id":31,"round":"TURN","currentBet":"5000000","currentActionSeat":0,"status":"TURN"}
[DEBUG isBettingRoundComplete] Hand 31: currentBet=5000000, currentRound=TURN
[DEBUG isBettingRoundComplete] Hand 31: Querying handPlayers with: {"where":{"handId":31}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG isBettingRoundComplete] Hand 31: Query returned 2 handPlayers: [{"id":61,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"5000000"},{"id":62,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 31: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 31: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 31: Querying roundActions with: {
  "where": {
    "handId": 31,
    "round": "TURN",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG isBettingRoundComplete] Hand 31: Query returned 1 roundActions for round TURN: [{"id":153,"seatNumber":0,"action":"RAISE","amount":"5000000","round":"TURN"}]
[DEBUG isBettingRoundComplete] Hand 31: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 31: Checking 2 active players against actedSeats and currentBet=5000000
[DEBUG isBettingRoundComplete] Hand 31: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=5000000, currentBet=5000000)
[DEBUG isBettingRoundComplete] Hand 31: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 31: Context - actedSeats=[0], playerSeat=1, currentRound=TURN, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG handleNextPlayerOrRoundComplete] Hand 31: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 31: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 31: Updating hand with: {"where":{"id":31},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG handleNextPlayerOrRoundComplete] Hand 31: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 31: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 31: Context - currentRound=TURN, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG handleBettingActionCompletion] Hand 31: RETURNING result: handEnded=false, roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG betAction] Hand 31: handleBettingActionCompletion returned: handEnded=false, roundAdvanced=false
[DEBUG betAction] Hand 31: RETURNING from transaction
[DEBUG betAction] Hand 31: Context - hand.round=TURN, handEnded=false, roundAdvanced=false, winnerSeatNumber=null
[DEBUG betAction] Hand 31: RETURNING from transaction - Final values: handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG betAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=31

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG callAction] Hand 31: Player seat 1 calling 5000000 in round TURN, currentBet=5000000, chipsCommitted before=0
[DEBUG callAction] Hand 31: Creating CALL action with: handId=31, seatNumber=1, round=TURN, amount=5000000
[DEBUG createActionAndEvent] Hand 31: Creating action with: {"handId":31,"seatNumber":1,"round":"TURN","action":"CALL","amount":"5000000","handRound":"TURN","roundParam":"TURN","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG createActionAndEvent] Hand 31: Action created successfully: {"id":154,"seatNumber":1,"action":"CALL","round":"TURN","amount":"5000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG callAction] Hand 31: CALL action created successfully: {"id":154,"seatNumber":1,"action":"CALL","round":"TURN","amount":"5000000"}
[DEBUG callAction] Hand 31: CALL action created, chipsCommitted now=5000000

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG callAction] Hand 31: After CALL by seat 1, checking if round complete
[DEBUG isBettingRoundComplete] Hand 31: Starting check
[DEBUG isBettingRoundComplete] Hand 31: Querying hand with: {"where":{"id":31}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG isBettingRoundComplete] Hand 31: Query result - hand={"id":31,"round":"TURN","currentBet":"5000000","currentActionSeat":1,"status":"TURN"}
[DEBUG isBettingRoundComplete] Hand 31: currentBet=5000000, currentRound=TURN
[DEBUG isBettingRoundComplete] Hand 31: Querying handPlayers with: {"where":{"handId":31}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG isBettingRoundComplete] Hand 31: Query returned 2 handPlayers: [{"id":61,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"5000000"},{"id":62,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"5000000"}]
[DEBUG isBettingRoundComplete] Hand 31: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 31: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 31: Querying roundActions with: {
  "where": {
    "handId": 31,
    "round": "TURN",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG isBettingRoundComplete] Hand 31: Query returned 2 roundActions for round TURN: [{"id":153,"seatNumber":0,"action":"RAISE","amount":"5000000","round":"TURN"},{"id":154,"seatNumber":1,"action":"CALL","amount":"5000000","round":"TURN"}]
[DEBUG isBettingRoundComplete] Hand 31: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 31: Checking 2 active players against actedSeats and currentBet=5000000
[DEBUG isBettingRoundComplete] Hand 31: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=5000000, currentBet=5000000)
[DEBUG isBettingRoundComplete] Hand 31: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=5000000, currentBet=5000000)
[DEBUG isBettingRoundComplete] Hand 31: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=5000000, currentBet=5000000)
[DEBUG isBettingRoundComplete] Hand 31: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=5000000, currentBet=5000000)
[DEBUG isBettingRoundComplete] Hand 31: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 31: Context - activePlayers=2, actedSeats=[0,1], currentBet=5000000, currentRound=TURN, roundActions queried=2, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 31: Active players detail: [{"seatNumber":0,"chipsCommitted":"5000000","status":"ACTIVE","hasActed":true,"hasMatched":true},{"seatNumber":1,"chipsCommitted":"5000000","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG callAction] Hand 31: isBettingRoundComplete returned true
[DEBUG callAction] Hand 31: Round complete, calling handleBettingRoundComplete
[DEBUG handleBettingRoundComplete] Hand 31: Called with currentRound=TURN
[DEBUG handleBettingRoundComplete] Hand 31: Advancing from TURN to next round
[DEBUG advanceBettingRound] Hand 31: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG advanceBettingRound] Hand 31: needsSidePots=false
[DEBUG advanceBettingRound] Hand 31: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG advanceBettingRound] Hand 31: Querying hand with: {"where":{"id":31},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG advanceBettingRound] Hand 31: Query result - hand.round=TURN, players=2
[DEBUG advanceBettingRound] Hand 31: currentRound=TURN, deckPosition=8, communityCards.length=4
[DEBUG advanceBettingRound] Hand 31: Advancing from TURN to RIVER, cardsToDeal=1
[DEBUG advanceBettingRound] Hand 31: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 31: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '5000000' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '5000000' }
]
[DEBUG advanceBettingRound] Hand 31: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 31: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 31: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 31: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 31: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG advanceBettingRound] Hand 31: Updating hand state: round=RIVER, status=RIVER, currentActionSeat=0, newCommunityCards.length=5
[DEBUG advanceBettingRound] Hand 31: Updating hand with: {"where":{"id":31},"data":{"round":"RIVER","status":"RIVER","communityCards":"[5 cards]","deckPosition":9,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG advanceBettingRound] Hand 31: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG advanceBettingRound] Hand 31: RETURNING false - Round advanced successfully from TURN to RIVER (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG handleBettingRoundComplete] Hand 31: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 31: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG handleBettingRoundComplete] Hand 31: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 31: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG callAction] Hand 31: handleBettingRoundComplete returned handEnded=false, roundAdvanced=true
[DEBUG callAction] Hand 31: RETURNING from transaction - Round complete
[DEBUG callAction] Hand 31: Context - hand.round=TURN, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-002: Bet-Call on Turn
[DEBUG callAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=31

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG callAction] Hand 32: Player seat 0 calling 1000000 in round PRE_FLOP, currentBet=2000000, chipsCommitted before=1000000
[DEBUG callAction] Hand 32: Creating CALL action with: handId=32, seatNumber=0, round=PRE_FLOP, amount=1000000
[DEBUG createActionAndEvent] Hand 32: Creating action with: {"handId":32,"seatNumber":0,"round":"PRE_FLOP","action":"CALL","amount":"1000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG createActionAndEvent] Hand 32: Action created successfully: {"id":157,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"1000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG callAction] Hand 32: CALL action created successfully: {"id":157,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"1000000"}
[DEBUG callAction] Hand 32: CALL action created, chipsCommitted now=2000000

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG callAction] Hand 32: After CALL by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 32: Starting check
[DEBUG isBettingRoundComplete] Hand 32: Querying hand with: {"where":{"id":32}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG isBettingRoundComplete] Hand 32: Query result - hand={"id":32,"round":"PRE_FLOP","currentBet":"2000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 32: currentBet=2000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 32: Querying handPlayers with: {"where":{"handId":32}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG isBettingRoundComplete] Hand 32: Query returned 2 handPlayers: [{"id":63,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"id":64,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG isBettingRoundComplete] Hand 32: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 32: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 32: Querying roundActions with: {
  "where": {
    "handId": 32,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG isBettingRoundComplete] Hand 32: Query returned 1 roundActions for round PRE_FLOP: [{"id":157,"seatNumber":0,"action":"CALL","amount":"1000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 32: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 32: Checking 2 active players against actedSeats and currentBet=2000000
[DEBUG isBettingRoundComplete] Hand 32: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=2000000, currentBet=2000000)
[DEBUG isBettingRoundComplete] Hand 32: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 32: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG callAction] Hand 32: isBettingRoundComplete returned false
[DEBUG callAction] Hand 32: Round not complete, checking auto-advance or next player

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG callAction] Hand 32: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 32: Called with currentSeatNumber=0, currentRound=PRE_FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG handleNextPlayerOrRoundComplete] Hand 32: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 32: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 32: Querying hand with: {"where":{"id":32},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG handleNextPlayerOrRoundComplete] Hand 32: Query result - hand.round=PRE_FLOP, currentRound param=PRE_FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 32: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 32: nextPlayer seat=1, chipsCommitted=2000000, currentBet=2000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 32: Next player has matched bet (currentBet > 0n), checking if all acted and matched
[DEBUG handleNextPlayerOrRoundComplete] Hand 32: Querying roundActions with: {
  "where": {
    "handId": 32,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG handleNextPlayerOrRoundComplete] Hand 32: Query returned 1 roundActions for round PRE_FLOP: [{"id":157,"seatNumber":0,"action":"CALL","amount":"1000000","round":"PRE_FLOP"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 32: allActivePlayers (2): [
  { seatNumber: 0, chipsCommitted: '2000000', status: 'ACTIVE' },
  { seatNumber: 1, chipsCommitted: '2000000', status: 'ACTIVE' }
]
[DEBUG handleNextPlayerOrRoundComplete] Hand 32: Wrap-around check - allActed=false, allMatched=true, actedSeats=0, playersWhoHaventActed=1, onlyNextPlayerHaventActed=true
[DEBUG handleNextPlayerOrRoundComplete] Hand 32: Round complete detected - RETURNING early with round completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 32: Context - allActed=false, onlyNextPlayerHaventActed=true, allMatched=true, currentRound=PRE_FLOP, nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 32: Context - allActivePlayers=[{"seat":0,"chipsCommitted":"2000000","status":"ACTIVE"},{"seat":1,"chipsCommitted":"2000000","status":"ACTIVE"}], actedSeats=[0], roundActions found=1
[DEBUG handleBettingRoundComplete] Hand 32: Called with currentRound=PRE_FLOP
[DEBUG handleBettingRoundComplete] Hand 32: Advancing from PRE_FLOP to next round
[DEBUG advanceBettingRound] Hand 32: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG advanceBettingRound] Hand 32: needsSidePots=false
[DEBUG advanceBettingRound] Hand 32: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG advanceBettingRound] Hand 32: Querying hand with: {"where":{"id":32},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG advanceBettingRound] Hand 32: Query result - hand.round=PRE_FLOP, players=2
[DEBUG advanceBettingRound] Hand 32: currentRound=PRE_FLOP, deckPosition=4, communityCards.length=0
[DEBUG advanceBettingRound] Hand 32: Advancing from PRE_FLOP to FLOP, cardsToDeal=3
[DEBUG advanceBettingRound] Hand 32: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 32: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '2000000' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '2000000' }
]
[DEBUG advanceBettingRound] Hand 32: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 32: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 32: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 32: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 32: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG advanceBettingRound] Hand 32: Updating hand state: round=FLOP, status=FLOP, currentActionSeat=0, newCommunityCards.length=3
[DEBUG advanceBettingRound] Hand 32: Updating hand with: {"where":{"id":32},"data":{"round":"FLOP","status":"FLOP","communityCards":"[3 cards]","deckPosition":7,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG advanceBettingRound] Hand 32: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG advanceBettingRound] Hand 32: RETURNING false - Round advanced successfully from PRE_FLOP to FLOP (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG handleBettingRoundComplete] Hand 32: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 32: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG handleBettingRoundComplete] Hand 32: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 32: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG handleNextPlayerOrRoundComplete] Hand 32: RETURNING result from handleBettingRoundComplete: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG callAction] Hand 32: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=true
[DEBUG callAction] Hand 32: RETURNING from transaction - Final result
[DEBUG callAction] Hand 32: Context - hand.round=PRE_FLOP, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG callAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=32

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG checkAction] Hand 32: Player seat 0 checking in round FLOP
[DEBUG checkAction] Hand 32: Creating CHECK action with: {"handId":32,"seatNumber":0,"round":"FLOP","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG checkAction] Hand 32: CHECK action created successfully: {"id":158,"seatNumber":0,"action":"CHECK","round":"FLOP","amount":null}
[DEBUG checkAction] Hand 32: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG checkAction] Hand 32: After CHECK by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 32: Starting check
[DEBUG isBettingRoundComplete] Hand 32: Querying hand with: {"where":{"id":32}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG isBettingRoundComplete] Hand 32: Query result - hand={"id":32,"round":"FLOP","currentBet":"0","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 32: currentBet=0, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 32: Querying handPlayers with: {"where":{"handId":32}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG isBettingRoundComplete] Hand 32: Query returned 2 handPlayers: [{"id":63,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":64,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 32: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 32: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 32: Querying roundActions with: {
  "where": {
    "handId": 32,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG isBettingRoundComplete] Hand 32: Query returned 1 roundActions for round FLOP: [{"id":158,"seatNumber":0,"action":"CHECK","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 32: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 32: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 32: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 32: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 32: Context - actedSeats=[0], playerSeat=1, currentRound=FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG checkAction] Hand 32: isBettingRoundComplete returned false
[DEBUG checkAction] Hand 32: Round not complete, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 32: Called with currentSeatNumber=0, currentRound=FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG handleNextPlayerOrRoundComplete] Hand 32: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 32: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 32: Querying hand with: {"where":{"id":32},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG handleNextPlayerOrRoundComplete] Hand 32: Query result - hand.round=FLOP, currentRound param=FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 32: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 32: nextPlayer seat=1, chipsCommitted=0, currentBet=0
[DEBUG handleNextPlayerOrRoundComplete] Hand 32: Zero-bet wrap-around, advancing to next player (will complete after they act)
[DEBUG handleNextPlayerOrRoundComplete] Hand 32: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 32: Starting check
[DEBUG isBettingRoundComplete] Hand 32: Querying hand with: {"where":{"id":32}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG isBettingRoundComplete] Hand 32: Query result - hand={"id":32,"round":"FLOP","currentBet":"0","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 32: currentBet=0, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 32: Querying handPlayers with: {"where":{"handId":32}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG isBettingRoundComplete] Hand 32: Query returned 2 handPlayers: [{"id":63,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":64,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 32: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 32: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 32: Querying roundActions with: {
  "where": {
    "handId": 32,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG isBettingRoundComplete] Hand 32: Query returned 1 roundActions for round FLOP: [{"id":158,"seatNumber":0,"action":"CHECK","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 32: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 32: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 32: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 32: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 32: Context - actedSeats=[0], playerSeat=1, currentRound=FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG handleNextPlayerOrRoundComplete] Hand 32: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 32: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 32: Updating hand with: {"where":{"id":32},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG handleNextPlayerOrRoundComplete] Hand 32: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 32: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 32: Context - currentRound=FLOP, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG checkAction] Hand 32: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=false
[DEBUG checkAction] Hand 32: RETURNING from transaction - Final result
[DEBUG checkAction] Hand 32: Context - hand.round=FLOP, handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG checkAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=32

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG checkAction] Hand 32: Player seat 1 checking in round FLOP
[DEBUG checkAction] Hand 32: Creating CHECK action with: {"handId":32,"seatNumber":1,"round":"FLOP","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG checkAction] Hand 32: CHECK action created successfully: {"id":159,"seatNumber":1,"action":"CHECK","round":"FLOP","amount":null}
[DEBUG checkAction] Hand 32: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG checkAction] Hand 32: After CHECK by seat 1, checking if round complete
[DEBUG isBettingRoundComplete] Hand 32: Starting check
[DEBUG isBettingRoundComplete] Hand 32: Querying hand with: {"where":{"id":32}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG isBettingRoundComplete] Hand 32: Query result - hand={"id":32,"round":"FLOP","currentBet":"0","currentActionSeat":1,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 32: currentBet=0, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 32: Querying handPlayers with: {"where":{"handId":32}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG isBettingRoundComplete] Hand 32: Query returned 2 handPlayers: [{"id":63,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":64,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 32: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 32: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 32: Querying roundActions with: {
  "where": {
    "handId": 32,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG isBettingRoundComplete] Hand 32: Query returned 2 roundActions for round FLOP: [{"id":158,"seatNumber":0,"action":"CHECK","round":"FLOP"},{"id":159,"seatNumber":1,"action":"CHECK","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 32: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 32: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 32: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 32: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 32: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 32: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 32: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 32: Context - activePlayers=2, actedSeats=[0,1], currentBet=0, currentRound=FLOP, roundActions queried=2, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 32: Active players detail: [{"seatNumber":0,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true},{"seatNumber":1,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG checkAction] Hand 32: isBettingRoundComplete returned true
[DEBUG checkAction] Hand 32: Round complete, calling handleBettingRoundComplete
[DEBUG handleBettingRoundComplete] Hand 32: Called with currentRound=FLOP
[DEBUG handleBettingRoundComplete] Hand 32: Advancing from FLOP to next round
[DEBUG advanceBettingRound] Hand 32: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG advanceBettingRound] Hand 32: needsSidePots=false
[DEBUG advanceBettingRound] Hand 32: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG advanceBettingRound] Hand 32: Querying hand with: {"where":{"id":32},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG advanceBettingRound] Hand 32: Query result - hand.round=FLOP, players=2
[DEBUG advanceBettingRound] Hand 32: currentRound=FLOP, deckPosition=7, communityCards.length=3
[DEBUG advanceBettingRound] Hand 32: Advancing from FLOP to TURN, cardsToDeal=1
[DEBUG advanceBettingRound] Hand 32: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 32: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '0' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '0' }
]
[DEBUG advanceBettingRound] Hand 32: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 32: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 32: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 32: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 32: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG advanceBettingRound] Hand 32: Updating hand state: round=TURN, status=TURN, currentActionSeat=0, newCommunityCards.length=4
[DEBUG advanceBettingRound] Hand 32: Updating hand with: {"where":{"id":32},"data":{"round":"TURN","status":"TURN","communityCards":"[4 cards]","deckPosition":8,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG advanceBettingRound] Hand 32: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG advanceBettingRound] Hand 32: RETURNING false - Round advanced successfully from FLOP to TURN (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG handleBettingRoundComplete] Hand 32: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 32: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG handleBettingRoundComplete] Hand 32: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 32: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG checkAction] Hand 32: handleBettingRoundComplete returned handEnded=false, roundAdvanced=true
[DEBUG checkAction] Hand 32: RETURNING from transaction - Round complete
[DEBUG checkAction] Hand 32: Context - hand.round=FLOP, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG checkAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=32

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG betAction] Hand 32: Player seat 0 betting 5000000 in round TURN, currentBet before=0, chipsCommitted before=0, isAllIn=false
[DEBUG betAction] Hand 32: Creating BET action - hand.round=TURN, actionType=RAISE, eventActionType=BET
[DEBUG createActionAndEvent] Hand 32: Creating action with: {"handId":32,"seatNumber":0,"round":"TURN","action":"RAISE","amount":"5000000","handRound":"TURN","roundParam":"TURN","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG createActionAndEvent] Hand 32: Action created successfully: {"id":160,"seatNumber":0,"action":"RAISE","round":"TURN","amount":"5000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG betAction] Hand 32: BET action created successfully, checking if round complete
[DEBUG betAction] Hand 32: Checking if betting round complete after BET
[DEBUG betAction] Hand 32: Context before isBettingRoundComplete - hand.round=TURN, currentBet=0, currentActionSeat=0
[DEBUG isBettingRoundComplete] Hand 32: Starting check
[DEBUG isBettingRoundComplete] Hand 32: Querying hand with: {"where":{"id":32}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG isBettingRoundComplete] Hand 32: Query result - hand={"id":32,"round":"TURN","currentBet":"5000000","currentActionSeat":0,"status":"TURN"}
[DEBUG isBettingRoundComplete] Hand 32: currentBet=5000000, currentRound=TURN
[DEBUG isBettingRoundComplete] Hand 32: Querying handPlayers with: {"where":{"handId":32}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG isBettingRoundComplete] Hand 32: Query returned 2 handPlayers: [{"id":63,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"5000000"},{"id":64,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 32: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 32: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 32: Querying roundActions with: {
  "where": {
    "handId": 32,
    "round": "TURN",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG isBettingRoundComplete] Hand 32: Query returned 1 roundActions for round TURN: [{"id":160,"seatNumber":0,"action":"RAISE","amount":"5000000","round":"TURN"}]
[DEBUG isBettingRoundComplete] Hand 32: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 32: Checking 2 active players against actedSeats and currentBet=5000000
[DEBUG isBettingRoundComplete] Hand 32: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=5000000, currentBet=5000000)
[DEBUG isBettingRoundComplete] Hand 32: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 32: Context - actedSeats=[0], playerSeat=1, currentRound=TURN, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG betAction] Hand 32: isBettingRoundComplete returned false
[DEBUG handleBettingActionCompletion] Hand 32: Called with currentSeatNumber=0, currentRound=TURN, bettingRoundComplete=false, isAllIn=false
[DEBUG handleBettingActionCompletion] Hand 32: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 32: Called with currentSeatNumber=0, currentRound=TURN

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG handleNextPlayerOrRoundComplete] Hand 32: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 32: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 32: Querying hand with: {"where":{"id":32},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG handleNextPlayerOrRoundComplete] Hand 32: Query result - hand.round=TURN, currentRound param=TURN, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 32: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"5000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 32: nextPlayer seat=1, chipsCommitted=0, currentBet=5000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 32: Next player hasn't matched (chipsCommitted=0, currentBet=5000000)
[DEBUG handleNextPlayerOrRoundComplete] Hand 32: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 32: Starting check
[DEBUG isBettingRoundComplete] Hand 32: Querying hand with: {"where":{"id":32}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG isBettingRoundComplete] Hand 32: Query result - hand={"id":32,"round":"TURN","currentBet":"5000000","currentActionSeat":0,"status":"TURN"}
[DEBUG isBettingRoundComplete] Hand 32: currentBet=5000000, currentRound=TURN
[DEBUG isBettingRoundComplete] Hand 32: Querying handPlayers with: {"where":{"handId":32}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG isBettingRoundComplete] Hand 32: Query returned 2 handPlayers: [{"id":63,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"5000000"},{"id":64,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 32: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 32: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 32: Querying roundActions with: {
  "where": {
    "handId": 32,
    "round": "TURN",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG isBettingRoundComplete] Hand 32: Query returned 1 roundActions for round TURN: [{"id":160,"seatNumber":0,"action":"RAISE","amount":"5000000","round":"TURN"}]
[DEBUG isBettingRoundComplete] Hand 32: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 32: Checking 2 active players against actedSeats and currentBet=5000000
[DEBUG isBettingRoundComplete] Hand 32: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=5000000, currentBet=5000000)
[DEBUG isBettingRoundComplete] Hand 32: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 32: Context - actedSeats=[0], playerSeat=1, currentRound=TURN, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG handleNextPlayerOrRoundComplete] Hand 32: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 32: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 32: Updating hand with: {"where":{"id":32},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG handleNextPlayerOrRoundComplete] Hand 32: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 32: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 32: Context - currentRound=TURN, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG handleBettingActionCompletion] Hand 32: RETURNING result: handEnded=false, roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG betAction] Hand 32: handleBettingActionCompletion returned: handEnded=false, roundAdvanced=false
[DEBUG betAction] Hand 32: RETURNING from transaction
[DEBUG betAction] Hand 32: Context - hand.round=TURN, handEnded=false, roundAdvanced=false, winnerSeatNumber=null
[DEBUG betAction] Hand 32: RETURNING from transaction - Final values: handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG betAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=32

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG foldAction] Hand 32: Player seat 1 folding in round TURN
[DEBUG foldAction] Hand 32: Creating FOLD action with: {"handId":32,"seatNumber":1,"round":"TURN","action":"FOLD","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn
[DEBUG foldAction] Hand 32: FOLD action created successfully: {"id":161,"seatNumber":1,"action":"FOLD","round":"TURN","amount":null}
[DEBUG foldAction] Hand 32: FOLD action created, checking if round complete or advancing to next player

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG callAction] Hand 33: Player seat 0 calling 1000000 in round PRE_FLOP, currentBet=2000000, chipsCommitted before=1000000
[DEBUG callAction] Hand 33: Creating CALL action with: handId=33, seatNumber=0, round=PRE_FLOP, amount=1000000
[DEBUG createActionAndEvent] Hand 33: Creating action with: {"handId":33,"seatNumber":0,"round":"PRE_FLOP","action":"CALL","amount":"1000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG createActionAndEvent] Hand 33: Action created successfully: {"id":164,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"1000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG callAction] Hand 33: CALL action created successfully: {"id":164,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"1000000"}
[DEBUG callAction] Hand 33: CALL action created, chipsCommitted now=2000000

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG callAction] Hand 33: After CALL by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 33: Starting check
[DEBUG isBettingRoundComplete] Hand 33: Querying hand with: {"where":{"id":33}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 33: Query result - hand={"id":33,"round":"PRE_FLOP","currentBet":"2000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 33: currentBet=2000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 33: Querying handPlayers with: {"where":{"handId":33}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 33: Query returned 2 handPlayers: [{"id":65,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"id":66,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG isBettingRoundComplete] Hand 33: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 33: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 33: Querying roundActions with: {
  "where": {
    "handId": 33,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 33: Query returned 1 roundActions for round PRE_FLOP: [{"id":164,"seatNumber":0,"action":"CALL","amount":"1000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 33: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 33: Checking 2 active players against actedSeats and currentBet=2000000
[DEBUG isBettingRoundComplete] Hand 33: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=2000000, currentBet=2000000)
[DEBUG isBettingRoundComplete] Hand 33: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 33: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG callAction] Hand 33: isBettingRoundComplete returned false
[DEBUG callAction] Hand 33: Round not complete, checking auto-advance or next player

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG callAction] Hand 33: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 33: Called with currentSeatNumber=0, currentRound=PRE_FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 33: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 33: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 33: Querying hand with: {"where":{"id":33},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 33: Query result - hand.round=PRE_FLOP, currentRound param=PRE_FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 33: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 33: nextPlayer seat=1, chipsCommitted=2000000, currentBet=2000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 33: Next player has matched bet (currentBet > 0n), checking if all acted and matched
[DEBUG handleNextPlayerOrRoundComplete] Hand 33: Querying roundActions with: {
  "where": {
    "handId": 33,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 33: Query returned 1 roundActions for round PRE_FLOP: [{"id":164,"seatNumber":0,"action":"CALL","amount":"1000000","round":"PRE_FLOP"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 33: allActivePlayers (2): [
  { seatNumber: 0, chipsCommitted: '2000000', status: 'ACTIVE' },
  { seatNumber: 1, chipsCommitted: '2000000', status: 'ACTIVE' }
]
[DEBUG handleNextPlayerOrRoundComplete] Hand 33: Wrap-around check - allActed=false, allMatched=true, actedSeats=0, playersWhoHaventActed=1, onlyNextPlayerHaventActed=true
[DEBUG handleNextPlayerOrRoundComplete] Hand 33: Round complete detected - RETURNING early with round completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 33: Context - allActed=false, onlyNextPlayerHaventActed=true, allMatched=true, currentRound=PRE_FLOP, nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 33: Context - allActivePlayers=[{"seat":0,"chipsCommitted":"2000000","status":"ACTIVE"},{"seat":1,"chipsCommitted":"2000000","status":"ACTIVE"}], actedSeats=[0], roundActions found=1
[DEBUG handleBettingRoundComplete] Hand 33: Called with currentRound=PRE_FLOP
[DEBUG handleBettingRoundComplete] Hand 33: Advancing from PRE_FLOP to next round
[DEBUG advanceBettingRound] Hand 33: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG advanceBettingRound] Hand 33: needsSidePots=false
[DEBUG advanceBettingRound] Hand 33: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG advanceBettingRound] Hand 33: Querying hand with: {"where":{"id":33},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG advanceBettingRound] Hand 33: Query result - hand.round=PRE_FLOP, players=2
[DEBUG advanceBettingRound] Hand 33: currentRound=PRE_FLOP, deckPosition=4, communityCards.length=0
[DEBUG advanceBettingRound] Hand 33: Advancing from PRE_FLOP to FLOP, cardsToDeal=3
[DEBUG advanceBettingRound] Hand 33: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 33: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '2000000' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '2000000' }
]
[DEBUG advanceBettingRound] Hand 33: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 33: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 33: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 33: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 33: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG advanceBettingRound] Hand 33: Updating hand state: round=FLOP, status=FLOP, currentActionSeat=0, newCommunityCards.length=3
[DEBUG advanceBettingRound] Hand 33: Updating hand with: {"where":{"id":33},"data":{"round":"FLOP","status":"FLOP","communityCards":"[3 cards]","deckPosition":7,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG advanceBettingRound] Hand 33: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG advanceBettingRound] Hand 33: RETURNING false - Round advanced successfully from PRE_FLOP to FLOP (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG handleBettingRoundComplete] Hand 33: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 33: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG handleBettingRoundComplete] Hand 33: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 33: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 33: RETURNING result from handleBettingRoundComplete: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG callAction] Hand 33: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=true
[DEBUG callAction] Hand 33: RETURNING from transaction - Final result
[DEBUG callAction] Hand 33: Context - hand.round=PRE_FLOP, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG callAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=33

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG checkAction] Hand 33: Player seat 0 checking in round FLOP
[DEBUG checkAction] Hand 33: Creating CHECK action with: {"handId":33,"seatNumber":0,"round":"FLOP","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG checkAction] Hand 33: CHECK action created successfully: {"id":165,"seatNumber":0,"action":"CHECK","round":"FLOP","amount":null}
[DEBUG checkAction] Hand 33: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG checkAction] Hand 33: After CHECK by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 33: Starting check
[DEBUG isBettingRoundComplete] Hand 33: Querying hand with: {"where":{"id":33}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 33: Query result - hand={"id":33,"round":"FLOP","currentBet":"0","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 33: currentBet=0, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 33: Querying handPlayers with: {"where":{"handId":33}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 33: Query returned 2 handPlayers: [{"id":65,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":66,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 33: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 33: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 33: Querying roundActions with: {
  "where": {
    "handId": 33,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 33: Query returned 1 roundActions for round FLOP: [{"id":165,"seatNumber":0,"action":"CHECK","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 33: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 33: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 33: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 33: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 33: Context - actedSeats=[0], playerSeat=1, currentRound=FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG checkAction] Hand 33: isBettingRoundComplete returned false
[DEBUG checkAction] Hand 33: Round not complete, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 33: Called with currentSeatNumber=0, currentRound=FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 33: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 33: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 33: Querying hand with: {"where":{"id":33},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 33: Query result - hand.round=FLOP, currentRound param=FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 33: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 33: nextPlayer seat=1, chipsCommitted=0, currentBet=0
[DEBUG handleNextPlayerOrRoundComplete] Hand 33: Zero-bet wrap-around, advancing to next player (will complete after they act)
[DEBUG handleNextPlayerOrRoundComplete] Hand 33: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 33: Starting check
[DEBUG isBettingRoundComplete] Hand 33: Querying hand with: {"where":{"id":33}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 33: Query result - hand={"id":33,"round":"FLOP","currentBet":"0","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 33: currentBet=0, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 33: Querying handPlayers with: {"where":{"handId":33}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 33: Query returned 2 handPlayers: [{"id":65,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":66,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 33: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 33: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 33: Querying roundActions with: {
  "where": {
    "handId": 33,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 33: Query returned 1 roundActions for round FLOP: [{"id":165,"seatNumber":0,"action":"CHECK","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 33: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 33: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 33: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 33: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 33: Context - actedSeats=[0], playerSeat=1, currentRound=FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 33: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 33: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 33: Updating hand with: {"where":{"id":33},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 33: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 33: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 33: Context - currentRound=FLOP, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG checkAction] Hand 33: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=false
[DEBUG checkAction] Hand 33: RETURNING from transaction - Final result
[DEBUG checkAction] Hand 33: Context - hand.round=FLOP, handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG checkAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=33

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG checkAction] Hand 33: Player seat 1 checking in round FLOP
[DEBUG checkAction] Hand 33: Creating CHECK action with: {"handId":33,"seatNumber":1,"round":"FLOP","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG checkAction] Hand 33: CHECK action created successfully: {"id":166,"seatNumber":1,"action":"CHECK","round":"FLOP","amount":null}
[DEBUG checkAction] Hand 33: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG checkAction] Hand 33: After CHECK by seat 1, checking if round complete
[DEBUG isBettingRoundComplete] Hand 33: Starting check
[DEBUG isBettingRoundComplete] Hand 33: Querying hand with: {"where":{"id":33}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 33: Query result - hand={"id":33,"round":"FLOP","currentBet":"0","currentActionSeat":1,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 33: currentBet=0, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 33: Querying handPlayers with: {"where":{"handId":33}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 33: Query returned 2 handPlayers: [{"id":65,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":66,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 33: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 33: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 33: Querying roundActions with: {
  "where": {
    "handId": 33,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 33: Query returned 2 roundActions for round FLOP: [{"id":165,"seatNumber":0,"action":"CHECK","round":"FLOP"},{"id":166,"seatNumber":1,"action":"CHECK","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 33: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 33: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 33: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 33: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 33: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 33: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 33: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 33: Context - activePlayers=2, actedSeats=[0,1], currentBet=0, currentRound=FLOP, roundActions queried=2, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 33: Active players detail: [{"seatNumber":0,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true},{"seatNumber":1,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG checkAction] Hand 33: isBettingRoundComplete returned true
[DEBUG checkAction] Hand 33: Round complete, calling handleBettingRoundComplete
[DEBUG handleBettingRoundComplete] Hand 33: Called with currentRound=FLOP
[DEBUG handleBettingRoundComplete] Hand 33: Advancing from FLOP to next round
[DEBUG advanceBettingRound] Hand 33: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG advanceBettingRound] Hand 33: needsSidePots=false
[DEBUG advanceBettingRound] Hand 33: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG advanceBettingRound] Hand 33: Querying hand with: {"where":{"id":33},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG advanceBettingRound] Hand 33: Query result - hand.round=FLOP, players=2
[DEBUG advanceBettingRound] Hand 33: currentRound=FLOP, deckPosition=7, communityCards.length=3
[DEBUG advanceBettingRound] Hand 33: Advancing from FLOP to TURN, cardsToDeal=1
[DEBUG advanceBettingRound] Hand 33: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 33: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '0' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '0' }
]
[DEBUG advanceBettingRound] Hand 33: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 33: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 33: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 33: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 33: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG advanceBettingRound] Hand 33: Updating hand state: round=TURN, status=TURN, currentActionSeat=0, newCommunityCards.length=4
[DEBUG advanceBettingRound] Hand 33: Updating hand with: {"where":{"id":33},"data":{"round":"TURN","status":"TURN","communityCards":"[4 cards]","deckPosition":8,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG advanceBettingRound] Hand 33: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG advanceBettingRound] Hand 33: RETURNING false - Round advanced successfully from FLOP to TURN (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG handleBettingRoundComplete] Hand 33: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 33: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG handleBettingRoundComplete] Hand 33: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 33: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG checkAction] Hand 33: handleBettingRoundComplete returned handEnded=false, roundAdvanced=true
[DEBUG checkAction] Hand 33: RETURNING from transaction - Round complete
[DEBUG checkAction] Hand 33: Context - hand.round=FLOP, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG checkAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=33

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG betAction] Hand 33: Player seat 0 betting 5000000 in round TURN, currentBet before=0, chipsCommitted before=0, isAllIn=false
[DEBUG betAction] Hand 33: Creating BET action - hand.round=TURN, actionType=RAISE, eventActionType=BET
[DEBUG createActionAndEvent] Hand 33: Creating action with: {"handId":33,"seatNumber":0,"round":"TURN","action":"RAISE","amount":"5000000","handRound":"TURN","roundParam":"TURN","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG createActionAndEvent] Hand 33: Action created successfully: {"id":167,"seatNumber":0,"action":"RAISE","round":"TURN","amount":"5000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG betAction] Hand 33: BET action created successfully, checking if round complete
[DEBUG betAction] Hand 33: Checking if betting round complete after BET
[DEBUG betAction] Hand 33: Context before isBettingRoundComplete - hand.round=TURN, currentBet=0, currentActionSeat=0
[DEBUG isBettingRoundComplete] Hand 33: Starting check
[DEBUG isBettingRoundComplete] Hand 33: Querying hand with: {"where":{"id":33}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 33: Query result - hand={"id":33,"round":"TURN","currentBet":"5000000","currentActionSeat":0,"status":"TURN"}
[DEBUG isBettingRoundComplete] Hand 33: currentBet=5000000, currentRound=TURN
[DEBUG isBettingRoundComplete] Hand 33: Querying handPlayers with: {"where":{"handId":33}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 33: Query returned 2 handPlayers: [{"id":65,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"5000000"},{"id":66,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 33: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 33: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 33: Querying roundActions with: {
  "where": {
    "handId": 33,
    "round": "TURN",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 33: Query returned 1 roundActions for round TURN: [{"id":167,"seatNumber":0,"action":"RAISE","amount":"5000000","round":"TURN"}]
[DEBUG isBettingRoundComplete] Hand 33: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 33: Checking 2 active players against actedSeats and currentBet=5000000
[DEBUG isBettingRoundComplete] Hand 33: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=5000000, currentBet=5000000)
[DEBUG isBettingRoundComplete] Hand 33: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 33: Context - actedSeats=[0], playerSeat=1, currentRound=TURN, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG betAction] Hand 33: isBettingRoundComplete returned false
[DEBUG handleBettingActionCompletion] Hand 33: Called with currentSeatNumber=0, currentRound=TURN, bettingRoundComplete=false, isAllIn=false
[DEBUG handleBettingActionCompletion] Hand 33: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 33: Called with currentSeatNumber=0, currentRound=TURN

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 33: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 33: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 33: Querying hand with: {"where":{"id":33},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 33: Query result - hand.round=TURN, currentRound param=TURN, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 33: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"5000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 33: nextPlayer seat=1, chipsCommitted=0, currentBet=5000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 33: Next player hasn't matched (chipsCommitted=0, currentBet=5000000)
[DEBUG handleNextPlayerOrRoundComplete] Hand 33: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 33: Starting check
[DEBUG isBettingRoundComplete] Hand 33: Querying hand with: {"where":{"id":33}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 33: Query result - hand={"id":33,"round":"TURN","currentBet":"5000000","currentActionSeat":0,"status":"TURN"}
[DEBUG isBettingRoundComplete] Hand 33: currentBet=5000000, currentRound=TURN
[DEBUG isBettingRoundComplete] Hand 33: Querying handPlayers with: {"where":{"handId":33}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 33: Query returned 2 handPlayers: [{"id":65,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"5000000"},{"id":66,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 33: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 33: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 33: Querying roundActions with: {
  "where": {
    "handId": 33,
    "round": "TURN",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 33: Query returned 1 roundActions for round TURN: [{"id":167,"seatNumber":0,"action":"RAISE","amount":"5000000","round":"TURN"}]
[DEBUG isBettingRoundComplete] Hand 33: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 33: Checking 2 active players against actedSeats and currentBet=5000000
[DEBUG isBettingRoundComplete] Hand 33: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=5000000, currentBet=5000000)
[DEBUG isBettingRoundComplete] Hand 33: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 33: Context - actedSeats=[0], playerSeat=1, currentRound=TURN, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 33: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 33: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 33: Updating hand with: {"where":{"id":33},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 33: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 33: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 33: Context - currentRound=TURN, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG handleBettingActionCompletion] Hand 33: RETURNING result: handEnded=false, roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG betAction] Hand 33: handleBettingActionCompletion returned: handEnded=false, roundAdvanced=false
[DEBUG betAction] Hand 33: RETURNING from transaction
[DEBUG betAction] Hand 33: Context - hand.round=TURN, handEnded=false, roundAdvanced=false, winnerSeatNumber=null
[DEBUG betAction] Hand 33: RETURNING from transaction - Final values: handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG betAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=33

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG foldAction] Hand 33: Player seat 1 folding in round TURN
[DEBUG foldAction] Hand 33: Creating FOLD action with: {"handId":33,"seatNumber":1,"round":"TURN","action":"FOLD","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
[DEBUG foldAction] Hand 33: FOLD action created successfully: {"id":168,"seatNumber":1,"action":"FOLD","round":"TURN","amount":null}
[DEBUG foldAction] Hand 33: FOLD action created, checking if round complete or advancing to next player

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TURN Scenarios > TU-003: Bet-Fold on Turn - 700 bps rake
ðŸ’° Added rake 630000 gwei to TEE balance (hand 33)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG callAction] Hand 34: Player seat 0 calling 1000000 in round PRE_FLOP, currentBet=2000000, chipsCommitted before=1000000
[DEBUG callAction] Hand 34: Creating CALL action with: handId=34, seatNumber=0, round=PRE_FLOP, amount=1000000
[DEBUG createActionAndEvent] Hand 34: Creating action with: {"handId":34,"seatNumber":0,"round":"PRE_FLOP","action":"CALL","amount":"1000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG createActionAndEvent] Hand 34: Action created successfully: {"id":171,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"1000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG callAction] Hand 34: CALL action created successfully: {"id":171,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"1000000"}
[DEBUG callAction] Hand 34: CALL action created, chipsCommitted now=2000000

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG callAction] Hand 34: After CALL by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 34: Starting check
[DEBUG isBettingRoundComplete] Hand 34: Querying hand with: {"where":{"id":34}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 34: Query result - hand={"id":34,"round":"PRE_FLOP","currentBet":"2000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 34: currentBet=2000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 34: Querying handPlayers with: {"where":{"handId":34}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 34: Query returned 2 handPlayers: [{"id":67,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"id":68,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG isBettingRoundComplete] Hand 34: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 34: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 34: Querying roundActions with: {
  "where": {
    "handId": 34,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 34: Query returned 1 roundActions for round PRE_FLOP: [{"id":171,"seatNumber":0,"action":"CALL","amount":"1000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 34: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 34: Checking 2 active players against actedSeats and currentBet=2000000
[DEBUG isBettingRoundComplete] Hand 34: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=2000000, currentBet=2000000)
[DEBUG isBettingRoundComplete] Hand 34: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 34: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG callAction] Hand 34: isBettingRoundComplete returned false
[DEBUG callAction] Hand 34: Round not complete, checking auto-advance or next player

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG callAction] Hand 34: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: Called with currentSeatNumber=0, currentRound=PRE_FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: Querying hand with: {"where":{"id":34},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: Query result - hand.round=PRE_FLOP, currentRound param=PRE_FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: nextPlayer seat=1, chipsCommitted=2000000, currentBet=2000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: Next player has matched bet (currentBet > 0n), checking if all acted and matched
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: Querying roundActions with: {
  "where": {
    "handId": 34,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: Query returned 1 roundActions for round PRE_FLOP: [{"id":171,"seatNumber":0,"action":"CALL","amount":"1000000","round":"PRE_FLOP"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: allActivePlayers (2): [
  { seatNumber: 0, chipsCommitted: '2000000', status: 'ACTIVE' },
  { seatNumber: 1, chipsCommitted: '2000000', status: 'ACTIVE' }
]
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: Wrap-around check - allActed=false, allMatched=true, actedSeats=0, playersWhoHaventActed=1, onlyNextPlayerHaventActed=true
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: Round complete detected - RETURNING early with round completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: Context - allActed=false, onlyNextPlayerHaventActed=true, allMatched=true, currentRound=PRE_FLOP, nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: Context - allActivePlayers=[{"seat":0,"chipsCommitted":"2000000","status":"ACTIVE"},{"seat":1,"chipsCommitted":"2000000","status":"ACTIVE"}], actedSeats=[0], roundActions found=1
[DEBUG handleBettingRoundComplete] Hand 34: Called with currentRound=PRE_FLOP
[DEBUG handleBettingRoundComplete] Hand 34: Advancing from PRE_FLOP to next round
[DEBUG advanceBettingRound] Hand 34: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG advanceBettingRound] Hand 34: needsSidePots=false
[DEBUG advanceBettingRound] Hand 34: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG advanceBettingRound] Hand 34: Querying hand with: {"where":{"id":34},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG advanceBettingRound] Hand 34: Query result - hand.round=PRE_FLOP, players=2
[DEBUG advanceBettingRound] Hand 34: currentRound=PRE_FLOP, deckPosition=4, communityCards.length=0
[DEBUG advanceBettingRound] Hand 34: Advancing from PRE_FLOP to FLOP, cardsToDeal=3
[DEBUG advanceBettingRound] Hand 34: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 34: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '2000000' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '2000000' }
]
[DEBUG advanceBettingRound] Hand 34: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 34: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 34: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 34: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 34: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG advanceBettingRound] Hand 34: Updating hand state: round=FLOP, status=FLOP, currentActionSeat=0, newCommunityCards.length=3
[DEBUG advanceBettingRound] Hand 34: Updating hand with: {"where":{"id":34},"data":{"round":"FLOP","status":"FLOP","communityCards":"[3 cards]","deckPosition":7,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG advanceBettingRound] Hand 34: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG advanceBettingRound] Hand 34: RETURNING false - Round advanced successfully from PRE_FLOP to FLOP (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG handleBettingRoundComplete] Hand 34: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 34: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG handleBettingRoundComplete] Hand 34: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 34: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: RETURNING result from handleBettingRoundComplete: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG callAction] Hand 34: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=true
[DEBUG callAction] Hand 34: RETURNING from transaction - Final result
[DEBUG callAction] Hand 34: Context - hand.round=PRE_FLOP, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG callAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=34

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG checkAction] Hand 34: Player seat 0 checking in round FLOP
[DEBUG checkAction] Hand 34: Creating CHECK action with: {"handId":34,"seatNumber":0,"round":"FLOP","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG checkAction] Hand 34: CHECK action created successfully: {"id":172,"seatNumber":0,"action":"CHECK","round":"FLOP","amount":null}
[DEBUG checkAction] Hand 34: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG checkAction] Hand 34: After CHECK by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 34: Starting check
[DEBUG isBettingRoundComplete] Hand 34: Querying hand with: {"where":{"id":34}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 34: Query result - hand={"id":34,"round":"FLOP","currentBet":"0","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 34: currentBet=0, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 34: Querying handPlayers with: {"where":{"handId":34}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 34: Query returned 2 handPlayers: [{"id":67,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":68,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 34: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 34: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 34: Querying roundActions with: {
  "where": {
    "handId": 34,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 34: Query returned 1 roundActions for round FLOP: [{"id":172,"seatNumber":0,"action":"CHECK","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 34: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 34: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 34: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 34: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 34: Context - actedSeats=[0], playerSeat=1, currentRound=FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG checkAction] Hand 34: isBettingRoundComplete returned false
[DEBUG checkAction] Hand 34: Round not complete, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: Called with currentSeatNumber=0, currentRound=FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: Querying hand with: {"where":{"id":34},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: Query result - hand.round=FLOP, currentRound param=FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: nextPlayer seat=1, chipsCommitted=0, currentBet=0
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: Zero-bet wrap-around, advancing to next player (will complete after they act)
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 34: Starting check
[DEBUG isBettingRoundComplete] Hand 34: Querying hand with: {"where":{"id":34}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 34: Query result - hand={"id":34,"round":"FLOP","currentBet":"0","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 34: currentBet=0, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 34: Querying handPlayers with: {"where":{"handId":34}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 34: Query returned 2 handPlayers: [{"id":67,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":68,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 34: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 34: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 34: Querying roundActions with: {
  "where": {
    "handId": 34,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 34: Query returned 1 roundActions for round FLOP: [{"id":172,"seatNumber":0,"action":"CHECK","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 34: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 34: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 34: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 34: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 34: Context - actedSeats=[0], playerSeat=1, currentRound=FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: Updating hand with: {"where":{"id":34},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: Context - currentRound=FLOP, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG checkAction] Hand 34: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=false
[DEBUG checkAction] Hand 34: RETURNING from transaction - Final result
[DEBUG checkAction] Hand 34: Context - hand.round=FLOP, handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG checkAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=34

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG checkAction] Hand 34: Player seat 1 checking in round FLOP
[DEBUG checkAction] Hand 34: Creating CHECK action with: {"handId":34,"seatNumber":1,"round":"FLOP","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG checkAction] Hand 34: CHECK action created successfully: {"id":173,"seatNumber":1,"action":"CHECK","round":"FLOP","amount":null}
[DEBUG checkAction] Hand 34: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG checkAction] Hand 34: After CHECK by seat 1, checking if round complete
[DEBUG isBettingRoundComplete] Hand 34: Starting check
[DEBUG isBettingRoundComplete] Hand 34: Querying hand with: {"where":{"id":34}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 34: Query result - hand={"id":34,"round":"FLOP","currentBet":"0","currentActionSeat":1,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 34: currentBet=0, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 34: Querying handPlayers with: {"where":{"handId":34}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 34: Query returned 2 handPlayers: [{"id":67,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":68,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 34: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 34: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 34: Querying roundActions with: {
  "where": {
    "handId": 34,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 34: Query returned 2 roundActions for round FLOP: [{"id":172,"seatNumber":0,"action":"CHECK","round":"FLOP"},{"id":173,"seatNumber":1,"action":"CHECK","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 34: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 34: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 34: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 34: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 34: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 34: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 34: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 34: Context - activePlayers=2, actedSeats=[0,1], currentBet=0, currentRound=FLOP, roundActions queried=2, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 34: Active players detail: [{"seatNumber":0,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true},{"seatNumber":1,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG checkAction] Hand 34: isBettingRoundComplete returned true
[DEBUG checkAction] Hand 34: Round complete, calling handleBettingRoundComplete
[DEBUG handleBettingRoundComplete] Hand 34: Called with currentRound=FLOP
[DEBUG handleBettingRoundComplete] Hand 34: Advancing from FLOP to next round
[DEBUG advanceBettingRound] Hand 34: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG advanceBettingRound] Hand 34: needsSidePots=false
[DEBUG advanceBettingRound] Hand 34: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG advanceBettingRound] Hand 34: Querying hand with: {"where":{"id":34},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG advanceBettingRound] Hand 34: Query result - hand.round=FLOP, players=2
[DEBUG advanceBettingRound] Hand 34: currentRound=FLOP, deckPosition=7, communityCards.length=3
[DEBUG advanceBettingRound] Hand 34: Advancing from FLOP to TURN, cardsToDeal=1
[DEBUG advanceBettingRound] Hand 34: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 34: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '0' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '0' }
]
[DEBUG advanceBettingRound] Hand 34: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 34: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 34: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 34: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 34: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG advanceBettingRound] Hand 34: Updating hand state: round=TURN, status=TURN, currentActionSeat=0, newCommunityCards.length=4
[DEBUG advanceBettingRound] Hand 34: Updating hand with: {"where":{"id":34},"data":{"round":"TURN","status":"TURN","communityCards":"[4 cards]","deckPosition":8,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG advanceBettingRound] Hand 34: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG advanceBettingRound] Hand 34: RETURNING false - Round advanced successfully from FLOP to TURN (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG handleBettingRoundComplete] Hand 34: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 34: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG handleBettingRoundComplete] Hand 34: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 34: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG checkAction] Hand 34: handleBettingRoundComplete returned handEnded=false, roundAdvanced=true
[DEBUG checkAction] Hand 34: RETURNING from transaction - Round complete
[DEBUG checkAction] Hand 34: Context - hand.round=FLOP, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG checkAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=34

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG checkAction] Hand 34: Player seat 0 checking in round TURN
[DEBUG checkAction] Hand 34: Creating CHECK action with: {"handId":34,"seatNumber":0,"round":"TURN","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG checkAction] Hand 34: CHECK action created successfully: {"id":174,"seatNumber":0,"action":"CHECK","round":"TURN","amount":null}
[DEBUG checkAction] Hand 34: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG checkAction] Hand 34: After CHECK by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 34: Starting check
[DEBUG isBettingRoundComplete] Hand 34: Querying hand with: {"where":{"id":34}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 34: Query result - hand={"id":34,"round":"TURN","currentBet":"0","currentActionSeat":0,"status":"TURN"}
[DEBUG isBettingRoundComplete] Hand 34: currentBet=0, currentRound=TURN
[DEBUG isBettingRoundComplete] Hand 34: Querying handPlayers with: {"where":{"handId":34}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 34: Query returned 2 handPlayers: [{"id":67,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":68,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 34: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 34: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 34: Querying roundActions with: {
  "where": {
    "handId": 34,
    "round": "TURN",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 34: Query returned 1 roundActions for round TURN: [{"id":174,"seatNumber":0,"action":"CHECK","round":"TURN"}]
[DEBUG isBettingRoundComplete] Hand 34: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 34: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 34: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 34: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 34: Context - actedSeats=[0], playerSeat=1, currentRound=TURN, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG checkAction] Hand 34: isBettingRoundComplete returned false
[DEBUG checkAction] Hand 34: Round not complete, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: Called with currentSeatNumber=0, currentRound=TURN

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: Querying hand with: {"where":{"id":34},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: Query result - hand.round=TURN, currentRound param=TURN, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: nextPlayer seat=1, chipsCommitted=0, currentBet=0
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: Zero-bet wrap-around, advancing to next player (will complete after they act)
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 34: Starting check
[DEBUG isBettingRoundComplete] Hand 34: Querying hand with: {"where":{"id":34}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 34: Query result - hand={"id":34,"round":"TURN","currentBet":"0","currentActionSeat":0,"status":"TURN"}
[DEBUG isBettingRoundComplete] Hand 34: currentBet=0, currentRound=TURN
[DEBUG isBettingRoundComplete] Hand 34: Querying handPlayers with: {"where":{"handId":34}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 34: Query returned 2 handPlayers: [{"id":67,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":68,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 34: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 34: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 34: Querying roundActions with: {
  "where": {
    "handId": 34,
    "round": "TURN",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 34: Query returned 1 roundActions for round TURN: [{"id":174,"seatNumber":0,"action":"CHECK","round":"TURN"}]
[DEBUG isBettingRoundComplete] Hand 34: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 34: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 34: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 34: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 34: Context - actedSeats=[0], playerSeat=1, currentRound=TURN, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: Updating hand with: {"where":{"id":34},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: Context - currentRound=TURN, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG checkAction] Hand 34: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=false
[DEBUG checkAction] Hand 34: RETURNING from transaction - Final result
[DEBUG checkAction] Hand 34: Context - hand.round=TURN, handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG checkAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=34

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG checkAction] Hand 34: Player seat 1 checking in round TURN
[DEBUG checkAction] Hand 34: Creating CHECK action with: {"handId":34,"seatNumber":1,"round":"TURN","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG checkAction] Hand 34: CHECK action created successfully: {"id":175,"seatNumber":1,"action":"CHECK","round":"TURN","amount":null}
[DEBUG checkAction] Hand 34: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG checkAction] Hand 34: After CHECK by seat 1, checking if round complete
[DEBUG isBettingRoundComplete] Hand 34: Starting check
[DEBUG isBettingRoundComplete] Hand 34: Querying hand with: {"where":{"id":34}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 34: Query result - hand={"id":34,"round":"TURN","currentBet":"0","currentActionSeat":1,"status":"TURN"}
[DEBUG isBettingRoundComplete] Hand 34: currentBet=0, currentRound=TURN
[DEBUG isBettingRoundComplete] Hand 34: Querying handPlayers with: {"where":{"handId":34}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 34: Query returned 2 handPlayers: [{"id":67,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":68,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 34: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 34: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 34: Querying roundActions with: {
  "where": {
    "handId": 34,
    "round": "TURN",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 34: Query returned 2 roundActions for round TURN: [{"id":174,"seatNumber":0,"action":"CHECK","round":"TURN"},{"id":175,"seatNumber":1,"action":"CHECK","round":"TURN"}]
[DEBUG isBettingRoundComplete] Hand 34: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 34: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 34: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 34: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 34: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 34: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 34: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 34: Context - activePlayers=2, actedSeats=[0,1], currentBet=0, currentRound=TURN, roundActions queried=2, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 34: Active players detail: [{"seatNumber":0,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true},{"seatNumber":1,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG checkAction] Hand 34: isBettingRoundComplete returned true
[DEBUG checkAction] Hand 34: Round complete, calling handleBettingRoundComplete
[DEBUG handleBettingRoundComplete] Hand 34: Called with currentRound=TURN
[DEBUG handleBettingRoundComplete] Hand 34: Advancing from TURN to next round
[DEBUG advanceBettingRound] Hand 34: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG advanceBettingRound] Hand 34: needsSidePots=false
[DEBUG advanceBettingRound] Hand 34: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG advanceBettingRound] Hand 34: Querying hand with: {"where":{"id":34},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG advanceBettingRound] Hand 34: Query result - hand.round=TURN, players=2
[DEBUG advanceBettingRound] Hand 34: currentRound=TURN, deckPosition=8, communityCards.length=4
[DEBUG advanceBettingRound] Hand 34: Advancing from TURN to RIVER, cardsToDeal=1
[DEBUG advanceBettingRound] Hand 34: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 34: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '0' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '0' }
]
[DEBUG advanceBettingRound] Hand 34: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 34: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 34: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 34: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 34: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG advanceBettingRound] Hand 34: Updating hand state: round=RIVER, status=RIVER, currentActionSeat=0, newCommunityCards.length=5
[DEBUG advanceBettingRound] Hand 34: Updating hand with: {"where":{"id":34},"data":{"round":"RIVER","status":"RIVER","communityCards":"[5 cards]","deckPosition":9,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG advanceBettingRound] Hand 34: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG advanceBettingRound] Hand 34: RETURNING false - Round advanced successfully from TURN to RIVER (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG handleBettingRoundComplete] Hand 34: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 34: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG handleBettingRoundComplete] Hand 34: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 34: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG checkAction] Hand 34: handleBettingRoundComplete returned handEnded=false, roundAdvanced=true
[DEBUG checkAction] Hand 34: RETURNING from transaction - Round complete
[DEBUG checkAction] Hand 34: Context - hand.round=TURN, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG checkAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=34

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG checkAction] Hand 34: Player seat 0 checking in round RIVER
[DEBUG checkAction] Hand 34: Creating CHECK action with: {"handId":34,"seatNumber":0,"round":"RIVER","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG checkAction] Hand 34: CHECK action created successfully: {"id":176,"seatNumber":0,"action":"CHECK","round":"RIVER","amount":null}
[DEBUG checkAction] Hand 34: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG checkAction] Hand 34: After CHECK by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 34: Starting check
[DEBUG isBettingRoundComplete] Hand 34: Querying hand with: {"where":{"id":34}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 34: Query result - hand={"id":34,"round":"RIVER","currentBet":"0","currentActionSeat":0,"status":"RIVER"}
[DEBUG isBettingRoundComplete] Hand 34: currentBet=0, currentRound=RIVER
[DEBUG isBettingRoundComplete] Hand 34: Querying handPlayers with: {"where":{"handId":34}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 34: Query returned 2 handPlayers: [{"id":67,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":68,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 34: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 34: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 34: Querying roundActions with: {
  "where": {
    "handId": 34,
    "round": "RIVER",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 34: Query returned 1 roundActions for round RIVER: [{"id":176,"seatNumber":0,"action":"CHECK","round":"RIVER"}]
[DEBUG isBettingRoundComplete] Hand 34: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 34: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 34: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 34: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 34: Context - actedSeats=[0], playerSeat=1, currentRound=RIVER, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG checkAction] Hand 34: isBettingRoundComplete returned false
[DEBUG checkAction] Hand 34: Round not complete, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: Called with currentSeatNumber=0, currentRound=RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: Querying hand with: {"where":{"id":34},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: Query result - hand.round=RIVER, currentRound param=RIVER, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: nextPlayer seat=1, chipsCommitted=0, currentBet=0
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: Zero-bet wrap-around, advancing to next player (will complete after they act)
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 34: Starting check
[DEBUG isBettingRoundComplete] Hand 34: Querying hand with: {"where":{"id":34}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 34: Query result - hand={"id":34,"round":"RIVER","currentBet":"0","currentActionSeat":0,"status":"RIVER"}
[DEBUG isBettingRoundComplete] Hand 34: currentBet=0, currentRound=RIVER
[DEBUG isBettingRoundComplete] Hand 34: Querying handPlayers with: {"where":{"handId":34}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 34: Query returned 2 handPlayers: [{"id":67,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":68,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 34: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 34: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 34: Querying roundActions with: {
  "where": {
    "handId": 34,
    "round": "RIVER",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 34: Query returned 1 roundActions for round RIVER: [{"id":176,"seatNumber":0,"action":"CHECK","round":"RIVER"}]
[DEBUG isBettingRoundComplete] Hand 34: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 34: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 34: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 34: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 34: Context - actedSeats=[0], playerSeat=1, currentRound=RIVER, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: Updating hand with: {"where":{"id":34},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 34: Context - currentRound=RIVER, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG checkAction] Hand 34: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=false
[DEBUG checkAction] Hand 34: RETURNING from transaction - Final result
[DEBUG checkAction] Hand 34: Context - hand.round=RIVER, handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG checkAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=34

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG checkAction] Hand 34: Player seat 1 checking in round RIVER
[DEBUG checkAction] Hand 34: Creating CHECK action with: {"handId":34,"seatNumber":1,"round":"RIVER","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG checkAction] Hand 34: CHECK action created successfully: {"id":177,"seatNumber":1,"action":"CHECK","round":"RIVER","amount":null}
[DEBUG checkAction] Hand 34: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG checkAction] Hand 34: After CHECK by seat 1, checking if round complete
[DEBUG isBettingRoundComplete] Hand 34: Starting check
[DEBUG isBettingRoundComplete] Hand 34: Querying hand with: {"where":{"id":34}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 34: Query result - hand={"id":34,"round":"RIVER","currentBet":"0","currentActionSeat":1,"status":"RIVER"}
[DEBUG isBettingRoundComplete] Hand 34: currentBet=0, currentRound=RIVER
[DEBUG isBettingRoundComplete] Hand 34: Querying handPlayers with: {"where":{"handId":34}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 34: Query returned 2 handPlayers: [{"id":67,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":68,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 34: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 34: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 34: Querying roundActions with: {
  "where": {
    "handId": 34,
    "round": "RIVER",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 34: Query returned 2 roundActions for round RIVER: [{"id":176,"seatNumber":0,"action":"CHECK","round":"RIVER"},{"id":177,"seatNumber":1,"action":"CHECK","round":"RIVER"}]
[DEBUG isBettingRoundComplete] Hand 34: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 34: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 34: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 34: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 34: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 34: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 34: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 34: Context - activePlayers=2, actedSeats=[0,1], currentBet=0, currentRound=RIVER, roundActions queried=2, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 34: Active players detail: [{"seatNumber":0,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true},{"seatNumber":1,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG checkAction] Hand 34: isBettingRoundComplete returned true
[DEBUG checkAction] Hand 34: Round complete, calling handleBettingRoundComplete
[DEBUG handleBettingRoundComplete] Hand 34: Called with currentRound=RIVER
[DEBUG handleBettingRoundComplete] Hand 34: RIVER round, settling hand via showdown

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG handleBettingRoundComplete] Hand 34: Hand settled, winnerSeatNumber=1
[DEBUG handleBettingRoundComplete] Hand 34: RETURNING result with settlement: handEnded=true, roundAdvanced=false, winnerSeatNumber=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG checkAction] Hand 34: handleBettingRoundComplete returned handEnded=true, roundAdvanced=false
[DEBUG checkAction] Hand 34: RETURNING from transaction - Round complete
[DEBUG checkAction] Hand 34: Context - hand.round=RIVER, handEnded=true, roundAdvanced=false, winnerSeatNumber=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown)
[DEBUG checkAction] RETURNING final result: handEnded=true, roundAdvanced=false, tableId=34

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG callAction] Hand 35: Player seat 0 calling 1000000 in round PRE_FLOP, currentBet=2000000, chipsCommitted before=1000000
[DEBUG callAction] Hand 35: Creating CALL action with: handId=35, seatNumber=0, round=PRE_FLOP, amount=1000000
[DEBUG createActionAndEvent] Hand 35: Creating action with: {"handId":35,"seatNumber":0,"round":"PRE_FLOP","action":"CALL","amount":"1000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG createActionAndEvent] Hand 35: Action created successfully: {"id":180,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"1000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG callAction] Hand 35: CALL action created successfully: {"id":180,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"1000000"}
[DEBUG callAction] Hand 35: CALL action created, chipsCommitted now=2000000

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG callAction] Hand 35: After CALL by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 35: Starting check
[DEBUG isBettingRoundComplete] Hand 35: Querying hand with: {"where":{"id":35}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 35: Query result - hand={"id":35,"round":"PRE_FLOP","currentBet":"2000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 35: currentBet=2000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 35: Querying handPlayers with: {"where":{"handId":35}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 35: Query returned 2 handPlayers: [{"id":69,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"id":70,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG isBettingRoundComplete] Hand 35: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 35: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 35: Querying roundActions with: {
  "where": {
    "handId": 35,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 35: Query returned 1 roundActions for round PRE_FLOP: [{"id":180,"seatNumber":0,"action":"CALL","amount":"1000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 35: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 35: Checking 2 active players against actedSeats and currentBet=2000000
[DEBUG isBettingRoundComplete] Hand 35: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=2000000, currentBet=2000000)
[DEBUG isBettingRoundComplete] Hand 35: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 35: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG callAction] Hand 35: isBettingRoundComplete returned false
[DEBUG callAction] Hand 35: Round not complete, checking auto-advance or next player

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG callAction] Hand 35: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: Called with currentSeatNumber=0, currentRound=PRE_FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: Querying hand with: {"where":{"id":35},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: Query result - hand.round=PRE_FLOP, currentRound param=PRE_FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: nextPlayer seat=1, chipsCommitted=2000000, currentBet=2000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: Next player has matched bet (currentBet > 0n), checking if all acted and matched
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: Querying roundActions with: {
  "where": {
    "handId": 35,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: Query returned 1 roundActions for round PRE_FLOP: [{"id":180,"seatNumber":0,"action":"CALL","amount":"1000000","round":"PRE_FLOP"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: allActivePlayers (2): [
  { seatNumber: 0, chipsCommitted: '2000000', status: 'ACTIVE' },
  { seatNumber: 1, chipsCommitted: '2000000', status: 'ACTIVE' }
]
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: Wrap-around check - allActed=false, allMatched=true, actedSeats=0, playersWhoHaventActed=1, onlyNextPlayerHaventActed=true
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: Round complete detected - RETURNING early with round completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: Context - allActed=false, onlyNextPlayerHaventActed=true, allMatched=true, currentRound=PRE_FLOP, nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: Context - allActivePlayers=[{"seat":0,"chipsCommitted":"2000000","status":"ACTIVE"},{"seat":1,"chipsCommitted":"2000000","status":"ACTIVE"}], actedSeats=[0], roundActions found=1
[DEBUG handleBettingRoundComplete] Hand 35: Called with currentRound=PRE_FLOP
[DEBUG handleBettingRoundComplete] Hand 35: Advancing from PRE_FLOP to next round
[DEBUG advanceBettingRound] Hand 35: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG advanceBettingRound] Hand 35: needsSidePots=false
[DEBUG advanceBettingRound] Hand 35: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG advanceBettingRound] Hand 35: Querying hand with: {"where":{"id":35},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG advanceBettingRound] Hand 35: Query result - hand.round=PRE_FLOP, players=2
[DEBUG advanceBettingRound] Hand 35: currentRound=PRE_FLOP, deckPosition=4, communityCards.length=0
[DEBUG advanceBettingRound] Hand 35: Advancing from PRE_FLOP to FLOP, cardsToDeal=3
[DEBUG advanceBettingRound] Hand 35: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 35: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '2000000' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '2000000' }
]
[DEBUG advanceBettingRound] Hand 35: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 35: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 35: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 35: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 35: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG advanceBettingRound] Hand 35: Updating hand state: round=FLOP, status=FLOP, currentActionSeat=0, newCommunityCards.length=3
[DEBUG advanceBettingRound] Hand 35: Updating hand with: {"where":{"id":35},"data":{"round":"FLOP","status":"FLOP","communityCards":"[3 cards]","deckPosition":7,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG advanceBettingRound] Hand 35: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG advanceBettingRound] Hand 35: RETURNING false - Round advanced successfully from PRE_FLOP to FLOP (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG handleBettingRoundComplete] Hand 35: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 35: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG handleBettingRoundComplete] Hand 35: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 35: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: RETURNING result from handleBettingRoundComplete: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG callAction] Hand 35: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=true
[DEBUG callAction] Hand 35: RETURNING from transaction - Final result
[DEBUG callAction] Hand 35: Context - hand.round=PRE_FLOP, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG callAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=35

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG checkAction] Hand 35: Player seat 0 checking in round FLOP
[DEBUG checkAction] Hand 35: Creating CHECK action with: {"handId":35,"seatNumber":0,"round":"FLOP","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG checkAction] Hand 35: CHECK action created successfully: {"id":181,"seatNumber":0,"action":"CHECK","round":"FLOP","amount":null}
[DEBUG checkAction] Hand 35: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG checkAction] Hand 35: After CHECK by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 35: Starting check
[DEBUG isBettingRoundComplete] Hand 35: Querying hand with: {"where":{"id":35}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 35: Query result - hand={"id":35,"round":"FLOP","currentBet":"0","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 35: currentBet=0, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 35: Querying handPlayers with: {"where":{"handId":35}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 35: Query returned 2 handPlayers: [{"id":69,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":70,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 35: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 35: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 35: Querying roundActions with: {
  "where": {
    "handId": 35,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 35: Query returned 1 roundActions for round FLOP: [{"id":181,"seatNumber":0,"action":"CHECK","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 35: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 35: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 35: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 35: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 35: Context - actedSeats=[0], playerSeat=1, currentRound=FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG checkAction] Hand 35: isBettingRoundComplete returned false
[DEBUG checkAction] Hand 35: Round not complete, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: Called with currentSeatNumber=0, currentRound=FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: Querying hand with: {"where":{"id":35},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: Query result - hand.round=FLOP, currentRound param=FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: nextPlayer seat=1, chipsCommitted=0, currentBet=0
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: Zero-bet wrap-around, advancing to next player (will complete after they act)
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 35: Starting check
[DEBUG isBettingRoundComplete] Hand 35: Querying hand with: {"where":{"id":35}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 35: Query result - hand={"id":35,"round":"FLOP","currentBet":"0","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 35: currentBet=0, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 35: Querying handPlayers with: {"where":{"handId":35}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 35: Query returned 2 handPlayers: [{"id":69,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":70,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 35: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 35: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 35: Querying roundActions with: {
  "where": {
    "handId": 35,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 35: Query returned 1 roundActions for round FLOP: [{"id":181,"seatNumber":0,"action":"CHECK","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 35: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 35: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 35: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 35: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 35: Context - actedSeats=[0], playerSeat=1, currentRound=FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: Updating hand with: {"where":{"id":35},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: Context - currentRound=FLOP, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG checkAction] Hand 35: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=false
[DEBUG checkAction] Hand 35: RETURNING from transaction - Final result
[DEBUG checkAction] Hand 35: Context - hand.round=FLOP, handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG checkAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=35

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG checkAction] Hand 35: Player seat 1 checking in round FLOP
[DEBUG checkAction] Hand 35: Creating CHECK action with: {"handId":35,"seatNumber":1,"round":"FLOP","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG checkAction] Hand 35: CHECK action created successfully: {"id":182,"seatNumber":1,"action":"CHECK","round":"FLOP","amount":null}
[DEBUG checkAction] Hand 35: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG checkAction] Hand 35: After CHECK by seat 1, checking if round complete
[DEBUG isBettingRoundComplete] Hand 35: Starting check
[DEBUG isBettingRoundComplete] Hand 35: Querying hand with: {"where":{"id":35}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 35: Query result - hand={"id":35,"round":"FLOP","currentBet":"0","currentActionSeat":1,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 35: currentBet=0, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 35: Querying handPlayers with: {"where":{"handId":35}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 35: Query returned 2 handPlayers: [{"id":69,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":70,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 35: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 35: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 35: Querying roundActions with: {
  "where": {
    "handId": 35,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 35: Query returned 2 roundActions for round FLOP: [{"id":181,"seatNumber":0,"action":"CHECK","round":"FLOP"},{"id":182,"seatNumber":1,"action":"CHECK","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 35: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 35: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 35: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 35: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 35: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 35: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 35: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 35: Context - activePlayers=2, actedSeats=[0,1], currentBet=0, currentRound=FLOP, roundActions queried=2, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 35: Active players detail: [{"seatNumber":0,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true},{"seatNumber":1,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG checkAction] Hand 35: isBettingRoundComplete returned true
[DEBUG checkAction] Hand 35: Round complete, calling handleBettingRoundComplete
[DEBUG handleBettingRoundComplete] Hand 35: Called with currentRound=FLOP
[DEBUG handleBettingRoundComplete] Hand 35: Advancing from FLOP to next round
[DEBUG advanceBettingRound] Hand 35: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG advanceBettingRound] Hand 35: needsSidePots=false
[DEBUG advanceBettingRound] Hand 35: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG advanceBettingRound] Hand 35: Querying hand with: {"where":{"id":35},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG advanceBettingRound] Hand 35: Query result - hand.round=FLOP, players=2
[DEBUG advanceBettingRound] Hand 35: currentRound=FLOP, deckPosition=7, communityCards.length=3
[DEBUG advanceBettingRound] Hand 35: Advancing from FLOP to TURN, cardsToDeal=1
[DEBUG advanceBettingRound] Hand 35: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 35: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '0' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '0' }
]
[DEBUG advanceBettingRound] Hand 35: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 35: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 35: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 35: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 35: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG advanceBettingRound] Hand 35: Updating hand state: round=TURN, status=TURN, currentActionSeat=0, newCommunityCards.length=4
[DEBUG advanceBettingRound] Hand 35: Updating hand with: {"where":{"id":35},"data":{"round":"TURN","status":"TURN","communityCards":"[4 cards]","deckPosition":8,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG advanceBettingRound] Hand 35: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG advanceBettingRound] Hand 35: RETURNING false - Round advanced successfully from FLOP to TURN (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG handleBettingRoundComplete] Hand 35: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 35: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG handleBettingRoundComplete] Hand 35: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 35: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG checkAction] Hand 35: handleBettingRoundComplete returned handEnded=false, roundAdvanced=true
[DEBUG checkAction] Hand 35: RETURNING from transaction - Round complete
[DEBUG checkAction] Hand 35: Context - hand.round=FLOP, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG checkAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=35

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG checkAction] Hand 35: Player seat 0 checking in round TURN
[DEBUG checkAction] Hand 35: Creating CHECK action with: {"handId":35,"seatNumber":0,"round":"TURN","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG checkAction] Hand 35: CHECK action created successfully: {"id":183,"seatNumber":0,"action":"CHECK","round":"TURN","amount":null}
[DEBUG checkAction] Hand 35: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG checkAction] Hand 35: After CHECK by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 35: Starting check
[DEBUG isBettingRoundComplete] Hand 35: Querying hand with: {"where":{"id":35}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 35: Query result - hand={"id":35,"round":"TURN","currentBet":"0","currentActionSeat":0,"status":"TURN"}
[DEBUG isBettingRoundComplete] Hand 35: currentBet=0, currentRound=TURN
[DEBUG isBettingRoundComplete] Hand 35: Querying handPlayers with: {"where":{"handId":35}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 35: Query returned 2 handPlayers: [{"id":69,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":70,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 35: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 35: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 35: Querying roundActions with: {
  "where": {
    "handId": 35,
    "round": "TURN",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 35: Query returned 1 roundActions for round TURN: [{"id":183,"seatNumber":0,"action":"CHECK","round":"TURN"}]
[DEBUG isBettingRoundComplete] Hand 35: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 35: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 35: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 35: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 35: Context - actedSeats=[0], playerSeat=1, currentRound=TURN, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG checkAction] Hand 35: isBettingRoundComplete returned false
[DEBUG checkAction] Hand 35: Round not complete, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: Called with currentSeatNumber=0, currentRound=TURN

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: Querying hand with: {"where":{"id":35},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: Query result - hand.round=TURN, currentRound param=TURN, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: nextPlayer seat=1, chipsCommitted=0, currentBet=0
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: Zero-bet wrap-around, advancing to next player (will complete after they act)
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 35: Starting check
[DEBUG isBettingRoundComplete] Hand 35: Querying hand with: {"where":{"id":35}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 35: Query result - hand={"id":35,"round":"TURN","currentBet":"0","currentActionSeat":0,"status":"TURN"}
[DEBUG isBettingRoundComplete] Hand 35: currentBet=0, currentRound=TURN
[DEBUG isBettingRoundComplete] Hand 35: Querying handPlayers with: {"where":{"handId":35}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 35: Query returned 2 handPlayers: [{"id":69,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":70,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 35: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 35: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 35: Querying roundActions with: {
  "where": {
    "handId": 35,
    "round": "TURN",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 35: Query returned 1 roundActions for round TURN: [{"id":183,"seatNumber":0,"action":"CHECK","round":"TURN"}]
[DEBUG isBettingRoundComplete] Hand 35: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 35: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 35: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 35: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 35: Context - actedSeats=[0], playerSeat=1, currentRound=TURN, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: Updating hand with: {"where":{"id":35},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: Context - currentRound=TURN, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG checkAction] Hand 35: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=false
[DEBUG checkAction] Hand 35: RETURNING from transaction - Final result
[DEBUG checkAction] Hand 35: Context - hand.round=TURN, handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG checkAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=35

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG checkAction] Hand 35: Player seat 1 checking in round TURN
[DEBUG checkAction] Hand 35: Creating CHECK action with: {"handId":35,"seatNumber":1,"round":"TURN","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG checkAction] Hand 35: CHECK action created successfully: {"id":184,"seatNumber":1,"action":"CHECK","round":"TURN","amount":null}
[DEBUG checkAction] Hand 35: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG checkAction] Hand 35: After CHECK by seat 1, checking if round complete
[DEBUG isBettingRoundComplete] Hand 35: Starting check
[DEBUG isBettingRoundComplete] Hand 35: Querying hand with: {"where":{"id":35}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 35: Query result - hand={"id":35,"round":"TURN","currentBet":"0","currentActionSeat":1,"status":"TURN"}
[DEBUG isBettingRoundComplete] Hand 35: currentBet=0, currentRound=TURN
[DEBUG isBettingRoundComplete] Hand 35: Querying handPlayers with: {"where":{"handId":35}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 35: Query returned 2 handPlayers: [{"id":69,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":70,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 35: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 35: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 35: Querying roundActions with: {
  "where": {
    "handId": 35,
    "round": "TURN",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 35: Query returned 2 roundActions for round TURN: [{"id":183,"seatNumber":0,"action":"CHECK","round":"TURN"},{"id":184,"seatNumber":1,"action":"CHECK","round":"TURN"}]
[DEBUG isBettingRoundComplete] Hand 35: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 35: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 35: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 35: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 35: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 35: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 35: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 35: Context - activePlayers=2, actedSeats=[0,1], currentBet=0, currentRound=TURN, roundActions queried=2, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 35: Active players detail: [{"seatNumber":0,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true},{"seatNumber":1,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG checkAction] Hand 35: isBettingRoundComplete returned true
[DEBUG checkAction] Hand 35: Round complete, calling handleBettingRoundComplete
[DEBUG handleBettingRoundComplete] Hand 35: Called with currentRound=TURN
[DEBUG handleBettingRoundComplete] Hand 35: Advancing from TURN to next round
[DEBUG advanceBettingRound] Hand 35: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG advanceBettingRound] Hand 35: needsSidePots=false
[DEBUG advanceBettingRound] Hand 35: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG advanceBettingRound] Hand 35: Querying hand with: {"where":{"id":35},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG advanceBettingRound] Hand 35: Query result - hand.round=TURN, players=2
[DEBUG advanceBettingRound] Hand 35: currentRound=TURN, deckPosition=8, communityCards.length=4
[DEBUG advanceBettingRound] Hand 35: Advancing from TURN to RIVER, cardsToDeal=1
[DEBUG advanceBettingRound] Hand 35: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 35: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '0' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '0' }
]
[DEBUG advanceBettingRound] Hand 35: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 35: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 35: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 35: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 35: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG advanceBettingRound] Hand 35: Updating hand state: round=RIVER, status=RIVER, currentActionSeat=0, newCommunityCards.length=5
[DEBUG advanceBettingRound] Hand 35: Updating hand with: {"where":{"id":35},"data":{"round":"RIVER","status":"RIVER","communityCards":"[5 cards]","deckPosition":9,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG advanceBettingRound] Hand 35: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG advanceBettingRound] Hand 35: RETURNING false - Round advanced successfully from TURN to RIVER (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG handleBettingRoundComplete] Hand 35: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 35: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG handleBettingRoundComplete] Hand 35: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 35: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG checkAction] Hand 35: handleBettingRoundComplete returned handEnded=false, roundAdvanced=true
[DEBUG checkAction] Hand 35: RETURNING from transaction - Round complete
[DEBUG checkAction] Hand 35: Context - hand.round=TURN, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG checkAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=35

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG checkAction] Hand 35: Player seat 0 checking in round RIVER
[DEBUG checkAction] Hand 35: Creating CHECK action with: {"handId":35,"seatNumber":0,"round":"RIVER","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG checkAction] Hand 35: CHECK action created successfully: {"id":185,"seatNumber":0,"action":"CHECK","round":"RIVER","amount":null}
[DEBUG checkAction] Hand 35: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG checkAction] Hand 35: After CHECK by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 35: Starting check
[DEBUG isBettingRoundComplete] Hand 35: Querying hand with: {"where":{"id":35}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 35: Query result - hand={"id":35,"round":"RIVER","currentBet":"0","currentActionSeat":0,"status":"RIVER"}
[DEBUG isBettingRoundComplete] Hand 35: currentBet=0, currentRound=RIVER
[DEBUG isBettingRoundComplete] Hand 35: Querying handPlayers with: {"where":{"handId":35}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 35: Query returned 2 handPlayers: [{"id":69,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":70,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 35: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 35: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 35: Querying roundActions with: {
  "where": {
    "handId": 35,
    "round": "RIVER",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 35: Query returned 1 roundActions for round RIVER: [{"id":185,"seatNumber":0,"action":"CHECK","round":"RIVER"}]
[DEBUG isBettingRoundComplete] Hand 35: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 35: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 35: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 35: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 35: Context - actedSeats=[0], playerSeat=1, currentRound=RIVER, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG checkAction] Hand 35: isBettingRoundComplete returned false
[DEBUG checkAction] Hand 35: Round not complete, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: Called with currentSeatNumber=0, currentRound=RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: Querying hand with: {"where":{"id":35},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: Query result - hand.round=RIVER, currentRound param=RIVER, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: nextPlayer seat=1, chipsCommitted=0, currentBet=0
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: Zero-bet wrap-around, advancing to next player (will complete after they act)
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 35: Starting check
[DEBUG isBettingRoundComplete] Hand 35: Querying hand with: {"where":{"id":35}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 35: Query result - hand={"id":35,"round":"RIVER","currentBet":"0","currentActionSeat":0,"status":"RIVER"}
[DEBUG isBettingRoundComplete] Hand 35: currentBet=0, currentRound=RIVER
[DEBUG isBettingRoundComplete] Hand 35: Querying handPlayers with: {"where":{"handId":35}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 35: Query returned 2 handPlayers: [{"id":69,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":70,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 35: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 35: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 35: Querying roundActions with: {
  "where": {
    "handId": 35,
    "round": "RIVER",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 35: Query returned 1 roundActions for round RIVER: [{"id":185,"seatNumber":0,"action":"CHECK","round":"RIVER"}]
[DEBUG isBettingRoundComplete] Hand 35: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 35: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 35: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 35: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 35: Context - actedSeats=[0], playerSeat=1, currentRound=RIVER, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: Updating hand with: {"where":{"id":35},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 35: Context - currentRound=RIVER, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG checkAction] Hand 35: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=false
[DEBUG checkAction] Hand 35: RETURNING from transaction - Final result
[DEBUG checkAction] Hand 35: Context - hand.round=RIVER, handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG checkAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=35

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG checkAction] Hand 35: Player seat 1 checking in round RIVER
[DEBUG checkAction] Hand 35: Creating CHECK action with: {"handId":35,"seatNumber":1,"round":"RIVER","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG checkAction] Hand 35: CHECK action created successfully: {"id":186,"seatNumber":1,"action":"CHECK","round":"RIVER","amount":null}
[DEBUG checkAction] Hand 35: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG checkAction] Hand 35: After CHECK by seat 1, checking if round complete
[DEBUG isBettingRoundComplete] Hand 35: Starting check
[DEBUG isBettingRoundComplete] Hand 35: Querying hand with: {"where":{"id":35}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 35: Query result - hand={"id":35,"round":"RIVER","currentBet":"0","currentActionSeat":1,"status":"RIVER"}
[DEBUG isBettingRoundComplete] Hand 35: currentBet=0, currentRound=RIVER
[DEBUG isBettingRoundComplete] Hand 35: Querying handPlayers with: {"where":{"handId":35}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 35: Query returned 2 handPlayers: [{"id":69,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":70,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 35: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 35: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 35: Querying roundActions with: {
  "where": {
    "handId": 35,
    "round": "RIVER",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 35: Query returned 2 roundActions for round RIVER: [{"id":185,"seatNumber":0,"action":"CHECK","round":"RIVER"},{"id":186,"seatNumber":1,"action":"CHECK","round":"RIVER"}]
[DEBUG isBettingRoundComplete] Hand 35: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 35: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 35: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 35: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 35: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 35: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 35: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 35: Context - activePlayers=2, actedSeats=[0,1], currentBet=0, currentRound=RIVER, roundActions queried=2, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 35: Active players detail: [{"seatNumber":0,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true},{"seatNumber":1,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG checkAction] Hand 35: isBettingRoundComplete returned true
[DEBUG checkAction] Hand 35: Round complete, calling handleBettingRoundComplete
[DEBUG handleBettingRoundComplete] Hand 35: Called with currentRound=RIVER
[DEBUG handleBettingRoundComplete] Hand 35: RIVER round, settling hand via showdown

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
ðŸ’° Added rake 280000 gwei to TEE balance (hand 35)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG handleBettingRoundComplete] Hand 35: Hand settled, winnerSeatNumber=0
[DEBUG handleBettingRoundComplete] Hand 35: RETURNING result with settlement: handEnded=true, roundAdvanced=false, winnerSeatNumber=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG checkAction] Hand 35: handleBettingRoundComplete returned handEnded=true, roundAdvanced=false
[DEBUG checkAction] Hand 35: RETURNING from transaction - Round complete
[DEBUG checkAction] Hand 35: Context - hand.round=RIVER, handEnded=true, roundAdvanced=false, winnerSeatNumber=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-001: Check-Check on River (Showdown) - 700 bps rake
[DEBUG checkAction] RETURNING final result: handEnded=true, roundAdvanced=false, tableId=35

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG callAction] Hand 36: Player seat 0 calling 1000000 in round PRE_FLOP, currentBet=2000000, chipsCommitted before=1000000
[DEBUG callAction] Hand 36: Creating CALL action with: handId=36, seatNumber=0, round=PRE_FLOP, amount=1000000
[DEBUG createActionAndEvent] Hand 36: Creating action with: {"handId":36,"seatNumber":0,"round":"PRE_FLOP","action":"CALL","amount":"1000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG createActionAndEvent] Hand 36: Action created successfully: {"id":189,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"1000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG callAction] Hand 36: CALL action created successfully: {"id":189,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"1000000"}
[DEBUG callAction] Hand 36: CALL action created, chipsCommitted now=2000000

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG callAction] Hand 36: After CALL by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 36: Starting check
[DEBUG isBettingRoundComplete] Hand 36: Querying hand with: {"where":{"id":36}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 36: Query result - hand={"id":36,"round":"PRE_FLOP","currentBet":"2000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 36: currentBet=2000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 36: Querying handPlayers with: {"where":{"handId":36}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 36: Query returned 2 handPlayers: [{"id":71,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"id":72,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG isBettingRoundComplete] Hand 36: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 36: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 36: Querying roundActions with: {
  "where": {
    "handId": 36,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 36: Query returned 1 roundActions for round PRE_FLOP: [{"id":189,"seatNumber":0,"action":"CALL","amount":"1000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 36: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 36: Checking 2 active players against actedSeats and currentBet=2000000
[DEBUG isBettingRoundComplete] Hand 36: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=2000000, currentBet=2000000)
[DEBUG isBettingRoundComplete] Hand 36: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 36: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG callAction] Hand 36: isBettingRoundComplete returned false
[DEBUG callAction] Hand 36: Round not complete, checking auto-advance or next player

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG callAction] Hand 36: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: Called with currentSeatNumber=0, currentRound=PRE_FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: Querying hand with: {"where":{"id":36},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: Query result - hand.round=PRE_FLOP, currentRound param=PRE_FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: nextPlayer seat=1, chipsCommitted=2000000, currentBet=2000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: Next player has matched bet (currentBet > 0n), checking if all acted and matched
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: Querying roundActions with: {
  "where": {
    "handId": 36,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: Query returned 1 roundActions for round PRE_FLOP: [{"id":189,"seatNumber":0,"action":"CALL","amount":"1000000","round":"PRE_FLOP"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: allActivePlayers (2): [
  { seatNumber: 0, chipsCommitted: '2000000', status: 'ACTIVE' },
  { seatNumber: 1, chipsCommitted: '2000000', status: 'ACTIVE' }
]
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: Wrap-around check - allActed=false, allMatched=true, actedSeats=0, playersWhoHaventActed=1, onlyNextPlayerHaventActed=true
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: Round complete detected - RETURNING early with round completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: Context - allActed=false, onlyNextPlayerHaventActed=true, allMatched=true, currentRound=PRE_FLOP, nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: Context - allActivePlayers=[{"seat":0,"chipsCommitted":"2000000","status":"ACTIVE"},{"seat":1,"chipsCommitted":"2000000","status":"ACTIVE"}], actedSeats=[0], roundActions found=1
[DEBUG handleBettingRoundComplete] Hand 36: Called with currentRound=PRE_FLOP
[DEBUG handleBettingRoundComplete] Hand 36: Advancing from PRE_FLOP to next round
[DEBUG advanceBettingRound] Hand 36: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG advanceBettingRound] Hand 36: needsSidePots=false
[DEBUG advanceBettingRound] Hand 36: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG advanceBettingRound] Hand 36: Querying hand with: {"where":{"id":36},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG advanceBettingRound] Hand 36: Query result - hand.round=PRE_FLOP, players=2
[DEBUG advanceBettingRound] Hand 36: currentRound=PRE_FLOP, deckPosition=4, communityCards.length=0
[DEBUG advanceBettingRound] Hand 36: Advancing from PRE_FLOP to FLOP, cardsToDeal=3
[DEBUG advanceBettingRound] Hand 36: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 36: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '2000000' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '2000000' }
]
[DEBUG advanceBettingRound] Hand 36: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 36: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 36: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 36: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 36: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG advanceBettingRound] Hand 36: Updating hand state: round=FLOP, status=FLOP, currentActionSeat=0, newCommunityCards.length=3
[DEBUG advanceBettingRound] Hand 36: Updating hand with: {"where":{"id":36},"data":{"round":"FLOP","status":"FLOP","communityCards":"[3 cards]","deckPosition":7,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG advanceBettingRound] Hand 36: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG advanceBettingRound] Hand 36: RETURNING false - Round advanced successfully from PRE_FLOP to FLOP (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG handleBettingRoundComplete] Hand 36: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 36: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG handleBettingRoundComplete] Hand 36: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 36: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: RETURNING result from handleBettingRoundComplete: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG callAction] Hand 36: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=true
[DEBUG callAction] Hand 36: RETURNING from transaction - Final result
[DEBUG callAction] Hand 36: Context - hand.round=PRE_FLOP, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG callAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=36

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG checkAction] Hand 36: Player seat 0 checking in round FLOP
[DEBUG checkAction] Hand 36: Creating CHECK action with: {"handId":36,"seatNumber":0,"round":"FLOP","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG checkAction] Hand 36: CHECK action created successfully: {"id":190,"seatNumber":0,"action":"CHECK","round":"FLOP","amount":null}
[DEBUG checkAction] Hand 36: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG checkAction] Hand 36: After CHECK by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 36: Starting check
[DEBUG isBettingRoundComplete] Hand 36: Querying hand with: {"where":{"id":36}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 36: Query result - hand={"id":36,"round":"FLOP","currentBet":"0","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 36: currentBet=0, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 36: Querying handPlayers with: {"where":{"handId":36}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 36: Query returned 2 handPlayers: [{"id":71,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":72,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 36: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 36: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 36: Querying roundActions with: {
  "where": {
    "handId": 36,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 36: Query returned 1 roundActions for round FLOP: [{"id":190,"seatNumber":0,"action":"CHECK","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 36: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 36: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 36: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 36: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 36: Context - actedSeats=[0], playerSeat=1, currentRound=FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG checkAction] Hand 36: isBettingRoundComplete returned false
[DEBUG checkAction] Hand 36: Round not complete, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: Called with currentSeatNumber=0, currentRound=FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: Querying hand with: {"where":{"id":36},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: Query result - hand.round=FLOP, currentRound param=FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: nextPlayer seat=1, chipsCommitted=0, currentBet=0
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: Zero-bet wrap-around, advancing to next player (will complete after they act)
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 36: Starting check
[DEBUG isBettingRoundComplete] Hand 36: Querying hand with: {"where":{"id":36}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 36: Query result - hand={"id":36,"round":"FLOP","currentBet":"0","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 36: currentBet=0, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 36: Querying handPlayers with: {"where":{"handId":36}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 36: Query returned 2 handPlayers: [{"id":71,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":72,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 36: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 36: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 36: Querying roundActions with: {
  "where": {
    "handId": 36,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 36: Query returned 1 roundActions for round FLOP: [{"id":190,"seatNumber":0,"action":"CHECK","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 36: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 36: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 36: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 36: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 36: Context - actedSeats=[0], playerSeat=1, currentRound=FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: Updating hand with: {"where":{"id":36},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: Context - currentRound=FLOP, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG checkAction] Hand 36: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=false
[DEBUG checkAction] Hand 36: RETURNING from transaction - Final result
[DEBUG checkAction] Hand 36: Context - hand.round=FLOP, handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG checkAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=36

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG checkAction] Hand 36: Player seat 1 checking in round FLOP
[DEBUG checkAction] Hand 36: Creating CHECK action with: {"handId":36,"seatNumber":1,"round":"FLOP","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG checkAction] Hand 36: CHECK action created successfully: {"id":191,"seatNumber":1,"action":"CHECK","round":"FLOP","amount":null}
[DEBUG checkAction] Hand 36: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG checkAction] Hand 36: After CHECK by seat 1, checking if round complete
[DEBUG isBettingRoundComplete] Hand 36: Starting check
[DEBUG isBettingRoundComplete] Hand 36: Querying hand with: {"where":{"id":36}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 36: Query result - hand={"id":36,"round":"FLOP","currentBet":"0","currentActionSeat":1,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 36: currentBet=0, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 36: Querying handPlayers with: {"where":{"handId":36}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 36: Query returned 2 handPlayers: [{"id":71,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":72,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 36: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 36: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 36: Querying roundActions with: {
  "where": {
    "handId": 36,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 36: Query returned 2 roundActions for round FLOP: [{"id":190,"seatNumber":0,"action":"CHECK","round":"FLOP"},{"id":191,"seatNumber":1,"action":"CHECK","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 36: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 36: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 36: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 36: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 36: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 36: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 36: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 36: Context - activePlayers=2, actedSeats=[0,1], currentBet=0, currentRound=FLOP, roundActions queried=2, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 36: Active players detail: [{"seatNumber":0,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true},{"seatNumber":1,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG checkAction] Hand 36: isBettingRoundComplete returned true
[DEBUG checkAction] Hand 36: Round complete, calling handleBettingRoundComplete
[DEBUG handleBettingRoundComplete] Hand 36: Called with currentRound=FLOP
[DEBUG handleBettingRoundComplete] Hand 36: Advancing from FLOP to next round
[DEBUG advanceBettingRound] Hand 36: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG advanceBettingRound] Hand 36: needsSidePots=false
[DEBUG advanceBettingRound] Hand 36: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG advanceBettingRound] Hand 36: Querying hand with: {"where":{"id":36},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG advanceBettingRound] Hand 36: Query result - hand.round=FLOP, players=2
[DEBUG advanceBettingRound] Hand 36: currentRound=FLOP, deckPosition=7, communityCards.length=3
[DEBUG advanceBettingRound] Hand 36: Advancing from FLOP to TURN, cardsToDeal=1
[DEBUG advanceBettingRound] Hand 36: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 36: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '0' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '0' }
]
[DEBUG advanceBettingRound] Hand 36: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 36: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 36: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 36: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 36: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG advanceBettingRound] Hand 36: Updating hand state: round=TURN, status=TURN, currentActionSeat=0, newCommunityCards.length=4
[DEBUG advanceBettingRound] Hand 36: Updating hand with: {"where":{"id":36},"data":{"round":"TURN","status":"TURN","communityCards":"[4 cards]","deckPosition":8,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG advanceBettingRound] Hand 36: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG advanceBettingRound] Hand 36: RETURNING false - Round advanced successfully from FLOP to TURN (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG handleBettingRoundComplete] Hand 36: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 36: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG handleBettingRoundComplete] Hand 36: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 36: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG checkAction] Hand 36: handleBettingRoundComplete returned handEnded=false, roundAdvanced=true
[DEBUG checkAction] Hand 36: RETURNING from transaction - Round complete
[DEBUG checkAction] Hand 36: Context - hand.round=FLOP, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG checkAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=36

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG checkAction] Hand 36: Player seat 0 checking in round TURN
[DEBUG checkAction] Hand 36: Creating CHECK action with: {"handId":36,"seatNumber":0,"round":"TURN","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG checkAction] Hand 36: CHECK action created successfully: {"id":192,"seatNumber":0,"action":"CHECK","round":"TURN","amount":null}
[DEBUG checkAction] Hand 36: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG checkAction] Hand 36: After CHECK by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 36: Starting check
[DEBUG isBettingRoundComplete] Hand 36: Querying hand with: {"where":{"id":36}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 36: Query result - hand={"id":36,"round":"TURN","currentBet":"0","currentActionSeat":0,"status":"TURN"}
[DEBUG isBettingRoundComplete] Hand 36: currentBet=0, currentRound=TURN
[DEBUG isBettingRoundComplete] Hand 36: Querying handPlayers with: {"where":{"handId":36}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 36: Query returned 2 handPlayers: [{"id":71,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":72,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 36: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 36: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 36: Querying roundActions with: {
  "where": {
    "handId": 36,
    "round": "TURN",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 36: Query returned 1 roundActions for round TURN: [{"id":192,"seatNumber":0,"action":"CHECK","round":"TURN"}]
[DEBUG isBettingRoundComplete] Hand 36: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 36: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 36: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 36: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 36: Context - actedSeats=[0], playerSeat=1, currentRound=TURN, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG checkAction] Hand 36: isBettingRoundComplete returned false
[DEBUG checkAction] Hand 36: Round not complete, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: Called with currentSeatNumber=0, currentRound=TURN

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: Querying hand with: {"where":{"id":36},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: Query result - hand.round=TURN, currentRound param=TURN, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: nextPlayer seat=1, chipsCommitted=0, currentBet=0
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: Zero-bet wrap-around, advancing to next player (will complete after they act)
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 36: Starting check
[DEBUG isBettingRoundComplete] Hand 36: Querying hand with: {"where":{"id":36}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 36: Query result - hand={"id":36,"round":"TURN","currentBet":"0","currentActionSeat":0,"status":"TURN"}
[DEBUG isBettingRoundComplete] Hand 36: currentBet=0, currentRound=TURN
[DEBUG isBettingRoundComplete] Hand 36: Querying handPlayers with: {"where":{"handId":36}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 36: Query returned 2 handPlayers: [{"id":71,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":72,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 36: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 36: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 36: Querying roundActions with: {
  "where": {
    "handId": 36,
    "round": "TURN",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 36: Query returned 1 roundActions for round TURN: [{"id":192,"seatNumber":0,"action":"CHECK","round":"TURN"}]
[DEBUG isBettingRoundComplete] Hand 36: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 36: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 36: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 36: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 36: Context - actedSeats=[0], playerSeat=1, currentRound=TURN, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: Updating hand with: {"where":{"id":36},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: Context - currentRound=TURN, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG checkAction] Hand 36: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=false
[DEBUG checkAction] Hand 36: RETURNING from transaction - Final result
[DEBUG checkAction] Hand 36: Context - hand.round=TURN, handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG checkAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=36

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG checkAction] Hand 36: Player seat 1 checking in round TURN
[DEBUG checkAction] Hand 36: Creating CHECK action with: {"handId":36,"seatNumber":1,"round":"TURN","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG checkAction] Hand 36: CHECK action created successfully: {"id":193,"seatNumber":1,"action":"CHECK","round":"TURN","amount":null}
[DEBUG checkAction] Hand 36: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG checkAction] Hand 36: After CHECK by seat 1, checking if round complete
[DEBUG isBettingRoundComplete] Hand 36: Starting check
[DEBUG isBettingRoundComplete] Hand 36: Querying hand with: {"where":{"id":36}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 36: Query result - hand={"id":36,"round":"TURN","currentBet":"0","currentActionSeat":1,"status":"TURN"}
[DEBUG isBettingRoundComplete] Hand 36: currentBet=0, currentRound=TURN
[DEBUG isBettingRoundComplete] Hand 36: Querying handPlayers with: {"where":{"handId":36}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 36: Query returned 2 handPlayers: [{"id":71,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":72,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 36: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 36: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 36: Querying roundActions with: {
  "where": {
    "handId": 36,
    "round": "TURN",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 36: Query returned 2 roundActions for round TURN: [{"id":192,"seatNumber":0,"action":"CHECK","round":"TURN"},{"id":193,"seatNumber":1,"action":"CHECK","round":"TURN"}]
[DEBUG isBettingRoundComplete] Hand 36: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 36: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 36: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 36: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 36: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 36: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 36: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 36: Context - activePlayers=2, actedSeats=[0,1], currentBet=0, currentRound=TURN, roundActions queried=2, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 36: Active players detail: [{"seatNumber":0,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true},{"seatNumber":1,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG checkAction] Hand 36: isBettingRoundComplete returned true
[DEBUG checkAction] Hand 36: Round complete, calling handleBettingRoundComplete
[DEBUG handleBettingRoundComplete] Hand 36: Called with currentRound=TURN
[DEBUG handleBettingRoundComplete] Hand 36: Advancing from TURN to next round
[DEBUG advanceBettingRound] Hand 36: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG advanceBettingRound] Hand 36: needsSidePots=false
[DEBUG advanceBettingRound] Hand 36: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG advanceBettingRound] Hand 36: Querying hand with: {"where":{"id":36},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG advanceBettingRound] Hand 36: Query result - hand.round=TURN, players=2
[DEBUG advanceBettingRound] Hand 36: currentRound=TURN, deckPosition=8, communityCards.length=4
[DEBUG advanceBettingRound] Hand 36: Advancing from TURN to RIVER, cardsToDeal=1
[DEBUG advanceBettingRound] Hand 36: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 36: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '0' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '0' }
]
[DEBUG advanceBettingRound] Hand 36: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 36: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 36: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 36: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 36: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG advanceBettingRound] Hand 36: Updating hand state: round=RIVER, status=RIVER, currentActionSeat=0, newCommunityCards.length=5
[DEBUG advanceBettingRound] Hand 36: Updating hand with: {"where":{"id":36},"data":{"round":"RIVER","status":"RIVER","communityCards":"[5 cards]","deckPosition":9,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG advanceBettingRound] Hand 36: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG advanceBettingRound] Hand 36: RETURNING false - Round advanced successfully from TURN to RIVER (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG handleBettingRoundComplete] Hand 36: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 36: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG handleBettingRoundComplete] Hand 36: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 36: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG checkAction] Hand 36: handleBettingRoundComplete returned handEnded=false, roundAdvanced=true
[DEBUG checkAction] Hand 36: RETURNING from transaction - Round complete
[DEBUG checkAction] Hand 36: Context - hand.round=TURN, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG checkAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=36

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG betAction] Hand 36: Player seat 0 betting 5000000 in round RIVER, currentBet before=0, chipsCommitted before=0, isAllIn=false
[DEBUG betAction] Hand 36: Creating BET action - hand.round=RIVER, actionType=RAISE, eventActionType=BET
[DEBUG createActionAndEvent] Hand 36: Creating action with: {"handId":36,"seatNumber":0,"round":"RIVER","action":"RAISE","amount":"5000000","handRound":"RIVER","roundParam":"RIVER","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG createActionAndEvent] Hand 36: Action created successfully: {"id":194,"seatNumber":0,"action":"RAISE","round":"RIVER","amount":"5000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG betAction] Hand 36: BET action created successfully, checking if round complete
[DEBUG betAction] Hand 36: Checking if betting round complete after BET
[DEBUG betAction] Hand 36: Context before isBettingRoundComplete - hand.round=RIVER, currentBet=0, currentActionSeat=0
[DEBUG isBettingRoundComplete] Hand 36: Starting check
[DEBUG isBettingRoundComplete] Hand 36: Querying hand with: {"where":{"id":36}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 36: Query result - hand={"id":36,"round":"RIVER","currentBet":"5000000","currentActionSeat":0,"status":"RIVER"}
[DEBUG isBettingRoundComplete] Hand 36: currentBet=5000000, currentRound=RIVER
[DEBUG isBettingRoundComplete] Hand 36: Querying handPlayers with: {"where":{"handId":36}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 36: Query returned 2 handPlayers: [{"id":71,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"5000000"},{"id":72,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 36: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 36: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 36: Querying roundActions with: {
  "where": {
    "handId": 36,
    "round": "RIVER",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 36: Query returned 1 roundActions for round RIVER: [{"id":194,"seatNumber":0,"action":"RAISE","amount":"5000000","round":"RIVER"}]
[DEBUG isBettingRoundComplete] Hand 36: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 36: Checking 2 active players against actedSeats and currentBet=5000000
[DEBUG isBettingRoundComplete] Hand 36: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=5000000, currentBet=5000000)
[DEBUG isBettingRoundComplete] Hand 36: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 36: Context - actedSeats=[0], playerSeat=1, currentRound=RIVER, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG betAction] Hand 36: isBettingRoundComplete returned false
[DEBUG handleBettingActionCompletion] Hand 36: Called with currentSeatNumber=0, currentRound=RIVER, bettingRoundComplete=false, isAllIn=false
[DEBUG handleBettingActionCompletion] Hand 36: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: Called with currentSeatNumber=0, currentRound=RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: Querying hand with: {"where":{"id":36},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: Query result - hand.round=RIVER, currentRound param=RIVER, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"5000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: nextPlayer seat=1, chipsCommitted=0, currentBet=5000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: Next player hasn't matched (chipsCommitted=0, currentBet=5000000)
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 36: Starting check
[DEBUG isBettingRoundComplete] Hand 36: Querying hand with: {"where":{"id":36}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 36: Query result - hand={"id":36,"round":"RIVER","currentBet":"5000000","currentActionSeat":0,"status":"RIVER"}
[DEBUG isBettingRoundComplete] Hand 36: currentBet=5000000, currentRound=RIVER
[DEBUG isBettingRoundComplete] Hand 36: Querying handPlayers with: {"where":{"handId":36}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 36: Query returned 2 handPlayers: [{"id":71,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"5000000"},{"id":72,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 36: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 36: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 36: Querying roundActions with: {
  "where": {
    "handId": 36,
    "round": "RIVER",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 36: Query returned 1 roundActions for round RIVER: [{"id":194,"seatNumber":0,"action":"RAISE","amount":"5000000","round":"RIVER"}]
[DEBUG isBettingRoundComplete] Hand 36: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 36: Checking 2 active players against actedSeats and currentBet=5000000
[DEBUG isBettingRoundComplete] Hand 36: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=5000000, currentBet=5000000)
[DEBUG isBettingRoundComplete] Hand 36: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 36: Context - actedSeats=[0], playerSeat=1, currentRound=RIVER, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: Updating hand with: {"where":{"id":36},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 36: Context - currentRound=RIVER, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG handleBettingActionCompletion] Hand 36: RETURNING result: handEnded=false, roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG betAction] Hand 36: handleBettingActionCompletion returned: handEnded=false, roundAdvanced=false
[DEBUG betAction] Hand 36: RETURNING from transaction
[DEBUG betAction] Hand 36: Context - hand.round=RIVER, handEnded=false, roundAdvanced=false, winnerSeatNumber=null
[DEBUG betAction] Hand 36: RETURNING from transaction - Final values: handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG betAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=36

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG callAction] Hand 36: Player seat 1 calling 5000000 in round RIVER, currentBet=5000000, chipsCommitted before=0
[DEBUG callAction] Hand 36: Creating CALL action with: handId=36, seatNumber=1, round=RIVER, amount=5000000
[DEBUG createActionAndEvent] Hand 36: Creating action with: {"handId":36,"seatNumber":1,"round":"RIVER","action":"CALL","amount":"5000000","handRound":"RIVER","roundParam":"RIVER","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG createActionAndEvent] Hand 36: Action created successfully: {"id":195,"seatNumber":1,"action":"CALL","round":"RIVER","amount":"5000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG callAction] Hand 36: CALL action created successfully: {"id":195,"seatNumber":1,"action":"CALL","round":"RIVER","amount":"5000000"}
[DEBUG callAction] Hand 36: CALL action created, chipsCommitted now=5000000

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG callAction] Hand 36: After CALL by seat 1, checking if round complete
[DEBUG isBettingRoundComplete] Hand 36: Starting check
[DEBUG isBettingRoundComplete] Hand 36: Querying hand with: {"where":{"id":36}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 36: Query result - hand={"id":36,"round":"RIVER","currentBet":"5000000","currentActionSeat":1,"status":"RIVER"}
[DEBUG isBettingRoundComplete] Hand 36: currentBet=5000000, currentRound=RIVER
[DEBUG isBettingRoundComplete] Hand 36: Querying handPlayers with: {"where":{"handId":36}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 36: Query returned 2 handPlayers: [{"id":71,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"5000000"},{"id":72,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"5000000"}]
[DEBUG isBettingRoundComplete] Hand 36: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 36: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 36: Querying roundActions with: {
  "where": {
    "handId": 36,
    "round": "RIVER",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG isBettingRoundComplete] Hand 36: Query returned 2 roundActions for round RIVER: [{"id":194,"seatNumber":0,"action":"RAISE","amount":"5000000","round":"RIVER"},{"id":195,"seatNumber":1,"action":"CALL","amount":"5000000","round":"RIVER"}]
[DEBUG isBettingRoundComplete] Hand 36: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 36: Checking 2 active players against actedSeats and currentBet=5000000
[DEBUG isBettingRoundComplete] Hand 36: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=5000000, currentBet=5000000)
[DEBUG isBettingRoundComplete] Hand 36: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=5000000, currentBet=5000000)
[DEBUG isBettingRoundComplete] Hand 36: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=5000000, currentBet=5000000)
[DEBUG isBettingRoundComplete] Hand 36: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=5000000, currentBet=5000000)
[DEBUG isBettingRoundComplete] Hand 36: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 36: Context - activePlayers=2, actedSeats=[0,1], currentBet=5000000, currentRound=RIVER, roundActions queried=2, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 36: Active players detail: [{"seatNumber":0,"chipsCommitted":"5000000","status":"ACTIVE","hasActed":true,"hasMatched":true},{"seatNumber":1,"chipsCommitted":"5000000","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG callAction] Hand 36: isBettingRoundComplete returned true
[DEBUG callAction] Hand 36: Round complete, calling handleBettingRoundComplete
[DEBUG handleBettingRoundComplete] Hand 36: Called with currentRound=RIVER
[DEBUG handleBettingRoundComplete] Hand 36: RIVER round, settling hand via showdown

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG handleBettingRoundComplete] Hand 36: Hand settled, winnerSeatNumber=1
[DEBUG handleBettingRoundComplete] Hand 36: RETURNING result with settlement: handEnded=true, roundAdvanced=false, winnerSeatNumber=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG callAction] Hand 36: handleBettingRoundComplete returned handEnded=true, roundAdvanced=false
[DEBUG callAction] Hand 36: RETURNING from transaction - Round complete
[DEBUG callAction] Hand 36: Context - hand.round=RIVER, handEnded=true, roundAdvanced=false, winnerSeatNumber=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-002: Bet-Call on River (Showdown)
[DEBUG callAction] RETURNING final result: handEnded=true, roundAdvanced=false, tableId=36

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG callAction] Hand 37: Player seat 0 calling 1000000 in round PRE_FLOP, currentBet=2000000, chipsCommitted before=1000000
[DEBUG callAction] Hand 37: Creating CALL action with: handId=37, seatNumber=0, round=PRE_FLOP, amount=1000000
[DEBUG createActionAndEvent] Hand 37: Creating action with: {"handId":37,"seatNumber":0,"round":"PRE_FLOP","action":"CALL","amount":"1000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG createActionAndEvent] Hand 37: Action created successfully: {"id":198,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"1000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG callAction] Hand 37: CALL action created successfully: {"id":198,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"1000000"}
[DEBUG callAction] Hand 37: CALL action created, chipsCommitted now=2000000

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG callAction] Hand 37: After CALL by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 37: Starting check
[DEBUG isBettingRoundComplete] Hand 37: Querying hand with: {"where":{"id":37}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG isBettingRoundComplete] Hand 37: Query result - hand={"id":37,"round":"PRE_FLOP","currentBet":"2000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 37: currentBet=2000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 37: Querying handPlayers with: {"where":{"handId":37}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG isBettingRoundComplete] Hand 37: Query returned 2 handPlayers: [{"id":73,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"id":74,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG isBettingRoundComplete] Hand 37: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 37: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 37: Querying roundActions with: {
  "where": {
    "handId": 37,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG isBettingRoundComplete] Hand 37: Query returned 1 roundActions for round PRE_FLOP: [{"id":198,"seatNumber":0,"action":"CALL","amount":"1000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 37: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 37: Checking 2 active players against actedSeats and currentBet=2000000
[DEBUG isBettingRoundComplete] Hand 37: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=2000000, currentBet=2000000)
[DEBUG isBettingRoundComplete] Hand 37: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 37: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG callAction] Hand 37: isBettingRoundComplete returned false
[DEBUG callAction] Hand 37: Round not complete, checking auto-advance or next player

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG callAction] Hand 37: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: Called with currentSeatNumber=0, currentRound=PRE_FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: Querying hand with: {"where":{"id":37},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: Query result - hand.round=PRE_FLOP, currentRound param=PRE_FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: nextPlayer seat=1, chipsCommitted=2000000, currentBet=2000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: Next player has matched bet (currentBet > 0n), checking if all acted and matched
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: Querying roundActions with: {
  "where": {
    "handId": 37,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: Query returned 1 roundActions for round PRE_FLOP: [{"id":198,"seatNumber":0,"action":"CALL","amount":"1000000","round":"PRE_FLOP"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: allActivePlayers (2): [
  { seatNumber: 0, chipsCommitted: '2000000', status: 'ACTIVE' },
  { seatNumber: 1, chipsCommitted: '2000000', status: 'ACTIVE' }
]
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: Wrap-around check - allActed=false, allMatched=true, actedSeats=0, playersWhoHaventActed=1, onlyNextPlayerHaventActed=true
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: Round complete detected - RETURNING early with round completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: Context - allActed=false, onlyNextPlayerHaventActed=true, allMatched=true, currentRound=PRE_FLOP, nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: Context - allActivePlayers=[{"seat":0,"chipsCommitted":"2000000","status":"ACTIVE"},{"seat":1,"chipsCommitted":"2000000","status":"ACTIVE"}], actedSeats=[0], roundActions found=1
[DEBUG handleBettingRoundComplete] Hand 37: Called with currentRound=PRE_FLOP
[DEBUG handleBettingRoundComplete] Hand 37: Advancing from PRE_FLOP to next round
[DEBUG advanceBettingRound] Hand 37: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG advanceBettingRound] Hand 37: needsSidePots=false
[DEBUG advanceBettingRound] Hand 37: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG advanceBettingRound] Hand 37: Querying hand with: {"where":{"id":37},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG advanceBettingRound] Hand 37: Query result - hand.round=PRE_FLOP, players=2
[DEBUG advanceBettingRound] Hand 37: currentRound=PRE_FLOP, deckPosition=4, communityCards.length=0
[DEBUG advanceBettingRound] Hand 37: Advancing from PRE_FLOP to FLOP, cardsToDeal=3
[DEBUG advanceBettingRound] Hand 37: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 37: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '2000000' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '2000000' }
]
[DEBUG advanceBettingRound] Hand 37: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 37: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 37: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 37: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 37: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG advanceBettingRound] Hand 37: Updating hand state: round=FLOP, status=FLOP, currentActionSeat=0, newCommunityCards.length=3
[DEBUG advanceBettingRound] Hand 37: Updating hand with: {"where":{"id":37},"data":{"round":"FLOP","status":"FLOP","communityCards":"[3 cards]","deckPosition":7,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG advanceBettingRound] Hand 37: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG advanceBettingRound] Hand 37: RETURNING false - Round advanced successfully from PRE_FLOP to FLOP (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG handleBettingRoundComplete] Hand 37: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 37: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG handleBettingRoundComplete] Hand 37: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 37: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: RETURNING result from handleBettingRoundComplete: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG callAction] Hand 37: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=true
[DEBUG callAction] Hand 37: RETURNING from transaction - Final result
[DEBUG callAction] Hand 37: Context - hand.round=PRE_FLOP, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG callAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=37

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG checkAction] Hand 37: Player seat 0 checking in round FLOP
[DEBUG checkAction] Hand 37: Creating CHECK action with: {"handId":37,"seatNumber":0,"round":"FLOP","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG checkAction] Hand 37: CHECK action created successfully: {"id":199,"seatNumber":0,"action":"CHECK","round":"FLOP","amount":null}
[DEBUG checkAction] Hand 37: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG checkAction] Hand 37: After CHECK by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 37: Starting check
[DEBUG isBettingRoundComplete] Hand 37: Querying hand with: {"where":{"id":37}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG isBettingRoundComplete] Hand 37: Query result - hand={"id":37,"round":"FLOP","currentBet":"0","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 37: currentBet=0, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 37: Querying handPlayers with: {"where":{"handId":37}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG isBettingRoundComplete] Hand 37: Query returned 2 handPlayers: [{"id":73,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":74,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 37: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 37: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 37: Querying roundActions with: {
  "where": {
    "handId": 37,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG isBettingRoundComplete] Hand 37: Query returned 1 roundActions for round FLOP: [{"id":199,"seatNumber":0,"action":"CHECK","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 37: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 37: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 37: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 37: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 37: Context - actedSeats=[0], playerSeat=1, currentRound=FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG checkAction] Hand 37: isBettingRoundComplete returned false
[DEBUG checkAction] Hand 37: Round not complete, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: Called with currentSeatNumber=0, currentRound=FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: Querying hand with: {"where":{"id":37},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: Query result - hand.round=FLOP, currentRound param=FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: nextPlayer seat=1, chipsCommitted=0, currentBet=0
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: Zero-bet wrap-around, advancing to next player (will complete after they act)
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 37: Starting check
[DEBUG isBettingRoundComplete] Hand 37: Querying hand with: {"where":{"id":37}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG isBettingRoundComplete] Hand 37: Query result - hand={"id":37,"round":"FLOP","currentBet":"0","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 37: currentBet=0, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 37: Querying handPlayers with: {"where":{"handId":37}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG isBettingRoundComplete] Hand 37: Query returned 2 handPlayers: [{"id":73,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":74,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 37: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 37: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 37: Querying roundActions with: {
  "where": {
    "handId": 37,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG isBettingRoundComplete] Hand 37: Query returned 1 roundActions for round FLOP: [{"id":199,"seatNumber":0,"action":"CHECK","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 37: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 37: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 37: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 37: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 37: Context - actedSeats=[0], playerSeat=1, currentRound=FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: Updating hand with: {"where":{"id":37},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: Context - currentRound=FLOP, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG checkAction] Hand 37: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=false
[DEBUG checkAction] Hand 37: RETURNING from transaction - Final result
[DEBUG checkAction] Hand 37: Context - hand.round=FLOP, handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG checkAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=37

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG checkAction] Hand 37: Player seat 1 checking in round FLOP
[DEBUG checkAction] Hand 37: Creating CHECK action with: {"handId":37,"seatNumber":1,"round":"FLOP","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG checkAction] Hand 37: CHECK action created successfully: {"id":200,"seatNumber":1,"action":"CHECK","round":"FLOP","amount":null}
[DEBUG checkAction] Hand 37: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG checkAction] Hand 37: After CHECK by seat 1, checking if round complete
[DEBUG isBettingRoundComplete] Hand 37: Starting check
[DEBUG isBettingRoundComplete] Hand 37: Querying hand with: {"where":{"id":37}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG isBettingRoundComplete] Hand 37: Query result - hand={"id":37,"round":"FLOP","currentBet":"0","currentActionSeat":1,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 37: currentBet=0, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 37: Querying handPlayers with: {"where":{"handId":37}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG isBettingRoundComplete] Hand 37: Query returned 2 handPlayers: [{"id":73,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":74,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 37: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 37: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 37: Querying roundActions with: {
  "where": {
    "handId": 37,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG isBettingRoundComplete] Hand 37: Query returned 2 roundActions for round FLOP: [{"id":199,"seatNumber":0,"action":"CHECK","round":"FLOP"},{"id":200,"seatNumber":1,"action":"CHECK","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 37: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 37: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 37: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 37: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 37: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 37: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 37: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 37: Context - activePlayers=2, actedSeats=[0,1], currentBet=0, currentRound=FLOP, roundActions queried=2, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 37: Active players detail: [{"seatNumber":0,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true},{"seatNumber":1,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG checkAction] Hand 37: isBettingRoundComplete returned true
[DEBUG checkAction] Hand 37: Round complete, calling handleBettingRoundComplete
[DEBUG handleBettingRoundComplete] Hand 37: Called with currentRound=FLOP
[DEBUG handleBettingRoundComplete] Hand 37: Advancing from FLOP to next round
[DEBUG advanceBettingRound] Hand 37: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG advanceBettingRound] Hand 37: needsSidePots=false
[DEBUG advanceBettingRound] Hand 37: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG advanceBettingRound] Hand 37: Querying hand with: {"where":{"id":37},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG advanceBettingRound] Hand 37: Query result - hand.round=FLOP, players=2
[DEBUG advanceBettingRound] Hand 37: currentRound=FLOP, deckPosition=7, communityCards.length=3
[DEBUG advanceBettingRound] Hand 37: Advancing from FLOP to TURN, cardsToDeal=1
[DEBUG advanceBettingRound] Hand 37: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 37: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '0' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '0' }
]
[DEBUG advanceBettingRound] Hand 37: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 37: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 37: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 37: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 37: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG advanceBettingRound] Hand 37: Updating hand state: round=TURN, status=TURN, currentActionSeat=0, newCommunityCards.length=4
[DEBUG advanceBettingRound] Hand 37: Updating hand with: {"where":{"id":37},"data":{"round":"TURN","status":"TURN","communityCards":"[4 cards]","deckPosition":8,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG advanceBettingRound] Hand 37: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG advanceBettingRound] Hand 37: RETURNING false - Round advanced successfully from FLOP to TURN (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG handleBettingRoundComplete] Hand 37: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 37: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG handleBettingRoundComplete] Hand 37: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 37: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG checkAction] Hand 37: handleBettingRoundComplete returned handEnded=false, roundAdvanced=true
[DEBUG checkAction] Hand 37: RETURNING from transaction - Round complete
[DEBUG checkAction] Hand 37: Context - hand.round=FLOP, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG checkAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=37

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG checkAction] Hand 37: Player seat 0 checking in round TURN
[DEBUG checkAction] Hand 37: Creating CHECK action with: {"handId":37,"seatNumber":0,"round":"TURN","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG checkAction] Hand 37: CHECK action created successfully: {"id":201,"seatNumber":0,"action":"CHECK","round":"TURN","amount":null}
[DEBUG checkAction] Hand 37: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG checkAction] Hand 37: After CHECK by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 37: Starting check
[DEBUG isBettingRoundComplete] Hand 37: Querying hand with: {"where":{"id":37}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG isBettingRoundComplete] Hand 37: Query result - hand={"id":37,"round":"TURN","currentBet":"0","currentActionSeat":0,"status":"TURN"}
[DEBUG isBettingRoundComplete] Hand 37: currentBet=0, currentRound=TURN
[DEBUG isBettingRoundComplete] Hand 37: Querying handPlayers with: {"where":{"handId":37}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG isBettingRoundComplete] Hand 37: Query returned 2 handPlayers: [{"id":73,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":74,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 37: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 37: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 37: Querying roundActions with: {
  "where": {
    "handId": 37,
    "round": "TURN",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG isBettingRoundComplete] Hand 37: Query returned 1 roundActions for round TURN: [{"id":201,"seatNumber":0,"action":"CHECK","round":"TURN"}]
[DEBUG isBettingRoundComplete] Hand 37: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 37: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 37: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 37: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 37: Context - actedSeats=[0], playerSeat=1, currentRound=TURN, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG checkAction] Hand 37: isBettingRoundComplete returned false
[DEBUG checkAction] Hand 37: Round not complete, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: Called with currentSeatNumber=0, currentRound=TURN

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: Querying hand with: {"where":{"id":37},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: Query result - hand.round=TURN, currentRound param=TURN, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: nextPlayer seat=1, chipsCommitted=0, currentBet=0
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: Zero-bet wrap-around, advancing to next player (will complete after they act)
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 37: Starting check
[DEBUG isBettingRoundComplete] Hand 37: Querying hand with: {"where":{"id":37}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG isBettingRoundComplete] Hand 37: Query result - hand={"id":37,"round":"TURN","currentBet":"0","currentActionSeat":0,"status":"TURN"}
[DEBUG isBettingRoundComplete] Hand 37: currentBet=0, currentRound=TURN
[DEBUG isBettingRoundComplete] Hand 37: Querying handPlayers with: {"where":{"handId":37}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG isBettingRoundComplete] Hand 37: Query returned 2 handPlayers: [{"id":73,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":74,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 37: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 37: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 37: Querying roundActions with: {
  "where": {
    "handId": 37,
    "round": "TURN",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG isBettingRoundComplete] Hand 37: Query returned 1 roundActions for round TURN: [{"id":201,"seatNumber":0,"action":"CHECK","round":"TURN"}]
[DEBUG isBettingRoundComplete] Hand 37: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 37: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 37: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 37: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 37: Context - actedSeats=[0], playerSeat=1, currentRound=TURN, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: Updating hand with: {"where":{"id":37},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: Context - currentRound=TURN, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG checkAction] Hand 37: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=false
[DEBUG checkAction] Hand 37: RETURNING from transaction - Final result
[DEBUG checkAction] Hand 37: Context - hand.round=TURN, handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG checkAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=37

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG checkAction] Hand 37: Player seat 1 checking in round TURN
[DEBUG checkAction] Hand 37: Creating CHECK action with: {"handId":37,"seatNumber":1,"round":"TURN","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG checkAction] Hand 37: CHECK action created successfully: {"id":202,"seatNumber":1,"action":"CHECK","round":"TURN","amount":null}
[DEBUG checkAction] Hand 37: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG checkAction] Hand 37: After CHECK by seat 1, checking if round complete
[DEBUG isBettingRoundComplete] Hand 37: Starting check
[DEBUG isBettingRoundComplete] Hand 37: Querying hand with: {"where":{"id":37}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG isBettingRoundComplete] Hand 37: Query result - hand={"id":37,"round":"TURN","currentBet":"0","currentActionSeat":1,"status":"TURN"}
[DEBUG isBettingRoundComplete] Hand 37: currentBet=0, currentRound=TURN
[DEBUG isBettingRoundComplete] Hand 37: Querying handPlayers with: {"where":{"handId":37}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG isBettingRoundComplete] Hand 37: Query returned 2 handPlayers: [{"id":73,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":74,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 37: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 37: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 37: Querying roundActions with: {
  "where": {
    "handId": 37,
    "round": "TURN",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG isBettingRoundComplete] Hand 37: Query returned 2 roundActions for round TURN: [{"id":201,"seatNumber":0,"action":"CHECK","round":"TURN"},{"id":202,"seatNumber":1,"action":"CHECK","round":"TURN"}]
[DEBUG isBettingRoundComplete] Hand 37: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 37: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 37: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 37: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 37: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 37: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 37: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 37: Context - activePlayers=2, actedSeats=[0,1], currentBet=0, currentRound=TURN, roundActions queried=2, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 37: Active players detail: [{"seatNumber":0,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true},{"seatNumber":1,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG checkAction] Hand 37: isBettingRoundComplete returned true
[DEBUG checkAction] Hand 37: Round complete, calling handleBettingRoundComplete
[DEBUG handleBettingRoundComplete] Hand 37: Called with currentRound=TURN
[DEBUG handleBettingRoundComplete] Hand 37: Advancing from TURN to next round
[DEBUG advanceBettingRound] Hand 37: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG advanceBettingRound] Hand 37: needsSidePots=false
[DEBUG advanceBettingRound] Hand 37: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG advanceBettingRound] Hand 37: Querying hand with: {"where":{"id":37},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG advanceBettingRound] Hand 37: Query result - hand.round=TURN, players=2
[DEBUG advanceBettingRound] Hand 37: currentRound=TURN, deckPosition=8, communityCards.length=4
[DEBUG advanceBettingRound] Hand 37: Advancing from TURN to RIVER, cardsToDeal=1
[DEBUG advanceBettingRound] Hand 37: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 37: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '0' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '0' }
]
[DEBUG advanceBettingRound] Hand 37: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 37: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 37: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 37: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 37: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG advanceBettingRound] Hand 37: Updating hand state: round=RIVER, status=RIVER, currentActionSeat=0, newCommunityCards.length=5
[DEBUG advanceBettingRound] Hand 37: Updating hand with: {"where":{"id":37},"data":{"round":"RIVER","status":"RIVER","communityCards":"[5 cards]","deckPosition":9,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG advanceBettingRound] Hand 37: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG advanceBettingRound] Hand 37: RETURNING false - Round advanced successfully from TURN to RIVER (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG handleBettingRoundComplete] Hand 37: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 37: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG handleBettingRoundComplete] Hand 37: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 37: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG checkAction] Hand 37: handleBettingRoundComplete returned handEnded=false, roundAdvanced=true
[DEBUG checkAction] Hand 37: RETURNING from transaction - Round complete
[DEBUG checkAction] Hand 37: Context - hand.round=TURN, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG checkAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=37

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG betAction] Hand 37: Player seat 0 betting 5000000 in round RIVER, currentBet before=0, chipsCommitted before=0, isAllIn=false
[DEBUG betAction] Hand 37: Creating BET action - hand.round=RIVER, actionType=RAISE, eventActionType=BET
[DEBUG createActionAndEvent] Hand 37: Creating action with: {"handId":37,"seatNumber":0,"round":"RIVER","action":"RAISE","amount":"5000000","handRound":"RIVER","roundParam":"RIVER","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG createActionAndEvent] Hand 37: Action created successfully: {"id":203,"seatNumber":0,"action":"RAISE","round":"RIVER","amount":"5000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG betAction] Hand 37: BET action created successfully, checking if round complete
[DEBUG betAction] Hand 37: Checking if betting round complete after BET
[DEBUG betAction] Hand 37: Context before isBettingRoundComplete - hand.round=RIVER, currentBet=0, currentActionSeat=0
[DEBUG isBettingRoundComplete] Hand 37: Starting check
[DEBUG isBettingRoundComplete] Hand 37: Querying hand with: {"where":{"id":37}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG isBettingRoundComplete] Hand 37: Query result - hand={"id":37,"round":"RIVER","currentBet":"5000000","currentActionSeat":0,"status":"RIVER"}
[DEBUG isBettingRoundComplete] Hand 37: currentBet=5000000, currentRound=RIVER
[DEBUG isBettingRoundComplete] Hand 37: Querying handPlayers with: {"where":{"handId":37}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG isBettingRoundComplete] Hand 37: Query returned 2 handPlayers: [{"id":73,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"5000000"},{"id":74,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 37: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 37: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 37: Querying roundActions with: {
  "where": {
    "handId": 37,
    "round": "RIVER",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG isBettingRoundComplete] Hand 37: Query returned 1 roundActions for round RIVER: [{"id":203,"seatNumber":0,"action":"RAISE","amount":"5000000","round":"RIVER"}]
[DEBUG isBettingRoundComplete] Hand 37: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 37: Checking 2 active players against actedSeats and currentBet=5000000
[DEBUG isBettingRoundComplete] Hand 37: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=5000000, currentBet=5000000)
[DEBUG isBettingRoundComplete] Hand 37: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 37: Context - actedSeats=[0], playerSeat=1, currentRound=RIVER, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG betAction] Hand 37: isBettingRoundComplete returned false
[DEBUG handleBettingActionCompletion] Hand 37: Called with currentSeatNumber=0, currentRound=RIVER, bettingRoundComplete=false, isAllIn=false
[DEBUG handleBettingActionCompletion] Hand 37: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: Called with currentSeatNumber=0, currentRound=RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: Querying hand with: {"where":{"id":37},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: Query result - hand.round=RIVER, currentRound param=RIVER, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"5000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: nextPlayer seat=1, chipsCommitted=0, currentBet=5000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: Next player hasn't matched (chipsCommitted=0, currentBet=5000000)
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 37: Starting check
[DEBUG isBettingRoundComplete] Hand 37: Querying hand with: {"where":{"id":37}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG isBettingRoundComplete] Hand 37: Query result - hand={"id":37,"round":"RIVER","currentBet":"5000000","currentActionSeat":0,"status":"RIVER"}
[DEBUG isBettingRoundComplete] Hand 37: currentBet=5000000, currentRound=RIVER
[DEBUG isBettingRoundComplete] Hand 37: Querying handPlayers with: {"where":{"handId":37}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG isBettingRoundComplete] Hand 37: Query returned 2 handPlayers: [{"id":73,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"5000000"},{"id":74,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 37: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 37: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 37: Querying roundActions with: {
  "where": {
    "handId": 37,
    "round": "RIVER",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG isBettingRoundComplete] Hand 37: Query returned 1 roundActions for round RIVER: [{"id":203,"seatNumber":0,"action":"RAISE","amount":"5000000","round":"RIVER"}]
[DEBUG isBettingRoundComplete] Hand 37: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 37: Checking 2 active players against actedSeats and currentBet=5000000
[DEBUG isBettingRoundComplete] Hand 37: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=5000000, currentBet=5000000)
[DEBUG isBettingRoundComplete] Hand 37: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 37: Context - actedSeats=[0], playerSeat=1, currentRound=RIVER, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: Updating hand with: {"where":{"id":37},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 37: Context - currentRound=RIVER, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG handleBettingActionCompletion] Hand 37: RETURNING result: handEnded=false, roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG betAction] Hand 37: handleBettingActionCompletion returned: handEnded=false, roundAdvanced=false
[DEBUG betAction] Hand 37: RETURNING from transaction
[DEBUG betAction] Hand 37: Context - hand.round=RIVER, handEnded=false, roundAdvanced=false, winnerSeatNumber=null
[DEBUG betAction] Hand 37: RETURNING from transaction - Final values: handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG betAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=37

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG foldAction] Hand 37: Player seat 1 folding in round RIVER
[DEBUG foldAction] Hand 37: Creating FOLD action with: {"handId":37,"seatNumber":1,"round":"RIVER","action":"FOLD","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River
[DEBUG foldAction] Hand 37: FOLD action created successfully: {"id":204,"seatNumber":1,"action":"FOLD","round":"RIVER","amount":null}
[DEBUG foldAction] Hand 37: FOLD action created, checking if round complete or advancing to next player

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG callAction] Hand 38: Player seat 0 calling 1000000 in round PRE_FLOP, currentBet=2000000, chipsCommitted before=1000000
[DEBUG callAction] Hand 38: Creating CALL action with: handId=38, seatNumber=0, round=PRE_FLOP, amount=1000000
[DEBUG createActionAndEvent] Hand 38: Creating action with: {"handId":38,"seatNumber":0,"round":"PRE_FLOP","action":"CALL","amount":"1000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG createActionAndEvent] Hand 38: Action created successfully: {"id":207,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"1000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG callAction] Hand 38: CALL action created successfully: {"id":207,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"1000000"}
[DEBUG callAction] Hand 38: CALL action created, chipsCommitted now=2000000

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG callAction] Hand 38: After CALL by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 38: Starting check
[DEBUG isBettingRoundComplete] Hand 38: Querying hand with: {"where":{"id":38}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 38: Query result - hand={"id":38,"round":"PRE_FLOP","currentBet":"2000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 38: currentBet=2000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 38: Querying handPlayers with: {"where":{"handId":38}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 38: Query returned 2 handPlayers: [{"id":75,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"id":76,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG isBettingRoundComplete] Hand 38: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 38: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 38: Querying roundActions with: {
  "where": {
    "handId": 38,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 38: Query returned 1 roundActions for round PRE_FLOP: [{"id":207,"seatNumber":0,"action":"CALL","amount":"1000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 38: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 38: Checking 2 active players against actedSeats and currentBet=2000000
[DEBUG isBettingRoundComplete] Hand 38: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=2000000, currentBet=2000000)
[DEBUG isBettingRoundComplete] Hand 38: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 38: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG callAction] Hand 38: isBettingRoundComplete returned false
[DEBUG callAction] Hand 38: Round not complete, checking auto-advance or next player

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG callAction] Hand 38: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: Called with currentSeatNumber=0, currentRound=PRE_FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: Querying hand with: {"where":{"id":38},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: Query result - hand.round=PRE_FLOP, currentRound param=PRE_FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: nextPlayer seat=1, chipsCommitted=2000000, currentBet=2000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: Next player has matched bet (currentBet > 0n), checking if all acted and matched
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: Querying roundActions with: {
  "where": {
    "handId": 38,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: Query returned 1 roundActions for round PRE_FLOP: [{"id":207,"seatNumber":0,"action":"CALL","amount":"1000000","round":"PRE_FLOP"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: allActivePlayers (2): [
  { seatNumber: 0, chipsCommitted: '2000000', status: 'ACTIVE' },
  { seatNumber: 1, chipsCommitted: '2000000', status: 'ACTIVE' }
]
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: Wrap-around check - allActed=false, allMatched=true, actedSeats=0, playersWhoHaventActed=1, onlyNextPlayerHaventActed=true
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: Round complete detected - RETURNING early with round completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: Context - allActed=false, onlyNextPlayerHaventActed=true, allMatched=true, currentRound=PRE_FLOP, nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: Context - allActivePlayers=[{"seat":0,"chipsCommitted":"2000000","status":"ACTIVE"},{"seat":1,"chipsCommitted":"2000000","status":"ACTIVE"}], actedSeats=[0], roundActions found=1
[DEBUG handleBettingRoundComplete] Hand 38: Called with currentRound=PRE_FLOP
[DEBUG handleBettingRoundComplete] Hand 38: Advancing from PRE_FLOP to next round
[DEBUG advanceBettingRound] Hand 38: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG advanceBettingRound] Hand 38: needsSidePots=false
[DEBUG advanceBettingRound] Hand 38: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG advanceBettingRound] Hand 38: Querying hand with: {"where":{"id":38},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG advanceBettingRound] Hand 38: Query result - hand.round=PRE_FLOP, players=2
[DEBUG advanceBettingRound] Hand 38: currentRound=PRE_FLOP, deckPosition=4, communityCards.length=0
[DEBUG advanceBettingRound] Hand 38: Advancing from PRE_FLOP to FLOP, cardsToDeal=3
[DEBUG advanceBettingRound] Hand 38: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 38: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '2000000' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '2000000' }
]
[DEBUG advanceBettingRound] Hand 38: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 38: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 38: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 38: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 38: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG advanceBettingRound] Hand 38: Updating hand state: round=FLOP, status=FLOP, currentActionSeat=0, newCommunityCards.length=3
[DEBUG advanceBettingRound] Hand 38: Updating hand with: {"where":{"id":38},"data":{"round":"FLOP","status":"FLOP","communityCards":"[3 cards]","deckPosition":7,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG advanceBettingRound] Hand 38: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG advanceBettingRound] Hand 38: RETURNING false - Round advanced successfully from PRE_FLOP to FLOP (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG handleBettingRoundComplete] Hand 38: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 38: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG handleBettingRoundComplete] Hand 38: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 38: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: RETURNING result from handleBettingRoundComplete: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG callAction] Hand 38: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=true
[DEBUG callAction] Hand 38: RETURNING from transaction - Final result
[DEBUG callAction] Hand 38: Context - hand.round=PRE_FLOP, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG callAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=38

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG checkAction] Hand 38: Player seat 0 checking in round FLOP
[DEBUG checkAction] Hand 38: Creating CHECK action with: {"handId":38,"seatNumber":0,"round":"FLOP","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG checkAction] Hand 38: CHECK action created successfully: {"id":208,"seatNumber":0,"action":"CHECK","round":"FLOP","amount":null}
[DEBUG checkAction] Hand 38: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG checkAction] Hand 38: After CHECK by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 38: Starting check
[DEBUG isBettingRoundComplete] Hand 38: Querying hand with: {"where":{"id":38}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 38: Query result - hand={"id":38,"round":"FLOP","currentBet":"0","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 38: currentBet=0, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 38: Querying handPlayers with: {"where":{"handId":38}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 38: Query returned 2 handPlayers: [{"id":75,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":76,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 38: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 38: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 38: Querying roundActions with: {
  "where": {
    "handId": 38,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 38: Query returned 1 roundActions for round FLOP: [{"id":208,"seatNumber":0,"action":"CHECK","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 38: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 38: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 38: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 38: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 38: Context - actedSeats=[0], playerSeat=1, currentRound=FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG checkAction] Hand 38: isBettingRoundComplete returned false
[DEBUG checkAction] Hand 38: Round not complete, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: Called with currentSeatNumber=0, currentRound=FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: Querying hand with: {"where":{"id":38},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: Query result - hand.round=FLOP, currentRound param=FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: nextPlayer seat=1, chipsCommitted=0, currentBet=0
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: Zero-bet wrap-around, advancing to next player (will complete after they act)
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 38: Starting check
[DEBUG isBettingRoundComplete] Hand 38: Querying hand with: {"where":{"id":38}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 38: Query result - hand={"id":38,"round":"FLOP","currentBet":"0","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 38: currentBet=0, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 38: Querying handPlayers with: {"where":{"handId":38}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 38: Query returned 2 handPlayers: [{"id":75,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":76,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 38: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 38: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 38: Querying roundActions with: {
  "where": {
    "handId": 38,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 38: Query returned 1 roundActions for round FLOP: [{"id":208,"seatNumber":0,"action":"CHECK","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 38: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 38: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 38: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 38: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 38: Context - actedSeats=[0], playerSeat=1, currentRound=FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: Updating hand with: {"where":{"id":38},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: Context - currentRound=FLOP, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG checkAction] Hand 38: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=false
[DEBUG checkAction] Hand 38: RETURNING from transaction - Final result
[DEBUG checkAction] Hand 38: Context - hand.round=FLOP, handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG checkAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=38

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG checkAction] Hand 38: Player seat 1 checking in round FLOP
[DEBUG checkAction] Hand 38: Creating CHECK action with: {"handId":38,"seatNumber":1,"round":"FLOP","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG checkAction] Hand 38: CHECK action created successfully: {"id":209,"seatNumber":1,"action":"CHECK","round":"FLOP","amount":null}
[DEBUG checkAction] Hand 38: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG checkAction] Hand 38: After CHECK by seat 1, checking if round complete
[DEBUG isBettingRoundComplete] Hand 38: Starting check
[DEBUG isBettingRoundComplete] Hand 38: Querying hand with: {"where":{"id":38}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 38: Query result - hand={"id":38,"round":"FLOP","currentBet":"0","currentActionSeat":1,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 38: currentBet=0, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 38: Querying handPlayers with: {"where":{"handId":38}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 38: Query returned 2 handPlayers: [{"id":75,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":76,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 38: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 38: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 38: Querying roundActions with: {
  "where": {
    "handId": 38,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 38: Query returned 2 roundActions for round FLOP: [{"id":208,"seatNumber":0,"action":"CHECK","round":"FLOP"},{"id":209,"seatNumber":1,"action":"CHECK","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 38: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 38: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 38: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 38: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 38: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 38: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 38: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 38: Context - activePlayers=2, actedSeats=[0,1], currentBet=0, currentRound=FLOP, roundActions queried=2, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 38: Active players detail: [{"seatNumber":0,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true},{"seatNumber":1,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG checkAction] Hand 38: isBettingRoundComplete returned true
[DEBUG checkAction] Hand 38: Round complete, calling handleBettingRoundComplete
[DEBUG handleBettingRoundComplete] Hand 38: Called with currentRound=FLOP
[DEBUG handleBettingRoundComplete] Hand 38: Advancing from FLOP to next round
[DEBUG advanceBettingRound] Hand 38: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG advanceBettingRound] Hand 38: needsSidePots=false
[DEBUG advanceBettingRound] Hand 38: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG advanceBettingRound] Hand 38: Querying hand with: {"where":{"id":38},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG advanceBettingRound] Hand 38: Query result - hand.round=FLOP, players=2
[DEBUG advanceBettingRound] Hand 38: currentRound=FLOP, deckPosition=7, communityCards.length=3
[DEBUG advanceBettingRound] Hand 38: Advancing from FLOP to TURN, cardsToDeal=1
[DEBUG advanceBettingRound] Hand 38: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 38: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '0' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '0' }
]
[DEBUG advanceBettingRound] Hand 38: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 38: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 38: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 38: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 38: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG advanceBettingRound] Hand 38: Updating hand state: round=TURN, status=TURN, currentActionSeat=0, newCommunityCards.length=4
[DEBUG advanceBettingRound] Hand 38: Updating hand with: {"where":{"id":38},"data":{"round":"TURN","status":"TURN","communityCards":"[4 cards]","deckPosition":8,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG advanceBettingRound] Hand 38: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG advanceBettingRound] Hand 38: RETURNING false - Round advanced successfully from FLOP to TURN (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG handleBettingRoundComplete] Hand 38: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 38: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG handleBettingRoundComplete] Hand 38: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 38: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG checkAction] Hand 38: handleBettingRoundComplete returned handEnded=false, roundAdvanced=true
[DEBUG checkAction] Hand 38: RETURNING from transaction - Round complete
[DEBUG checkAction] Hand 38: Context - hand.round=FLOP, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG checkAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=38

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG checkAction] Hand 38: Player seat 0 checking in round TURN
[DEBUG checkAction] Hand 38: Creating CHECK action with: {"handId":38,"seatNumber":0,"round":"TURN","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG checkAction] Hand 38: CHECK action created successfully: {"id":210,"seatNumber":0,"action":"CHECK","round":"TURN","amount":null}
[DEBUG checkAction] Hand 38: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG checkAction] Hand 38: After CHECK by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 38: Starting check
[DEBUG isBettingRoundComplete] Hand 38: Querying hand with: {"where":{"id":38}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 38: Query result - hand={"id":38,"round":"TURN","currentBet":"0","currentActionSeat":0,"status":"TURN"}
[DEBUG isBettingRoundComplete] Hand 38: currentBet=0, currentRound=TURN
[DEBUG isBettingRoundComplete] Hand 38: Querying handPlayers with: {"where":{"handId":38}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 38: Query returned 2 handPlayers: [{"id":75,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":76,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 38: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 38: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 38: Querying roundActions with: {
  "where": {
    "handId": 38,
    "round": "TURN",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 38: Query returned 1 roundActions for round TURN: [{"id":210,"seatNumber":0,"action":"CHECK","round":"TURN"}]
[DEBUG isBettingRoundComplete] Hand 38: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 38: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 38: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 38: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 38: Context - actedSeats=[0], playerSeat=1, currentRound=TURN, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG checkAction] Hand 38: isBettingRoundComplete returned false
[DEBUG checkAction] Hand 38: Round not complete, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: Called with currentSeatNumber=0, currentRound=TURN

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: Querying hand with: {"where":{"id":38},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: Query result - hand.round=TURN, currentRound param=TURN, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: nextPlayer seat=1, chipsCommitted=0, currentBet=0
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: Zero-bet wrap-around, advancing to next player (will complete after they act)
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 38: Starting check
[DEBUG isBettingRoundComplete] Hand 38: Querying hand with: {"where":{"id":38}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 38: Query result - hand={"id":38,"round":"TURN","currentBet":"0","currentActionSeat":0,"status":"TURN"}
[DEBUG isBettingRoundComplete] Hand 38: currentBet=0, currentRound=TURN
[DEBUG isBettingRoundComplete] Hand 38: Querying handPlayers with: {"where":{"handId":38}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 38: Query returned 2 handPlayers: [{"id":75,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":76,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 38: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 38: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 38: Querying roundActions with: {
  "where": {
    "handId": 38,
    "round": "TURN",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 38: Query returned 1 roundActions for round TURN: [{"id":210,"seatNumber":0,"action":"CHECK","round":"TURN"}]
[DEBUG isBettingRoundComplete] Hand 38: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 38: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 38: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 38: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 38: Context - actedSeats=[0], playerSeat=1, currentRound=TURN, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: Updating hand with: {"where":{"id":38},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: Context - currentRound=TURN, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG checkAction] Hand 38: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=false
[DEBUG checkAction] Hand 38: RETURNING from transaction - Final result
[DEBUG checkAction] Hand 38: Context - hand.round=TURN, handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG checkAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=38

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG checkAction] Hand 38: Player seat 1 checking in round TURN
[DEBUG checkAction] Hand 38: Creating CHECK action with: {"handId":38,"seatNumber":1,"round":"TURN","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG checkAction] Hand 38: CHECK action created successfully: {"id":211,"seatNumber":1,"action":"CHECK","round":"TURN","amount":null}
[DEBUG checkAction] Hand 38: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG checkAction] Hand 38: After CHECK by seat 1, checking if round complete
[DEBUG isBettingRoundComplete] Hand 38: Starting check
[DEBUG isBettingRoundComplete] Hand 38: Querying hand with: {"where":{"id":38}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 38: Query result - hand={"id":38,"round":"TURN","currentBet":"0","currentActionSeat":1,"status":"TURN"}
[DEBUG isBettingRoundComplete] Hand 38: currentBet=0, currentRound=TURN
[DEBUG isBettingRoundComplete] Hand 38: Querying handPlayers with: {"where":{"handId":38}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 38: Query returned 2 handPlayers: [{"id":75,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":76,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 38: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 38: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 38: Querying roundActions with: {
  "where": {
    "handId": 38,
    "round": "TURN",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 38: Query returned 2 roundActions for round TURN: [{"id":210,"seatNumber":0,"action":"CHECK","round":"TURN"},{"id":211,"seatNumber":1,"action":"CHECK","round":"TURN"}]
[DEBUG isBettingRoundComplete] Hand 38: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 38: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 38: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 38: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 38: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 38: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 38: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 38: Context - activePlayers=2, actedSeats=[0,1], currentBet=0, currentRound=TURN, roundActions queried=2, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 38: Active players detail: [{"seatNumber":0,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true},{"seatNumber":1,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG checkAction] Hand 38: isBettingRoundComplete returned true
[DEBUG checkAction] Hand 38: Round complete, calling handleBettingRoundComplete
[DEBUG handleBettingRoundComplete] Hand 38: Called with currentRound=TURN
[DEBUG handleBettingRoundComplete] Hand 38: Advancing from TURN to next round
[DEBUG advanceBettingRound] Hand 38: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG advanceBettingRound] Hand 38: needsSidePots=false
[DEBUG advanceBettingRound] Hand 38: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG advanceBettingRound] Hand 38: Querying hand with: {"where":{"id":38},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG advanceBettingRound] Hand 38: Query result - hand.round=TURN, players=2
[DEBUG advanceBettingRound] Hand 38: currentRound=TURN, deckPosition=8, communityCards.length=4
[DEBUG advanceBettingRound] Hand 38: Advancing from TURN to RIVER, cardsToDeal=1
[DEBUG advanceBettingRound] Hand 38: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 38: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '0' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '0' }
]
[DEBUG advanceBettingRound] Hand 38: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 38: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 38: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 38: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 38: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG advanceBettingRound] Hand 38: Updating hand state: round=RIVER, status=RIVER, currentActionSeat=0, newCommunityCards.length=5
[DEBUG advanceBettingRound] Hand 38: Updating hand with: {"where":{"id":38},"data":{"round":"RIVER","status":"RIVER","communityCards":"[5 cards]","deckPosition":9,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG advanceBettingRound] Hand 38: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG advanceBettingRound] Hand 38: RETURNING false - Round advanced successfully from TURN to RIVER (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG handleBettingRoundComplete] Hand 38: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 38: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG handleBettingRoundComplete] Hand 38: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 38: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG checkAction] Hand 38: handleBettingRoundComplete returned handEnded=false, roundAdvanced=true
[DEBUG checkAction] Hand 38: RETURNING from transaction - Round complete
[DEBUG checkAction] Hand 38: Context - hand.round=TURN, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG checkAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=38

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG betAction] Hand 38: Player seat 0 betting 5000000 in round RIVER, currentBet before=0, chipsCommitted before=0, isAllIn=false
[DEBUG betAction] Hand 38: Creating BET action - hand.round=RIVER, actionType=RAISE, eventActionType=BET
[DEBUG createActionAndEvent] Hand 38: Creating action with: {"handId":38,"seatNumber":0,"round":"RIVER","action":"RAISE","amount":"5000000","handRound":"RIVER","roundParam":"RIVER","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG createActionAndEvent] Hand 38: Action created successfully: {"id":212,"seatNumber":0,"action":"RAISE","round":"RIVER","amount":"5000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG betAction] Hand 38: BET action created successfully, checking if round complete
[DEBUG betAction] Hand 38: Checking if betting round complete after BET
[DEBUG betAction] Hand 38: Context before isBettingRoundComplete - hand.round=RIVER, currentBet=0, currentActionSeat=0
[DEBUG isBettingRoundComplete] Hand 38: Starting check
[DEBUG isBettingRoundComplete] Hand 38: Querying hand with: {"where":{"id":38}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 38: Query result - hand={"id":38,"round":"RIVER","currentBet":"5000000","currentActionSeat":0,"status":"RIVER"}
[DEBUG isBettingRoundComplete] Hand 38: currentBet=5000000, currentRound=RIVER
[DEBUG isBettingRoundComplete] Hand 38: Querying handPlayers with: {"where":{"handId":38}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 38: Query returned 2 handPlayers: [{"id":75,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"5000000"},{"id":76,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 38: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 38: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 38: Querying roundActions with: {
  "where": {
    "handId": 38,
    "round": "RIVER",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 38: Query returned 1 roundActions for round RIVER: [{"id":212,"seatNumber":0,"action":"RAISE","amount":"5000000","round":"RIVER"}]
[DEBUG isBettingRoundComplete] Hand 38: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 38: Checking 2 active players against actedSeats and currentBet=5000000
[DEBUG isBettingRoundComplete] Hand 38: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=5000000, currentBet=5000000)
[DEBUG isBettingRoundComplete] Hand 38: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 38: Context - actedSeats=[0], playerSeat=1, currentRound=RIVER, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG betAction] Hand 38: isBettingRoundComplete returned false
[DEBUG handleBettingActionCompletion] Hand 38: Called with currentSeatNumber=0, currentRound=RIVER, bettingRoundComplete=false, isAllIn=false
[DEBUG handleBettingActionCompletion] Hand 38: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: Called with currentSeatNumber=0, currentRound=RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: Querying hand with: {"where":{"id":38},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: Query result - hand.round=RIVER, currentRound param=RIVER, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"5000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: nextPlayer seat=1, chipsCommitted=0, currentBet=5000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: Next player hasn't matched (chipsCommitted=0, currentBet=5000000)
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 38: Starting check
[DEBUG isBettingRoundComplete] Hand 38: Querying hand with: {"where":{"id":38}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 38: Query result - hand={"id":38,"round":"RIVER","currentBet":"5000000","currentActionSeat":0,"status":"RIVER"}
[DEBUG isBettingRoundComplete] Hand 38: currentBet=5000000, currentRound=RIVER
[DEBUG isBettingRoundComplete] Hand 38: Querying handPlayers with: {"where":{"handId":38}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 38: Query returned 2 handPlayers: [{"id":75,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"5000000"},{"id":76,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 38: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 38: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 38: Querying roundActions with: {
  "where": {
    "handId": 38,
    "round": "RIVER",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 38: Query returned 1 roundActions for round RIVER: [{"id":212,"seatNumber":0,"action":"RAISE","amount":"5000000","round":"RIVER"}]
[DEBUG isBettingRoundComplete] Hand 38: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 38: Checking 2 active players against actedSeats and currentBet=5000000
[DEBUG isBettingRoundComplete] Hand 38: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=5000000, currentBet=5000000)
[DEBUG isBettingRoundComplete] Hand 38: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 38: Context - actedSeats=[0], playerSeat=1, currentRound=RIVER, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: Updating hand with: {"where":{"id":38},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 38: Context - currentRound=RIVER, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG handleBettingActionCompletion] Hand 38: RETURNING result: handEnded=false, roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG betAction] Hand 38: handleBettingActionCompletion returned: handEnded=false, roundAdvanced=false
[DEBUG betAction] Hand 38: RETURNING from transaction
[DEBUG betAction] Hand 38: Context - hand.round=RIVER, handEnded=false, roundAdvanced=false, winnerSeatNumber=null
[DEBUG betAction] Hand 38: RETURNING from transaction - Final values: handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG betAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=38

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG foldAction] Hand 38: Player seat 1 folding in round RIVER
[DEBUG foldAction] Hand 38: Creating FOLD action with: {"handId":38,"seatNumber":1,"round":"RIVER","action":"FOLD","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
[DEBUG foldAction] Hand 38: FOLD action created successfully: {"id":213,"seatNumber":1,"action":"FOLD","round":"RIVER","amount":null}
[DEBUG foldAction] Hand 38: FOLD action created, checking if round complete or advancing to next player

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > RIVER Scenarios > RV-003: Bet-Fold on River - 700 bps rake
ðŸ’° Added rake 630000 gwei to TEE balance (hand 38)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG raiseAction] Hand 39: Player seat 0 raising 3000000 in round PRE_FLOP, currentBet before=2000000, chipsCommitted before=1000000, isAllIn=false
[DEBUG raiseAction] Hand 39: Creating RAISE action - hand.round=PRE_FLOP, actionType=RAISE, eventActionType=RAISE
[DEBUG createActionAndEvent] Hand 39: Creating action with: {"handId":39,"seatNumber":0,"round":"PRE_FLOP","action":"RAISE","amount":"3000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG createActionAndEvent] Hand 39: Action created successfully: {"id":216,"seatNumber":0,"action":"RAISE","round":"PRE_FLOP","amount":"3000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG raiseAction] Hand 39: RAISE action created successfully, checking if round complete
[DEBUG raiseAction] Hand 39: Checking if betting round complete after RAISE
[DEBUG raiseAction] Hand 39: Context before isBettingRoundComplete - hand.round=PRE_FLOP, currentBet=2000000, currentActionSeat=0
[DEBUG isBettingRoundComplete] Hand 39: Starting check
[DEBUG isBettingRoundComplete] Hand 39: Querying hand with: {"where":{"id":39}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG isBettingRoundComplete] Hand 39: Query result - hand={"id":39,"round":"PRE_FLOP","currentBet":"4000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 39: currentBet=4000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 39: Querying handPlayers with: {"where":{"handId":39}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG isBettingRoundComplete] Hand 39: Query returned 2 handPlayers: [{"id":77,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"4000000"},{"id":78,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG isBettingRoundComplete] Hand 39: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 39: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 39: Querying roundActions with: {
  "where": {
    "handId": 39,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG isBettingRoundComplete] Hand 39: Query returned 1 roundActions for round PRE_FLOP: [{"id":216,"seatNumber":0,"action":"RAISE","amount":"3000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 39: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 39: Checking 2 active players against actedSeats and currentBet=4000000
[DEBUG isBettingRoundComplete] Hand 39: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=4000000, currentBet=4000000)
[DEBUG isBettingRoundComplete] Hand 39: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 39: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG raiseAction] Hand 39: isBettingRoundComplete returned false
[DEBUG handleBettingActionCompletion] Hand 39: Called with currentSeatNumber=0, currentRound=PRE_FLOP, bettingRoundComplete=false, isAllIn=false
[DEBUG handleBettingActionCompletion] Hand 39: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: Called with currentSeatNumber=0, currentRound=PRE_FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: Querying hand with: {"where":{"id":39},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: Query result - hand.round=PRE_FLOP, currentRound param=PRE_FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"4000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: nextPlayer seat=1, chipsCommitted=2000000, currentBet=4000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: Next player hasn't matched (chipsCommitted=2000000, currentBet=4000000)
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 39: Starting check
[DEBUG isBettingRoundComplete] Hand 39: Querying hand with: {"where":{"id":39}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG isBettingRoundComplete] Hand 39: Query result - hand={"id":39,"round":"PRE_FLOP","currentBet":"4000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 39: currentBet=4000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 39: Querying handPlayers with: {"where":{"handId":39}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG isBettingRoundComplete] Hand 39: Query returned 2 handPlayers: [{"id":77,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"4000000"},{"id":78,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG isBettingRoundComplete] Hand 39: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 39: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 39: Querying roundActions with: {
  "where": {
    "handId": 39,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG isBettingRoundComplete] Hand 39: Query returned 1 roundActions for round PRE_FLOP: [{"id":216,"seatNumber":0,"action":"RAISE","amount":"3000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 39: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 39: Checking 2 active players against actedSeats and currentBet=4000000
[DEBUG isBettingRoundComplete] Hand 39: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=4000000, currentBet=4000000)
[DEBUG isBettingRoundComplete] Hand 39: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 39: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: Updating hand with: {"where":{"id":39},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: Context - currentRound=PRE_FLOP, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG handleBettingActionCompletion] Hand 39: RETURNING result: handEnded=false, roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG raiseAction] Hand 39: handleBettingActionCompletion returned: handEnded=false, roundAdvanced=false
[DEBUG raiseAction] Hand 39: RETURNING from transaction
[DEBUG raiseAction] Hand 39: Context - hand.round=PRE_FLOP, handEnded=false, roundAdvanced=false, winnerSeatNumber=null
[DEBUG raiseAction] Hand 39: RETURNING from transaction - Final values: handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG raiseAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=39

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG callAction] Hand 39: Player seat 1 calling 2000000 in round PRE_FLOP, currentBet=4000000, chipsCommitted before=2000000
[DEBUG callAction] Hand 39: Creating CALL action with: handId=39, seatNumber=1, round=PRE_FLOP, amount=2000000
[DEBUG createActionAndEvent] Hand 39: Creating action with: {"handId":39,"seatNumber":1,"round":"PRE_FLOP","action":"CALL","amount":"2000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG createActionAndEvent] Hand 39: Action created successfully: {"id":217,"seatNumber":1,"action":"CALL","round":"PRE_FLOP","amount":"2000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG callAction] Hand 39: CALL action created successfully: {"id":217,"seatNumber":1,"action":"CALL","round":"PRE_FLOP","amount":"2000000"}
[DEBUG callAction] Hand 39: CALL action created, chipsCommitted now=4000000

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG callAction] Hand 39: After CALL by seat 1, checking if round complete
[DEBUG isBettingRoundComplete] Hand 39: Starting check
[DEBUG isBettingRoundComplete] Hand 39: Querying hand with: {"where":{"id":39}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG isBettingRoundComplete] Hand 39: Query result - hand={"id":39,"round":"PRE_FLOP","currentBet":"4000000","currentActionSeat":1,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 39: currentBet=4000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 39: Querying handPlayers with: {"where":{"handId":39}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG isBettingRoundComplete] Hand 39: Query returned 2 handPlayers: [{"id":77,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"4000000"},{"id":78,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"4000000"}]
[DEBUG isBettingRoundComplete] Hand 39: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 39: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 39: Querying roundActions with: {
  "where": {
    "handId": 39,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG isBettingRoundComplete] Hand 39: Query returned 2 roundActions for round PRE_FLOP: [{"id":216,"seatNumber":0,"action":"RAISE","amount":"3000000","round":"PRE_FLOP"},{"id":217,"seatNumber":1,"action":"CALL","amount":"2000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 39: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 39: Checking 2 active players against actedSeats and currentBet=4000000
[DEBUG isBettingRoundComplete] Hand 39: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=4000000, currentBet=4000000)
[DEBUG isBettingRoundComplete] Hand 39: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=4000000, currentBet=4000000)
[DEBUG isBettingRoundComplete] Hand 39: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=4000000, currentBet=4000000)
[DEBUG isBettingRoundComplete] Hand 39: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=4000000, currentBet=4000000)
[DEBUG isBettingRoundComplete] Hand 39: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 39: Context - activePlayers=2, actedSeats=[0,1], currentBet=4000000, currentRound=PRE_FLOP, roundActions queried=2, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 39: Active players detail: [{"seatNumber":0,"chipsCommitted":"4000000","status":"ACTIVE","hasActed":true,"hasMatched":true},{"seatNumber":1,"chipsCommitted":"4000000","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG callAction] Hand 39: isBettingRoundComplete returned true
[DEBUG callAction] Hand 39: Round complete, calling handleBettingRoundComplete
[DEBUG handleBettingRoundComplete] Hand 39: Called with currentRound=PRE_FLOP
[DEBUG handleBettingRoundComplete] Hand 39: Advancing from PRE_FLOP to next round
[DEBUG advanceBettingRound] Hand 39: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG advanceBettingRound] Hand 39: needsSidePots=false
[DEBUG advanceBettingRound] Hand 39: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG advanceBettingRound] Hand 39: Querying hand with: {"where":{"id":39},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG advanceBettingRound] Hand 39: Query result - hand.round=PRE_FLOP, players=2
[DEBUG advanceBettingRound] Hand 39: currentRound=PRE_FLOP, deckPosition=4, communityCards.length=0
[DEBUG advanceBettingRound] Hand 39: Advancing from PRE_FLOP to FLOP, cardsToDeal=3
[DEBUG advanceBettingRound] Hand 39: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 39: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '4000000' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '4000000' }
]
[DEBUG advanceBettingRound] Hand 39: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 39: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 39: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 39: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 39: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG advanceBettingRound] Hand 39: Updating hand state: round=FLOP, status=FLOP, currentActionSeat=0, newCommunityCards.length=3
[DEBUG advanceBettingRound] Hand 39: Updating hand with: {"where":{"id":39},"data":{"round":"FLOP","status":"FLOP","communityCards":"[3 cards]","deckPosition":7,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG advanceBettingRound] Hand 39: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG advanceBettingRound] Hand 39: RETURNING false - Round advanced successfully from PRE_FLOP to FLOP (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG handleBettingRoundComplete] Hand 39: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 39: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG handleBettingRoundComplete] Hand 39: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 39: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG callAction] Hand 39: handleBettingRoundComplete returned handEnded=false, roundAdvanced=true
[DEBUG callAction] Hand 39: RETURNING from transaction - Round complete
[DEBUG callAction] Hand 39: Context - hand.round=PRE_FLOP, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG callAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=39

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG betAction] Hand 39: Player seat 0 betting 5000000 in round FLOP, currentBet before=0, chipsCommitted before=0, isAllIn=false
[DEBUG betAction] Hand 39: Creating BET action - hand.round=FLOP, actionType=RAISE, eventActionType=BET
[DEBUG createActionAndEvent] Hand 39: Creating action with: {"handId":39,"seatNumber":0,"round":"FLOP","action":"RAISE","amount":"5000000","handRound":"FLOP","roundParam":"FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG createActionAndEvent] Hand 39: Action created successfully: {"id":218,"seatNumber":0,"action":"RAISE","round":"FLOP","amount":"5000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG betAction] Hand 39: BET action created successfully, checking if round complete
[DEBUG betAction] Hand 39: Checking if betting round complete after BET
[DEBUG betAction] Hand 39: Context before isBettingRoundComplete - hand.round=FLOP, currentBet=0, currentActionSeat=0
[DEBUG isBettingRoundComplete] Hand 39: Starting check
[DEBUG isBettingRoundComplete] Hand 39: Querying hand with: {"where":{"id":39}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG isBettingRoundComplete] Hand 39: Query result - hand={"id":39,"round":"FLOP","currentBet":"5000000","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 39: currentBet=5000000, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 39: Querying handPlayers with: {"where":{"handId":39}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG isBettingRoundComplete] Hand 39: Query returned 2 handPlayers: [{"id":77,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"5000000"},{"id":78,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 39: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 39: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 39: Querying roundActions with: {
  "where": {
    "handId": 39,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG isBettingRoundComplete] Hand 39: Query returned 1 roundActions for round FLOP: [{"id":218,"seatNumber":0,"action":"RAISE","amount":"5000000","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 39: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 39: Checking 2 active players against actedSeats and currentBet=5000000
[DEBUG isBettingRoundComplete] Hand 39: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=5000000, currentBet=5000000)
[DEBUG isBettingRoundComplete] Hand 39: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 39: Context - actedSeats=[0], playerSeat=1, currentRound=FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG betAction] Hand 39: isBettingRoundComplete returned false
[DEBUG handleBettingActionCompletion] Hand 39: Called with currentSeatNumber=0, currentRound=FLOP, bettingRoundComplete=false, isAllIn=false
[DEBUG handleBettingActionCompletion] Hand 39: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: Called with currentSeatNumber=0, currentRound=FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: Querying hand with: {"where":{"id":39},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: Query result - hand.round=FLOP, currentRound param=FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"5000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: nextPlayer seat=1, chipsCommitted=0, currentBet=5000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: Next player hasn't matched (chipsCommitted=0, currentBet=5000000)
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 39: Starting check
[DEBUG isBettingRoundComplete] Hand 39: Querying hand with: {"where":{"id":39}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG isBettingRoundComplete] Hand 39: Query result - hand={"id":39,"round":"FLOP","currentBet":"5000000","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 39: currentBet=5000000, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 39: Querying handPlayers with: {"where":{"handId":39}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG isBettingRoundComplete] Hand 39: Query returned 2 handPlayers: [{"id":77,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"5000000"},{"id":78,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 39: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 39: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 39: Querying roundActions with: {
  "where": {
    "handId": 39,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG isBettingRoundComplete] Hand 39: Query returned 1 roundActions for round FLOP: [{"id":218,"seatNumber":0,"action":"RAISE","amount":"5000000","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 39: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 39: Checking 2 active players against actedSeats and currentBet=5000000
[DEBUG isBettingRoundComplete] Hand 39: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=5000000, currentBet=5000000)
[DEBUG isBettingRoundComplete] Hand 39: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 39: Context - actedSeats=[0], playerSeat=1, currentRound=FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: Updating hand with: {"where":{"id":39},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: Context - currentRound=FLOP, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG handleBettingActionCompletion] Hand 39: RETURNING result: handEnded=false, roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG betAction] Hand 39: handleBettingActionCompletion returned: handEnded=false, roundAdvanced=false
[DEBUG betAction] Hand 39: RETURNING from transaction
[DEBUG betAction] Hand 39: Context - hand.round=FLOP, handEnded=false, roundAdvanced=false, winnerSeatNumber=null
[DEBUG betAction] Hand 39: RETURNING from transaction - Final values: handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG betAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=39

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG callAction] Hand 39: Player seat 1 calling 5000000 in round FLOP, currentBet=5000000, chipsCommitted before=0
[DEBUG callAction] Hand 39: Creating CALL action with: handId=39, seatNumber=1, round=FLOP, amount=5000000
[DEBUG createActionAndEvent] Hand 39: Creating action with: {"handId":39,"seatNumber":1,"round":"FLOP","action":"CALL","amount":"5000000","handRound":"FLOP","roundParam":"FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG createActionAndEvent] Hand 39: Action created successfully: {"id":219,"seatNumber":1,"action":"CALL","round":"FLOP","amount":"5000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG callAction] Hand 39: CALL action created successfully: {"id":219,"seatNumber":1,"action":"CALL","round":"FLOP","amount":"5000000"}
[DEBUG callAction] Hand 39: CALL action created, chipsCommitted now=5000000

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG callAction] Hand 39: After CALL by seat 1, checking if round complete
[DEBUG isBettingRoundComplete] Hand 39: Starting check
[DEBUG isBettingRoundComplete] Hand 39: Querying hand with: {"where":{"id":39}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG isBettingRoundComplete] Hand 39: Query result - hand={"id":39,"round":"FLOP","currentBet":"5000000","currentActionSeat":1,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 39: currentBet=5000000, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 39: Querying handPlayers with: {"where":{"handId":39}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG isBettingRoundComplete] Hand 39: Query returned 2 handPlayers: [{"id":77,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"5000000"},{"id":78,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"5000000"}]
[DEBUG isBettingRoundComplete] Hand 39: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 39: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 39: Querying roundActions with: {
  "where": {
    "handId": 39,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG isBettingRoundComplete] Hand 39: Query returned 2 roundActions for round FLOP: [{"id":218,"seatNumber":0,"action":"RAISE","amount":"5000000","round":"FLOP"},{"id":219,"seatNumber":1,"action":"CALL","amount":"5000000","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 39: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 39: Checking 2 active players against actedSeats and currentBet=5000000
[DEBUG isBettingRoundComplete] Hand 39: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=5000000, currentBet=5000000)
[DEBUG isBettingRoundComplete] Hand 39: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=5000000, currentBet=5000000)
[DEBUG isBettingRoundComplete] Hand 39: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=5000000, currentBet=5000000)
[DEBUG isBettingRoundComplete] Hand 39: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=5000000, currentBet=5000000)
[DEBUG isBettingRoundComplete] Hand 39: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 39: Context - activePlayers=2, actedSeats=[0,1], currentBet=5000000, currentRound=FLOP, roundActions queried=2, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 39: Active players detail: [{"seatNumber":0,"chipsCommitted":"5000000","status":"ACTIVE","hasActed":true,"hasMatched":true},{"seatNumber":1,"chipsCommitted":"5000000","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG callAction] Hand 39: isBettingRoundComplete returned true
[DEBUG callAction] Hand 39: Round complete, calling handleBettingRoundComplete
[DEBUG handleBettingRoundComplete] Hand 39: Called with currentRound=FLOP
[DEBUG handleBettingRoundComplete] Hand 39: Advancing from FLOP to next round
[DEBUG advanceBettingRound] Hand 39: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG advanceBettingRound] Hand 39: needsSidePots=false
[DEBUG advanceBettingRound] Hand 39: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG advanceBettingRound] Hand 39: Querying hand with: {"where":{"id":39},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG advanceBettingRound] Hand 39: Query result - hand.round=FLOP, players=2
[DEBUG advanceBettingRound] Hand 39: currentRound=FLOP, deckPosition=7, communityCards.length=3
[DEBUG advanceBettingRound] Hand 39: Advancing from FLOP to TURN, cardsToDeal=1
[DEBUG advanceBettingRound] Hand 39: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 39: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '5000000' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '5000000' }
]
[DEBUG advanceBettingRound] Hand 39: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 39: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 39: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 39: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 39: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG advanceBettingRound] Hand 39: Updating hand state: round=TURN, status=TURN, currentActionSeat=0, newCommunityCards.length=4
[DEBUG advanceBettingRound] Hand 39: Updating hand with: {"where":{"id":39},"data":{"round":"TURN","status":"TURN","communityCards":"[4 cards]","deckPosition":8,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG advanceBettingRound] Hand 39: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG advanceBettingRound] Hand 39: RETURNING false - Round advanced successfully from FLOP to TURN (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG handleBettingRoundComplete] Hand 39: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 39: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG handleBettingRoundComplete] Hand 39: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 39: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG callAction] Hand 39: handleBettingRoundComplete returned handEnded=false, roundAdvanced=true
[DEBUG callAction] Hand 39: RETURNING from transaction - Round complete
[DEBUG callAction] Hand 39: Context - hand.round=FLOP, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG callAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=39

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG betAction] Hand 39: Player seat 0 betting 10000000 in round TURN, currentBet before=0, chipsCommitted before=0, isAllIn=false
[DEBUG betAction] Hand 39: Creating BET action - hand.round=TURN, actionType=RAISE, eventActionType=BET
[DEBUG createActionAndEvent] Hand 39: Creating action with: {"handId":39,"seatNumber":0,"round":"TURN","action":"RAISE","amount":"10000000","handRound":"TURN","roundParam":"TURN","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG createActionAndEvent] Hand 39: Action created successfully: {"id":220,"seatNumber":0,"action":"RAISE","round":"TURN","amount":"10000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG betAction] Hand 39: BET action created successfully, checking if round complete
[DEBUG betAction] Hand 39: Checking if betting round complete after BET
[DEBUG betAction] Hand 39: Context before isBettingRoundComplete - hand.round=TURN, currentBet=0, currentActionSeat=0
[DEBUG isBettingRoundComplete] Hand 39: Starting check
[DEBUG isBettingRoundComplete] Hand 39: Querying hand with: {"where":{"id":39}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG isBettingRoundComplete] Hand 39: Query result - hand={"id":39,"round":"TURN","currentBet":"10000000","currentActionSeat":0,"status":"TURN"}
[DEBUG isBettingRoundComplete] Hand 39: currentBet=10000000, currentRound=TURN
[DEBUG isBettingRoundComplete] Hand 39: Querying handPlayers with: {"where":{"handId":39}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG isBettingRoundComplete] Hand 39: Query returned 2 handPlayers: [{"id":77,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"10000000"},{"id":78,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 39: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 39: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 39: Querying roundActions with: {
  "where": {
    "handId": 39,
    "round": "TURN",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG isBettingRoundComplete] Hand 39: Query returned 1 roundActions for round TURN: [{"id":220,"seatNumber":0,"action":"RAISE","amount":"10000000","round":"TURN"}]
[DEBUG isBettingRoundComplete] Hand 39: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 39: Checking 2 active players against actedSeats and currentBet=10000000
[DEBUG isBettingRoundComplete] Hand 39: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=10000000, currentBet=10000000)
[DEBUG isBettingRoundComplete] Hand 39: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 39: Context - actedSeats=[0], playerSeat=1, currentRound=TURN, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG betAction] Hand 39: isBettingRoundComplete returned false
[DEBUG handleBettingActionCompletion] Hand 39: Called with currentSeatNumber=0, currentRound=TURN, bettingRoundComplete=false, isAllIn=false
[DEBUG handleBettingActionCompletion] Hand 39: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: Called with currentSeatNumber=0, currentRound=TURN

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: Querying hand with: {"where":{"id":39},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: Query result - hand.round=TURN, currentRound param=TURN, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"10000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: nextPlayer seat=1, chipsCommitted=0, currentBet=10000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: Next player hasn't matched (chipsCommitted=0, currentBet=10000000)
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 39: Starting check
[DEBUG isBettingRoundComplete] Hand 39: Querying hand with: {"where":{"id":39}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG isBettingRoundComplete] Hand 39: Query result - hand={"id":39,"round":"TURN","currentBet":"10000000","currentActionSeat":0,"status":"TURN"}
[DEBUG isBettingRoundComplete] Hand 39: currentBet=10000000, currentRound=TURN
[DEBUG isBettingRoundComplete] Hand 39: Querying handPlayers with: {"where":{"handId":39}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG isBettingRoundComplete] Hand 39: Query returned 2 handPlayers: [{"id":77,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"10000000"},{"id":78,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 39: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 39: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 39: Querying roundActions with: {
  "where": {
    "handId": 39,
    "round": "TURN",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG isBettingRoundComplete] Hand 39: Query returned 1 roundActions for round TURN: [{"id":220,"seatNumber":0,"action":"RAISE","amount":"10000000","round":"TURN"}]
[DEBUG isBettingRoundComplete] Hand 39: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 39: Checking 2 active players against actedSeats and currentBet=10000000
[DEBUG isBettingRoundComplete] Hand 39: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=10000000, currentBet=10000000)
[DEBUG isBettingRoundComplete] Hand 39: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 39: Context - actedSeats=[0], playerSeat=1, currentRound=TURN, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: Updating hand with: {"where":{"id":39},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: Context - currentRound=TURN, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG handleBettingActionCompletion] Hand 39: RETURNING result: handEnded=false, roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG betAction] Hand 39: handleBettingActionCompletion returned: handEnded=false, roundAdvanced=false
[DEBUG betAction] Hand 39: RETURNING from transaction
[DEBUG betAction] Hand 39: Context - hand.round=TURN, handEnded=false, roundAdvanced=false, winnerSeatNumber=null
[DEBUG betAction] Hand 39: RETURNING from transaction - Final values: handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG betAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=39

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG callAction] Hand 39: Player seat 1 calling 10000000 in round TURN, currentBet=10000000, chipsCommitted before=0
[DEBUG callAction] Hand 39: Creating CALL action with: handId=39, seatNumber=1, round=TURN, amount=10000000
[DEBUG createActionAndEvent] Hand 39: Creating action with: {"handId":39,"seatNumber":1,"round":"TURN","action":"CALL","amount":"10000000","handRound":"TURN","roundParam":"TURN","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG createActionAndEvent] Hand 39: Action created successfully: {"id":221,"seatNumber":1,"action":"CALL","round":"TURN","amount":"10000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG callAction] Hand 39: CALL action created successfully: {"id":221,"seatNumber":1,"action":"CALL","round":"TURN","amount":"10000000"}
[DEBUG callAction] Hand 39: CALL action created, chipsCommitted now=10000000

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG callAction] Hand 39: After CALL by seat 1, checking if round complete
[DEBUG isBettingRoundComplete] Hand 39: Starting check
[DEBUG isBettingRoundComplete] Hand 39: Querying hand with: {"where":{"id":39}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG isBettingRoundComplete] Hand 39: Query result - hand={"id":39,"round":"TURN","currentBet":"10000000","currentActionSeat":1,"status":"TURN"}
[DEBUG isBettingRoundComplete] Hand 39: currentBet=10000000, currentRound=TURN
[DEBUG isBettingRoundComplete] Hand 39: Querying handPlayers with: {"where":{"handId":39}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG isBettingRoundComplete] Hand 39: Query returned 2 handPlayers: [{"id":77,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"10000000"},{"id":78,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"10000000"}]
[DEBUG isBettingRoundComplete] Hand 39: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 39: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 39: Querying roundActions with: {
  "where": {
    "handId": 39,
    "round": "TURN",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG isBettingRoundComplete] Hand 39: Query returned 2 roundActions for round TURN: [{"id":220,"seatNumber":0,"action":"RAISE","amount":"10000000","round":"TURN"},{"id":221,"seatNumber":1,"action":"CALL","amount":"10000000","round":"TURN"}]
[DEBUG isBettingRoundComplete] Hand 39: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 39: Checking 2 active players against actedSeats and currentBet=10000000
[DEBUG isBettingRoundComplete] Hand 39: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=10000000, currentBet=10000000)
[DEBUG isBettingRoundComplete] Hand 39: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=10000000, currentBet=10000000)
[DEBUG isBettingRoundComplete] Hand 39: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=10000000, currentBet=10000000)
[DEBUG isBettingRoundComplete] Hand 39: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=10000000, currentBet=10000000)
[DEBUG isBettingRoundComplete] Hand 39: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 39: Context - activePlayers=2, actedSeats=[0,1], currentBet=10000000, currentRound=TURN, roundActions queried=2, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 39: Active players detail: [{"seatNumber":0,"chipsCommitted":"10000000","status":"ACTIVE","hasActed":true,"hasMatched":true},{"seatNumber":1,"chipsCommitted":"10000000","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG callAction] Hand 39: isBettingRoundComplete returned true
[DEBUG callAction] Hand 39: Round complete, calling handleBettingRoundComplete
[DEBUG handleBettingRoundComplete] Hand 39: Called with currentRound=TURN
[DEBUG handleBettingRoundComplete] Hand 39: Advancing from TURN to next round
[DEBUG advanceBettingRound] Hand 39: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG advanceBettingRound] Hand 39: needsSidePots=false
[DEBUG advanceBettingRound] Hand 39: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG advanceBettingRound] Hand 39: Querying hand with: {"where":{"id":39},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG advanceBettingRound] Hand 39: Query result - hand.round=TURN, players=2
[DEBUG advanceBettingRound] Hand 39: currentRound=TURN, deckPosition=8, communityCards.length=4
[DEBUG advanceBettingRound] Hand 39: Advancing from TURN to RIVER, cardsToDeal=1
[DEBUG advanceBettingRound] Hand 39: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 39: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '10000000' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '10000000' }
]
[DEBUG advanceBettingRound] Hand 39: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 39: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 39: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 39: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 39: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG advanceBettingRound] Hand 39: Updating hand state: round=RIVER, status=RIVER, currentActionSeat=0, newCommunityCards.length=5
[DEBUG advanceBettingRound] Hand 39: Updating hand with: {"where":{"id":39},"data":{"round":"RIVER","status":"RIVER","communityCards":"[5 cards]","deckPosition":9,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG advanceBettingRound] Hand 39: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG advanceBettingRound] Hand 39: RETURNING false - Round advanced successfully from TURN to RIVER (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG handleBettingRoundComplete] Hand 39: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 39: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG handleBettingRoundComplete] Hand 39: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 39: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG callAction] Hand 39: handleBettingRoundComplete returned handEnded=false, roundAdvanced=true
[DEBUG callAction] Hand 39: RETURNING from transaction - Round complete
[DEBUG callAction] Hand 39: Context - hand.round=TURN, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG callAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=39

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG betAction] Hand 39: Player seat 0 betting 15000000 in round RIVER, currentBet before=0, chipsCommitted before=0, isAllIn=false
[DEBUG betAction] Hand 39: Creating BET action - hand.round=RIVER, actionType=RAISE, eventActionType=BET
[DEBUG createActionAndEvent] Hand 39: Creating action with: {"handId":39,"seatNumber":0,"round":"RIVER","action":"RAISE","amount":"15000000","handRound":"RIVER","roundParam":"RIVER","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG createActionAndEvent] Hand 39: Action created successfully: {"id":222,"seatNumber":0,"action":"RAISE","round":"RIVER","amount":"15000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG betAction] Hand 39: BET action created successfully, checking if round complete
[DEBUG betAction] Hand 39: Checking if betting round complete after BET
[DEBUG betAction] Hand 39: Context before isBettingRoundComplete - hand.round=RIVER, currentBet=0, currentActionSeat=0
[DEBUG isBettingRoundComplete] Hand 39: Starting check
[DEBUG isBettingRoundComplete] Hand 39: Querying hand with: {"where":{"id":39}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG isBettingRoundComplete] Hand 39: Query result - hand={"id":39,"round":"RIVER","currentBet":"15000000","currentActionSeat":0,"status":"RIVER"}
[DEBUG isBettingRoundComplete] Hand 39: currentBet=15000000, currentRound=RIVER
[DEBUG isBettingRoundComplete] Hand 39: Querying handPlayers with: {"where":{"handId":39}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG isBettingRoundComplete] Hand 39: Query returned 2 handPlayers: [{"id":77,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"15000000"},{"id":78,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 39: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 39: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 39: Querying roundActions with: {
  "where": {
    "handId": 39,
    "round": "RIVER",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG isBettingRoundComplete] Hand 39: Query returned 1 roundActions for round RIVER: [{"id":222,"seatNumber":0,"action":"RAISE","amount":"15000000","round":"RIVER"}]
[DEBUG isBettingRoundComplete] Hand 39: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 39: Checking 2 active players against actedSeats and currentBet=15000000
[DEBUG isBettingRoundComplete] Hand 39: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=15000000, currentBet=15000000)
[DEBUG isBettingRoundComplete] Hand 39: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 39: Context - actedSeats=[0], playerSeat=1, currentRound=RIVER, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG betAction] Hand 39: isBettingRoundComplete returned false
[DEBUG handleBettingActionCompletion] Hand 39: Called with currentSeatNumber=0, currentRound=RIVER, bettingRoundComplete=false, isAllIn=false
[DEBUG handleBettingActionCompletion] Hand 39: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: Called with currentSeatNumber=0, currentRound=RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: Querying hand with: {"where":{"id":39},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: Query result - hand.round=RIVER, currentRound param=RIVER, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"15000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: nextPlayer seat=1, chipsCommitted=0, currentBet=15000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: Next player hasn't matched (chipsCommitted=0, currentBet=15000000)
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 39: Starting check
[DEBUG isBettingRoundComplete] Hand 39: Querying hand with: {"where":{"id":39}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG isBettingRoundComplete] Hand 39: Query result - hand={"id":39,"round":"RIVER","currentBet":"15000000","currentActionSeat":0,"status":"RIVER"}
[DEBUG isBettingRoundComplete] Hand 39: currentBet=15000000, currentRound=RIVER
[DEBUG isBettingRoundComplete] Hand 39: Querying handPlayers with: {"where":{"handId":39}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG isBettingRoundComplete] Hand 39: Query returned 2 handPlayers: [{"id":77,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"15000000"},{"id":78,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 39: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 39: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 39: Querying roundActions with: {
  "where": {
    "handId": 39,
    "round": "RIVER",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG isBettingRoundComplete] Hand 39: Query returned 1 roundActions for round RIVER: [{"id":222,"seatNumber":0,"action":"RAISE","amount":"15000000","round":"RIVER"}]
[DEBUG isBettingRoundComplete] Hand 39: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 39: Checking 2 active players against actedSeats and currentBet=15000000
[DEBUG isBettingRoundComplete] Hand 39: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=15000000, currentBet=15000000)
[DEBUG isBettingRoundComplete] Hand 39: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 39: Context - actedSeats=[0], playerSeat=1, currentRound=RIVER, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: Updating hand with: {"where":{"id":39},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 39: Context - currentRound=RIVER, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG handleBettingActionCompletion] Hand 39: RETURNING result: handEnded=false, roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG betAction] Hand 39: handleBettingActionCompletion returned: handEnded=false, roundAdvanced=false
[DEBUG betAction] Hand 39: RETURNING from transaction
[DEBUG betAction] Hand 39: Context - hand.round=RIVER, handEnded=false, roundAdvanced=false, winnerSeatNumber=null
[DEBUG betAction] Hand 39: RETURNING from transaction - Final values: handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG betAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=39

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG callAction] Hand 39: Player seat 1 calling 15000000 in round RIVER, currentBet=15000000, chipsCommitted before=0
[DEBUG callAction] Hand 39: Creating CALL action with: handId=39, seatNumber=1, round=RIVER, amount=15000000
[DEBUG createActionAndEvent] Hand 39: Creating action with: {"handId":39,"seatNumber":1,"round":"RIVER","action":"CALL","amount":"15000000","handRound":"RIVER","roundParam":"RIVER","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG createActionAndEvent] Hand 39: Action created successfully: {"id":223,"seatNumber":1,"action":"CALL","round":"RIVER","amount":"15000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG callAction] Hand 39: CALL action created successfully: {"id":223,"seatNumber":1,"action":"CALL","round":"RIVER","amount":"15000000"}
[DEBUG callAction] Hand 39: CALL action created, chipsCommitted now=15000000

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG callAction] Hand 39: After CALL by seat 1, checking if round complete
[DEBUG isBettingRoundComplete] Hand 39: Starting check
[DEBUG isBettingRoundComplete] Hand 39: Querying hand with: {"where":{"id":39}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG isBettingRoundComplete] Hand 39: Query result - hand={"id":39,"round":"RIVER","currentBet":"15000000","currentActionSeat":1,"status":"RIVER"}
[DEBUG isBettingRoundComplete] Hand 39: currentBet=15000000, currentRound=RIVER
[DEBUG isBettingRoundComplete] Hand 39: Querying handPlayers with: {"where":{"handId":39}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG isBettingRoundComplete] Hand 39: Query returned 2 handPlayers: [{"id":77,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"15000000"},{"id":78,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"15000000"}]
[DEBUG isBettingRoundComplete] Hand 39: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 39: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 39: Querying roundActions with: {
  "where": {
    "handId": 39,
    "round": "RIVER",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG isBettingRoundComplete] Hand 39: Query returned 2 roundActions for round RIVER: [{"id":222,"seatNumber":0,"action":"RAISE","amount":"15000000","round":"RIVER"},{"id":223,"seatNumber":1,"action":"CALL","amount":"15000000","round":"RIVER"}]
[DEBUG isBettingRoundComplete] Hand 39: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 39: Checking 2 active players against actedSeats and currentBet=15000000
[DEBUG isBettingRoundComplete] Hand 39: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=15000000, currentBet=15000000)
[DEBUG isBettingRoundComplete] Hand 39: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=15000000, currentBet=15000000)
[DEBUG isBettingRoundComplete] Hand 39: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=15000000, currentBet=15000000)
[DEBUG isBettingRoundComplete] Hand 39: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=15000000, currentBet=15000000)
[DEBUG isBettingRoundComplete] Hand 39: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 39: Context - activePlayers=2, actedSeats=[0,1], currentBet=15000000, currentRound=RIVER, roundActions queried=2, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 39: Active players detail: [{"seatNumber":0,"chipsCommitted":"15000000","status":"ACTIVE","hasActed":true,"hasMatched":true},{"seatNumber":1,"chipsCommitted":"15000000","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG callAction] Hand 39: isBettingRoundComplete returned true
[DEBUG callAction] Hand 39: Round complete, calling handleBettingRoundComplete
[DEBUG handleBettingRoundComplete] Hand 39: Called with currentRound=RIVER
[DEBUG handleBettingRoundComplete] Hand 39: RIVER round, settling hand via showdown

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG handleBettingRoundComplete] Hand 39: Hand settled, winnerSeatNumber=1
[DEBUG handleBettingRoundComplete] Hand 39: RETURNING result with settlement: handEnded=true, roundAdvanced=false, winnerSeatNumber=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG callAction] Hand 39: handleBettingRoundComplete returned handEnded=true, roundAdvanced=false
[DEBUG callAction] Hand 39: RETURNING from transaction - Round complete
[DEBUG callAction] Hand 39: Context - hand.round=RIVER, handEnded=true, roundAdvanced=false, winnerSeatNumber=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-001: Full Hand with Betting on Every Round
[DEBUG callAction] RETURNING final result: handEnded=true, roundAdvanced=false, tableId=39

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG callAction] Hand 40: Player seat 0 calling 1000000 in round PRE_FLOP, currentBet=2000000, chipsCommitted before=1000000
[DEBUG callAction] Hand 40: Creating CALL action with: handId=40, seatNumber=0, round=PRE_FLOP, amount=1000000
[DEBUG createActionAndEvent] Hand 40: Creating action with: {"handId":40,"seatNumber":0,"round":"PRE_FLOP","action":"CALL","amount":"1000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG createActionAndEvent] Hand 40: Action created successfully: {"id":226,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"1000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG callAction] Hand 40: CALL action created successfully: {"id":226,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"1000000"}
[DEBUG callAction] Hand 40: CALL action created, chipsCommitted now=2000000

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG callAction] Hand 40: After CALL by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 40: Starting check
[DEBUG isBettingRoundComplete] Hand 40: Querying hand with: {"where":{"id":40}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG isBettingRoundComplete] Hand 40: Query result - hand={"id":40,"round":"PRE_FLOP","currentBet":"2000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 40: currentBet=2000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 40: Querying handPlayers with: {"where":{"handId":40}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG isBettingRoundComplete] Hand 40: Query returned 2 handPlayers: [{"id":79,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"id":80,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG isBettingRoundComplete] Hand 40: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 40: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 40: Querying roundActions with: {
  "where": {
    "handId": 40,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG isBettingRoundComplete] Hand 40: Query returned 1 roundActions for round PRE_FLOP: [{"id":226,"seatNumber":0,"action":"CALL","amount":"1000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 40: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 40: Checking 2 active players against actedSeats and currentBet=2000000
[DEBUG isBettingRoundComplete] Hand 40: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=2000000, currentBet=2000000)
[DEBUG isBettingRoundComplete] Hand 40: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 40: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG callAction] Hand 40: isBettingRoundComplete returned false
[DEBUG callAction] Hand 40: Round not complete, checking auto-advance or next player

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG callAction] Hand 40: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: Called with currentSeatNumber=0, currentRound=PRE_FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: Querying hand with: {"where":{"id":40},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: Query result - hand.round=PRE_FLOP, currentRound param=PRE_FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: nextPlayer seat=1, chipsCommitted=2000000, currentBet=2000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: Next player has matched bet (currentBet > 0n), checking if all acted and matched
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: Querying roundActions with: {
  "where": {
    "handId": 40,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: Query returned 1 roundActions for round PRE_FLOP: [{"id":226,"seatNumber":0,"action":"CALL","amount":"1000000","round":"PRE_FLOP"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: allActivePlayers (2): [
  { seatNumber: 0, chipsCommitted: '2000000', status: 'ACTIVE' },
  { seatNumber: 1, chipsCommitted: '2000000', status: 'ACTIVE' }
]
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: Wrap-around check - allActed=false, allMatched=true, actedSeats=0, playersWhoHaventActed=1, onlyNextPlayerHaventActed=true
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: Round complete detected - RETURNING early with round completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: Context - allActed=false, onlyNextPlayerHaventActed=true, allMatched=true, currentRound=PRE_FLOP, nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: Context - allActivePlayers=[{"seat":0,"chipsCommitted":"2000000","status":"ACTIVE"},{"seat":1,"chipsCommitted":"2000000","status":"ACTIVE"}], actedSeats=[0], roundActions found=1
[DEBUG handleBettingRoundComplete] Hand 40: Called with currentRound=PRE_FLOP
[DEBUG handleBettingRoundComplete] Hand 40: Advancing from PRE_FLOP to next round
[DEBUG advanceBettingRound] Hand 40: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG advanceBettingRound] Hand 40: needsSidePots=false
[DEBUG advanceBettingRound] Hand 40: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG advanceBettingRound] Hand 40: Querying hand with: {"where":{"id":40},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG advanceBettingRound] Hand 40: Query result - hand.round=PRE_FLOP, players=2
[DEBUG advanceBettingRound] Hand 40: currentRound=PRE_FLOP, deckPosition=4, communityCards.length=0
[DEBUG advanceBettingRound] Hand 40: Advancing from PRE_FLOP to FLOP, cardsToDeal=3
[DEBUG advanceBettingRound] Hand 40: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 40: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '2000000' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '2000000' }
]
[DEBUG advanceBettingRound] Hand 40: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 40: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 40: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 40: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 40: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG advanceBettingRound] Hand 40: Updating hand state: round=FLOP, status=FLOP, currentActionSeat=0, newCommunityCards.length=3
[DEBUG advanceBettingRound] Hand 40: Updating hand with: {"where":{"id":40},"data":{"round":"FLOP","status":"FLOP","communityCards":"[3 cards]","deckPosition":7,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG advanceBettingRound] Hand 40: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG advanceBettingRound] Hand 40: RETURNING false - Round advanced successfully from PRE_FLOP to FLOP (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG handleBettingRoundComplete] Hand 40: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 40: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG handleBettingRoundComplete] Hand 40: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 40: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: RETURNING result from handleBettingRoundComplete: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG callAction] Hand 40: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=true
[DEBUG callAction] Hand 40: RETURNING from transaction - Final result
[DEBUG callAction] Hand 40: Context - hand.round=PRE_FLOP, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG callAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=40

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG checkAction] Hand 40: Player seat 0 checking in round FLOP
[DEBUG checkAction] Hand 40: Creating CHECK action with: {"handId":40,"seatNumber":0,"round":"FLOP","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG checkAction] Hand 40: CHECK action created successfully: {"id":227,"seatNumber":0,"action":"CHECK","round":"FLOP","amount":null}
[DEBUG checkAction] Hand 40: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG checkAction] Hand 40: After CHECK by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 40: Starting check
[DEBUG isBettingRoundComplete] Hand 40: Querying hand with: {"where":{"id":40}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG isBettingRoundComplete] Hand 40: Query result - hand={"id":40,"round":"FLOP","currentBet":"0","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 40: currentBet=0, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 40: Querying handPlayers with: {"where":{"handId":40}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG isBettingRoundComplete] Hand 40: Query returned 2 handPlayers: [{"id":79,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":80,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 40: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 40: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 40: Querying roundActions with: {
  "where": {
    "handId": 40,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG isBettingRoundComplete] Hand 40: Query returned 1 roundActions for round FLOP: [{"id":227,"seatNumber":0,"action":"CHECK","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 40: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 40: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 40: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 40: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 40: Context - actedSeats=[0], playerSeat=1, currentRound=FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG checkAction] Hand 40: isBettingRoundComplete returned false
[DEBUG checkAction] Hand 40: Round not complete, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: Called with currentSeatNumber=0, currentRound=FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: Querying hand with: {"where":{"id":40},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: Query result - hand.round=FLOP, currentRound param=FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: nextPlayer seat=1, chipsCommitted=0, currentBet=0
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: Zero-bet wrap-around, advancing to next player (will complete after they act)
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 40: Starting check
[DEBUG isBettingRoundComplete] Hand 40: Querying hand with: {"where":{"id":40}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG isBettingRoundComplete] Hand 40: Query result - hand={"id":40,"round":"FLOP","currentBet":"0","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 40: currentBet=0, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 40: Querying handPlayers with: {"where":{"handId":40}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG isBettingRoundComplete] Hand 40: Query returned 2 handPlayers: [{"id":79,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":80,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 40: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 40: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 40: Querying roundActions with: {
  "where": {
    "handId": 40,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG isBettingRoundComplete] Hand 40: Query returned 1 roundActions for round FLOP: [{"id":227,"seatNumber":0,"action":"CHECK","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 40: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 40: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 40: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 40: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 40: Context - actedSeats=[0], playerSeat=1, currentRound=FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: Updating hand with: {"where":{"id":40},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: Context - currentRound=FLOP, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG checkAction] Hand 40: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=false
[DEBUG checkAction] Hand 40: RETURNING from transaction - Final result
[DEBUG checkAction] Hand 40: Context - hand.round=FLOP, handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG checkAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=40

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG checkAction] Hand 40: Player seat 1 checking in round FLOP
[DEBUG checkAction] Hand 40: Creating CHECK action with: {"handId":40,"seatNumber":1,"round":"FLOP","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG checkAction] Hand 40: CHECK action created successfully: {"id":228,"seatNumber":1,"action":"CHECK","round":"FLOP","amount":null}
[DEBUG checkAction] Hand 40: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG checkAction] Hand 40: After CHECK by seat 1, checking if round complete
[DEBUG isBettingRoundComplete] Hand 40: Starting check
[DEBUG isBettingRoundComplete] Hand 40: Querying hand with: {"where":{"id":40}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG isBettingRoundComplete] Hand 40: Query result - hand={"id":40,"round":"FLOP","currentBet":"0","currentActionSeat":1,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 40: currentBet=0, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 40: Querying handPlayers with: {"where":{"handId":40}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG isBettingRoundComplete] Hand 40: Query returned 2 handPlayers: [{"id":79,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":80,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 40: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 40: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 40: Querying roundActions with: {
  "where": {
    "handId": 40,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG isBettingRoundComplete] Hand 40: Query returned 2 roundActions for round FLOP: [{"id":227,"seatNumber":0,"action":"CHECK","round":"FLOP"},{"id":228,"seatNumber":1,"action":"CHECK","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 40: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 40: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 40: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 40: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 40: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 40: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 40: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 40: Context - activePlayers=2, actedSeats=[0,1], currentBet=0, currentRound=FLOP, roundActions queried=2, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 40: Active players detail: [{"seatNumber":0,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true},{"seatNumber":1,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG checkAction] Hand 40: isBettingRoundComplete returned true
[DEBUG checkAction] Hand 40: Round complete, calling handleBettingRoundComplete
[DEBUG handleBettingRoundComplete] Hand 40: Called with currentRound=FLOP
[DEBUG handleBettingRoundComplete] Hand 40: Advancing from FLOP to next round
[DEBUG advanceBettingRound] Hand 40: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG advanceBettingRound] Hand 40: needsSidePots=false
[DEBUG advanceBettingRound] Hand 40: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG advanceBettingRound] Hand 40: Querying hand with: {"where":{"id":40},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG advanceBettingRound] Hand 40: Query result - hand.round=FLOP, players=2
[DEBUG advanceBettingRound] Hand 40: currentRound=FLOP, deckPosition=7, communityCards.length=3
[DEBUG advanceBettingRound] Hand 40: Advancing from FLOP to TURN, cardsToDeal=1
[DEBUG advanceBettingRound] Hand 40: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 40: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '0' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '0' }
]
[DEBUG advanceBettingRound] Hand 40: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 40: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 40: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 40: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 40: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG advanceBettingRound] Hand 40: Updating hand state: round=TURN, status=TURN, currentActionSeat=0, newCommunityCards.length=4
[DEBUG advanceBettingRound] Hand 40: Updating hand with: {"where":{"id":40},"data":{"round":"TURN","status":"TURN","communityCards":"[4 cards]","deckPosition":8,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG advanceBettingRound] Hand 40: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG advanceBettingRound] Hand 40: RETURNING false - Round advanced successfully from FLOP to TURN (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG handleBettingRoundComplete] Hand 40: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 40: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG handleBettingRoundComplete] Hand 40: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 40: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG checkAction] Hand 40: handleBettingRoundComplete returned handEnded=false, roundAdvanced=true
[DEBUG checkAction] Hand 40: RETURNING from transaction - Round complete
[DEBUG checkAction] Hand 40: Context - hand.round=FLOP, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG checkAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=40

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG checkAction] Hand 40: Player seat 0 checking in round TURN
[DEBUG checkAction] Hand 40: Creating CHECK action with: {"handId":40,"seatNumber":0,"round":"TURN","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG checkAction] Hand 40: CHECK action created successfully: {"id":229,"seatNumber":0,"action":"CHECK","round":"TURN","amount":null}
[DEBUG checkAction] Hand 40: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG checkAction] Hand 40: After CHECK by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 40: Starting check
[DEBUG isBettingRoundComplete] Hand 40: Querying hand with: {"where":{"id":40}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG isBettingRoundComplete] Hand 40: Query result - hand={"id":40,"round":"TURN","currentBet":"0","currentActionSeat":0,"status":"TURN"}
[DEBUG isBettingRoundComplete] Hand 40: currentBet=0, currentRound=TURN
[DEBUG isBettingRoundComplete] Hand 40: Querying handPlayers with: {"where":{"handId":40}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG isBettingRoundComplete] Hand 40: Query returned 2 handPlayers: [{"id":79,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":80,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 40: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 40: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 40: Querying roundActions with: {
  "where": {
    "handId": 40,
    "round": "TURN",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG isBettingRoundComplete] Hand 40: Query returned 1 roundActions for round TURN: [{"id":229,"seatNumber":0,"action":"CHECK","round":"TURN"}]
[DEBUG isBettingRoundComplete] Hand 40: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 40: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 40: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 40: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 40: Context - actedSeats=[0], playerSeat=1, currentRound=TURN, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG checkAction] Hand 40: isBettingRoundComplete returned false
[DEBUG checkAction] Hand 40: Round not complete, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: Called with currentSeatNumber=0, currentRound=TURN

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: Querying hand with: {"where":{"id":40},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: Query result - hand.round=TURN, currentRound param=TURN, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: nextPlayer seat=1, chipsCommitted=0, currentBet=0
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: Zero-bet wrap-around, advancing to next player (will complete after they act)
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 40: Starting check
[DEBUG isBettingRoundComplete] Hand 40: Querying hand with: {"where":{"id":40}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG isBettingRoundComplete] Hand 40: Query result - hand={"id":40,"round":"TURN","currentBet":"0","currentActionSeat":0,"status":"TURN"}
[DEBUG isBettingRoundComplete] Hand 40: currentBet=0, currentRound=TURN
[DEBUG isBettingRoundComplete] Hand 40: Querying handPlayers with: {"where":{"handId":40}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG isBettingRoundComplete] Hand 40: Query returned 2 handPlayers: [{"id":79,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":80,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 40: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 40: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 40: Querying roundActions with: {
  "where": {
    "handId": 40,
    "round": "TURN",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG isBettingRoundComplete] Hand 40: Query returned 1 roundActions for round TURN: [{"id":229,"seatNumber":0,"action":"CHECK","round":"TURN"}]
[DEBUG isBettingRoundComplete] Hand 40: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 40: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 40: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 40: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 40: Context - actedSeats=[0], playerSeat=1, currentRound=TURN, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: Updating hand with: {"where":{"id":40},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: Context - currentRound=TURN, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG checkAction] Hand 40: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=false
[DEBUG checkAction] Hand 40: RETURNING from transaction - Final result
[DEBUG checkAction] Hand 40: Context - hand.round=TURN, handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG checkAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=40

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG checkAction] Hand 40: Player seat 1 checking in round TURN
[DEBUG checkAction] Hand 40: Creating CHECK action with: {"handId":40,"seatNumber":1,"round":"TURN","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG checkAction] Hand 40: CHECK action created successfully: {"id":230,"seatNumber":1,"action":"CHECK","round":"TURN","amount":null}
[DEBUG checkAction] Hand 40: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG checkAction] Hand 40: After CHECK by seat 1, checking if round complete
[DEBUG isBettingRoundComplete] Hand 40: Starting check
[DEBUG isBettingRoundComplete] Hand 40: Querying hand with: {"where":{"id":40}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG isBettingRoundComplete] Hand 40: Query result - hand={"id":40,"round":"TURN","currentBet":"0","currentActionSeat":1,"status":"TURN"}
[DEBUG isBettingRoundComplete] Hand 40: currentBet=0, currentRound=TURN
[DEBUG isBettingRoundComplete] Hand 40: Querying handPlayers with: {"where":{"handId":40}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG isBettingRoundComplete] Hand 40: Query returned 2 handPlayers: [{"id":79,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":80,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 40: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 40: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 40: Querying roundActions with: {
  "where": {
    "handId": 40,
    "round": "TURN",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG isBettingRoundComplete] Hand 40: Query returned 2 roundActions for round TURN: [{"id":229,"seatNumber":0,"action":"CHECK","round":"TURN"},{"id":230,"seatNumber":1,"action":"CHECK","round":"TURN"}]
[DEBUG isBettingRoundComplete] Hand 40: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 40: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 40: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 40: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 40: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 40: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 40: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 40: Context - activePlayers=2, actedSeats=[0,1], currentBet=0, currentRound=TURN, roundActions queried=2, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 40: Active players detail: [{"seatNumber":0,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true},{"seatNumber":1,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG checkAction] Hand 40: isBettingRoundComplete returned true
[DEBUG checkAction] Hand 40: Round complete, calling handleBettingRoundComplete
[DEBUG handleBettingRoundComplete] Hand 40: Called with currentRound=TURN
[DEBUG handleBettingRoundComplete] Hand 40: Advancing from TURN to next round
[DEBUG advanceBettingRound] Hand 40: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG advanceBettingRound] Hand 40: needsSidePots=false
[DEBUG advanceBettingRound] Hand 40: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG advanceBettingRound] Hand 40: Querying hand with: {"where":{"id":40},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG advanceBettingRound] Hand 40: Query result - hand.round=TURN, players=2
[DEBUG advanceBettingRound] Hand 40: currentRound=TURN, deckPosition=8, communityCards.length=4
[DEBUG advanceBettingRound] Hand 40: Advancing from TURN to RIVER, cardsToDeal=1
[DEBUG advanceBettingRound] Hand 40: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 40: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '0' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '0' }
]
[DEBUG advanceBettingRound] Hand 40: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 40: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 40: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 40: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 40: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG advanceBettingRound] Hand 40: Updating hand state: round=RIVER, status=RIVER, currentActionSeat=0, newCommunityCards.length=5
[DEBUG advanceBettingRound] Hand 40: Updating hand with: {"where":{"id":40},"data":{"round":"RIVER","status":"RIVER","communityCards":"[5 cards]","deckPosition":9,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG advanceBettingRound] Hand 40: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG advanceBettingRound] Hand 40: RETURNING false - Round advanced successfully from TURN to RIVER (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG handleBettingRoundComplete] Hand 40: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 40: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG handleBettingRoundComplete] Hand 40: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 40: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG checkAction] Hand 40: handleBettingRoundComplete returned handEnded=false, roundAdvanced=true
[DEBUG checkAction] Hand 40: RETURNING from transaction - Round complete
[DEBUG checkAction] Hand 40: Context - hand.round=TURN, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG checkAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=40

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG checkAction] Hand 40: Player seat 0 checking in round RIVER
[DEBUG checkAction] Hand 40: Creating CHECK action with: {"handId":40,"seatNumber":0,"round":"RIVER","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG checkAction] Hand 40: CHECK action created successfully: {"id":231,"seatNumber":0,"action":"CHECK","round":"RIVER","amount":null}
[DEBUG checkAction] Hand 40: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG checkAction] Hand 40: After CHECK by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 40: Starting check
[DEBUG isBettingRoundComplete] Hand 40: Querying hand with: {"where":{"id":40}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG isBettingRoundComplete] Hand 40: Query result - hand={"id":40,"round":"RIVER","currentBet":"0","currentActionSeat":0,"status":"RIVER"}
[DEBUG isBettingRoundComplete] Hand 40: currentBet=0, currentRound=RIVER
[DEBUG isBettingRoundComplete] Hand 40: Querying handPlayers with: {"where":{"handId":40}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG isBettingRoundComplete] Hand 40: Query returned 2 handPlayers: [{"id":79,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":80,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 40: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 40: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 40: Querying roundActions with: {
  "where": {
    "handId": 40,
    "round": "RIVER",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG isBettingRoundComplete] Hand 40: Query returned 1 roundActions for round RIVER: [{"id":231,"seatNumber":0,"action":"CHECK","round":"RIVER"}]
[DEBUG isBettingRoundComplete] Hand 40: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 40: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 40: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 40: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 40: Context - actedSeats=[0], playerSeat=1, currentRound=RIVER, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG checkAction] Hand 40: isBettingRoundComplete returned false
[DEBUG checkAction] Hand 40: Round not complete, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: Called with currentSeatNumber=0, currentRound=RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: Querying hand with: {"where":{"id":40},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: Query result - hand.round=RIVER, currentRound param=RIVER, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: nextPlayer seat=1, chipsCommitted=0, currentBet=0
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: Zero-bet wrap-around, advancing to next player (will complete after they act)
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 40: Starting check
[DEBUG isBettingRoundComplete] Hand 40: Querying hand with: {"where":{"id":40}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG isBettingRoundComplete] Hand 40: Query result - hand={"id":40,"round":"RIVER","currentBet":"0","currentActionSeat":0,"status":"RIVER"}
[DEBUG isBettingRoundComplete] Hand 40: currentBet=0, currentRound=RIVER
[DEBUG isBettingRoundComplete] Hand 40: Querying handPlayers with: {"where":{"handId":40}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG isBettingRoundComplete] Hand 40: Query returned 2 handPlayers: [{"id":79,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":80,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 40: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 40: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 40: Querying roundActions with: {
  "where": {
    "handId": 40,
    "round": "RIVER",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG isBettingRoundComplete] Hand 40: Query returned 1 roundActions for round RIVER: [{"id":231,"seatNumber":0,"action":"CHECK","round":"RIVER"}]
[DEBUG isBettingRoundComplete] Hand 40: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 40: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 40: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 40: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 40: Context - actedSeats=[0], playerSeat=1, currentRound=RIVER, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: Updating hand with: {"where":{"id":40},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 40: Context - currentRound=RIVER, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG checkAction] Hand 40: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=false
[DEBUG checkAction] Hand 40: RETURNING from transaction - Final result
[DEBUG checkAction] Hand 40: Context - hand.round=RIVER, handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG checkAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=40

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG checkAction] Hand 40: Player seat 1 checking in round RIVER
[DEBUG checkAction] Hand 40: Creating CHECK action with: {"handId":40,"seatNumber":1,"round":"RIVER","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG checkAction] Hand 40: CHECK action created successfully: {"id":232,"seatNumber":1,"action":"CHECK","round":"RIVER","amount":null}
[DEBUG checkAction] Hand 40: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG checkAction] Hand 40: After CHECK by seat 1, checking if round complete
[DEBUG isBettingRoundComplete] Hand 40: Starting check
[DEBUG isBettingRoundComplete] Hand 40: Querying hand with: {"where":{"id":40}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG isBettingRoundComplete] Hand 40: Query result - hand={"id":40,"round":"RIVER","currentBet":"0","currentActionSeat":1,"status":"RIVER"}
[DEBUG isBettingRoundComplete] Hand 40: currentBet=0, currentRound=RIVER
[DEBUG isBettingRoundComplete] Hand 40: Querying handPlayers with: {"where":{"handId":40}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG isBettingRoundComplete] Hand 40: Query returned 2 handPlayers: [{"id":79,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":80,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 40: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 40: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 40: Querying roundActions with: {
  "where": {
    "handId": 40,
    "round": "RIVER",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG isBettingRoundComplete] Hand 40: Query returned 2 roundActions for round RIVER: [{"id":231,"seatNumber":0,"action":"CHECK","round":"RIVER"},{"id":232,"seatNumber":1,"action":"CHECK","round":"RIVER"}]
[DEBUG isBettingRoundComplete] Hand 40: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 40: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 40: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 40: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 40: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 40: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 40: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 40: Context - activePlayers=2, actedSeats=[0,1], currentBet=0, currentRound=RIVER, roundActions queried=2, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 40: Active players detail: [{"seatNumber":0,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true},{"seatNumber":1,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG checkAction] Hand 40: isBettingRoundComplete returned true
[DEBUG checkAction] Hand 40: Round complete, calling handleBettingRoundComplete
[DEBUG handleBettingRoundComplete] Hand 40: Called with currentRound=RIVER
[DEBUG handleBettingRoundComplete] Hand 40: RIVER round, settling hand via showdown

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG handleBettingRoundComplete] Hand 40: Hand settled, winnerSeatNumber=1
[DEBUG handleBettingRoundComplete] Hand 40: RETURNING result with settlement: handEnded=true, roundAdvanced=false, winnerSeatNumber=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG checkAction] Hand 40: handleBettingRoundComplete returned handEnded=true, roundAdvanced=false
[DEBUG checkAction] Hand 40: RETURNING from transaction - Round complete
[DEBUG checkAction] Hand 40: Context - hand.round=RIVER, handEnded=true, roundAdvanced=false, winnerSeatNumber=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks
[DEBUG checkAction] RETURNING final result: handEnded=true, roundAdvanced=false, tableId=40

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG callAction] Hand 41: Player seat 0 calling 1000000 in round PRE_FLOP, currentBet=2000000, chipsCommitted before=1000000
[DEBUG callAction] Hand 41: Creating CALL action with: handId=41, seatNumber=0, round=PRE_FLOP, amount=1000000
[DEBUG createActionAndEvent] Hand 41: Creating action with: {"handId":41,"seatNumber":0,"round":"PRE_FLOP","action":"CALL","amount":"1000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG createActionAndEvent] Hand 41: Action created successfully: {"id":235,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"1000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG callAction] Hand 41: CALL action created successfully: {"id":235,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"1000000"}
[DEBUG callAction] Hand 41: CALL action created, chipsCommitted now=2000000

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG callAction] Hand 41: After CALL by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 41: Starting check
[DEBUG isBettingRoundComplete] Hand 41: Querying hand with: {"where":{"id":41}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 41: Query result - hand={"id":41,"round":"PRE_FLOP","currentBet":"2000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 41: currentBet=2000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 41: Querying handPlayers with: {"where":{"handId":41}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 41: Query returned 2 handPlayers: [{"id":81,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"id":82,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG isBettingRoundComplete] Hand 41: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 41: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 41: Querying roundActions with: {
  "where": {
    "handId": 41,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 41: Query returned 1 roundActions for round PRE_FLOP: [{"id":235,"seatNumber":0,"action":"CALL","amount":"1000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 41: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 41: Checking 2 active players against actedSeats and currentBet=2000000
[DEBUG isBettingRoundComplete] Hand 41: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=2000000, currentBet=2000000)
[DEBUG isBettingRoundComplete] Hand 41: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 41: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG callAction] Hand 41: isBettingRoundComplete returned false
[DEBUG callAction] Hand 41: Round not complete, checking auto-advance or next player

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG callAction] Hand 41: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: Called with currentSeatNumber=0, currentRound=PRE_FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: Querying hand with: {"where":{"id":41},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: Query result - hand.round=PRE_FLOP, currentRound param=PRE_FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: nextPlayer seat=1, chipsCommitted=2000000, currentBet=2000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: Next player has matched bet (currentBet > 0n), checking if all acted and matched
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: Querying roundActions with: {
  "where": {
    "handId": 41,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: Query returned 1 roundActions for round PRE_FLOP: [{"id":235,"seatNumber":0,"action":"CALL","amount":"1000000","round":"PRE_FLOP"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: allActivePlayers (2): [
  { seatNumber: 0, chipsCommitted: '2000000', status: 'ACTIVE' },
  { seatNumber: 1, chipsCommitted: '2000000', status: 'ACTIVE' }
]
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: Wrap-around check - allActed=false, allMatched=true, actedSeats=0, playersWhoHaventActed=1, onlyNextPlayerHaventActed=true
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: Round complete detected - RETURNING early with round completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: Context - allActed=false, onlyNextPlayerHaventActed=true, allMatched=true, currentRound=PRE_FLOP, nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: Context - allActivePlayers=[{"seat":0,"chipsCommitted":"2000000","status":"ACTIVE"},{"seat":1,"chipsCommitted":"2000000","status":"ACTIVE"}], actedSeats=[0], roundActions found=1
[DEBUG handleBettingRoundComplete] Hand 41: Called with currentRound=PRE_FLOP
[DEBUG handleBettingRoundComplete] Hand 41: Advancing from PRE_FLOP to next round
[DEBUG advanceBettingRound] Hand 41: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG advanceBettingRound] Hand 41: needsSidePots=false
[DEBUG advanceBettingRound] Hand 41: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG advanceBettingRound] Hand 41: Querying hand with: {"where":{"id":41},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG advanceBettingRound] Hand 41: Query result - hand.round=PRE_FLOP, players=2
[DEBUG advanceBettingRound] Hand 41: currentRound=PRE_FLOP, deckPosition=4, communityCards.length=0
[DEBUG advanceBettingRound] Hand 41: Advancing from PRE_FLOP to FLOP, cardsToDeal=3
[DEBUG advanceBettingRound] Hand 41: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 41: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '2000000' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '2000000' }
]
[DEBUG advanceBettingRound] Hand 41: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 41: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 41: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 41: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 41: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG advanceBettingRound] Hand 41: Updating hand state: round=FLOP, status=FLOP, currentActionSeat=0, newCommunityCards.length=3
[DEBUG advanceBettingRound] Hand 41: Updating hand with: {"where":{"id":41},"data":{"round":"FLOP","status":"FLOP","communityCards":"[3 cards]","deckPosition":7,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG advanceBettingRound] Hand 41: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG advanceBettingRound] Hand 41: RETURNING false - Round advanced successfully from PRE_FLOP to FLOP (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG handleBettingRoundComplete] Hand 41: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 41: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG handleBettingRoundComplete] Hand 41: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 41: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: RETURNING result from handleBettingRoundComplete: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG callAction] Hand 41: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=true
[DEBUG callAction] Hand 41: RETURNING from transaction - Final result
[DEBUG callAction] Hand 41: Context - hand.round=PRE_FLOP, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG callAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=41

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG checkAction] Hand 41: Player seat 0 checking in round FLOP
[DEBUG checkAction] Hand 41: Creating CHECK action with: {"handId":41,"seatNumber":0,"round":"FLOP","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG checkAction] Hand 41: CHECK action created successfully: {"id":236,"seatNumber":0,"action":"CHECK","round":"FLOP","amount":null}
[DEBUG checkAction] Hand 41: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG checkAction] Hand 41: After CHECK by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 41: Starting check
[DEBUG isBettingRoundComplete] Hand 41: Querying hand with: {"where":{"id":41}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 41: Query result - hand={"id":41,"round":"FLOP","currentBet":"0","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 41: currentBet=0, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 41: Querying handPlayers with: {"where":{"handId":41}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 41: Query returned 2 handPlayers: [{"id":81,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":82,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 41: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 41: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 41: Querying roundActions with: {
  "where": {
    "handId": 41,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 41: Query returned 1 roundActions for round FLOP: [{"id":236,"seatNumber":0,"action":"CHECK","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 41: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 41: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 41: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 41: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 41: Context - actedSeats=[0], playerSeat=1, currentRound=FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG checkAction] Hand 41: isBettingRoundComplete returned false
[DEBUG checkAction] Hand 41: Round not complete, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: Called with currentSeatNumber=0, currentRound=FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: Querying hand with: {"where":{"id":41},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: Query result - hand.round=FLOP, currentRound param=FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: nextPlayer seat=1, chipsCommitted=0, currentBet=0
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: Zero-bet wrap-around, advancing to next player (will complete after they act)
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 41: Starting check
[DEBUG isBettingRoundComplete] Hand 41: Querying hand with: {"where":{"id":41}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 41: Query result - hand={"id":41,"round":"FLOP","currentBet":"0","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 41: currentBet=0, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 41: Querying handPlayers with: {"where":{"handId":41}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 41: Query returned 2 handPlayers: [{"id":81,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":82,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 41: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 41: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 41: Querying roundActions with: {
  "where": {
    "handId": 41,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 41: Query returned 1 roundActions for round FLOP: [{"id":236,"seatNumber":0,"action":"CHECK","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 41: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 41: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 41: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 41: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 41: Context - actedSeats=[0], playerSeat=1, currentRound=FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: Updating hand with: {"where":{"id":41},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: Context - currentRound=FLOP, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG checkAction] Hand 41: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=false
[DEBUG checkAction] Hand 41: RETURNING from transaction - Final result
[DEBUG checkAction] Hand 41: Context - hand.round=FLOP, handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG checkAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=41

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG checkAction] Hand 41: Player seat 1 checking in round FLOP
[DEBUG checkAction] Hand 41: Creating CHECK action with: {"handId":41,"seatNumber":1,"round":"FLOP","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG checkAction] Hand 41: CHECK action created successfully: {"id":237,"seatNumber":1,"action":"CHECK","round":"FLOP","amount":null}
[DEBUG checkAction] Hand 41: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG checkAction] Hand 41: After CHECK by seat 1, checking if round complete
[DEBUG isBettingRoundComplete] Hand 41: Starting check
[DEBUG isBettingRoundComplete] Hand 41: Querying hand with: {"where":{"id":41}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 41: Query result - hand={"id":41,"round":"FLOP","currentBet":"0","currentActionSeat":1,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 41: currentBet=0, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 41: Querying handPlayers with: {"where":{"handId":41}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 41: Query returned 2 handPlayers: [{"id":81,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":82,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 41: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 41: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 41: Querying roundActions with: {
  "where": {
    "handId": 41,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 41: Query returned 2 roundActions for round FLOP: [{"id":236,"seatNumber":0,"action":"CHECK","round":"FLOP"},{"id":237,"seatNumber":1,"action":"CHECK","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 41: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 41: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 41: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 41: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 41: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 41: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 41: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 41: Context - activePlayers=2, actedSeats=[0,1], currentBet=0, currentRound=FLOP, roundActions queried=2, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 41: Active players detail: [{"seatNumber":0,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true},{"seatNumber":1,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG checkAction] Hand 41: isBettingRoundComplete returned true
[DEBUG checkAction] Hand 41: Round complete, calling handleBettingRoundComplete
[DEBUG handleBettingRoundComplete] Hand 41: Called with currentRound=FLOP
[DEBUG handleBettingRoundComplete] Hand 41: Advancing from FLOP to next round
[DEBUG advanceBettingRound] Hand 41: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG advanceBettingRound] Hand 41: needsSidePots=false
[DEBUG advanceBettingRound] Hand 41: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG advanceBettingRound] Hand 41: Querying hand with: {"where":{"id":41},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG advanceBettingRound] Hand 41: Query result - hand.round=FLOP, players=2
[DEBUG advanceBettingRound] Hand 41: currentRound=FLOP, deckPosition=7, communityCards.length=3
[DEBUG advanceBettingRound] Hand 41: Advancing from FLOP to TURN, cardsToDeal=1
[DEBUG advanceBettingRound] Hand 41: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 41: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '0' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '0' }
]
[DEBUG advanceBettingRound] Hand 41: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 41: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 41: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 41: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 41: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG advanceBettingRound] Hand 41: Updating hand state: round=TURN, status=TURN, currentActionSeat=0, newCommunityCards.length=4
[DEBUG advanceBettingRound] Hand 41: Updating hand with: {"where":{"id":41},"data":{"round":"TURN","status":"TURN","communityCards":"[4 cards]","deckPosition":8,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG advanceBettingRound] Hand 41: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG advanceBettingRound] Hand 41: RETURNING false - Round advanced successfully from FLOP to TURN (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG handleBettingRoundComplete] Hand 41: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 41: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG handleBettingRoundComplete] Hand 41: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 41: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG checkAction] Hand 41: handleBettingRoundComplete returned handEnded=false, roundAdvanced=true
[DEBUG checkAction] Hand 41: RETURNING from transaction - Round complete
[DEBUG checkAction] Hand 41: Context - hand.round=FLOP, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG checkAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=41

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG checkAction] Hand 41: Player seat 0 checking in round TURN
[DEBUG checkAction] Hand 41: Creating CHECK action with: {"handId":41,"seatNumber":0,"round":"TURN","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG checkAction] Hand 41: CHECK action created successfully: {"id":238,"seatNumber":0,"action":"CHECK","round":"TURN","amount":null}
[DEBUG checkAction] Hand 41: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG checkAction] Hand 41: After CHECK by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 41: Starting check
[DEBUG isBettingRoundComplete] Hand 41: Querying hand with: {"where":{"id":41}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 41: Query result - hand={"id":41,"round":"TURN","currentBet":"0","currentActionSeat":0,"status":"TURN"}
[DEBUG isBettingRoundComplete] Hand 41: currentBet=0, currentRound=TURN
[DEBUG isBettingRoundComplete] Hand 41: Querying handPlayers with: {"where":{"handId":41}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 41: Query returned 2 handPlayers: [{"id":81,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":82,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 41: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 41: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 41: Querying roundActions with: {
  "where": {
    "handId": 41,
    "round": "TURN",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 41: Query returned 1 roundActions for round TURN: [{"id":238,"seatNumber":0,"action":"CHECK","round":"TURN"}]
[DEBUG isBettingRoundComplete] Hand 41: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 41: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 41: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 41: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 41: Context - actedSeats=[0], playerSeat=1, currentRound=TURN, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG checkAction] Hand 41: isBettingRoundComplete returned false
[DEBUG checkAction] Hand 41: Round not complete, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: Called with currentSeatNumber=0, currentRound=TURN

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: Querying hand with: {"where":{"id":41},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: Query result - hand.round=TURN, currentRound param=TURN, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: nextPlayer seat=1, chipsCommitted=0, currentBet=0
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: Zero-bet wrap-around, advancing to next player (will complete after they act)
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 41: Starting check
[DEBUG isBettingRoundComplete] Hand 41: Querying hand with: {"where":{"id":41}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 41: Query result - hand={"id":41,"round":"TURN","currentBet":"0","currentActionSeat":0,"status":"TURN"}
[DEBUG isBettingRoundComplete] Hand 41: currentBet=0, currentRound=TURN
[DEBUG isBettingRoundComplete] Hand 41: Querying handPlayers with: {"where":{"handId":41}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 41: Query returned 2 handPlayers: [{"id":81,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":82,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 41: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 41: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 41: Querying roundActions with: {
  "where": {
    "handId": 41,
    "round": "TURN",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 41: Query returned 1 roundActions for round TURN: [{"id":238,"seatNumber":0,"action":"CHECK","round":"TURN"}]
[DEBUG isBettingRoundComplete] Hand 41: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 41: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 41: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 41: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 41: Context - actedSeats=[0], playerSeat=1, currentRound=TURN, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: Updating hand with: {"where":{"id":41},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: Context - currentRound=TURN, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG checkAction] Hand 41: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=false
[DEBUG checkAction] Hand 41: RETURNING from transaction - Final result
[DEBUG checkAction] Hand 41: Context - hand.round=TURN, handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG checkAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=41

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG checkAction] Hand 41: Player seat 1 checking in round TURN
[DEBUG checkAction] Hand 41: Creating CHECK action with: {"handId":41,"seatNumber":1,"round":"TURN","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG checkAction] Hand 41: CHECK action created successfully: {"id":239,"seatNumber":1,"action":"CHECK","round":"TURN","amount":null}
[DEBUG checkAction] Hand 41: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG checkAction] Hand 41: After CHECK by seat 1, checking if round complete
[DEBUG isBettingRoundComplete] Hand 41: Starting check
[DEBUG isBettingRoundComplete] Hand 41: Querying hand with: {"where":{"id":41}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 41: Query result - hand={"id":41,"round":"TURN","currentBet":"0","currentActionSeat":1,"status":"TURN"}
[DEBUG isBettingRoundComplete] Hand 41: currentBet=0, currentRound=TURN
[DEBUG isBettingRoundComplete] Hand 41: Querying handPlayers with: {"where":{"handId":41}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 41: Query returned 2 handPlayers: [{"id":81,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":82,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 41: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 41: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 41: Querying roundActions with: {
  "where": {
    "handId": 41,
    "round": "TURN",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 41: Query returned 2 roundActions for round TURN: [{"id":238,"seatNumber":0,"action":"CHECK","round":"TURN"},{"id":239,"seatNumber":1,"action":"CHECK","round":"TURN"}]
[DEBUG isBettingRoundComplete] Hand 41: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 41: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 41: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 41: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 41: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 41: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 41: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 41: Context - activePlayers=2, actedSeats=[0,1], currentBet=0, currentRound=TURN, roundActions queried=2, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 41: Active players detail: [{"seatNumber":0,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true},{"seatNumber":1,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG checkAction] Hand 41: isBettingRoundComplete returned true
[DEBUG checkAction] Hand 41: Round complete, calling handleBettingRoundComplete
[DEBUG handleBettingRoundComplete] Hand 41: Called with currentRound=TURN
[DEBUG handleBettingRoundComplete] Hand 41: Advancing from TURN to next round
[DEBUG advanceBettingRound] Hand 41: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG advanceBettingRound] Hand 41: needsSidePots=false
[DEBUG advanceBettingRound] Hand 41: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG advanceBettingRound] Hand 41: Querying hand with: {"where":{"id":41},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG advanceBettingRound] Hand 41: Query result - hand.round=TURN, players=2
[DEBUG advanceBettingRound] Hand 41: currentRound=TURN, deckPosition=8, communityCards.length=4
[DEBUG advanceBettingRound] Hand 41: Advancing from TURN to RIVER, cardsToDeal=1
[DEBUG advanceBettingRound] Hand 41: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 41: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '0' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '0' }
]
[DEBUG advanceBettingRound] Hand 41: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 41: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 41: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 41: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 41: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG advanceBettingRound] Hand 41: Updating hand state: round=RIVER, status=RIVER, currentActionSeat=0, newCommunityCards.length=5
[DEBUG advanceBettingRound] Hand 41: Updating hand with: {"where":{"id":41},"data":{"round":"RIVER","status":"RIVER","communityCards":"[5 cards]","deckPosition":9,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG advanceBettingRound] Hand 41: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG advanceBettingRound] Hand 41: RETURNING false - Round advanced successfully from TURN to RIVER (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG handleBettingRoundComplete] Hand 41: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 41: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG handleBettingRoundComplete] Hand 41: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 41: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG checkAction] Hand 41: handleBettingRoundComplete returned handEnded=false, roundAdvanced=true
[DEBUG checkAction] Hand 41: RETURNING from transaction - Round complete
[DEBUG checkAction] Hand 41: Context - hand.round=TURN, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG checkAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=41

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG checkAction] Hand 41: Player seat 0 checking in round RIVER
[DEBUG checkAction] Hand 41: Creating CHECK action with: {"handId":41,"seatNumber":0,"round":"RIVER","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG checkAction] Hand 41: CHECK action created successfully: {"id":240,"seatNumber":0,"action":"CHECK","round":"RIVER","amount":null}
[DEBUG checkAction] Hand 41: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG checkAction] Hand 41: After CHECK by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 41: Starting check
[DEBUG isBettingRoundComplete] Hand 41: Querying hand with: {"where":{"id":41}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 41: Query result - hand={"id":41,"round":"RIVER","currentBet":"0","currentActionSeat":0,"status":"RIVER"}
[DEBUG isBettingRoundComplete] Hand 41: currentBet=0, currentRound=RIVER
[DEBUG isBettingRoundComplete] Hand 41: Querying handPlayers with: {"where":{"handId":41}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 41: Query returned 2 handPlayers: [{"id":81,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":82,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 41: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 41: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 41: Querying roundActions with: {
  "where": {
    "handId": 41,
    "round": "RIVER",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 41: Query returned 1 roundActions for round RIVER: [{"id":240,"seatNumber":0,"action":"CHECK","round":"RIVER"}]
[DEBUG isBettingRoundComplete] Hand 41: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 41: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 41: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 41: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 41: Context - actedSeats=[0], playerSeat=1, currentRound=RIVER, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG checkAction] Hand 41: isBettingRoundComplete returned false
[DEBUG checkAction] Hand 41: Round not complete, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: Called with currentSeatNumber=0, currentRound=RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: Querying hand with: {"where":{"id":41},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: Query result - hand.round=RIVER, currentRound param=RIVER, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: nextPlayer seat=1, chipsCommitted=0, currentBet=0
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: Zero-bet wrap-around, advancing to next player (will complete after they act)
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 41: Starting check
[DEBUG isBettingRoundComplete] Hand 41: Querying hand with: {"where":{"id":41}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 41: Query result - hand={"id":41,"round":"RIVER","currentBet":"0","currentActionSeat":0,"status":"RIVER"}
[DEBUG isBettingRoundComplete] Hand 41: currentBet=0, currentRound=RIVER
[DEBUG isBettingRoundComplete] Hand 41: Querying handPlayers with: {"where":{"handId":41}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 41: Query returned 2 handPlayers: [{"id":81,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":82,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 41: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 41: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 41: Querying roundActions with: {
  "where": {
    "handId": 41,
    "round": "RIVER",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 41: Query returned 1 roundActions for round RIVER: [{"id":240,"seatNumber":0,"action":"CHECK","round":"RIVER"}]
[DEBUG isBettingRoundComplete] Hand 41: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 41: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 41: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 41: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 41: Context - actedSeats=[0], playerSeat=1, currentRound=RIVER, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: Updating hand with: {"where":{"id":41},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 41: Context - currentRound=RIVER, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG checkAction] Hand 41: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=false
[DEBUG checkAction] Hand 41: RETURNING from transaction - Final result
[DEBUG checkAction] Hand 41: Context - hand.round=RIVER, handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG checkAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=41

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG checkAction] Hand 41: Player seat 1 checking in round RIVER
[DEBUG checkAction] Hand 41: Creating CHECK action with: {"handId":41,"seatNumber":1,"round":"RIVER","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG checkAction] Hand 41: CHECK action created successfully: {"id":241,"seatNumber":1,"action":"CHECK","round":"RIVER","amount":null}
[DEBUG checkAction] Hand 41: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG checkAction] Hand 41: After CHECK by seat 1, checking if round complete
[DEBUG isBettingRoundComplete] Hand 41: Starting check
[DEBUG isBettingRoundComplete] Hand 41: Querying hand with: {"where":{"id":41}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 41: Query result - hand={"id":41,"round":"RIVER","currentBet":"0","currentActionSeat":1,"status":"RIVER"}
[DEBUG isBettingRoundComplete] Hand 41: currentBet=0, currentRound=RIVER
[DEBUG isBettingRoundComplete] Hand 41: Querying handPlayers with: {"where":{"handId":41}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 41: Query returned 2 handPlayers: [{"id":81,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":82,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 41: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 41: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 41: Querying roundActions with: {
  "where": {
    "handId": 41,
    "round": "RIVER",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG isBettingRoundComplete] Hand 41: Query returned 2 roundActions for round RIVER: [{"id":240,"seatNumber":0,"action":"CHECK","round":"RIVER"},{"id":241,"seatNumber":1,"action":"CHECK","round":"RIVER"}]
[DEBUG isBettingRoundComplete] Hand 41: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 41: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 41: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 41: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 41: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 41: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 41: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 41: Context - activePlayers=2, actedSeats=[0,1], currentBet=0, currentRound=RIVER, roundActions queried=2, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 41: Active players detail: [{"seatNumber":0,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true},{"seatNumber":1,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG checkAction] Hand 41: isBettingRoundComplete returned true
[DEBUG checkAction] Hand 41: Round complete, calling handleBettingRoundComplete
[DEBUG handleBettingRoundComplete] Hand 41: Called with currentRound=RIVER
[DEBUG handleBettingRoundComplete] Hand 41: RIVER round, settling hand via showdown

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
ðŸ’° Added rake 280000 gwei to TEE balance (hand 41)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG handleBettingRoundComplete] Hand 41: Hand settled, winnerSeatNumber=1
[DEBUG handleBettingRoundComplete] Hand 41: RETURNING result with settlement: handEnded=true, roundAdvanced=false, winnerSeatNumber=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG checkAction] Hand 41: handleBettingRoundComplete returned handEnded=true, roundAdvanced=false
[DEBUG checkAction] Hand 41: RETURNING from transaction - Round complete
[DEBUG checkAction] Hand 41: Context - hand.round=RIVER, handEnded=true, roundAdvanced=false, winnerSeatNumber=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > MULTI-ROUND Scenarios > MR-003: Full Hand with All Checks - 700 bps rake
[DEBUG checkAction] RETURNING final result: handEnded=true, roundAdvanced=false, tableId=41

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG callAction] Hand 42: Player seat 0 calling 1000000 in round PRE_FLOP, currentBet=2000000, chipsCommitted before=1000000
[DEBUG callAction] Hand 42: Creating CALL action with: handId=42, seatNumber=0, round=PRE_FLOP, amount=1000000
[DEBUG createActionAndEvent] Hand 42: Creating action with: {"handId":42,"seatNumber":0,"round":"PRE_FLOP","action":"CALL","amount":"1000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG createActionAndEvent] Hand 42: Action created successfully: {"id":244,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"1000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG callAction] Hand 42: CALL action created successfully: {"id":244,"seatNumber":0,"action":"CALL","round":"PRE_FLOP","amount":"1000000"}
[DEBUG callAction] Hand 42: CALL action created, chipsCommitted now=2000000

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG callAction] Hand 42: After CALL by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 42: Starting check
[DEBUG isBettingRoundComplete] Hand 42: Querying hand with: {"where":{"id":42}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG isBettingRoundComplete] Hand 42: Query result - hand={"id":42,"round":"PRE_FLOP","currentBet":"2000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 42: currentBet=2000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 42: Querying handPlayers with: {"where":{"handId":42}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG isBettingRoundComplete] Hand 42: Query returned 2 handPlayers: [{"id":83,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"id":84,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG isBettingRoundComplete] Hand 42: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 42: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 42: Querying roundActions with: {
  "where": {
    "handId": 42,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG isBettingRoundComplete] Hand 42: Query returned 1 roundActions for round PRE_FLOP: [{"id":244,"seatNumber":0,"action":"CALL","amount":"1000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 42: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 42: Checking 2 active players against actedSeats and currentBet=2000000
[DEBUG isBettingRoundComplete] Hand 42: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=2000000, currentBet=2000000)
[DEBUG isBettingRoundComplete] Hand 42: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 42: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG callAction] Hand 42: isBettingRoundComplete returned false
[DEBUG callAction] Hand 42: Round not complete, checking auto-advance or next player

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG callAction] Hand 42: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: Called with currentSeatNumber=0, currentRound=PRE_FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: Querying hand with: {"where":{"id":42},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: Query result - hand.round=PRE_FLOP, currentRound param=PRE_FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: nextPlayer seat=1, chipsCommitted=2000000, currentBet=2000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: Next player has matched bet (currentBet > 0n), checking if all acted and matched
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: Querying roundActions with: {
  "where": {
    "handId": 42,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: Query returned 1 roundActions for round PRE_FLOP: [{"id":244,"seatNumber":0,"action":"CALL","amount":"1000000","round":"PRE_FLOP"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: allActivePlayers (2): [
  { seatNumber: 0, chipsCommitted: '2000000', status: 'ACTIVE' },
  { seatNumber: 1, chipsCommitted: '2000000', status: 'ACTIVE' }
]
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: Wrap-around check - allActed=false, allMatched=true, actedSeats=0, playersWhoHaventActed=1, onlyNextPlayerHaventActed=true
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: Round complete detected - RETURNING early with round completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: Context - allActed=false, onlyNextPlayerHaventActed=true, allMatched=true, currentRound=PRE_FLOP, nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: Context - allActivePlayers=[{"seat":0,"chipsCommitted":"2000000","status":"ACTIVE"},{"seat":1,"chipsCommitted":"2000000","status":"ACTIVE"}], actedSeats=[0], roundActions found=1
[DEBUG handleBettingRoundComplete] Hand 42: Called with currentRound=PRE_FLOP
[DEBUG handleBettingRoundComplete] Hand 42: Advancing from PRE_FLOP to next round
[DEBUG advanceBettingRound] Hand 42: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG advanceBettingRound] Hand 42: needsSidePots=false
[DEBUG advanceBettingRound] Hand 42: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG advanceBettingRound] Hand 42: Querying hand with: {"where":{"id":42},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG advanceBettingRound] Hand 42: Query result - hand.round=PRE_FLOP, players=2
[DEBUG advanceBettingRound] Hand 42: currentRound=PRE_FLOP, deckPosition=4, communityCards.length=0
[DEBUG advanceBettingRound] Hand 42: Advancing from PRE_FLOP to FLOP, cardsToDeal=3
[DEBUG advanceBettingRound] Hand 42: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 42: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '2000000' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '2000000' }
]
[DEBUG advanceBettingRound] Hand 42: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 42: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 42: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 42: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 42: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG advanceBettingRound] Hand 42: Updating hand state: round=FLOP, status=FLOP, currentActionSeat=0, newCommunityCards.length=3
[DEBUG advanceBettingRound] Hand 42: Updating hand with: {"where":{"id":42},"data":{"round":"FLOP","status":"FLOP","communityCards":"[3 cards]","deckPosition":7,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG advanceBettingRound] Hand 42: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG advanceBettingRound] Hand 42: RETURNING false - Round advanced successfully from PRE_FLOP to FLOP (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG handleBettingRoundComplete] Hand 42: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 42: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG handleBettingRoundComplete] Hand 42: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 42: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: RETURNING result from handleBettingRoundComplete: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG callAction] Hand 42: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=true
[DEBUG callAction] Hand 42: RETURNING from transaction - Final result
[DEBUG callAction] Hand 42: Context - hand.round=PRE_FLOP, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG callAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=42

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG checkAction] Hand 42: Player seat 0 checking in round FLOP
[DEBUG checkAction] Hand 42: Creating CHECK action with: {"handId":42,"seatNumber":0,"round":"FLOP","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG checkAction] Hand 42: CHECK action created successfully: {"id":245,"seatNumber":0,"action":"CHECK","round":"FLOP","amount":null}
[DEBUG checkAction] Hand 42: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG checkAction] Hand 42: After CHECK by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 42: Starting check
[DEBUG isBettingRoundComplete] Hand 42: Querying hand with: {"where":{"id":42}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG isBettingRoundComplete] Hand 42: Query result - hand={"id":42,"round":"FLOP","currentBet":"0","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 42: currentBet=0, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 42: Querying handPlayers with: {"where":{"handId":42}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG isBettingRoundComplete] Hand 42: Query returned 2 handPlayers: [{"id":83,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":84,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 42: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 42: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 42: Querying roundActions with: {
  "where": {
    "handId": 42,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG isBettingRoundComplete] Hand 42: Query returned 1 roundActions for round FLOP: [{"id":245,"seatNumber":0,"action":"CHECK","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 42: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 42: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 42: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 42: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 42: Context - actedSeats=[0], playerSeat=1, currentRound=FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG checkAction] Hand 42: isBettingRoundComplete returned false
[DEBUG checkAction] Hand 42: Round not complete, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: Called with currentSeatNumber=0, currentRound=FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: Querying hand with: {"where":{"id":42},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: Query result - hand.round=FLOP, currentRound param=FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: nextPlayer seat=1, chipsCommitted=0, currentBet=0
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: Zero-bet wrap-around, advancing to next player (will complete after they act)
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 42: Starting check
[DEBUG isBettingRoundComplete] Hand 42: Querying hand with: {"where":{"id":42}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG isBettingRoundComplete] Hand 42: Query result - hand={"id":42,"round":"FLOP","currentBet":"0","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 42: currentBet=0, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 42: Querying handPlayers with: {"where":{"handId":42}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG isBettingRoundComplete] Hand 42: Query returned 2 handPlayers: [{"id":83,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":84,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 42: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 42: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 42: Querying roundActions with: {
  "where": {
    "handId": 42,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG isBettingRoundComplete] Hand 42: Query returned 1 roundActions for round FLOP: [{"id":245,"seatNumber":0,"action":"CHECK","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 42: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 42: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 42: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 42: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 42: Context - actedSeats=[0], playerSeat=1, currentRound=FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: Updating hand with: {"where":{"id":42},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: Context - currentRound=FLOP, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG checkAction] Hand 42: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=false
[DEBUG checkAction] Hand 42: RETURNING from transaction - Final result
[DEBUG checkAction] Hand 42: Context - hand.round=FLOP, handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG checkAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=42

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG checkAction] Hand 42: Player seat 1 checking in round FLOP
[DEBUG checkAction] Hand 42: Creating CHECK action with: {"handId":42,"seatNumber":1,"round":"FLOP","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG checkAction] Hand 42: CHECK action created successfully: {"id":246,"seatNumber":1,"action":"CHECK","round":"FLOP","amount":null}
[DEBUG checkAction] Hand 42: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG checkAction] Hand 42: After CHECK by seat 1, checking if round complete
[DEBUG isBettingRoundComplete] Hand 42: Starting check
[DEBUG isBettingRoundComplete] Hand 42: Querying hand with: {"where":{"id":42}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG isBettingRoundComplete] Hand 42: Query result - hand={"id":42,"round":"FLOP","currentBet":"0","currentActionSeat":1,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 42: currentBet=0, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 42: Querying handPlayers with: {"where":{"handId":42}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG isBettingRoundComplete] Hand 42: Query returned 2 handPlayers: [{"id":83,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":84,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 42: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 42: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 42: Querying roundActions with: {
  "where": {
    "handId": 42,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG isBettingRoundComplete] Hand 42: Query returned 2 roundActions for round FLOP: [{"id":245,"seatNumber":0,"action":"CHECK","round":"FLOP"},{"id":246,"seatNumber":1,"action":"CHECK","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 42: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 42: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 42: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 42: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 42: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 42: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 42: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 42: Context - activePlayers=2, actedSeats=[0,1], currentBet=0, currentRound=FLOP, roundActions queried=2, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 42: Active players detail: [{"seatNumber":0,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true},{"seatNumber":1,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG checkAction] Hand 42: isBettingRoundComplete returned true
[DEBUG checkAction] Hand 42: Round complete, calling handleBettingRoundComplete
[DEBUG handleBettingRoundComplete] Hand 42: Called with currentRound=FLOP
[DEBUG handleBettingRoundComplete] Hand 42: Advancing from FLOP to next round
[DEBUG advanceBettingRound] Hand 42: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG advanceBettingRound] Hand 42: needsSidePots=false
[DEBUG advanceBettingRound] Hand 42: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG advanceBettingRound] Hand 42: Querying hand with: {"where":{"id":42},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG advanceBettingRound] Hand 42: Query result - hand.round=FLOP, players=2
[DEBUG advanceBettingRound] Hand 42: currentRound=FLOP, deckPosition=7, communityCards.length=3
[DEBUG advanceBettingRound] Hand 42: Advancing from FLOP to TURN, cardsToDeal=1
[DEBUG advanceBettingRound] Hand 42: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 42: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '0' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '0' }
]
[DEBUG advanceBettingRound] Hand 42: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 42: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 42: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 42: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 42: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG advanceBettingRound] Hand 42: Updating hand state: round=TURN, status=TURN, currentActionSeat=0, newCommunityCards.length=4
[DEBUG advanceBettingRound] Hand 42: Updating hand with: {"where":{"id":42},"data":{"round":"TURN","status":"TURN","communityCards":"[4 cards]","deckPosition":8,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG advanceBettingRound] Hand 42: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG advanceBettingRound] Hand 42: RETURNING false - Round advanced successfully from FLOP to TURN (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG handleBettingRoundComplete] Hand 42: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 42: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG handleBettingRoundComplete] Hand 42: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 42: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG checkAction] Hand 42: handleBettingRoundComplete returned handEnded=false, roundAdvanced=true
[DEBUG checkAction] Hand 42: RETURNING from transaction - Round complete
[DEBUG checkAction] Hand 42: Context - hand.round=FLOP, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG checkAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=42

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG checkAction] Hand 42: Player seat 0 checking in round TURN
[DEBUG checkAction] Hand 42: Creating CHECK action with: {"handId":42,"seatNumber":0,"round":"TURN","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG checkAction] Hand 42: CHECK action created successfully: {"id":247,"seatNumber":0,"action":"CHECK","round":"TURN","amount":null}
[DEBUG checkAction] Hand 42: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG checkAction] Hand 42: After CHECK by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 42: Starting check
[DEBUG isBettingRoundComplete] Hand 42: Querying hand with: {"where":{"id":42}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG isBettingRoundComplete] Hand 42: Query result - hand={"id":42,"round":"TURN","currentBet":"0","currentActionSeat":0,"status":"TURN"}
[DEBUG isBettingRoundComplete] Hand 42: currentBet=0, currentRound=TURN
[DEBUG isBettingRoundComplete] Hand 42: Querying handPlayers with: {"where":{"handId":42}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG isBettingRoundComplete] Hand 42: Query returned 2 handPlayers: [{"id":83,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":84,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 42: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 42: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 42: Querying roundActions with: {
  "where": {
    "handId": 42,
    "round": "TURN",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG isBettingRoundComplete] Hand 42: Query returned 1 roundActions for round TURN: [{"id":247,"seatNumber":0,"action":"CHECK","round":"TURN"}]
[DEBUG isBettingRoundComplete] Hand 42: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 42: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 42: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 42: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 42: Context - actedSeats=[0], playerSeat=1, currentRound=TURN, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG checkAction] Hand 42: isBettingRoundComplete returned false
[DEBUG checkAction] Hand 42: Round not complete, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: Called with currentSeatNumber=0, currentRound=TURN

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: Querying hand with: {"where":{"id":42},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: Query result - hand.round=TURN, currentRound param=TURN, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: nextPlayer seat=1, chipsCommitted=0, currentBet=0
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: Zero-bet wrap-around, advancing to next player (will complete after they act)
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 42: Starting check
[DEBUG isBettingRoundComplete] Hand 42: Querying hand with: {"where":{"id":42}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG isBettingRoundComplete] Hand 42: Query result - hand={"id":42,"round":"TURN","currentBet":"0","currentActionSeat":0,"status":"TURN"}
[DEBUG isBettingRoundComplete] Hand 42: currentBet=0, currentRound=TURN
[DEBUG isBettingRoundComplete] Hand 42: Querying handPlayers with: {"where":{"handId":42}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG isBettingRoundComplete] Hand 42: Query returned 2 handPlayers: [{"id":83,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":84,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 42: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 42: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 42: Querying roundActions with: {
  "where": {
    "handId": 42,
    "round": "TURN",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG isBettingRoundComplete] Hand 42: Query returned 1 roundActions for round TURN: [{"id":247,"seatNumber":0,"action":"CHECK","round":"TURN"}]
[DEBUG isBettingRoundComplete] Hand 42: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 42: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 42: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 42: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 42: Context - actedSeats=[0], playerSeat=1, currentRound=TURN, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: Updating hand with: {"where":{"id":42},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: Context - currentRound=TURN, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG checkAction] Hand 42: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=false
[DEBUG checkAction] Hand 42: RETURNING from transaction - Final result
[DEBUG checkAction] Hand 42: Context - hand.round=TURN, handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG checkAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=42

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG checkAction] Hand 42: Player seat 1 checking in round TURN
[DEBUG checkAction] Hand 42: Creating CHECK action with: {"handId":42,"seatNumber":1,"round":"TURN","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG checkAction] Hand 42: CHECK action created successfully: {"id":248,"seatNumber":1,"action":"CHECK","round":"TURN","amount":null}
[DEBUG checkAction] Hand 42: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG checkAction] Hand 42: After CHECK by seat 1, checking if round complete
[DEBUG isBettingRoundComplete] Hand 42: Starting check
[DEBUG isBettingRoundComplete] Hand 42: Querying hand with: {"where":{"id":42}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG isBettingRoundComplete] Hand 42: Query result - hand={"id":42,"round":"TURN","currentBet":"0","currentActionSeat":1,"status":"TURN"}
[DEBUG isBettingRoundComplete] Hand 42: currentBet=0, currentRound=TURN
[DEBUG isBettingRoundComplete] Hand 42: Querying handPlayers with: {"where":{"handId":42}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG isBettingRoundComplete] Hand 42: Query returned 2 handPlayers: [{"id":83,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":84,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 42: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 42: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 42: Querying roundActions with: {
  "where": {
    "handId": 42,
    "round": "TURN",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG isBettingRoundComplete] Hand 42: Query returned 2 roundActions for round TURN: [{"id":247,"seatNumber":0,"action":"CHECK","round":"TURN"},{"id":248,"seatNumber":1,"action":"CHECK","round":"TURN"}]
[DEBUG isBettingRoundComplete] Hand 42: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 42: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 42: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 42: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 42: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 42: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 42: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 42: Context - activePlayers=2, actedSeats=[0,1], currentBet=0, currentRound=TURN, roundActions queried=2, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 42: Active players detail: [{"seatNumber":0,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true},{"seatNumber":1,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG checkAction] Hand 42: isBettingRoundComplete returned true
[DEBUG checkAction] Hand 42: Round complete, calling handleBettingRoundComplete
[DEBUG handleBettingRoundComplete] Hand 42: Called with currentRound=TURN
[DEBUG handleBettingRoundComplete] Hand 42: Advancing from TURN to next round
[DEBUG advanceBettingRound] Hand 42: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG advanceBettingRound] Hand 42: needsSidePots=false
[DEBUG advanceBettingRound] Hand 42: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG advanceBettingRound] Hand 42: Querying hand with: {"where":{"id":42},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG advanceBettingRound] Hand 42: Query result - hand.round=TURN, players=2
[DEBUG advanceBettingRound] Hand 42: currentRound=TURN, deckPosition=8, communityCards.length=4
[DEBUG advanceBettingRound] Hand 42: Advancing from TURN to RIVER, cardsToDeal=1
[DEBUG advanceBettingRound] Hand 42: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 42: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '0' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '0' }
]
[DEBUG advanceBettingRound] Hand 42: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 42: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 42: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 42: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 42: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG advanceBettingRound] Hand 42: Updating hand state: round=RIVER, status=RIVER, currentActionSeat=0, newCommunityCards.length=5
[DEBUG advanceBettingRound] Hand 42: Updating hand with: {"where":{"id":42},"data":{"round":"RIVER","status":"RIVER","communityCards":"[5 cards]","deckPosition":9,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG advanceBettingRound] Hand 42: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG advanceBettingRound] Hand 42: RETURNING false - Round advanced successfully from TURN to RIVER (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG handleBettingRoundComplete] Hand 42: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 42: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG handleBettingRoundComplete] Hand 42: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 42: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG checkAction] Hand 42: handleBettingRoundComplete returned handEnded=false, roundAdvanced=true
[DEBUG checkAction] Hand 42: RETURNING from transaction - Round complete
[DEBUG checkAction] Hand 42: Context - hand.round=TURN, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG checkAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=42

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG checkAction] Hand 42: Player seat 0 checking in round RIVER
[DEBUG checkAction] Hand 42: Creating CHECK action with: {"handId":42,"seatNumber":0,"round":"RIVER","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG checkAction] Hand 42: CHECK action created successfully: {"id":249,"seatNumber":0,"action":"CHECK","round":"RIVER","amount":null}
[DEBUG checkAction] Hand 42: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG checkAction] Hand 42: After CHECK by seat 0, checking if round complete
[DEBUG isBettingRoundComplete] Hand 42: Starting check
[DEBUG isBettingRoundComplete] Hand 42: Querying hand with: {"where":{"id":42}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG isBettingRoundComplete] Hand 42: Query result - hand={"id":42,"round":"RIVER","currentBet":"0","currentActionSeat":0,"status":"RIVER"}
[DEBUG isBettingRoundComplete] Hand 42: currentBet=0, currentRound=RIVER
[DEBUG isBettingRoundComplete] Hand 42: Querying handPlayers with: {"where":{"handId":42}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG isBettingRoundComplete] Hand 42: Query returned 2 handPlayers: [{"id":83,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":84,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 42: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 42: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 42: Querying roundActions with: {
  "where": {
    "handId": 42,
    "round": "RIVER",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG isBettingRoundComplete] Hand 42: Query returned 1 roundActions for round RIVER: [{"id":249,"seatNumber":0,"action":"CHECK","round":"RIVER"}]
[DEBUG isBettingRoundComplete] Hand 42: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 42: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 42: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 42: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 42: Context - actedSeats=[0], playerSeat=1, currentRound=RIVER, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG checkAction] Hand 42: isBettingRoundComplete returned false
[DEBUG checkAction] Hand 42: Round not complete, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: Called with currentSeatNumber=0, currentRound=RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: Querying hand with: {"where":{"id":42},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: Query result - hand.round=RIVER, currentRound param=RIVER, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: nextPlayer seat=1, chipsCommitted=0, currentBet=0
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: Zero-bet wrap-around, advancing to next player (will complete after they act)
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 42: Starting check
[DEBUG isBettingRoundComplete] Hand 42: Querying hand with: {"where":{"id":42}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG isBettingRoundComplete] Hand 42: Query result - hand={"id":42,"round":"RIVER","currentBet":"0","currentActionSeat":0,"status":"RIVER"}
[DEBUG isBettingRoundComplete] Hand 42: currentBet=0, currentRound=RIVER
[DEBUG isBettingRoundComplete] Hand 42: Querying handPlayers with: {"where":{"handId":42}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG isBettingRoundComplete] Hand 42: Query returned 2 handPlayers: [{"id":83,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":84,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 42: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 42: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 42: Querying roundActions with: {
  "where": {
    "handId": 42,
    "round": "RIVER",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG isBettingRoundComplete] Hand 42: Query returned 1 roundActions for round RIVER: [{"id":249,"seatNumber":0,"action":"CHECK","round":"RIVER"}]
[DEBUG isBettingRoundComplete] Hand 42: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 42: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 42: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 42: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 42: Context - actedSeats=[0], playerSeat=1, currentRound=RIVER, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: Updating hand with: {"where":{"id":42},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 42: Context - currentRound=RIVER, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG checkAction] Hand 42: Round completed in handleNextPlayerOrRoundComplete: handEnded=false, roundAdvanced=false
[DEBUG checkAction] Hand 42: RETURNING from transaction - Final result
[DEBUG checkAction] Hand 42: Context - hand.round=RIVER, handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG checkAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=42

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG checkAction] Hand 42: Player seat 1 checking in round RIVER
[DEBUG checkAction] Hand 42: Creating CHECK action with: {"handId":42,"seatNumber":1,"round":"RIVER","action":"CHECK","amount":null}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG checkAction] Hand 42: CHECK action created successfully: {"id":250,"seatNumber":1,"action":"CHECK","round":"RIVER","amount":null}
[DEBUG checkAction] Hand 42: CHECK action created, checking if round complete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG checkAction] Hand 42: After CHECK by seat 1, checking if round complete
[DEBUG isBettingRoundComplete] Hand 42: Starting check
[DEBUG isBettingRoundComplete] Hand 42: Querying hand with: {"where":{"id":42}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG isBettingRoundComplete] Hand 42: Query result - hand={"id":42,"round":"RIVER","currentBet":"0","currentActionSeat":1,"status":"RIVER"}
[DEBUG isBettingRoundComplete] Hand 42: currentBet=0, currentRound=RIVER
[DEBUG isBettingRoundComplete] Hand 42: Querying handPlayers with: {"where":{"handId":42}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG isBettingRoundComplete] Hand 42: Query returned 2 handPlayers: [{"id":83,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"0"},{"id":84,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 42: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 42: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 42: Querying roundActions with: {
  "where": {
    "handId": 42,
    "round": "RIVER",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG isBettingRoundComplete] Hand 42: Query returned 2 roundActions for round RIVER: [{"id":249,"seatNumber":0,"action":"CHECK","round":"RIVER"},{"id":250,"seatNumber":1,"action":"CHECK","round":"RIVER"}]
[DEBUG isBettingRoundComplete] Hand 42: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 42: Checking 2 active players against actedSeats and currentBet=0
[DEBUG isBettingRoundComplete] Hand 42: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 42: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 42: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 42: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=0, currentBet=0)
[DEBUG isBettingRoundComplete] Hand 42: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 42: Context - activePlayers=2, actedSeats=[0,1], currentBet=0, currentRound=RIVER, roundActions queried=2, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 42: Active players detail: [{"seatNumber":0,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true},{"seatNumber":1,"chipsCommitted":"0","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG checkAction] Hand 42: isBettingRoundComplete returned true
[DEBUG checkAction] Hand 42: Round complete, calling handleBettingRoundComplete
[DEBUG handleBettingRoundComplete] Hand 42: Called with currentRound=RIVER
[DEBUG handleBettingRoundComplete] Hand 42: RIVER round, settling hand via showdown

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG handleBettingRoundComplete] Hand 42: Hand settled, winnerSeatNumber=0
[DEBUG handleBettingRoundComplete] Hand 42: RETURNING result with settlement: handEnded=true, roundAdvanced=false, winnerSeatNumber=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG checkAction] Hand 42: handleBettingRoundComplete returned handEnded=true, roundAdvanced=false
[DEBUG checkAction] Hand 42: RETURNING from transaction - Round complete
[DEBUG checkAction] Hand 42: Context - hand.round=RIVER, handEnded=true, roundAdvanced=false, winnerSeatNumber=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > TIE Scenarios > TI-001: Tie on River (Same Hand Rank)
[DEBUG checkAction] RETURNING final result: handEnded=true, roundAdvanced=false, tableId=42

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG raiseAction] Hand 43: Player seat 0 raising 3000000 in round PRE_FLOP, currentBet before=2000000, chipsCommitted before=1000000, isAllIn=false
[DEBUG raiseAction] Hand 43: Creating RAISE action - hand.round=PRE_FLOP, actionType=RAISE, eventActionType=RAISE
[DEBUG createActionAndEvent] Hand 43: Creating action with: {"handId":43,"seatNumber":0,"round":"PRE_FLOP","action":"RAISE","amount":"3000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG createActionAndEvent] Hand 43: Action created successfully: {"id":253,"seatNumber":0,"action":"RAISE","round":"PRE_FLOP","amount":"3000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG raiseAction] Hand 43: RAISE action created successfully, checking if round complete
[DEBUG raiseAction] Hand 43: Checking if betting round complete after RAISE
[DEBUG raiseAction] Hand 43: Context before isBettingRoundComplete - hand.round=PRE_FLOP, currentBet=2000000, currentActionSeat=0
[DEBUG isBettingRoundComplete] Hand 43: Starting check
[DEBUG isBettingRoundComplete] Hand 43: Querying hand with: {"where":{"id":43}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG isBettingRoundComplete] Hand 43: Query result - hand={"id":43,"round":"PRE_FLOP","currentBet":"4000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 43: currentBet=4000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 43: Querying handPlayers with: {"where":{"handId":43}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG isBettingRoundComplete] Hand 43: Query returned 2 handPlayers: [{"id":85,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"4000000"},{"id":86,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG isBettingRoundComplete] Hand 43: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 43: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 43: Querying roundActions with: {
  "where": {
    "handId": 43,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG isBettingRoundComplete] Hand 43: Query returned 1 roundActions for round PRE_FLOP: [{"id":253,"seatNumber":0,"action":"RAISE","amount":"3000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 43: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 43: Checking 2 active players against actedSeats and currentBet=4000000
[DEBUG isBettingRoundComplete] Hand 43: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=4000000, currentBet=4000000)
[DEBUG isBettingRoundComplete] Hand 43: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 43: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG raiseAction] Hand 43: isBettingRoundComplete returned false
[DEBUG handleBettingActionCompletion] Hand 43: Called with currentSeatNumber=0, currentRound=PRE_FLOP, bettingRoundComplete=false, isAllIn=false
[DEBUG handleBettingActionCompletion] Hand 43: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: Called with currentSeatNumber=0, currentRound=PRE_FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: Querying hand with: {"where":{"id":43},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: Query result - hand.round=PRE_FLOP, currentRound param=PRE_FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"4000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: nextPlayer seat=1, chipsCommitted=2000000, currentBet=4000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: Next player hasn't matched (chipsCommitted=2000000, currentBet=4000000)
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 43: Starting check
[DEBUG isBettingRoundComplete] Hand 43: Querying hand with: {"where":{"id":43}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG isBettingRoundComplete] Hand 43: Query result - hand={"id":43,"round":"PRE_FLOP","currentBet":"4000000","currentActionSeat":0,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 43: currentBet=4000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 43: Querying handPlayers with: {"where":{"handId":43}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG isBettingRoundComplete] Hand 43: Query returned 2 handPlayers: [{"id":85,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"4000000"},{"id":86,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG isBettingRoundComplete] Hand 43: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 43: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 43: Querying roundActions with: {
  "where": {
    "handId": 43,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG isBettingRoundComplete] Hand 43: Query returned 1 roundActions for round PRE_FLOP: [{"id":253,"seatNumber":0,"action":"RAISE","amount":"3000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 43: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 43: Checking 2 active players against actedSeats and currentBet=4000000
[DEBUG isBettingRoundComplete] Hand 43: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=4000000, currentBet=4000000)
[DEBUG isBettingRoundComplete] Hand 43: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 43: Context - actedSeats=[0], playerSeat=1, currentRound=PRE_FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: Updating hand with: {"where":{"id":43},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: Context - currentRound=PRE_FLOP, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG handleBettingActionCompletion] Hand 43: RETURNING result: handEnded=false, roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG raiseAction] Hand 43: handleBettingActionCompletion returned: handEnded=false, roundAdvanced=false
[DEBUG raiseAction] Hand 43: RETURNING from transaction
[DEBUG raiseAction] Hand 43: Context - hand.round=PRE_FLOP, handEnded=false, roundAdvanced=false, winnerSeatNumber=null
[DEBUG raiseAction] Hand 43: RETURNING from transaction - Final values: handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG raiseAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=43

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG callAction] Hand 43: Player seat 1 calling 2000000 in round PRE_FLOP, currentBet=4000000, chipsCommitted before=2000000
[DEBUG callAction] Hand 43: Creating CALL action with: handId=43, seatNumber=1, round=PRE_FLOP, amount=2000000
[DEBUG createActionAndEvent] Hand 43: Creating action with: {"handId":43,"seatNumber":1,"round":"PRE_FLOP","action":"CALL","amount":"2000000","handRound":"PRE_FLOP","roundParam":"PRE_FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG createActionAndEvent] Hand 43: Action created successfully: {"id":254,"seatNumber":1,"action":"CALL","round":"PRE_FLOP","amount":"2000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG callAction] Hand 43: CALL action created successfully: {"id":254,"seatNumber":1,"action":"CALL","round":"PRE_FLOP","amount":"2000000"}
[DEBUG callAction] Hand 43: CALL action created, chipsCommitted now=4000000

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG callAction] Hand 43: After CALL by seat 1, checking if round complete
[DEBUG isBettingRoundComplete] Hand 43: Starting check
[DEBUG isBettingRoundComplete] Hand 43: Querying hand with: {"where":{"id":43}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG isBettingRoundComplete] Hand 43: Query result - hand={"id":43,"round":"PRE_FLOP","currentBet":"4000000","currentActionSeat":1,"status":"PRE_FLOP"}
[DEBUG isBettingRoundComplete] Hand 43: currentBet=4000000, currentRound=PRE_FLOP
[DEBUG isBettingRoundComplete] Hand 43: Querying handPlayers with: {"where":{"handId":43}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG isBettingRoundComplete] Hand 43: Query returned 2 handPlayers: [{"id":85,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"4000000"},{"id":86,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"4000000"}]
[DEBUG isBettingRoundComplete] Hand 43: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 43: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 43: Querying roundActions with: {
  "where": {
    "handId": 43,
    "round": "PRE_FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG isBettingRoundComplete] Hand 43: Query returned 2 roundActions for round PRE_FLOP: [{"id":253,"seatNumber":0,"action":"RAISE","amount":"3000000","round":"PRE_FLOP"},{"id":254,"seatNumber":1,"action":"CALL","amount":"2000000","round":"PRE_FLOP"}]
[DEBUG isBettingRoundComplete] Hand 43: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 43: Checking 2 active players against actedSeats and currentBet=4000000
[DEBUG isBettingRoundComplete] Hand 43: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=4000000, currentBet=4000000)
[DEBUG isBettingRoundComplete] Hand 43: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=4000000, currentBet=4000000)
[DEBUG isBettingRoundComplete] Hand 43: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=4000000, currentBet=4000000)
[DEBUG isBettingRoundComplete] Hand 43: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=4000000, currentBet=4000000)
[DEBUG isBettingRoundComplete] Hand 43: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 43: Context - activePlayers=2, actedSeats=[0,1], currentBet=4000000, currentRound=PRE_FLOP, roundActions queried=2, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 43: Active players detail: [{"seatNumber":0,"chipsCommitted":"4000000","status":"ACTIVE","hasActed":true,"hasMatched":true},{"seatNumber":1,"chipsCommitted":"4000000","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG callAction] Hand 43: isBettingRoundComplete returned true
[DEBUG callAction] Hand 43: Round complete, calling handleBettingRoundComplete
[DEBUG handleBettingRoundComplete] Hand 43: Called with currentRound=PRE_FLOP
[DEBUG handleBettingRoundComplete] Hand 43: Advancing from PRE_FLOP to next round
[DEBUG advanceBettingRound] Hand 43: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG advanceBettingRound] Hand 43: needsSidePots=false
[DEBUG advanceBettingRound] Hand 43: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG advanceBettingRound] Hand 43: Querying hand with: {"where":{"id":43},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG advanceBettingRound] Hand 43: Query result - hand.round=PRE_FLOP, players=2
[DEBUG advanceBettingRound] Hand 43: currentRound=PRE_FLOP, deckPosition=4, communityCards.length=0
[DEBUG advanceBettingRound] Hand 43: Advancing from PRE_FLOP to FLOP, cardsToDeal=3
[DEBUG advanceBettingRound] Hand 43: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 43: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '4000000' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '4000000' }
]
[DEBUG advanceBettingRound] Hand 43: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 43: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 43: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 43: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 43: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG advanceBettingRound] Hand 43: Updating hand state: round=FLOP, status=FLOP, currentActionSeat=0, newCommunityCards.length=3
[DEBUG advanceBettingRound] Hand 43: Updating hand with: {"where":{"id":43},"data":{"round":"FLOP","status":"FLOP","communityCards":"[3 cards]","deckPosition":7,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG advanceBettingRound] Hand 43: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG advanceBettingRound] Hand 43: RETURNING false - Round advanced successfully from PRE_FLOP to FLOP (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG handleBettingRoundComplete] Hand 43: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 43: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG handleBettingRoundComplete] Hand 43: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 43: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG callAction] Hand 43: handleBettingRoundComplete returned handEnded=false, roundAdvanced=true
[DEBUG callAction] Hand 43: RETURNING from transaction - Round complete
[DEBUG callAction] Hand 43: Context - hand.round=PRE_FLOP, handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG callAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=43

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG betAction] Hand 43: Player seat 0 betting 2000000 in round FLOP, currentBet before=0, chipsCommitted before=0, isAllIn=false
[DEBUG betAction] Hand 43: Creating BET action - hand.round=FLOP, actionType=RAISE, eventActionType=BET
[DEBUG createActionAndEvent] Hand 43: Creating action with: {"handId":43,"seatNumber":0,"round":"FLOP","action":"RAISE","amount":"2000000","handRound":"FLOP","roundParam":"FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG createActionAndEvent] Hand 43: Action created successfully: {"id":255,"seatNumber":0,"action":"RAISE","round":"FLOP","amount":"2000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG betAction] Hand 43: BET action created successfully, checking if round complete
[DEBUG betAction] Hand 43: Checking if betting round complete after BET
[DEBUG betAction] Hand 43: Context before isBettingRoundComplete - hand.round=FLOP, currentBet=0, currentActionSeat=0
[DEBUG isBettingRoundComplete] Hand 43: Starting check
[DEBUG isBettingRoundComplete] Hand 43: Querying hand with: {"where":{"id":43}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG isBettingRoundComplete] Hand 43: Query result - hand={"id":43,"round":"FLOP","currentBet":"2000000","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 43: currentBet=2000000, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 43: Querying handPlayers with: {"where":{"handId":43}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG isBettingRoundComplete] Hand 43: Query returned 2 handPlayers: [{"id":85,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"id":86,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 43: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 43: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 43: Querying roundActions with: {
  "where": {
    "handId": 43,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG isBettingRoundComplete] Hand 43: Query returned 1 roundActions for round FLOP: [{"id":255,"seatNumber":0,"action":"RAISE","amount":"2000000","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 43: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 43: Checking 2 active players against actedSeats and currentBet=2000000
[DEBUG isBettingRoundComplete] Hand 43: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=2000000, currentBet=2000000)
[DEBUG isBettingRoundComplete] Hand 43: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 43: Context - actedSeats=[0], playerSeat=1, currentRound=FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG betAction] Hand 43: isBettingRoundComplete returned false
[DEBUG handleBettingActionCompletion] Hand 43: Called with currentSeatNumber=0, currentRound=FLOP, bettingRoundComplete=false, isAllIn=false
[DEBUG handleBettingActionCompletion] Hand 43: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: Called with currentSeatNumber=0, currentRound=FLOP

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: Querying hand with: {"where":{"id":43},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: Query result - hand.round=FLOP, currentRound param=FLOP, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: nextPlayer seat=1, chipsCommitted=0, currentBet=2000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: Next player hasn't matched (chipsCommitted=0, currentBet=2000000)
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 43: Starting check
[DEBUG isBettingRoundComplete] Hand 43: Querying hand with: {"where":{"id":43}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG isBettingRoundComplete] Hand 43: Query result - hand={"id":43,"round":"FLOP","currentBet":"2000000","currentActionSeat":0,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 43: currentBet=2000000, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 43: Querying handPlayers with: {"where":{"handId":43}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG isBettingRoundComplete] Hand 43: Query returned 2 handPlayers: [{"id":85,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"id":86,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 43: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 43: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 43: Querying roundActions with: {
  "where": {
    "handId": 43,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG isBettingRoundComplete] Hand 43: Query returned 1 roundActions for round FLOP: [{"id":255,"seatNumber":0,"action":"RAISE","amount":"2000000","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 43: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 43: Checking 2 active players against actedSeats and currentBet=2000000
[DEBUG isBettingRoundComplete] Hand 43: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=2000000, currentBet=2000000)
[DEBUG isBettingRoundComplete] Hand 43: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 43: Context - actedSeats=[0], playerSeat=1, currentRound=FLOP, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: Updating hand with: {"where":{"id":43},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: Context - currentRound=FLOP, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG handleBettingActionCompletion] Hand 43: RETURNING result: handEnded=false, roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG betAction] Hand 43: handleBettingActionCompletion returned: handEnded=false, roundAdvanced=false
[DEBUG betAction] Hand 43: RETURNING from transaction
[DEBUG betAction] Hand 43: Context - hand.round=FLOP, handEnded=false, roundAdvanced=false, winnerSeatNumber=null
[DEBUG betAction] Hand 43: RETURNING from transaction - Final values: handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG betAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=43

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG raiseAction] Hand 43: Player seat 1 raising 2000000 in round FLOP, currentBet before=2000000, chipsCommitted before=0, isAllIn=false
[DEBUG raiseAction] Hand 43: Creating RAISE action - hand.round=FLOP, actionType=RAISE, eventActionType=RAISE
[DEBUG createActionAndEvent] Hand 43: Creating action with: {"handId":43,"seatNumber":1,"round":"FLOP","action":"RAISE","amount":"2000000","handRound":"FLOP","roundParam":"FLOP","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG createActionAndEvent] Hand 43: Action created successfully: {"id":256,"seatNumber":1,"action":"RAISE","round":"FLOP","amount":"2000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG raiseAction] Hand 43: RAISE action created successfully, checking if round complete
[DEBUG raiseAction] Hand 43: Checking if betting round complete after RAISE
[DEBUG raiseAction] Hand 43: Context before isBettingRoundComplete - hand.round=FLOP, currentBet=2000000, currentActionSeat=1
[DEBUG isBettingRoundComplete] Hand 43: Starting check
[DEBUG isBettingRoundComplete] Hand 43: Querying hand with: {"where":{"id":43}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG isBettingRoundComplete] Hand 43: Query result - hand={"id":43,"round":"FLOP","currentBet":"2000000","currentActionSeat":1,"status":"FLOP"}
[DEBUG isBettingRoundComplete] Hand 43: currentBet=2000000, currentRound=FLOP
[DEBUG isBettingRoundComplete] Hand 43: Querying handPlayers with: {"where":{"handId":43}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG isBettingRoundComplete] Hand 43: Query returned 2 handPlayers: [{"id":85,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"id":86,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG isBettingRoundComplete] Hand 43: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 43: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 43: Querying roundActions with: {
  "where": {
    "handId": 43,
    "round": "FLOP",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG isBettingRoundComplete] Hand 43: Query returned 2 roundActions for round FLOP: [{"id":255,"seatNumber":0,"action":"RAISE","amount":"2000000","round":"FLOP"},{"id":256,"seatNumber":1,"action":"RAISE","amount":"2000000","round":"FLOP"}]
[DEBUG isBettingRoundComplete] Hand 43: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 43: Checking 2 active players against actedSeats and currentBet=2000000
[DEBUG isBettingRoundComplete] Hand 43: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=2000000, currentBet=2000000)
[DEBUG isBettingRoundComplete] Hand 43: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=2000000, currentBet=2000000)
[DEBUG isBettingRoundComplete] Hand 43: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=2000000, currentBet=2000000)
[DEBUG isBettingRoundComplete] Hand 43: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=2000000, currentBet=2000000)
[DEBUG isBettingRoundComplete] Hand 43: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 43: Context - activePlayers=2, actedSeats=[0,1], currentBet=2000000, currentRound=FLOP, roundActions queried=2, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 43: Active players detail: [{"seatNumber":0,"chipsCommitted":"2000000","status":"ACTIVE","hasActed":true,"hasMatched":true},{"seatNumber":1,"chipsCommitted":"2000000","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG raiseAction] Hand 43: isBettingRoundComplete returned true
[DEBUG handleBettingActionCompletion] Hand 43: Called with currentSeatNumber=1, currentRound=FLOP, bettingRoundComplete=true, isAllIn=false
[DEBUG handleBettingActionCompletion] Hand 43: Betting round complete, calling handleBettingRoundComplete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG handleBettingRoundComplete] Hand 43: Called with currentRound=FLOP
[DEBUG handleBettingRoundComplete] Hand 43: Advancing from FLOP to next round
[DEBUG advanceBettingRound] Hand 43: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG advanceBettingRound] Hand 43: needsSidePots=false
[DEBUG advanceBettingRound] Hand 43: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG advanceBettingRound] Hand 43: Querying hand with: {"where":{"id":43},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG advanceBettingRound] Hand 43: Query result - hand.round=FLOP, players=2
[DEBUG advanceBettingRound] Hand 43: currentRound=FLOP, deckPosition=7, communityCards.length=3
[DEBUG advanceBettingRound] Hand 43: Advancing from FLOP to TURN, cardsToDeal=1
[DEBUG advanceBettingRound] Hand 43: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 43: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '2000000' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '2000000' }
]
[DEBUG advanceBettingRound] Hand 43: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 43: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 43: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 43: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 43: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG advanceBettingRound] Hand 43: Updating hand state: round=TURN, status=TURN, currentActionSeat=0, newCommunityCards.length=4
[DEBUG advanceBettingRound] Hand 43: Updating hand with: {"where":{"id":43},"data":{"round":"TURN","status":"TURN","communityCards":"[4 cards]","deckPosition":8,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG advanceBettingRound] Hand 43: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG advanceBettingRound] Hand 43: RETURNING false - Round advanced successfully from FLOP to TURN (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG handleBettingRoundComplete] Hand 43: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 43: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG handleBettingRoundComplete] Hand 43: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 43: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG handleBettingActionCompletion] Hand 43: Round completion handled: handEnded=false, roundAdvanced=true
[DEBUG handleBettingActionCompletion] Hand 43: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG raiseAction] Hand 43: handleBettingActionCompletion returned: handEnded=false, roundAdvanced=true
[DEBUG raiseAction] Hand 43: RETURNING from transaction
[DEBUG raiseAction] Hand 43: Context - hand.round=FLOP, handEnded=false, roundAdvanced=true, winnerSeatNumber=null
[DEBUG raiseAction] Hand 43: RETURNING from transaction - Final values: handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG raiseAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=43

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG betAction] Hand 43: Player seat 0 betting 2000000 in round TURN, currentBet before=0, chipsCommitted before=0, isAllIn=false
[DEBUG betAction] Hand 43: Creating BET action - hand.round=TURN, actionType=RAISE, eventActionType=BET
[DEBUG createActionAndEvent] Hand 43: Creating action with: {"handId":43,"seatNumber":0,"round":"TURN","action":"RAISE","amount":"2000000","handRound":"TURN","roundParam":"TURN","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG createActionAndEvent] Hand 43: Action created successfully: {"id":257,"seatNumber":0,"action":"RAISE","round":"TURN","amount":"2000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG betAction] Hand 43: BET action created successfully, checking if round complete
[DEBUG betAction] Hand 43: Checking if betting round complete after BET
[DEBUG betAction] Hand 43: Context before isBettingRoundComplete - hand.round=TURN, currentBet=0, currentActionSeat=0
[DEBUG isBettingRoundComplete] Hand 43: Starting check
[DEBUG isBettingRoundComplete] Hand 43: Querying hand with: {"where":{"id":43}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG isBettingRoundComplete] Hand 43: Query result - hand={"id":43,"round":"TURN","currentBet":"2000000","currentActionSeat":0,"status":"TURN"}
[DEBUG isBettingRoundComplete] Hand 43: currentBet=2000000, currentRound=TURN
[DEBUG isBettingRoundComplete] Hand 43: Querying handPlayers with: {"where":{"handId":43}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG isBettingRoundComplete] Hand 43: Query returned 2 handPlayers: [{"id":85,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"id":86,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 43: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 43: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 43: Querying roundActions with: {
  "where": {
    "handId": 43,
    "round": "TURN",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG isBettingRoundComplete] Hand 43: Query returned 1 roundActions for round TURN: [{"id":257,"seatNumber":0,"action":"RAISE","amount":"2000000","round":"TURN"}]
[DEBUG isBettingRoundComplete] Hand 43: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 43: Checking 2 active players against actedSeats and currentBet=2000000
[DEBUG isBettingRoundComplete] Hand 43: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=2000000, currentBet=2000000)
[DEBUG isBettingRoundComplete] Hand 43: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 43: Context - actedSeats=[0], playerSeat=1, currentRound=TURN, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG betAction] Hand 43: isBettingRoundComplete returned false
[DEBUG handleBettingActionCompletion] Hand 43: Called with currentSeatNumber=0, currentRound=TURN, bettingRoundComplete=false, isAllIn=false
[DEBUG handleBettingActionCompletion] Hand 43: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: Called with currentSeatNumber=0, currentRound=TURN

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: Querying hand with: {"where":{"id":43},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: Query result - hand.round=TURN, currentRound param=TURN, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: nextPlayer seat=1, chipsCommitted=0, currentBet=2000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: Next player hasn't matched (chipsCommitted=0, currentBet=2000000)
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 43: Starting check
[DEBUG isBettingRoundComplete] Hand 43: Querying hand with: {"where":{"id":43}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG isBettingRoundComplete] Hand 43: Query result - hand={"id":43,"round":"TURN","currentBet":"2000000","currentActionSeat":0,"status":"TURN"}
[DEBUG isBettingRoundComplete] Hand 43: currentBet=2000000, currentRound=TURN
[DEBUG isBettingRoundComplete] Hand 43: Querying handPlayers with: {"where":{"handId":43}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG isBettingRoundComplete] Hand 43: Query returned 2 handPlayers: [{"id":85,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"id":86,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 43: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 43: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 43: Querying roundActions with: {
  "where": {
    "handId": 43,
    "round": "TURN",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG isBettingRoundComplete] Hand 43: Query returned 1 roundActions for round TURN: [{"id":257,"seatNumber":0,"action":"RAISE","amount":"2000000","round":"TURN"}]
[DEBUG isBettingRoundComplete] Hand 43: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 43: Checking 2 active players against actedSeats and currentBet=2000000
[DEBUG isBettingRoundComplete] Hand 43: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=2000000, currentBet=2000000)
[DEBUG isBettingRoundComplete] Hand 43: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 43: Context - actedSeats=[0], playerSeat=1, currentRound=TURN, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: Updating hand with: {"where":{"id":43},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: Context - currentRound=TURN, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG handleBettingActionCompletion] Hand 43: RETURNING result: handEnded=false, roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG betAction] Hand 43: handleBettingActionCompletion returned: handEnded=false, roundAdvanced=false
[DEBUG betAction] Hand 43: RETURNING from transaction
[DEBUG betAction] Hand 43: Context - hand.round=TURN, handEnded=false, roundAdvanced=false, winnerSeatNumber=null
[DEBUG betAction] Hand 43: RETURNING from transaction - Final values: handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG betAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=43

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG raiseAction] Hand 43: Player seat 1 raising 2000000 in round TURN, currentBet before=2000000, chipsCommitted before=0, isAllIn=false
[DEBUG raiseAction] Hand 43: Creating RAISE action - hand.round=TURN, actionType=RAISE, eventActionType=RAISE
[DEBUG createActionAndEvent] Hand 43: Creating action with: {"handId":43,"seatNumber":1,"round":"TURN","action":"RAISE","amount":"2000000","handRound":"TURN","roundParam":"TURN","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG createActionAndEvent] Hand 43: Action created successfully: {"id":258,"seatNumber":1,"action":"RAISE","round":"TURN","amount":"2000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG raiseAction] Hand 43: RAISE action created successfully, checking if round complete
[DEBUG raiseAction] Hand 43: Checking if betting round complete after RAISE
[DEBUG raiseAction] Hand 43: Context before isBettingRoundComplete - hand.round=TURN, currentBet=2000000, currentActionSeat=1
[DEBUG isBettingRoundComplete] Hand 43: Starting check
[DEBUG isBettingRoundComplete] Hand 43: Querying hand with: {"where":{"id":43}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG isBettingRoundComplete] Hand 43: Query result - hand={"id":43,"round":"TURN","currentBet":"2000000","currentActionSeat":1,"status":"TURN"}
[DEBUG isBettingRoundComplete] Hand 43: currentBet=2000000, currentRound=TURN
[DEBUG isBettingRoundComplete] Hand 43: Querying handPlayers with: {"where":{"handId":43}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG isBettingRoundComplete] Hand 43: Query returned 2 handPlayers: [{"id":85,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"id":86,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG isBettingRoundComplete] Hand 43: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 43: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 43: Querying roundActions with: {
  "where": {
    "handId": 43,
    "round": "TURN",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG isBettingRoundComplete] Hand 43: Query returned 2 roundActions for round TURN: [{"id":257,"seatNumber":0,"action":"RAISE","amount":"2000000","round":"TURN"},{"id":258,"seatNumber":1,"action":"RAISE","amount":"2000000","round":"TURN"}]
[DEBUG isBettingRoundComplete] Hand 43: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 43: Checking 2 active players against actedSeats and currentBet=2000000
[DEBUG isBettingRoundComplete] Hand 43: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=2000000, currentBet=2000000)
[DEBUG isBettingRoundComplete] Hand 43: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=2000000, currentBet=2000000)
[DEBUG isBettingRoundComplete] Hand 43: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=2000000, currentBet=2000000)
[DEBUG isBettingRoundComplete] Hand 43: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=2000000, currentBet=2000000)
[DEBUG isBettingRoundComplete] Hand 43: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 43: Context - activePlayers=2, actedSeats=[0,1], currentBet=2000000, currentRound=TURN, roundActions queried=2, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 43: Active players detail: [{"seatNumber":0,"chipsCommitted":"2000000","status":"ACTIVE","hasActed":true,"hasMatched":true},{"seatNumber":1,"chipsCommitted":"2000000","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG raiseAction] Hand 43: isBettingRoundComplete returned true
[DEBUG handleBettingActionCompletion] Hand 43: Called with currentSeatNumber=1, currentRound=TURN, bettingRoundComplete=true, isAllIn=false
[DEBUG handleBettingActionCompletion] Hand 43: Betting round complete, calling handleBettingRoundComplete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG handleBettingRoundComplete] Hand 43: Called with currentRound=TURN
[DEBUG handleBettingRoundComplete] Hand 43: Advancing from TURN to next round
[DEBUG advanceBettingRound] Hand 43: Starting round advancement

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG advanceBettingRound] Hand 43: needsSidePots=false
[DEBUG advanceBettingRound] Hand 43: Updating total pot

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG advanceBettingRound] Hand 43: Querying hand with: {"where":{"id":43},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG advanceBettingRound] Hand 43: Query result - hand.round=TURN, players=2
[DEBUG advanceBettingRound] Hand 43: currentRound=TURN, deckPosition=8, communityCards.length=4
[DEBUG advanceBettingRound] Hand 43: Advancing from TURN to RIVER, cardsToDeal=1
[DEBUG advanceBettingRound] Hand 43: dealerPosition=0, totalPlayers=2
[DEBUG advanceBettingRound] Hand 43: Players: [
  { seatNumber: 0, status: 'ACTIVE', chipsCommitted: '2000000' },
  { seatNumber: 1, status: 'ACTIVE', chipsCommitted: '2000000' }
]
[DEBUG advanceBettingRound] Hand 43: nonFoldedPlayers=2, activePlayers=2
[DEBUG advanceBettingRound] Hand 43: Active player seats: [ 0, 1 ]
[DEBUG advanceBettingRound] Hand 43: allInPlayers=0, allPlayersAllIn=false, onlyOneActivePlayer=false
[DEBUG advanceBettingRound] Hand 43: smallBlindSeat=0
[DEBUG advanceBettingRound] Hand 43: Small blind (seat 0) is active, setting firstActionSeat=0

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG advanceBettingRound] Hand 43: Updating hand state: round=RIVER, status=RIVER, currentActionSeat=0, newCommunityCards.length=5
[DEBUG advanceBettingRound] Hand 43: Updating hand with: {"where":{"id":43},"data":{"round":"RIVER","status":"RIVER","communityCards":"[5 cards]","deckPosition":9,"currentBet":"0","lastRaiseAmount":null,"currentActionSeat":0}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG advanceBettingRound] Hand 43: Hand state updated successfully

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG advanceBettingRound] Hand 43: RETURNING false - Round advanced successfully from TURN to RIVER (not RIVER yet)

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG handleBettingRoundComplete] Hand 43: advanceBettingRound returned shouldSettle=false
[DEBUG handleBettingRoundComplete] Hand 43: Checking auto-advance to RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG handleBettingRoundComplete] Hand 43: advanceToRiverIfOnlyOneActivePlayer returned shouldAutoSettle=false
[DEBUG handleBettingRoundComplete] Hand 43: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG handleBettingActionCompletion] Hand 43: Round completion handled: handEnded=false, roundAdvanced=true
[DEBUG handleBettingActionCompletion] Hand 43: RETURNING result: handEnded=false, roundAdvanced=true

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG raiseAction] Hand 43: handleBettingActionCompletion returned: handEnded=false, roundAdvanced=true
[DEBUG raiseAction] Hand 43: RETURNING from transaction
[DEBUG raiseAction] Hand 43: Context - hand.round=TURN, handEnded=false, roundAdvanced=true, winnerSeatNumber=null
[DEBUG raiseAction] Hand 43: RETURNING from transaction - Final values: handEnded=false, roundAdvanced=true, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG raiseAction] RETURNING final result: handEnded=false, roundAdvanced=true, tableId=43

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG betAction] Hand 43: Player seat 0 betting 2000000 in round RIVER, currentBet before=0, chipsCommitted before=0, isAllIn=false
[DEBUG betAction] Hand 43: Creating BET action - hand.round=RIVER, actionType=RAISE, eventActionType=BET
[DEBUG createActionAndEvent] Hand 43: Creating action with: {"handId":43,"seatNumber":0,"round":"RIVER","action":"RAISE","amount":"2000000","handRound":"RIVER","roundParam":"RIVER","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG createActionAndEvent] Hand 43: Action created successfully: {"id":259,"seatNumber":0,"action":"RAISE","round":"RIVER","amount":"2000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG betAction] Hand 43: BET action created successfully, checking if round complete
[DEBUG betAction] Hand 43: Checking if betting round complete after BET
[DEBUG betAction] Hand 43: Context before isBettingRoundComplete - hand.round=RIVER, currentBet=0, currentActionSeat=0
[DEBUG isBettingRoundComplete] Hand 43: Starting check
[DEBUG isBettingRoundComplete] Hand 43: Querying hand with: {"where":{"id":43}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG isBettingRoundComplete] Hand 43: Query result - hand={"id":43,"round":"RIVER","currentBet":"2000000","currentActionSeat":0,"status":"RIVER"}
[DEBUG isBettingRoundComplete] Hand 43: currentBet=2000000, currentRound=RIVER
[DEBUG isBettingRoundComplete] Hand 43: Querying handPlayers with: {"where":{"handId":43}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG isBettingRoundComplete] Hand 43: Query returned 2 handPlayers: [{"id":85,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"id":86,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 43: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 43: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 43: Querying roundActions with: {
  "where": {
    "handId": 43,
    "round": "RIVER",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG isBettingRoundComplete] Hand 43: Query returned 1 roundActions for round RIVER: [{"id":259,"seatNumber":0,"action":"RAISE","amount":"2000000","round":"RIVER"}]
[DEBUG isBettingRoundComplete] Hand 43: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 43: Checking 2 active players against actedSeats and currentBet=2000000
[DEBUG isBettingRoundComplete] Hand 43: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=2000000, currentBet=2000000)
[DEBUG isBettingRoundComplete] Hand 43: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 43: Context - actedSeats=[0], playerSeat=1, currentRound=RIVER, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG betAction] Hand 43: isBettingRoundComplete returned false
[DEBUG handleBettingActionCompletion] Hand 43: Called with currentSeatNumber=0, currentRound=RIVER, bettingRoundComplete=false, isAllIn=false
[DEBUG handleBettingActionCompletion] Hand 43: No auto-advance, calling handleNextPlayerOrRoundComplete
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: Called with currentSeatNumber=0, currentRound=RIVER

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: getNextActivePlayer returned nextSeat=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: nextSeat=1, checking wrap-around completion
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: Querying hand with: {"where":{"id":43},"include":{"players":true}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: Query result - hand.round=RIVER, currentRound param=RIVER, players=2
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: Hand players: [{"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: nextPlayer seat=1, chipsCommitted=0, currentBet=2000000
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: Next player hasn't matched (chipsCommitted=0, currentBet=2000000)
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: Checking isBettingRoundComplete for zero-bet wrap-around
[DEBUG isBettingRoundComplete] Hand 43: Starting check
[DEBUG isBettingRoundComplete] Hand 43: Querying hand with: {"where":{"id":43}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG isBettingRoundComplete] Hand 43: Query result - hand={"id":43,"round":"RIVER","currentBet":"2000000","currentActionSeat":0,"status":"RIVER"}
[DEBUG isBettingRoundComplete] Hand 43: currentBet=2000000, currentRound=RIVER
[DEBUG isBettingRoundComplete] Hand 43: Querying handPlayers with: {"where":{"handId":43}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG isBettingRoundComplete] Hand 43: Query returned 2 handPlayers: [{"id":85,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"id":86,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"0"}]
[DEBUG isBettingRoundComplete] Hand 43: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 43: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 43: Querying roundActions with: {
  "where": {
    "handId": 43,
    "round": "RIVER",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG isBettingRoundComplete] Hand 43: Query returned 1 roundActions for round RIVER: [{"id":259,"seatNumber":0,"action":"RAISE","amount":"2000000","round":"RIVER"}]
[DEBUG isBettingRoundComplete] Hand 43: actedSeats: [ 0 ]
[DEBUG isBettingRoundComplete] Hand 43: Checking 2 active players against actedSeats and currentBet=2000000
[DEBUG isBettingRoundComplete] Hand 43: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=2000000, currentBet=2000000)
[DEBUG isBettingRoundComplete] Hand 43: RETURNING false - Player 1 hasn't acted yet.
[DEBUG isBettingRoundComplete] Hand 43: Context - actedSeats=[0], playerSeat=1, currentRound=RIVER, roundActions found=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: isBettingRoundComplete returned false
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: Round not complete, advancing to next player 1
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: Updating hand with: {"where":{"id":43},"data":{"currentActionSeat":1}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: Hand updated successfully, currentActionSeat now=1
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: RETURNING result - Round not complete, advancing to next player
[DEBUG handleNextPlayerOrRoundComplete] Hand 43: Context - currentRound=RIVER, nextSeat=1, result.handEnded=false, result.roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG handleBettingActionCompletion] Hand 43: RETURNING result: handEnded=false, roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG betAction] Hand 43: handleBettingActionCompletion returned: handEnded=false, roundAdvanced=false
[DEBUG betAction] Hand 43: RETURNING from transaction
[DEBUG betAction] Hand 43: Context - hand.round=RIVER, handEnded=false, roundAdvanced=false, winnerSeatNumber=null
[DEBUG betAction] Hand 43: RETURNING from transaction - Final values: handEnded=false, roundAdvanced=false, winnerSeatNumber=null

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG betAction] RETURNING final result: handEnded=false, roundAdvanced=false, tableId=43

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG raiseAction] Hand 43: Player seat 1 raising 2000000 in round RIVER, currentBet before=2000000, chipsCommitted before=0, isAllIn=false
[DEBUG raiseAction] Hand 43: Creating RAISE action - hand.round=RIVER, actionType=RAISE, eventActionType=RAISE
[DEBUG createActionAndEvent] Hand 43: Creating action with: {"handId":43,"seatNumber":1,"round":"RIVER","action":"RAISE","amount":"2000000","handRound":"RIVER","roundParam":"RIVER","roundMatch":true}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG createActionAndEvent] Hand 43: Action created successfully: {"id":260,"seatNumber":1,"action":"RAISE","round":"RIVER","amount":"2000000"}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG raiseAction] Hand 43: RAISE action created successfully, checking if round complete
[DEBUG raiseAction] Hand 43: Checking if betting round complete after RAISE
[DEBUG raiseAction] Hand 43: Context before isBettingRoundComplete - hand.round=RIVER, currentBet=2000000, currentActionSeat=1
[DEBUG isBettingRoundComplete] Hand 43: Starting check
[DEBUG isBettingRoundComplete] Hand 43: Querying hand with: {"where":{"id":43}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG isBettingRoundComplete] Hand 43: Query result - hand={"id":43,"round":"RIVER","currentBet":"2000000","currentActionSeat":1,"status":"RIVER"}
[DEBUG isBettingRoundComplete] Hand 43: currentBet=2000000, currentRound=RIVER
[DEBUG isBettingRoundComplete] Hand 43: Querying handPlayers with: {"where":{"handId":43}}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG isBettingRoundComplete] Hand 43: Query returned 2 handPlayers: [{"id":85,"seatNumber":0,"status":"ACTIVE","chipsCommitted":"2000000"},{"id":86,"seatNumber":1,"status":"ACTIVE","chipsCommitted":"2000000"}]
[DEBUG isBettingRoundComplete] Hand 43: activePlayers=2, allInPlayers=0
[DEBUG isBettingRoundComplete] Hand 43: Active player seats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 43: Querying roundActions with: {
  "where": {
    "handId": 43,
    "round": "RIVER",
    "action": {
      "not": "POST_BLIND"
    }
  }
}

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG isBettingRoundComplete] Hand 43: Query returned 2 roundActions for round RIVER: [{"id":259,"seatNumber":0,"action":"RAISE","amount":"2000000","round":"RIVER"},{"id":260,"seatNumber":1,"action":"RAISE","amount":"2000000","round":"RIVER"}]
[DEBUG isBettingRoundComplete] Hand 43: actedSeats: [ 0, 1 ]
[DEBUG isBettingRoundComplete] Hand 43: Checking 2 active players against actedSeats and currentBet=2000000
[DEBUG isBettingRoundComplete] Hand 43: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=2000000, currentBet=2000000)
[DEBUG isBettingRoundComplete] Hand 43: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=2000000, currentBet=2000000)
[DEBUG isBettingRoundComplete] Hand 43: Player 0 - hasActed=true, hasMatched=true (chipsCommitted=2000000, currentBet=2000000)
[DEBUG isBettingRoundComplete] Hand 43: Player 1 - hasActed=true, hasMatched=true (chipsCommitted=2000000, currentBet=2000000)
[DEBUG isBettingRoundComplete] Hand 43: RETURNING true - Final check complete
[DEBUG isBettingRoundComplete] Hand 43: Context - activePlayers=2, actedSeats=[0,1], currentBet=2000000, currentRound=RIVER, roundActions queried=2, allActedAndMatched=true
[DEBUG isBettingRoundComplete] Hand 43: Active players detail: [{"seatNumber":0,"chipsCommitted":"2000000","status":"ACTIVE","hasActed":true,"hasMatched":true},{"seatNumber":1,"chipsCommitted":"2000000","status":"ACTIVE","hasActed":true,"hasMatched":true}]

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG raiseAction] Hand 43: isBettingRoundComplete returned true
[DEBUG handleBettingActionCompletion] Hand 43: Called with currentSeatNumber=1, currentRound=RIVER, bettingRoundComplete=true, isAllIn=false
[DEBUG handleBettingActionCompletion] Hand 43: Betting round complete, calling handleBettingRoundComplete

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG handleBettingRoundComplete] Hand 43: Called with currentRound=RIVER
[DEBUG handleBettingRoundComplete] Hand 43: RIVER round, settling hand via showdown

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG handleBettingRoundComplete] Hand 43: Hand settled, winnerSeatNumber=1
[DEBUG handleBettingRoundComplete] Hand 43: RETURNING result with settlement: handEnded=true, roundAdvanced=false, winnerSeatNumber=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG handleBettingActionCompletion] Hand 43: Round completion handled: handEnded=true, roundAdvanced=false
[DEBUG handleBettingActionCompletion] Hand 43: RETURNING result: handEnded=true, roundAdvanced=false

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG raiseAction] Hand 43: handleBettingActionCompletion returned: handEnded=true, roundAdvanced=false
[DEBUG raiseAction] Hand 43: RETURNING from transaction
[DEBUG raiseAction] Hand 43: Context - hand.round=RIVER, handEnded=true, roundAdvanced=false, winnerSeatNumber=1
[DEBUG raiseAction] Hand 43: RETURNING from transaction - Final values: handEnded=true, roundAdvanced=false, winnerSeatNumber=1

stdout | tests/integration/twoPlayerMatrix.test.ts > 2-Player Poker Test Matrix > EDGE CASES > EC-001: Minimum Raise Scenario
[DEBUG raiseAction] RETURNING final result: handEnded=true, roundAdvanced=false, tableId=43

stdout | tests/integration/twoPlayerMatrix.test.ts
Cleaning up test database...

stdout | tests/integration/twoPlayerMatrix.test.ts
PostgreSQL container stopped

 âœ“ tests/integration/twoPlayerMatrix.test.ts (43 tests) 9727ms

 Test Files  1 passed (1)
      Tests  43 passed (43)
   Start at  07:10:09
   Duration  10.53s (transform 116ms, setup 173ms, import 560ms, tests 9.73s, environment 0ms)

